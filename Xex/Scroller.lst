mads 2.0.7
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		Scroller.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;	1 page 				= 256 bytes
    14 				;	1 K	   				= 004 pages - 1024 bytes	 
    15 				;	2 K	   				= 008 pages - 2048 bytes	 
    16 				;	3 K	   				= 012 pages - 3072 bytes	 
    17 				;	4 K	   				= 016 pages - 4096 bytes	 
    18 				;
    19 				;***** Memory Map - Atari 64K
    20 				;
    21 				;	$0000-$007F			zeropage for OS
    22 				;	$0080-$00FF 		zeropage for you
    23 				;	$0100-$01FF 		CPU stack
    24 				;	$0200-$02FF 		OS vector, registers
    25 				;	$0300-$03FF 		OS vector, registers
    26 				;	$0400-$05FF 		OS buffers
    27 				;	$0600-$06FF 		Page 6, object code in BASIC
    28 				;	$0700-$1FFF 		Disk Operating System
    29 				;	$2000-$7FFF 		User Code Area 
    30 				;	$8000-$BFFF 		Cartrige A and B slots
    31 				;	$C000-$CBFF 		OS part 1
    32 				;	$CC00-$CFFF 		OS character set, international
    33 				;	$D000-$D7FF			Hardware registers
    34 				;	$D800-$DFFF			FP Routines
    35 				;	$E000-$E3FF 		OS character set, standard
    36 				;	$E000-$FFFF 		OS part 2
    37 				;
    38 				;***** Include Library Files
    39 				;
    40 						icl "/Lib/AtariEquates.Asm"				; Atari hardware DOS,OS,ANTIC,GITA,POKEY,PIA equates
Source: E:\_8BitProjects\Series\Scroller\\Lib\AtariEquates.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		AtariEquates.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************
    14 				; OS memory and vectors
    15 				;
    16 = 0012			RTCLOK 						= $12 				; and $13, and $14.  
    17 = 0014			RTCLOK60 					= $14 				; incremented every jiffy/frame.
    18
    19 = 004D			ATRACT 						= $4D
    20 = 0200			VDSLST 						= $0200 			; Display List interrupt.
    21
    22 				;
    23 				;**************************************************
    24 				; DOS - Misc values related to DOS and file loading
    25 				;
    26 = 2000			LOMEM_DOS 					= $2000 			; First usable memory after DOS
    27 = 3308			LOMEM_DOS_DUP 				= $3308 			; First usable memory after DOS and DUP 
    28
    29 				;**************************************************	
    30 				; Atari RUN ADDRESS.  
    31 				;
    32 				; 	The binary load file has a segmented structure 
    33 				; 	specifying starting address, and ending address, 
    34 				; 	followed by the bytes to load in that memory range.  
    35 				;
    36 				; 	DOS observes two special addresses when loading data.
    37 				; 	If the contents of the INIT address changes ater loading
    38 				; 	a segment DOS calls that address immediately. If the routine
    39 				; 	returns to DOS cleanly then file loading continues.
    40 				;
    41 				; 	If the contents of the RUN address changes DOS waits until
    42 				; 	all segments from the file are loaded and then calls the RUN
    43 				; 	address target.
    44 				;
    45 = 02E0			DOS_RUN_ADDR 				= $02e0				; Execute here when file loading completes.
    46 = 02E2			DOS_INIT_ADDR 				= $02e2				; Execute here immediately then resume loading.
    47
    48 				;**************************************************	
    49 				; ANTIC - Register List
    50 				;
    51 = D400			DMACTL 						= $D400				; DMA control for display and Player/Missile graphics
    52 = D401			CHACTL 						= $D401				; Character display control
    53 = D402			DLISTL 						= $D402				; Display List Pointer (low)
    54 = D403			DLISTH 						= $D403				; Display List Pointer (high)
    55 = D404			HSCROL 						= $D404				; Horizontal Fine Scroll 0 to 16 color clocks.
    56 = D405			VSCROL 						= $D405				; Vertical Fine Scroll 0 to 16 scanlines.
    57 = D407			PMBASE 						= $D407				; Player/Missile Base Address (high) 
    58 = D409			CHBASE 						= $D409				; Character Set Base Address (high)
    59 = D40A			WSYNC 						= $D40A				; Wait for Horizontal Sync
    60 = D40B			VCOUNT 						= $D40B				; (Read) Vertical Scan Line Counter
    61 = D40C			PENH 						= $D40C				; (Read) Light Pen Horizontal Position
    62 = D40D			PENV 						= $D40D				; (Read) Light Pen Vertical Position
    63 = D40E			NMIEN 						= $D40E				; Non-Maskable Interupt (NMI) Enable
    64 = D40F			NMIRES 						= $D40F				; (Write) Non-Maskable Interrupt (NMI) Reset
    65 = D40F			NMIST 						= $D40F				; (Read)  Non-Maskable Interrupt Status                   	
    66 				                   	;
    67 				;**************************************************
    68 				; Handler vectors:
    69 				;
    70 = FFFA			NMIH_VECTOR					= $FFFA
    71 = FFFC			RESH_VECTOR					= $FFFC
    72 = FFFE			IRQH_VECTOR					= $FFFE
    73
    74 				;**************************************************	
    75 				; Shadow Registers for Hardware Registers
    76 				;
    77 = 022F			SDMCTL 						= $022F 			; DMACTL
    78 = 0230			SDLSTL 						= $0230 			; DLISTL
    79 = 0231			SDLSTH 						= $0231 			; DLISTH
    80 = 02F4			CHBAS 						= $02F4 			; CHBASE
    81 = 02F3			CHART 						= $02F3 			; CHACTL
    82 = 0234			LPENH 						= $0234 			; (Read) PENH
    83 = 0235			LPENV 						= $0235 			; (Read) PENV
    84
    85 				;**************************************************	
    86 				; Important Bit Positions
    87 				;
    88 				;**************************************************
    89 				; DMACTL and SDMCTL - DMA control for display and Player/Missile graphics
    90 				;
    91 = 00DF			MASK_DL_DMA 				= %11011111			; Enable/Disable DMA to read the Display List
    92 = 00EF			MASK_PM_RESOLUTION 			= %11101111			; Set P/M graphics DMA to 1 or 2 scan line per update  
    93 = 00F3			MASK_PM_DMA 				= %11110011			; Enable/Disable DMA for Players/Missiles
    94 = 00FC			MASK_PLAYFIELD_WIDTH 		= %11111100			; Enable playfield display/set playfield width
    95
    96 				;**************************************************	
    97 				; DMACTL and SDMCTL - Enable/Disable DMA to read the Display List
    98 				;
    99 = 0020			ENABLE_DL_DMA 				= %00100000
   100 = 0000			DISABLE_DL_DMA 				= %00000000			; defining this is overkill
   101
   102 				;**************************************************	
   103 				; DMACTL and SDMCTL - Set P/M graphics DMA to 1 or 2 scan line per update  
   104 				;
   105 = 0010			PM_1LINE_RESOLUTION 		= %00010000
   106 = 0000			PM_2LINE_RESOLUTION 		= %00000000
   107
   108 				;**************************************************	
   109 				; DMACTL and SDMCTL - Enable DMA for Players/Missiles
   110 				;
   111 = 0008			ENABLE_PLAYER_DMA 			= %00001000
   112 = 0004			ENABLE_MISSILE_DMA 			= %00000100
   113 = 000C			ENABLE_PM_DMA 				= %00001100
   114
   115 				;**************************************************	
   116 				; DMACTL and SDMCTL - Enable playfield display/set playfield width
   117 				;
   118 = 0000			PLAYFIELD_DISABLE 			= %00000000			; No width is the same as no display
   119 = 0001			PLAYFIELD_WIDTH_NARROW_MASK	= %00000001			; 32 characters/128 color clocks
   120 = 0002			PLAYFIELD_WIDTH_NORMAL_MASK	= %00000010			; 40 characters/160 color clocks
   121 = 0003			PLAYFIELD_WIDTH_WIDE_MASK	= %00000011			; 48 characters/192 color clocks (176 visible)
   122
   123 				;**************************************************	
   124 				; CHACTL - Character display control
   125 				;
   126 = 00FB			MASK_CHACTL_REFLECT 		= %11111011			; Enable/Disable vertical reflect
   127 = 00FD			MASK_CHACTL_INVERSE 		= %11111101			; Enable/Disable characters with high bit set displayed as inverse 
   128 = 00FE			MASK_CHACTL_BLANK 			= %11111110			; Enable/Disable characters with high bit set displayed as blank space
   129
   130 				;**************************************************	
   131 				; CHACTL - Enable character display options
   132 				; 
   133 = 0004			CHACTL_REFLECT 				= %00000100 		; Enable vertical reflect
   134 = 0002			CHACTL_INVERSE 				= %00000010 		; Enable inverse display for characters with high bit set
   135 = 0001			CHACTL_BLANK 				= %00000001 		; Enable blank display for characters with high bit set
   136
   137 				;**************************************************	
   138 				; NMIEN (NMIRES and NMIST) - Non-Maskable Interupt (NMI) Reset and Status
   139 				;
   140 = 007F			MASK_NMI_DLI 				= %01111111 		; Enable/Disable Display List Interrupts
   141 = 00BF			MASK_NMI_VBI 				= %10111111 		; Enable/Disable Vertical Blank Interrupt
   142 = 00DF			MASK_NMI_RESET 				= %11011111 		; Enable/Disable Reset Key Interrupt
   143
   144 				;**************************************************	
   145 				; NMIEN (NMIRES and NMIST) - Enable Non-Maskable Interupts
   146 				;
   147 = 0080			NMI_DLI 					= %10000000 		; Enable Display List Interrupts
   148 = 0040			NMI_VBI 					= %01000000 		; Enable Vertical Blank Interrupt
   149 = 0020			NMI_RESET 					= %00100000 		; Enable Reset Key Interrupt
   150
   151 				;**************************************************	
   152 				; Display List Instructions/Options Mask
   153 				;
   154 = 007F			MASK_DL_DLI 				= %01111111 		; Display List Interrupt on last scan line of graphics line
   155 = 00BF			MASK_DL_LMS 				= %10111111 		; Reload Memory Scan address for this graphics line
   156 = 00DF			MASK_DL_VSCROLL 			= %11011111 		; Vertical scrolling for this graphics line
   157 = 00EF			MASK_DL_HSCROLL 			= %11101111 		; Horizontal scrolling for this graphics line
   158 = 00F0			MASK_DL_MODE 				= %11110000 		; Text/Graphics Modes
   159
   160 				;**************************************************	
   161 				; Display List Instruction Options
   162 				;
   163 = 0080			DL_DLI 						= %10000000 		; Enable Display List Interrupt on last scan line of graphics line
   164 = 0040			DL_LMS 						= %01000000 		; Enable Reload Memory Scan address for this graphics line
   165 = 0020			DL_VSCROLL 					= %00100000 		; Enable Vertical scrolling for this graphics line
   166 = 0010			DL_HSCROLL 					= %00010000 		; Enable Horizontal scrolling for this graphics line
   167 = 000F			DL_MODE 					= %00001111 		; Collection of Text/Graphics Modes
   168
   169 				;**************************************************	
   170 				; Display List Instructions, Jump 
   171 				;
   172 = 0001			DL_JUMP 					= $01				; Display List jump to new address
   173 = 0041			DL_JUMP_VB 					= $41				; Display List jump to address and start Vertical Blank
   174 				                        	
   175 				;**************************************************	
   176 				; Display List Instructions, blank scan lines
   177 				;
   178 				; 	Note: Bit $80 is not part of this, so the
   179 				; 	DL_DLI Instruction Option is available for 
   180 				; 	the blank line instructions.
   181 				;
   182 = 0000			DL_BLANK_1 					= $00 				; 1 Blank Scan line
   183 = 0010			DL_BLANK_2 					= $10 				; 2 Blank Scan lines
   184 = 0020			DL_BLANK_3 					= $20 				; 3 Blank Scan lines
   185 = 0030			DL_BLANK_4 					= $30 				; 4 Blank Scan lines
   186 = 0040			DL_BLANK_5 					= $40 				; 5 Blank Scan lines
   187 = 0050			DL_BLANK_6 					= $50 				; 6 Blank Scan lines
   188 = 0060			DL_BLANK_7 					= $60 				; 7 Blank Scan lines
   189 = 0070			DL_BLANK_8 					= $70 				; 8 Blank Scan lines
   190
   191 				;**************************************************	
   192 				; Display List Instructions, Text Modes
   193 				;
   194 = 0002			DL_TEXT_2 					= $02 				; 1.5 Color, 40 Columns X  8 Scan lines
   195 = 0003			DL_TEXT_3 					= $03 				; 1.5 Color, 40 Columns X 10 Scan lines
   196 = 0004			DL_TEXT_4 					= $04 				; 4/5 Color, 40 Columns X  8 Scan lines
   197 = 0005			DL_TEXT_5 					= $05 				; 4/5 Color, 40 Columns X 16 Scan lines
   198 = 0006			DL_TEXT_6 					= $06 				;   5 Color, 20 Columns X  8 Scan lines
   199 = 0007			DL_TEXT_7 					= $07 				;   5 Color, 20 Columns X 16 Scan lines
   200
   201 				;**************************************************	
   202 				; Display List Instructions, Map Modes
   203 				;
   204 = 0008			DL_MAP_8 					= $08 				;   4 Color,  40 Pixels X   8 Scan Lines
   205 = 0009			DL_MAP_9 					= $09 				;   2 Color,  80 Pixels X   4 Scan Lines
   206 = 000A			DL_MAP_A 					= $0A 				;   4 Color,  80 Pixels X   4 Scan Lines
   207 = 000B			DL_MAP_B 					= $0B 				;   2 Color, 160 Pixels X   2 Scan Lines
   208 = 000C			DL_MAP_C 					= $0C 				;   2 Color, 160 Pixels X   1 Scan Lines
   209 = 000D			DL_MAP_D 					= $0D 				;   4 Color, 160 Pixels X   2 Scan Lines
   210 = 000E			DL_MAP_E 					= $0E 				;   4 Color, 160 Pixels X   1 Scan Lines
   211 = 000F			DL_MAP_F 					= $0F 				; 1.5 Color, 320 Pixels X   1 Scan Lines (and GTIA modes)
   212
   213 				;**************************************************	
   214 				; GTIA - Register List
   215 				;
   216 				;**************************************************	
   217 				; Hardware Registers
   218 				;
   219 = D000			HPOSP0 						= $D000 			; Player 0 Horizontal Position
   220 = D001			HPOSP1 						= $D001 			; Player 1 Horizontal Position
   221 = D002			HPOSP2 						= $D002 			; Player 2 Horizontal Position
   222 = D003			HPOSP3 						= $D003 			; Player 3 Horizontal Position
   223 				                        	
   224 = D004			HPOSM0 						= $D004 			; Missile 0 Horizontal Position
   225 = D005			HPOSM1 						= $D005 			; Missile 1 Horizontal Position
   226 = D006			HPOSM2 						= $D006 			; Missile 2 Horizontal Position
   227 = D007			HPOSM3 						= $D007 			; Missile 3 Horizontal Position
   228 				;;     						        			
   229 = D008			SIZEP0 						= $D008 			; Player 0 Size
   230 = D009			SIZEP1 						= $D009 			; Player 1 Size
   231 = D00A			SIZEP2 						= $D00A 			; Player 2 Size
   232 = D00B			SIZEP3 						= $D00B 			; Player 3 Size
   233 = D00C			SIZEM 						= $D00C 			; Missiles Sizes (2 bits per missile)
   234 				                        	
   235 = D00D			GRAFP0 						= $D00D 			; Player 0 Graphics Pattern
   236 = D00E			GRAFP1 						= $D00E 			; Player 1 Graphics Pattern
   237 = D00F			GRAFP2 						= $D00F 			; Player 2 Graphics Pattern
   238 = D010			GRAFP3 						= $D010 			; Player 3 Graphics Pattern
   239 = D011			GRAFM 						= $D011 			; Missile Graphics Pattern (2 bits per missile)
   240 				                        	
   241 = D000			M0PF 						= $D000 			; (Read) Missile 0 to Playfield collisions
   242 = D001			M1PF 						= $D001 			; (Read) Missile 1 to Playfield collisions
   243 = D002			M2PF 						= $D002 			; (Read) Missile 2 to Playfield collisions
   244 = D003			M3PF 						= $D003 			; (Read) Missile 3 to Playfield collisions
   245 				   					    	    			
   246 = D004			P0PF 						= $D004 			; (Read) Player 0 to Playfield collisions
   247 = D005			P1PF 						= $D005 			; (Read) Player 1 to Playfield collisions
   248 = D006			P2PF 						= $D006 			; (Read) Player 2 to Playfield collisions
   249 = D007			P3PF 						= $D007 			; (Read) Player 3 to Playfield collisions
   250 				   					    	    			
   251 = D008			M0PL 						= $D008 			; (Read) Missile 0 to Player collisions
   252 = D009			M1PL 						= $D009 			; (Read) Missile 1 to Player collisions
   253 = D00A			M2PL 						= $D00A 			; (Read) Missile 2 to Player collisions
   254 = D00B			M3PL 						= $D00B 			; (Read) Missile 3 to Player collisions
   255 				   					    	    			
   256 = D00C			P0PL 						= $D00C 			; (Read) Player 0 to Player collisions
   257 = D00D			P1PL 						= $D00D 			; (Read) Player 1 to Player collisions
   258 = D00E			P2PL 						= $D00E 			; (Read) Player 2 to Player collisions
   259 = D00F			P3PL 						= $D00F 			; (Read) Player 3 to Player collisions
   260 				                        	
   261 = D012			COLPM0 						= $D012 			; Player/Missile 0 color, GTIA 9-color playfield color 0 for Background
   262 = D013			COLPM1 						= $D013 			; Player/Missile 1 color, GTIA 9-color playfield color 1
   263 = D014			COLPM2 						= $D014 			; Player/Missile 2 color, GTIA 9-color playfield color 2
   264 = D015			COLPM3 						= $D015 			; Player/Missile 3 color, GTIA 9-color playfield color 3
   265 				       						        			
   266 = D016			COLPF0 						= $D016 			; Playfield 0 color
   267 = D017			COLPF1 						= $D017 			; Playfield 1 color
   268 = D018			COLPF2 						= $D018 			; Playfield 2 color
   269 = D019			COLPF3 						= $D019 			; Playfield 3 color (and fifth Player color)
   270 = D01A			COLBK 						= $D01A 			; Playfield Background color
   271 				                        	
   272 = D010			TRIG0 						= $D010 			; (Read) Joystick 0 trigger
   273 = D011			TRIG1 						= $D011 			; (Read) Joystick 1 trigger
   274 = D012			TRIG2 						= $D012 			; (Read) Joystick 2 trigger
   275 = D013			TRIG3 						= $D013 			; (Read) Joystick 3 trigger
   276 				    						        				
   277 = D014			PAL    						= $D014 			; (Read) PAL Flag
   278 = D01B			PRIOR  						= $D01B 			; Control Priority, Fifth Player and GTIA modes
   279 = D01C			VDELAY 						= $D01C 			; Player Missile Vertical Delay
   280 = D01D			GRACTL 						= $D01D 			; Graphics Control, P/M DMA and joystick trigger latches
   281 = D01E			HITCLR 						= $D01E 			; Clear Player/Missile Collisions
   282 				     						        			
   283 = D01F			CONSOL 						= $D01F 			; (Read) Start, Select, Option console keys.
   284 = D01F			CONSPK 						= $D01F 			; Console speaker.
   285
   286 				;**************************************************	
   287 				; Shadow Registers for Hardware Registers
   288 				;
   289 = 0284			STRIG0 						= $0284				; (Read) TRIG0 - Joystick 0 trigger
   290 = 0285			STRIG1 						= $0285				; (Read) TRIG1 - Joystick 1 trigger
   291 = 0286			STRIG2 						= $0286				; (Read) TRIG2 - Joystick 2 trigger
   292 = 0287			STRIG3 						= $0287				; (Read) TRIG3 - Joystick 3 trigger
   293 				                        	
   294 = 02C0			PCOLOR0 					= $02C0				; COLPM0 - Player/Missile 0 color, GTIA 9-color playfield color 0 for Background
   295 = 02C1			PCOLOR1 					= $02C1				; COLPM1 - Player/Missile 1 color, GTIA 9-color playfield color 1
   296 = 02C2			PCOLOR2 					= $02C2				; COLPM2 - Player/Missile 2 color, GTIA 9-color playfield color 2
   297 = 02C3			PCOLOR3 					= $02C3				; COLPM3 - Player/Missile 3 color, GTIA 9-color playfield color 3
   298 				                      	
   299 = 02C4			COLOR0 						= $02C4				; COLPF0 - Playfield 0 color
   300 = 02C5			COLOR1 						= $02C5				; COLPF1 - Playfield 1 color
   301 = 02C6			COLOR2 						= $02C6				; COLPF2 - Playfield 2 color
   302 = 02C7			COLOR3 						= $02C7				; COLPF3 - Playfield 3 color (and fifth Player color)
   303 = 02C8			COLOR4 						= $02C8				; COLBK  - Playfield Background color
   304 				     						        				
   305 = 026F			GPRIOR 						= $026F				; PRIOR - Control Priority, Fifth Player and GTIA modes
   306
   307 				;**************************************************	
   308 				; Important Bit Positions
   309 				;		
   310 				;	SIZEP0 - SIZEP3
   311 				;
   312 = 0003			PLAYER_SIZE_BITS 			= %00000011
   313 = 0000			PM_SIZE_NORMAL 				= %00000000 		; One color clock per Player/Missile pixel
   314 = 0001			PM_SIZE_DOUBLE 				= %00000001 		; Two color clocks per Player/Missile pixel
   315 = 0003			PM_SIZE_QUAD 				= %00000011 		; Fopur color clocks per Player/Missile pixel
   316
   317 				;**************************************************	
   318 				; SIZEM and GRAFM (and missile memory)
   319 				;
   320 = 00FC			MASK_MISSILE0_BITS 			= %11111100
   321 = 00F3			MASK_MISSILE1_BITS 			= %11110011
   322 = 00CF			MASK_MISSILE2_BITS 			= %11001111
   323 = 003F			MASK_MISSILE3_BITS 			= %00111111
   324 				                        	
   325 = 0003			MISSILE0_BITS 				= %00000011
   326 = 000C			MISSILE1_BITS 				= %00001100
   327 = 0030			MISSILE2_BITS 				= %00110000
   328 = 00C0			MISSILE3_BITS 				= %11000000
   329 = 0055			MISSILES_BITS				= %01010101
   330 				 
   331 				;**************************************************	
   332 				; Collisions MxPF, MxPL, PxPF, PxPL
   333 				;
   334 				; 	COLPMx or COLPFx where X is bits 0 through 3
   335 				;
   336 = 00FE			MASK_COLPMF0_BIT 			= %11111110 		; Player or Missile v Player or Playfield color 0
   337 = 00FD			MASK_COLPMF1_BIT 			= %11111101 		; Player or Missile v Player or Playfield color 1
   338 = 00FB			MASK_COLPMF2_BIT 			= %11111011 		; Player or Missile v Player or Playfield color 2
   339 = 00F7			MASK_COLPMF3_BIT 			= %11110111 		; Player or Missile v Player or Playfield color 3
   340 				                      	
   341 = 0001			COLPMF0_BIT 				= %00000001 		; Player or Missile v Player or Playfield color 0
   342 = 0002			COLPMF1_BIT 				= %00000010 		; Player or Missile v Player or Playfield color 1
   343 = 0004			COLPMF2_BIT 				= %00000100 		; Player or Missile v Player or Playfield color 2
   344 = 0008			COLPMF3_BIT 				= %00001000 		; Player or Missile v Player or Playfield color 3
   345
   346 				;**************************************************	
   347 				; Colors Registers
   348 				;
   349 = 00F0			COLOR_BITS 					= %11110000
   350 = 000F			LUMA_BITS 					= %00001111
   351
   352 				;**************************************************	
   353 				; PRIOR and GPRIOR - Control Priority, Fifth Player and GTIA modes
   354 				;
   355 = 00F0			MASK_PRIORITY 				= %11110000 		; Player/Missile, Playfield priority
   356 = 00EF			MASK_F.ifH_PLAYER 			= %11101111 		; Enable/Disable Fifth Player
   357 = 00DF			MASK_MULTICOLOR_PM 			= %11011111 		; Enable/Disable Player color mixing
   358 = 003F			MASK_GTIA_MODE 				= %00111111 		; Enable/Disable GTIA playfield modes
   359 				                        	           
   360 = 0001			PM_PRIORITY_1				= %00000001
   361 = 0002			PM_PRIORITY_2				= %00000010
   362 = 0004			PM_PRIORITY_3				= %00000100
   363 = 0008			PM_PRIORITY_4				= %00001000       
   364 				                 	            		
   365 = 000F			PRIORITY_BITS 				= %00001111 		; Player/Missile, Playfield priority
   366 = 0010			F.ifH_PLAYER 				= %00010000 		; Enable Fifth Player
   367 = 0020			MULTICOLOR_PM 				= %00100000 		; Enable Player color mixing
   368 				                        	            		
   369 = 0000			GTIA_MODE_DEFAULT 			= %00000000 		; Normal CTIA color interpretation
   370 = 0040			GTIA_MODE_16_SHADE 			= %01000000 		; 16 shades of background color (COLBK)
   371 = 0080			GTIA_MODE_9_COLOR 			= %10000000 		; 9 colors from registers, COLPM0 is background
   372 = 00C0			GTIA_MODE_16_COLOR 			= %11000000 		; 16 hues of brigntess of background color (COLBK)
   373
   374 				;**************************************************	
   375 				; VDELAY - Delay PM DMA to render 2 scan line Player data one scan line lower 
   376 				;
   377 = 00FE			MASK_VD_MISSILE0 			= %11111110
   378 = 00FD			MASK_VD_MISSILE1 			= %11111101
   379 = 00FB			MASK_VD_MISSILE2 			= %11111011
   380 = 00F7			MASK_VD_MISSILE3 			= %11110111
   381 = 00EF			MASK_VD_PLAYER0 			= %11101111
   382 = 00DF			MASK_VD_PLAYER1 			= %11011111
   383 = 00BF			MASK_VD_PLAYER2 			= %10111111
   384 = 007F			MASK_VD_PLAYER3 			= %01111111
   385 				                        	
   386 = 0001			VD_MISSILE0 				= %00000001
   387 = 0002			VD_MISSILE1 				= %00000010
   388 = 0004			VD_MISSILE2 				= %00000100
   389 = 0008			VD_MISSILE3 				= %00001000
   390 = 0010			VD_PLAYER0 					= %00010000
   391 = 0020			VD_PLAYER1 					= %00100000
   392 = 0040			VD_PLAYER2 					= %01000000
   393 = 0080			VD_PLAYER3 					= %10000000
   394
   395 				;**************************************************	
   396 				; GRACTL - Enable/Disable Player/Missile DMA to GRAFxx registers. And latch triggers.
   397 				;
   398 = 00FE			MASK_ENABLE_MISSILES 		= %11111110 		; Enable/Disable Missile DMA to GRAFM register
   399 = 00FD			MASK_ENABLE_PLAYERS 		= %11111101 		; Enable/Disable Player DMA to GRAFPx registers
   400 = 00FB			MASK_TRIGGER_LATCH 			= %11111011 		; Enable/Disable jostick trigger latching
   401 				                        	          		
   402 = 0001			ENABLE_MISSILES 			= %00000001 		; Enable Missile DMA to GRAFM register
   403 = 0002			ENABLE_PLAYERS 				= %00000010 		; Enable Player DMA to GRAFPx registers
   404 = 0004			TRIGGER_LATCH 				= %00000100 		; Enable joystick trigger latching
   405
   406 				;**************************************************	                                  			
   407 				; CONSOL and CONSPK - 0 is key pressed
   408 				;
   409 = 00F8			MASK_CONSOLE_KEYS 			= %11111000
   410 = 00FE			MASK_CONSOLE_START 			= %11111110 		; Start button
   411 = 00FD			MASK_CONSOLE_SELECT 		= %11111101 		; Select button
   412 = 00FB			MASK_CONSOLE_OPTION 		= %11111011 		; Option button
   413 = 00F7			MASK_CONSOLE_SPEAKER 		= %11110111 		; (Write) Keyboard speaker
   414 				                        	
   415 = 0001			CONSOLE_START 				= %00000001 		; Start button
   416 = 0002			CONSOLE_SELECT 				= %00000010 		; Select button
   417 = 0004			CONSOLE_OPTION 				= %00000100 		; Option button
   418 = 0008			CONSOLE_SPEAKER 			= %00001000 		; (Wrie) Keyboard speaker
   419
   420 				;**************************************************
   421 				; Other Value Lists 
   422 				;
   423 				; 	Sizes in horizontal color clocks and vertical scan lines
   424 				;
   425 = 0080			PLAYFIELD_WIDTH_NARROW 		= %10000000			; Color Clocks Normal Width = 128
   426 = 00A0			PLAYFIELD_WIDTH_NORMAL 		= %10100000			; Color Clocks Normal Width = 160
   427 = 00B0			PLAYFIELD_WIDTH_WIDE 		= %10110000			; Color Clocks Normal Width = 176
   428
   429 = 0040			PLAYFIELD_LEFT_EDGE_NARROW 	= %01000000 		; First/left-most color clock horizontal position
   430 = 0030			PLAYFIELD_LEFT_EDGE_NORMAL 	= %00110000
   431 = 0028			PLAYFIELD_LEFT_EDGE_WIDE 	= %00101000
   432
   433 = 00BF			PLAYFIELD_RIGHT_EDGE_NARROW = %10111111 		; Last/right-most color clock horizontal position
   434 = 00CF			PLAYFIELD_RIGHT_EDGE_NORMAL = %11001111
   435 = 00D7			PLAYFIELD_RIGHT_EDGE_WIDE 	= %11010111
   436
   437 				;**************************************************	
   438 				; PMBASE offsets to Player or Missile addresses
   439 				;
   440 = 0180			PMADR_2LINE_MISSILES 		= $180 
   441 = 0200			PMADR_2LINE_PLAYER0 		= $200
   442 = 0280			PMADR_2LINE_PLAYER1 		= $280
   443 = 0300			PMADR_2LINE_PLAYER2 		= $300
   444 = 0380			PMADR_2LINE_PLAYER3 		= $380
   445
   446 = 0300			PMADR_1LINE_MISSILES 		= $300
   447 = 0400			PMADR_1LINE_PLAYER0 		= $400
   448 = 0500			PMADR_1LINE_PLAYER1 		= $500
   449 = 0600			PMADR_1LINE_PLAYER2 		= $600
   450 = 0700			PMADR_1LINE_PLAYER3 		= $700
   451
   452 				;**************************************************	
   453 				; Vertical Alignments - screen scanlines are offsets into PMADR memory locations
   454 				;
   455 = 0004			PM_2LINE_OVERSCAN_TOP 		= $04
   456 = 0010			PM_2LINE_NORMAL_TOP 		= $10 				; For default OS 192 scan line display
   457 = 006F			PM_2LINE_NORMAL_BOTTOM 		= $6F 				; For default OS 192 scan line display
   458 = 007B			PM_2LINE_OVERSCAN_BOTTOM 	= $7B
   459
   460 = 0008			PM_1LINE_OVERSCAN_TOP 		= $08
   461 = 0020			PM_1LINE_NORMAL_TOP 		= $20 				; For default OS 192 scan line display
   462 = 00DF			PM_1LINE_NORMAL_BOTTOM 		= $DF 				; For default OS 192 scan line display
   463 = 00F7			PM_1LINE_OVERSCAN_BOTTOM 	= $F7
   464
   465 				;**************************************************	
   466 				; Helpful Colors.  (Many match C64)
   467 				;
   468 = 0000			COLOR_GREY 					= $00
   469 = 0010			COLOR_ORANGE1 				= $10
   470 = 0020			COLOR_ORANGE2 				= $20
   471 = 0030			COLOR_RED_ORANGE 			= $30
   472 = 0040			COLOR_PINK 					= $40
   473 = 0050			COLOR_PURPLE 				= $50
   474 = 0060			COLOR_PURPLE_BLUE 			= $60
   475 = 0070			COLOR_BLUE1 				= $70
   476 = 0080			COLOR_BLUE2 				= $80
   477 = 0090			COLOR_LITE_BLUE 			= $90
   478 = 00A0			COLOR_AQUA 					= $A0
   479 = 00B0			COLOR_BLUE_GREEN 			= $B0
   480 = 00C0			COLOR_GREEN 				= $C0
   481 = 00D0			COLOR_YELLOW_GREEN 			= $D0
   482 = 00E0			COLOR_ORANGE_GREEN 			= $E0
   483 = 00F0			COLOR_LITE_ORANGE 			= $F0
   484 = 0000			COLOR_BLACK 				= $00				; Some like to think of first color value as black.
   485
   486 				;**************************************************
   487 				; PIA  - Register List
   488 				;
   489 				;**************************************************
   490 				; Hardware Registers                                                                                                                                                   
   491 				;                                                                                                                                                                      
   492 = D300			PORTA 						= $D300				; Joystick ports 1 and 2, STICK0 and STICK1                                                                                                               
   493 = D301			PORTB 						= $D301				; Joystick ports 3 and 4, STICK2 and STICK3                                                                                                               
   494 = D302			PACTL 						= $D302				; Port A Control                                                                                                                                          
   495 = D303			PBCTL 						= $D303				; Port B Control                                                                                                                                          
   496
   497 				;**************************************************
   498 				; Shadow Registers for Hardware Registers                                                                                                                              
   499 				;                                                                                                                                                                      
   500 = 0278			STICK0 						= $0278                                                                                                                                                          
   501 = 0279			STICK1 						= $0279                                                                                                                                                          
   502 = 027A			STICK2 						= $027A                                                                                                                                                          
   503 = 027B			STICK3 						= $027B                                                                                                                                                          
   504 				       						                                                                                                                                                               
   505 = 027C			PTRIG0 						= $027C                                                                                                                                                          
   506 = 027D			PTRIG1 						= $027D                                                                                                                                                          
   507 = 027E			PTRIG2 						= $027E                                                                                                                                                          
   508 = 027F			PTRIG3 						= $027F                                                                                                                                                          
   509 = 0280			PTRIG4 						= $0280                                                                                                                                                          
   510 = 0281			PTRIG5 						= $0281                                                                                                                                                          
   511 = 0282			PTRIG6 						= $0282                                                                                                                                                          
   512 = 0283			PTRIG7 						= $0283                                                                                                                                                          
   513
   514 				;**************************************************
   515 				; Important Bit Positions                                                                                                                                              
   516 				;                                                                                                                                                                      
   517 = 000F			MASK_JACK_1_3 				= %00001111 		; Actually the anti-mask.  Keeps bits from first controller in pair.                                                                          
   518 = 00F0			MASK_JACK_2_4 				= %11110000 		; The inverse of mask.  Keeps bits from second controller in pair.                                                                            
   519
   520 				;**************************************************
   521 				; 	Stick's bits in the high nybble should be right shifted into a low nybble for testing.                                                                               
   522 				;  	Or just use the STICKx shadow register as that is its purpose.                                                                                                      
   523 				; 	Bits for STICKx shadow regs below:                                                                                                                                   
   524 				;
   525 = 00F7			MASK_STICK_RIGHT 			= %11110111                                                                                                                                            
   526 = 00FB			MASK_STICK_LEFT 			= %11111011                                                                                                                                            
   527 = 00FD			MASK_STICK_DOWN 			= %11111101                                                                                                                                            
   528 = 00FE			MASK_STICK_UP 				= %11111110                                                                                                                                            
   529 				                                                                                                                                                                      
   530 = 0008			STICK_RIGHT 				= %00001000                                                                                                                                                 
   531 = 0004			STICK_LEFT 					= %00000100                                                                                                                                                 
   532 = 0002			STICK_DOWN 					= %00000010                                                                                                                                                 
   533 = 0001			STICK_UP 					= %00000001                                                                                                                                                 
   534
   535 				;**************************************************                                                                                                                                                                      
   536 				; PACTL and PBCTL                                                                                                                                                      
   537 				;
   538 = 007F			MASK_PORT_SERIAL_IRQ 		= %01111111 		; (Read)                                                                                                                             
   539 = 00F7			MASK_MOTOR_CONTROL 			= %11110111 		; PACTL Peripheral motor control (cassette)                                                                                          
   540 = 00F7			MASK_COMMAND_IDENT 			= %11110111 		; PBCTL Peripheral command identification                                                                                            
   541 = 00FB			MASK_PORT_ADDRESSING 		= %11111011 		; PACTL 0 = Port direction control. 1 = Read port.                                                                                   
   542 = 00FE			MASK_SERIAL_IRQ_ENABLE 		= %11111110                                                                                                                                      
   543 				                                                                                                                                                                      
   544 = 0080			PORT_SERIAL_IRQ 			= %10000000 		; (Read)                                                                                                                                  
   545 = 0008			MOTOR_CONTROL 				= %00001000 		; PACTL                                                                                                                                   
   546 = 0008			COMMAND_IDENT 				= %00001000 		; PBCTL                                                                                                                                   
   547 = 0004			PORT_ADDRESSING 			= %00000100                                                                                                                                           
   548 = 0001			SERIAL_IRQ_ENABLE 			= %00000001                                                                                                                                           
   549 				                                                                                                                                                                      
   550
   551 				;**************************************************                                                                                                                                                                      
   552 				; PBCTL for the XL                                                                                                                                                     
   553 				;
   554 = 00FE			MASK_SELECT_OS_ROM 			= %11111110 		; Turn OS ROM on and off                                                                                                            
   555 = 00FD			MASK_SELECT_BASIC_ROM 		= %11111101 		; Turn BASIC ROM on and off                                                                                                         
   556 = 00FB			MASK_LED_1_KEYBOARD 		= %11111011 		; 1200XL LED 1, enable/disable keyboard                                                                                             
   557 = 00F7			MASK_LED_2_INTL_CHARSET 	= %11110111 		; 1200XL LED 2, enable international character set                                                                                  
   558 = 007F			MASK_SELF_TEST_ROM 			= %01111111 		; Expose Self Test at $5000                                                                                                         
   559 				                                                                                                                                                                      
   560 = 0001			SELECT_OS_ROM 				= %00000001                                                                                                                                          
   561 = 0002			SELECT_BASIC_ROM 			= %00000010                                                                                                                                          
   562 = 0004			LED_1_KEYBOARD 				= %00000100                                                                                                                                          
   563 = 0008			LED_2_INTL_CHARSET 			= %00001000                                                                                                                                          
   564 = 0080			SELF_TEST_ROM 				= %10000000                                                                                                                                          
   565 				                                                
   566 				;**************************************************
   567 				; POKEY  - Register List                             
   568 				;      
   569 				;**************************************************
   570 				; Hardware Registers
   571 				;
   572 = D200			AUDF1 						= $D200 			; Audio channel 1 Frequency
   573 = D202			AUDF2 						= $D202 			; Audio channel 2 Frequency
   574 = D204			AUDF3 						= $D204 			; Audio channel 3 Frequency
   575 = D206			AUDF4 						= $D206 			; Audio channel 4 Frequency
   576 				    						        			
   577 = D201			AUDC1 						= $D201 			; Audio channel 1 Control
   578 = D203			AUDC2 						= $D203 			; Audio channel 2 Control
   579 = D205			AUDC3 						= $D205 			; Audio channel 3 Control
   580 = D207			AUDC4 						= $D207 			; Audio channel 4 Control
   581
   582 = D208			AUDCTL 						= $D208 			; Audio Control
   583
   584 = D200			POT0 						= $D200 			; (Read) Potentiometer (paddle) 0 
   585 = D201			POT1 						= $D201 			; (Read) Potentiometer (paddle) 1 
   586 = D202			POT2 						= $D202 			; (Read) Potentiometer (paddle) 2 
   587 = D203			POT3 						= $D203 			; (Read) Potentiometer (paddle) 3 
   588 = D204			POT4 						= $D204 			; (Read) Potentiometer (paddle) 4 
   589 = D205			POT5 						= $D205 			; (Read) Potentiometer (paddle) 5 
   590 = D206			POT6 						= $D206 			; (Read) Potentiometer (paddle) 6 
   591 = D207			POT7 						= $D207 			; (Read) Potentiometer (paddle) 7 
   592
   593 = D208			ALLPOT 						= $D208 			; (Read) Read 8 line POT port state
   594 = D20B			POTGO  						= $D20B 			; Start the POT scan sequence
   595 				       						        			
   596 = D209			STIMER 						= $D209 			; Start timers
   597 = D209			KBCODE 						= $D209 			; (Read) Keyboard code
   598 = D208			RANDOM 						= $D208 			; (Read) Random number
   599 				       						        			
   600 = D20A			SKREST 						= $D20A 			; Reset Serial Status (SKSTAT)
   601 = D20D			SEROUT 						= $D20D 			; Serial port data output
   602 = D20D			SERIN  						= $D20D 			; (Read) Serial port data input
   603 = D20F			SKCTL  						= $D20F 			; Serial Port Control
   604 = D20F			SKSTAT 						= $D20F 			; (Read) Serial port status
   605 				       						        			
   606 = D20E			IRQEN  						= $D20E 			; Interrupt Request Enable
   607 = D20E			IRQST  						= $D20E 			; (Read) IRQ Status
   608
   609 				;**************************************************
   610 				; Shadow Registers for Hardware Registers
   611 				;
   612 = 0270			PADDL0 						= $0270 			; POT0
   613 = 0270			PADDL1 						= $0270 			; POT1
   614 = 0270			PADDL2 						= $0270 			; POT2
   615 = 0270			PADDL3 						= $0270 			; POT3
   616 = 0270			PADDL4 						= $0270 			; POT4
   617 = 0270			PADDL5 						= $0270 			; POT5
   618 = 0270			PADDL6 						= $0270 			; POT6
   619 = 0270			PADDL7 						= $0270 			; POT7
   620 				       						        			
   621 = 02FC			CH 	   						= $02FC 			; KBCODE       						
   622 = 0010			POKMSK 						= $10 				; IRQEN       						
   623 = 0232			SSKCTL 						= $0232 			; SKCTL
   624
   625 				;**************************************************
   626 				; Important Bit Positions
   627
   628 				;**************************************************
   629 				; AUDC 
   630 				;
   631 = 001F			MASK_AUD_NOISE  			= %00011111
   632 = 00EF			MASK_AUD_FORCE  			= %11101111
   633 = 00F0			MASK_AUD_VOLUME 			= %11110000
   634
   635 = 00E0			AUD_NOISE  					= %11100000
   636 = 0010			AUD_FORCE  					= %00010000
   637 = 000F			AUD_VOLUME 					= %00001111
   638
   639 = 0000			NOISE_5_BIT_17_BIT_POLY 	= %00000000
   640 = 0020			NOISE_5_BIT_POLY 			= %00100000
   641 = 0040			NOISE_5_BIT_4_BIT_POLY 		= %01000000
   642 = 0060			NOISE_5_BIT_POLY_2 			= %01100000 		; Duplicate of "5 bit poly"
   643 = 0080			NOISE_17_BIT_POLY 			= %10000000
   644 = 00A0			NOISE_NO_POLY_PURE 			= %10100000
   645 = 00C0			NOISE_4_BIT_POLY 			= %11000000
   646 = 00E0			NOISE_NO_POLY_PURE_2 		= %11100000 		; Duplicate of "No poly pure"
   647
   648 				;**************************************************
   649 				; AUDCTL
   650 				;
   651 = 007F			MASK_AUDCTL_POLY        	= %01111111 		; 17 or 9 bit poly
   652 = 00BF			MASK_AUDCTL_CH1_SYS     	= %10111111 		; Channel 1, 64KHz or system CPU clock (1.79Mhz NTSC)
   653 = 00DF			MASK_AUDCTL_CH3_SYS     	= %11011111 		; Channel 3, 64KHz or system CPU clock (1.79Mhz NTSC)
   654 = 00EF			MASK_AUDCTL_16_BIT_2_1  	= %11101111 		; Tie channels 2 and 1 for 16-bit resolution
   655 = 00F7			MASK_AUDCTL_16_BIT_4_3  	= %11110111 		; Tie channels 4 and 3 for 16-bit resolution
   656 = 00FB			MASK_AUDCTL_HIPASS_1_3  	= %11111011 		; High pass filter channel 1 by channel 3
   657 = 00FD			MASK_AUDCTL_HIPASS_2_4  	= %11111101 		; High pass filter channel 2 by channel 4
   658 = 00FE			MASK_AUDCTL_64_OR_15KHZ 	= %11111110 		; Use Clock 64Khz or 15Khz
   659
   660 = 0000			AUDCTL_POLY_17 				= %00000000
   661 = 0080			AUDCTL_POLY_9  				= %10000000
   662 = 0000			AUDCTL_CH1_64  				= %00000000
   663 = 0040			AUDCTL_CH1_SYS 				= %01000000
   664 = 0000			AUDCTL_CH3_64  				= %00000000
   665 = 0020			AUDCTL_CH3_SYS 				= %00100000
   666 = 0000			AUDCTL_16_BIT_2_1_OFF 		= %00000000
   667 = 0010			AUDCTL_16_BIT_2_1_ON 		= %00010000
   668 = 0000			AUDCTL_16_BIT_4_3_OFF 		= %00000000
   669 = 0008			AUDCTL_16_BIT_4_3_ON 		= %00001000
   670 = 0000			AUDCTL_HIPASS_1_3_OFF 		= %00000000
   671 = 0004			AUDCTL_HIPASS_1_3_ON 		= %00000100
   672 = 0000			AUDCTL_HIPASS_2_4_OFF 		= %00000000
   673 = 0002			AUDCTL_HIPASS_2_4_ON 		= %00000010
   674 = 0000			AUDCTL_CLOCK_64KHZ 			= %00000000
   675 = 0001			AUDCTL_CLOCK_15KHZ 			= %00000001
   676
   677 				;**************************************************
   678 				; ALLPOT
   679 				;
   680 = 007F			MASK_ALLPOT_PADDLE7 		= %01111111
   681 = 00BF			MASK_ALLPOT_PADDLE6 		= %10111111
   682 = 00DF			MASK_ALLPOT_PADDLE5 		= %11011111
   683 = 00EF			MASK_ALLPOT_PADDLE4 		= %11101111
   684 = 00F7			MASK_ALLPOT_PADDLE3 		= %11110111
   685 = 00FB			MASK_ALLPOT_PADDLE2 		= %11111011
   686 = 00FD			MASK_ALLPOT_PADDLE1 		= %11111101
   687 = 00FE			MASK_ALLPOT_PADDLE0 		= %11111110
   688
   689 = 0080			ALLPOT_PADDLE7 				= %10000000
   690 = 0040			ALLPOT_PADDLE6 				= %01000000
   691 = 0020			ALLPOT_PADDLE5 				= %00100000
   692 = 0010			ALLPOT_PADDLE4 				= %00010000
   693 = 0008			ALLPOT_PADDLE3 				= %00001000
   694 = 0004			ALLPOT_PADDLE2 				= %00000100
   695 = 0002			ALLPOT_PADDLE1 				= %00000010
   696 = 0001			ALLPOT_PADDLE0 				= %00000001
   697
   698 				;**************************************************
   699 				; SKCTL
   700 				;
   701 = 007F			MASK_SERIAL_BREAK 			= %01111111
   702 = 008F			MASK_SERIAL_MODE 			= %10001111
   703 = 00F7			MASK_SERIAL_2TONE 			= %11110111
   704 = 00FB			MASK_FAST_POT_SCAN 			= %11111011
   705 = 00FD			MASK_ENABLE_KB_SCAN 		= %11111101
   706 = 00FE			MASK_KB_DEBOUNCE 			= %11111110
   707
   708 = 0080			SERIAL_BREAK 				= %10000000 		
   709 = 0000			SERIAL_MODE0 				= %00000000 		; Input Clock External.            Output Clock External.          Bidirectional Clock Input.
   710 = 0010			SERIAL_MODE1 				= %00010000 		; Input Clock Channel 3+4 (async). Output Clock External.          Bidirectional Clock Input.
   711 = 0020			SERIAL_MODE2 				= %00100000 		; Input Clock Channel 4.           Output Clock Channel 4.         Bidirectional Clock Output Channel 4.
   712 = 0030			SERIAL_MODE3 				= %00110000 		; Input Clock Channel 3+4 (async). Output Clock Channel 4 (async). Bidirectional Clock Input.
   713 = 0040			SERIAL_MODE4 				= %01000000 		; Input Clock External.            Output Clock Channel 4.         Bidirectional Clock Input.
   714 = 0050			SERIAL_MODE5 				= %01010000 		; Input Clock Channel 3+4 (async). Output Clock Channel 4 (async). Bidirectional Clock Input.
   715 = 0060			SERIAL_MODE6 				= %01100000 		; Input Clock Channel 4.           Output Clock Channel 2.         Bidirectional Clock Output Channel 4.
   716 = 0070			SERIAL_MODE7 				= %01110000 		; Input Clock Channel 3+4 (async). Output Clock Channel 2.         Bidirectional Clock Input.
   717
   718 = 0008			SERIAL_2TONE 				= %00001000 		; 1 and 0 bits are audio set by timers 1 and 2
   719
   720 = 0000			FAST_POT_SCAN_OFF 			= %00000000
   721 = 0004			FAST_POT_SCAN_ON  			= %00000100
   722 = 0000			DISABLE_KB_SCAN   			= %00000000
   723 = 0002			ENABLE_KB_SCAN    			= %00000010
   724 = 0000			KB_DEBOUNCE_OFF   			= %00000000
   725 = 0001			KB_DEBOUNCE_ON    			= %00000001
   726
   727 				;**************************************************
   728 				; SKSTAT
   729 				;
   730 = 007F			MASK_SERIAL_FRAME_ERROR 	= %01111111
   731 = 00BF			MASK_SERIAL_INPUT_OVERRUN 	= %10111111
   732 = 00DF			MASK_KEYBOARD_OVERRUN 		= %11011111
   733 = 00EF			MASK_SERIAL_DATA_READY 		= %11101111
   734 = 00F7			MASK_SH.if_KEY_PRESSED 		= %11110111
   735 = 00FB			MASK_LAST_KEY_HELD 			= %11111011
   736 = 00FD			MASK_SERIAL_INPUT_BUSY 		= %11111101
   737
   738 = 0000			SERIAL_FRAME_NO_ERROR 		= %00000000
   739 = 0080			SERIAL_FRAME_ERROR 			= %10000000
   740 = 0000			SERIAL_NO_INPUT_OVERRUN 	= %00000000
   741 = 0040			SERIAL_INPUT_OVERRUN 		= %01000000
   742 = 0000			KEYBOARD_NO_OVERRUN 		= %00000000
   743 = 0020			KEYBOARD_OVERRUN 			= %00100000
   744 = 0000			SERIAL_DATA_NOT_READY 		= %00000000
   745 = 0010			SERIAL_DATA_READY 			= %00010000
   746 = 0000			SH.if_KEY_NOT_PRESSED 		= %00000000
   747 = 0008			SH.if_KEY_PRESSED 			= %00001000
   748 = 0000			LAST_KEY_NOT_HELD 			= %00000000
   749 = 0004			LAST_KEY_HELD 				= %00000100
   750 = 0000			SERIAL_INPUT_NOT_BUSY 		= %00000000
   751 = 0002			SERIAL_INPUT_BUSY 			= %00000010
   752
   753 				;**************************************************
   754 				; IRQEN and IRQST
   755 				;
   756 = 00FE			MASK_IRQ_TIMER1 			= %11111110
   757 = 00FD			MASK_IRQ_TIMER2 			= %11111101
   758 = 00FB			MASK_IRQ_TIMER4 			= %11111011
   759 = 00F7			MASK_IRQ_SERIAL_OUT_DONE 	= %11110111
   760 = 00EF			MASK_IRQ_SERIAL_OUT_READY 	= %11101111
   761 = 00DF			MASK_IRQ_SERIAL_IN_READY 	= %11011111
   762 = 00BF			MASK_IRQ_NORMAL_KEY_PRESS 	= %10111111
   763 = 007F			MASK_IRQ_BREAK_PRESSED 		= %01111111
   764
   765 = 0000			IRQ_TIMER1_OFF 				= %00000000
   766 = 0001			IRQ_TIMER1_ON 				= %00000001
   767 = 0000			IRQ_TIMER2_OFF 				= %00000000
   768 = 0002			IRQ_TIMER2_ON 				= %00000010
   769 = 0000			IRQ_TIMER4_OFF 				= %00000000
   770 = 0004			IRQ_TIMER4_ON 				= %00000100
   771 = 0000			IRQ_SERIAL_OUT_NOT_DONE 	= %00000000
   772 = 0008			IRQ_SERIAL_OUT_DONE 		= %00001000
   773 = 0000			IRQ_SERIAL_OUT_NOT_READY 	= %00000000
   774 = 0010			IRQ_SERIAL_OUT_READY 		= %00010000
   775 = 0000			IRQ_SERIAL_IN_NOT_READY 	= %00000000
   776 = 0020			IRQ_SERIAL_IN_READY 		= %00100000
   777 = 0000			IRQ_NO_KEY_PRESS 			= %00000000
   778 = 0040			IRQ_NORMAL_KEY_PRESS 		= %01000000
   779 = 0000			IRQ_BREAK_NOT_PRESSED 		= %00000000
   780 = 0080			IRQ_BREAK_PRESSED 			= %10000000
   781
   782 				;**************************************************
   783 				; Additional Registers
   784 				;
   785 = 006A			RAMTOP						= $6A
   786 = E45F			SYSVBV 						= $E45F  			; interrupt enabled vector
   787 = E45C			SETVBI 						= $E45C  			; set vertical blank interrupt vector
   788 = E462			XITVBL 						= $E462  			; exit VBI vector
   789
   790 = E45F			XITVB_I						= $e45f
   791 = 0006			VBI_I						= $06
   792 = 0007			VBI_D						= $07
   793 = C0E2			NORMAL_VBI_I				= $c0e2
   794 = C28A			NORMAL_VBI_D				= $c28a
   795 = E45C			SETVBV						= $e45c
   796 = 0222			VVBLKI						= $0222
   797 = 0224			VVBLKD						= $0224
   798 = E462			XITVB						= XITVBL
    41 						icl "/Lib/SysMacros.Asm"				; General purpose macros used by system
Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		SysMacros.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13
    14 				;
    15 				;**************************************************************************************************
    16 				; SaveAXY
    17 				;**************************************************************************************************
    18 				;
    19 				.macro SaveAXY
    20 					pha
    21 					txa
    22 					pha
    23 					tya
    24 					pha
    25 				.endm
    26
    27 				;
    28 				;**************************************************************************************************
    29 				; RestoreRTS
    30 				;**************************************************************************************************
    31 				;
    32 				.macro RestoreRTS
    33 					pla
    34 					tay
    35 					pla
    36 					tax
    37 					pla
    38 					rts
    39 				.endm
    40
    41 				;
    42 				;**************************************************************************************************
    43 				; RestoreRTS
    44 				;**************************************************************************************************
    45 				;
    46 				.macro RestoreRTI
    47 					pla
    48 					tay
    49 					pla
    50 					tax
    51 					pla
    52 					rti
    53 				.endm
    54
    55 				;
    56 				;**************************************************************************************************
    57 				; SetRamTop [pages]
    58 				;**************************************************************************************************
    59 				;
    60 				.macro SetRamTop
    61 					.if :0 <> 1
    62 						.error "SetRamTop error"
    63 				   .else
    64 				   		lda RAMTOP
    65 						sec
    66 						sbc :1
    67 						sta RAMTOP
    68 					.endif
    69 				.endm
    70
    71 				;
    72 				;**************************************************************************************************
    73 				; SetVector [address] [word]
    74 				;**************************************************************************************************
    75 				;
    76 				.macro SetVector
    77 					.if :0 <> 2
    78 						.error "SetVector error"
    79 				   .else
    80 				      	lda #<:2
    81 					    sta :1
    82 					    lda #>:2
    83 					    sta :1+1
    84 					.endif
    85 				.endm
    86
    87 				;
    88 				;**************************************************************************************************
    89 				; SetColor [0..4] [0..255]
    90 				; SetColor [0..4] [0..15] [0..15]
    91 				;**************************************************************************************************
    92 				;
    93 				.macro SetColor
    94 					.if :0 < 2 .or :0 > 3
    95 						.error "SetColor error"
    96 				   	.else
    97 						.if :0 = 2
    98 					    	lda #:2
    99 					        sta COLPF0+:1
   100 						.else
   101 							lda #[:2 * 16 + :3]
   102 							sta COLPF0+:1
   103 						.endif
   104 					.endif
   105 				.endm
   106
   107 				;
   108 				;**************************************************************************************************
   109 				; SetBKColor [0..15] [0..15]
   110 				;**************************************************************************************************
   111 				;
   112 				.macro SetBKColor
   113 					.if :0 < 1 .or :0 > 2
   114 						.error "SetBKColor error"
   115 				   	.else
   116 						.if :0 = 1
   117 					    	lda #:1
   118 					        sta COLBK
   119 						.else
   120 							lda #[:1 * 16 + :2]
   121 					        sta COLBK
   122 						.endif
   123 					.endif
   124 				.endm
   125
   126 				;
   127 				;**************************************************************************************************
   128 				; SetPMColor [0..3] [0..255]
   129 				; SetPMColor [0..3] [0..15] [0..15]
   130 				;**************************************************************************************************
   131 				;
   132 				.macro SetPMColor
   133 					.if :0 < 2 .or :0 > 3
   134 						.error "SetPMColor error"
   135 					.else
   136 						.if :0 = 2
   137 							lda #:2
   138 							sta COLPM0+:1
   139 						.else
   140 							lda #[:2 * 16 + :3]
   141 							sta COLPM0+:1
   142 						.endif
   143 					.endif
   144 				.endm
   145
   146 				;
   147 				;**************************************************************************************************
   148 				; VcountSync [0..130]
   149 				; (maximum limit is different on PAL: 155)
   150 				; (could wait forever if there are interrupts activated!)
   151 				; (or if some other "thread" uses "wsync")
   152 				;**************************************************************************************************
   153 				;
   154 				.macro VcountSync
   155 					.if :0 <> 1
   156 						.error "VcountSync error"
   157 				   	.else
   158 						sta WSYNC
   159 				      	lda #:1
   160 				VSync1	cmp VCOUNT
   161 					    bne VSync1
   162 						lda #:1+1
   163 				VSync2	cmp VCOUNT
   164 					    bne VSync2
   165 				      	sta WSYNC
   166 					.endif
   167 				.endm
   168
   169 				;
   170 				;**************************************************************************************************
   171 				; VcountWait [0..130]
   172 				; (maximum limit is different on PAL: 155)
   173 				;**************************************************************************************************
   174 				;
   175 				.macro VcountWait
   176 					.if :0 <> 1
   177 						.error "VcountWait error"
   178 				   	.else
   179 						lda #:1
   180 				VWait1	cmp VCOUNT
   181 					    bne VWait1
   182 					.endif
   183 				.endm
   184
   185 				;
   186 				;**************************************************************************************************
   187 				; VcountWaitUntilEnter [0..129] [(p1+1)..130]
   188 				; (maximum limit is different on PAL: 155)
   189 				;**************************************************************************************************
   190 				;
   191 				.macro VcountWaitUntilEnter
   192 					.if :0 <> 2 .or :1 >= :2
   193 						.error "VcountWaitUntilEnter error"
   194 					.else
   195 				VWait1	lda VCOUNT
   196 						cmp #:1
   197 						beq VExit
   198 					    bcc VWait1								; VCOUNT < :1
   199 						cmp #:2
   200 						beq VExit
   201 					    bcs VWait1								; VCOUNT >= :2
   202 				VExit
   203 					.endif
   204 				.endm
   205
   206 				;
   207 				;**************************************************************************************************
   208 				; VcountWaitUntilExit [0..129] [(p1+1)..130]
   209 				; (maximum limit is different on PAL: 155)
   210 				;**************************************************************************************************
   211 				;
   212 				.macro VcountWaitUntilExit
   213 					.if :0 <> 2 .or :1 >= :2
   214 						.error "VcountWaitUntilExit error"
   215 					.else
   216 				VWait1	lda VCOUNT
   217 						cmp #:1
   218 						beq VWait1
   219 					    bcc VExit								; VCOUNT < :1
   220 						cmp #:2
   221 					    bcc VWait1								; VCOUNT < :2
   222 						beq VWait1
   223 				VExit
   224 					.endif
   225 				.endm
   226
   227 				;
   228 				;**************************************************************************************************
   229 				; MarkScanLine [0..255] [0..255]
   230 				; (mark the current scan line with a color)
   231 				;**************************************************************************************************
   232 				;
   233 				.macro MarkScanLine
   234 					.if :0 <> 0 .and :0 <> 2
   235 						.error "MarkScanLine error"
   236 					.else
   237 						.if :0 = 0
   238 							sta WSYNC
   239 				  	     	lda #255							; mark color
   240 					  	    sta COLBK
   241 							sta WSYNC
   242 				  	     	lda #0								; restore color
   243 					  	    sta COLBK
   244 						.else
   245 							sta WSYNC
   246 						    lda #:1								; mark color
   247 						    sta COLBK
   248 							sta WSYNC
   249 							lda #:2								; restore color
   250 							sta COLBK
   251 						.endif
   252 					.endif
   253 				.endm
   254
   255 				;
   256 				;**************************************************************************************************
   257 				; MarkScanLineIfConsol [0..255] [0..255]
   258 				; (mark the current scan line with a color, if a consol key is pressed)
   259 				;**************************************************************************************************
   260 				;
   261 				.macro MarkScanLineIfConsol
   262 					.if :0 <> 0 .and :0 <> 2
   263 						.error "MarkScanLineIfConsol error"
   264 					.else
   265 						.if :0 = 0
   266 							lda CONSOL
   267 							and #%111
   268 					     	cmp #%111
   269 						    beq ExitMarkScanLineIfConsol
   270 							sta WSYNC
   271 						    lda #255							; mark color
   272 						    sta COLBK
   273 						    sta WSYNC
   274 						    lda #0								; restore color
   275 					     	sta COLBK
   276 						.else
   277 							lda CONSOL
   278 						    and #%111
   279 					     	cmp #%111
   280 						    beq ExitMarkScanLineIfConsol
   281 							sta WSYNC
   282 					     	lda #:1								; mark color
   283 						    sta COLBK
   284 					      	sta WSYNC
   285 					     	lda #:2								; restore color
   286 						    sta COLBK
   287 						.endif
   288 					.endif
   289 				
   290 				ExitMarkScanLineIfConsol
   291 				.endm
   292
   293 				;
   294 				;**************************************************************************************************
   295 				; MarkCyclesIfConsol [0..255] [0..255]
   296 				; (mark the current scan position with a color, for some cycles)
   297 				;**************************************************************************************************
   298 				;
   299 				.macro MarkCyclesIfConsol
   300 					.if :0 = 0
   301 						lda CONSOL
   302 						and #%111
   303 						cmp #%111
   304 						beq ExitMarkCyclesIfConsol
   305 				
   306 						lda #255								; mark color
   307 						sta COLBK
   308 				
   309 						lda ($00),y								; dummy 5 cycles
   310 						lda ($00),y								; dummy 5 cycles
   311 					    lda ($00),y								; dummy 5 cycles
   312 					    lda ($00),y								; dummy 5 cycles
   313 					    lda ($00),y								; dummy 5 cycles
   314 					    lda ($00),y								; dummy 5 cycles
   315 						lda #0									; restore color
   316 					    sta COLBK
   317 					.elseif :0 = 2
   318 						lda CONSOL
   319 						and #%111
   320 						cmp #%111
   321 						beq ExitMarkCyclesIfConsol
   322 				
   323 						lda #:1									; mark color
   324 						sta COLBK
   325 				
   326 						lda ($00),y								; dummy 5 cycles
   327 					    lda ($00),y								; dummy 5 cycles
   328 					    lda ($00),y								; dummy 5 cycles
   329 					    lda ($00),y								; dummy 5 cycles
   330 					    lda ($00),y								; dummy 5 cycles
   331 					    lda ($00),y								; dummy 5 cycles
   332 				
   333 					    lda #:2									; restore color
   334 					    sta COLBK
   335 					.else
   336 						.error "MarkCyclesIfConsol error"
   337 					.endif
   338 				
   339 				ExitMarkCyclesIfConsol
   340 				.endm
   341
   342 				;
   343 				;**************************************************************************************************
   344 				; SetBasic [0,1]
   345 				;**************************************************************************************************
   346 				;
   347 				.macro SetBasic
   348 					.if :0 <> 1
   349 						.error "SetBasic error"
   350 					.else
   351 						.if :1 = 0
   352 							lda PORTB							; deactivate Basic
   353 					        ora #%00000010
   354 					        sta PORTB
   355 						.else
   356 							lda PORTB							; activate Basic
   357 							and #%11111101
   358 							sta PORTB
   359 						.endif
   360 					.endif
   361 				.endm
   362
   363 				;
   364 				;**************************************************************************************************
   365 				; SetOperatingSystem [0,1]
   366 				;**************************************************************************************************
   367 				;
   368 				.macro SetOperatingSystem
   369 					.if :0 <> 1
   370 						.error "SetOperatingSystem error"
   371 					.else
   372 						.if :1 = 0
   373 							lda PORTB							; deactivate Operative System
   374 							and #%11111110
   375 							sta PORTB
   376 						.else
   377 							lda PORTB							; activate Operative System
   378 							ora #%00000001
   379 							sta PORTB
   380 						.endif
   381 					.endif
   382 				.endm
   383
   384 				;
   385 				;**************************************************************************************************
   386 				; EnableBasic
   387 				;**************************************************************************************************
   388 				;
   389 				.macro EnableBasic
   390 					.if :0 <> 0
   391 						.error "EnableBasic error"
   392 					.else
   393 						SetBasic 1
   394 					.endif
   395 				.endm
   396
   397 				;
   398 				;**************************************************************************************************
   399 				; DisableBasic
   400 				;**************************************************************************************************
   401 				;
   402 				.macro DisableBasic
   403 					.if :0 <> 0
   404 						.error "DisableBasic error"
   405 					.else
   406 						SetBasic 0
   407 					.endif
   408 				.endm
   409
   410 				;
   411 				;**************************************************************************************************
   412 				; EnableOperatingSystem
   413 				;**************************************************************************************************
   414 				;
   415 				.macro EnableOperatingSystem
   416 					.if :0 <> 0
   417 						.error "EnableOperatingSystem error"
   418 					.else
   419 						SetOperatingSystem 1
   420 					.endif
   421 				.endm
   422
   423 				;
   424 				;**************************************************************************************************
   425 				; DisableOperatingSystem
   426 				;**************************************************************************************************
   427 				;
   428 				.macro DisableOperatingSystem
   429 					.if :0 <> 0
   430 						.error "DisableOperatingSystem error"
   431 					.else
   432 						SetOperatingSystem 0
   433 					.endif
   434 				.endm
   435
   436 				;
   437 				;**************************************************************************************************
   438 				; EnableNormalInterrupts
   439 				;**************************************************************************************************
   440 				;
   441 				.macro EnableNormalInterrupts
   442 					.if :0 <> 0
   443 						.error "EnableNormalInterrupts error"
   444 					.else
   445 						cli
   446 						lda #$40								; VBI interrupt
   447 						sta NMIEN
   448 					.endif
   449 				.endm
   450
   451 				;
   452 				;**************************************************************************************************
   453 				; DisableNormalInterrupts
   454 				;**************************************************************************************************
   455 				;
   456 				.macro DisableNormalInterrupts
   457 					.if :0 <> 0
   458 						.error "DisableNormalInterrupts error"
   459 					.else
   460 						sei
   461 						lda #0
   462 						sta IRQEN
   463 						sta NMIEN
   464 					.endif
   465 				.endm
   466
   467 				;
   468 				;**************************************************************************************************
   469 				; ClearSystem
   470 				;**************************************************************************************************
   471 				;
   472 				.macro ClearSystem
   473 					.if :0 <> 0
   474 						.error "ClearSystem error"
   475 					.else
   476 						
   477 						clc
   478 					    cld
   479 						sei
   480 				
   481 					    lda #0									; clear interrupts and screen
   482 					    sta IRQEN	
   483 					    sta NMIEN
   484 					    sta DMACTL
   485 					    sta COLBK
   486 				      	sta GRACTL								; clear P/M
   487 						sta GRAFP0
   488 						sta GRAFP1
   489 						sta GRAFP2
   490 						sta GRAFP3
   491 						sta GRAFM
   492 				
   493 						sta HPOSP0
   494 					    sta HPOSP1
   495 					    sta HPOSP2
   496 					    sta HPOSP3
   497 					    sta HPOSM0
   498 					    sta HPOSM1
   499 					    sta HPOSM2
   500 					    sta HPOSM3
   501 				
   502 					    sta PRIOR								; clear GTIA also
   503 				
   504 					    sta AUDCTL								; clear sound
   505 						sta AUDC1
   506 					    sta AUDC2
   507 					    sta AUDC3
   508 					    sta AUDC4
   509 				
   510 					    lda #3
   511 					    sta SKCTL
   512 					    
   513 					.endif
   514 				.endm
   515
   516 				;
   517 				;**************************************************************************************************
   518 				; SetDisplayListAddress [word]
   519 				; (use when the screen is not being displayed!)
   520 				; (remember to not cross the 1K limit..)
   521 				;**************************************************************************************************
   522 				;
   523 				.macro SetDisplayListAddress
   524 					.if :0 <> 1
   525 						.error "SetDisplayListAddress error"
   526 					.else
   527 						SetVector DLISTL, :1
   528 					.endif
   529 				.endm
   530
   531 				;
   532 				;**************************************************************************************************
   533 				; SetDisplayListInterrupt
   534 				;**************************************************************************************************
   535 				;
   536 				.macro SetDisplayListInterrupt
   537 					.if :0 <> 1
   538 						.error "SetDisplayListInterrupt error"
   539 					.else
   540 						SetVector NMIH_VECTOR, :1
   541 					.endif
   542 				.endm
   543
   544 				;
   545 				;**************************************************************************************************
   546 				; SetFontAddress [word]
   547 				; (remember that this transform to a page a number)
   548 				;**************************************************************************************************
   549 				;
   550 				.macro SetFontAddress
   551 					.if :0 <> 1
   552 						.error "SetFontAddress error"
   553 					.else
   554 						lda #>:1
   555 					    sta CHBASE
   556 					.endif
   557 				.endm
   558
   559 				;
   560 				;**************************************************************************************************
   561 				; SetPMBaseAddress [word]
   562 				; (remember that this transform to a page a number)
   563 				;**************************************************************************************************
   564 				;
   565 				.macro SetPMBaseAddress
   566 				   .if :0 <> 1
   567 				      .error "SetPMBaseAddress error"
   568 				   .else
   569 				      lda #>:1
   570 				      sta PMBASE
   571 				   .endif
   572 				.endm
   573
   574 				;
   575 				;**************************************************************************************************
   576 				; NullZeroPage [zeroPageAddress] [size]
   577 				;**************************************************************************************************
   578 				;
   579 				.macro NullZeroPage
   580 				zpage = $FE
   581 					.if :0 <> 2
   582 						.error "NullZeroPage error"
   583 					.else
   584 						lda #<:1
   585 						sta zpage
   586 						
   587 						ldy :2
   588 						lda #$00
   589 				loop
   590 						sta (zpage),y
   591 						dey
   592 						bne loop		
   593 					.endif	
   594 				.endm
   595
   596 				;
   597 				;**************************************************************************************************
   598 				; SetMemory [address] [bytes] [value]
   599 				;**************************************************************************************************
   600 				;
   601 				.macro SetMemory
   602 				
   603 				; warning, using some page zero memory
   604 				setMemPtr		= $FE
   605 				setMemCounter	= $FC
   606 				
   607 					.if :0 <> 3
   608 						.error "SetMemory error"
   609 					.else
   610 						ldy #0
   611 						lda #<:1
   612 						sta setMemPtr
   613 						lda #>:1
   614 						sta setMemPtr+1
   615 				
   616 						.if :2 < $0100
   617 							lda #:3
   618 				
   619 				setMemLoop1
   620 							sta (setMemPtr),y
   621 							iny
   622 					        cpy #:2
   623 					        bne setMemLoop1
   624 				
   625 						.else
   626 							lda #<:2
   627 							sta setMemCounter
   628 							lda #>:2
   629 							sta setMemCounter+1
   630 				
   631 				setMemLoop2
   632 							lda #:3
   633 							sta (setMemPtr),y
   634 							iny
   635 							bne setMemB1
   636 							inc setMemPtr+1
   637 				
   638 				setMemB1
   639 							lda setMemCounter
   640 							bne setMemB2
   641 							dec setMemCounter+1
   642 				
   643 				setMemB2
   644 							dec setMemCounter
   645 							lda setMemCounter
   646 							ora setMemCounter+1
   647 							bne setMemLoop2
   648 						.endif
   649 					.endif
   650 				.endm
   651
   652 				;
   653 				;**************************************************************************************************
   654 				; SetMemoryRandom [address] [bytes]
   655 				;**************************************************************************************************
   656 				;
   657 				.macro SetMemoryRandom
   658 				
   659 				; warning, using some page zero memory
   660 				setMemRPtr		= $FE
   661 				setMemRCounter	= $FC
   662 				
   663 				   .if :0 <> 2
   664 				      .error "SetMemoryRandom error"
   665 				   .else
   666 				      ldy #0
   667 				      lda #<:1
   668 				      sta setMemRPtr
   669 				      lda #>:1
   670 				      sta setMemRPtr+1
   671 						
   672 						.if :2 < $0100
   673 				
   674 				setMemRLoop1
   675 				         	lda RANDOM
   676 				         	sta (setMemRPtr),y
   677 				         	iny
   678 				         	cpy #:2
   679 				         	bne setMemRLoop1
   680 						.else
   681 				        	lda #<:2
   682 				         	sta setMemRCounter
   683 				         	lda #>:2
   684 				         	sta setMemRCounter+1
   685 				
   686 				setMemRLoop2
   687 				         	lda RANDOM
   688 				         	sta (setMemRPtr),y
   689 				         	iny
   690 				         	bne setMemRB1
   691 				         	inc setMemRPtr+1
   692 				
   693 				setMemRB1
   694 				         	lda setMemRCounter
   695 				         	bne setMemRB2
   696 				         	dec setMemRCounter+1
   697 				
   698 				setMemRB2
   699 				         	dec setMemRCounter
   700 				         	lda setMemRCounter
   701 				         	ora setMemRCounter+1
   702 				         	bne setMemRLoop2
   703 					
   704 						.endif
   705 					.endif
   706 				.endm
   707
   708 				;
   709 				;**************************************************************************************************
   710 				; ClampMemory [address] [bytes] [min value] [max value]
   711 				;**************************************************************************************************
   712 				;
   713 				.macro ClampMemory
   714 				
   715 				; warning, using some page zero memory
   716 				clampMemPtr		= $FE
   717 				clampMemCounter	= $FC
   718 				
   719 					.if :0 <> 4
   720 						.error "ClampMemory error"
   721 					.else
   722 						ldy #0
   723 						lda #<:1
   724 						sta clampMemPtr
   725 						lda #>:1
   726 						sta clampMemPtr+1
   727 				
   728 						.if :2 < $0100
   729 				
   730 				clampMemLoop1
   731 							lda (clampMemPtr),y
   732 					        cmp #:3
   733 					        bcs clampMemB3		; if >= min then continue
   734 					        lda #:3
   735 					        jmp clampMemB4
   736 				
   737 				clampMemB3
   738 					        cmp #:4
   739 					        bcc clampMemB4		; if < max then continue
   740 					        lda #:4
   741 				
   742 				clampMemB4
   743 					        sta (clampMemPtr),y
   744 							iny
   745 					        cpy #:2
   746 					        bne clampMemLoop1
   747 				
   748 						.else
   749 					    
   750 					    	lda #<:2
   751 					        sta clampMemCounter
   752 					        lda #>:2
   753 					        sta clampMemCounter+1
   754 				
   755 				clampMemLoop2
   756 					        lda (clampMemPtr),y
   757 					        cmp #:3
   758 					        bcs clampMemB5		; if >= min then continue
   759 					        lda #:3
   760 					        jmp clampMemB6
   761 				
   762 				clampMemB5
   763 					        cmp #:4
   764 					        bcc clampMemB6		; if < max then continue
   765 					        lda #:4
   766 				
   767 				clampMemB6
   768 					        sta (clampMemPtr),y
   769 					        iny
   770 					        bne clampMemB1
   771 					        inc clampMemPtr+1
   772 				
   773 				clampMemB1
   774 					        lda clampMemCounter
   775 					        bne clampMemB2
   776 					        dec clampMemCounter+1
   777 				
   778 				clampMemB2
   779 					        dec clampMemCounter
   780 				         	lda clampMemCounter
   781 					        ora clampMemCounter+1
   782 					        bne clampMemLoop2
   783 						.endif
   784 					.endif
   785 				.endm
   786
   787 				;
   788 				;**************************************************************************************************
   789 				; AndMemory [address] [bytes] [value]
   790 				;**************************************************************************************************
   791 				.macro AndMemory
   792 				
   793 				; warning, using some page zero memory
   794 				andMemPtr		= $FE
   795 				andMemCounter	= $FC
   796 				
   797 					.if :0 <> 3
   798 						.error "AndMemory error"
   799 				   .else
   800 				      	ldy #0
   801 					    lda #<:1
   802 					    sta andMemPtr
   803 					    lda #>:1
   804 					    sta andMemPtr+1
   805 				
   806 					    .if :2 < 256
   807 				andMemLoop1
   808 					    
   809 					    	lda (andMemPtr),y
   810 					        and #:3
   811 					        sta (andMemPtr),y
   812 					        iny
   813 					        cpy #:2
   814 					        bne andMemLoop1
   815 				
   816 					     .else
   817 					     
   818 					        lda #<:2
   819 					        sta andMemCounter
   820 					        lda #>:2
   821 					        sta andMemCounter+1
   822 				
   823 				andMemLoop2
   824 					        lda (andMemPtr),y
   825 					        and #:3
   826 					        sta (andMemPtr),y
   827 					        iny
   828 					        bne andMemB1
   829 					        inc andMemPtr+1
   830 				andMemB1
   831 					        lda andMemCounter
   832 					        bne andMemB2
   833 					        dec andMemCounter+1
   834 				
   835 				andMemB2
   836 							dec andMemCounter
   837 					        lda andMemCounter
   838 					        ora andMemCounter+1
   839 					        bne andMemLoop2
   840 					  	.endif
   841 					.endif
   842 				.endm
   843
   844 				;
   845 				;**************************************************************************************************
   846 				; CopyMemory [source address] [dest address] [bytes]
   847 				;**************************************************************************************************
   848 				;
   849 				.macro CopyMemory
   850 				
   851 				; warning, using some page zero memory
   852 				copyMemPtr1		= $FE
   853 				copyMemPtr2		= $FC
   854 				copyMemCounter	= $FA
   855 				
   856 				   .if :0 <> 3
   857 						.error "CopyMemory error"
   858 				   .else
   859 					    ldy #0
   860 					    lda #<:1
   861 					    sta copyMemPtr1
   862 					    lda #>:1
   863 					    sta copyMemPtr1+1
   864 				
   865 					    lda #<:2
   866 					    sta copyMemPtr2
   867 					    lda #>:2
   868 					    sta copyMemPtr2+1
   869 					
   870 						.if :3 < $0100
   871 				
   872 				copyMemLoop1
   873 					      	lda (copyMemPtr1),y
   874 					       	sta (copyMemPtr2),y
   875 					       	iny
   876 					       	cpy #:3
   877 					       	bne copyMemLoop1
   878 				
   879 					   	.else
   880 					      	
   881 					       	lda #<:3
   882 					       	sta copyMemCounter
   883 					       	lda #>:3
   884 					       	sta copyMemCounter+1
   885 				
   886 				copyMemLoop2
   887 				        	lda (copyMemPtr1),y
   888 				        	sta (copyMemPtr2),y
   889 				        	iny
   890 				        	bne copyMemB1
   891 				        	inc copyMemPtr1+1
   892 				        	inc copyMemPtr2+1
   893 				copyMemB1
   894 				         	lda copyMemCounter
   895 				         	bne copyMemB2
   896 				         	dec copyMemCounter+1
   897 				
   898 				copyMemB2
   899 				         	dec copyMemCounter
   900 				         	lda copyMemCounter
   901 				         	ora copyMemCounter+1
   902 				         	bne copyMemLoop2
   903 				
   904 				     	.endif
   905 					.endif
   906 				.endm
    42 					
    43 				;***** Include Variable Files
    44 				;
    45 						icl "ZeroPage.Asm"
Source: E:\_8BitProjects\Series\Scroller\ZeroPage.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		ZeroPage.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;	
    13 				;**************************************************************************************************
    14 				; Zero Page Variables definitions
    15 				;**************************************************************************************************
    16 				;
    17 						org ZeroPageAddress
    18
    19 				;*****	RMT zero page variables
    20 				;
    21 				p_tis						
    22 				p_instrstable				org *+2
    23 				p_trackslbstable			org *+2
    24 				p_trackshbstable			org *+2
    25 				p_song						org *+2
    26 				ns							org *+2
    27 				nr							org *+2
    28 				nt							org *+2
    29 				reg1						org *+1
    30 				reg2						org *+1
    31 				reg3						org *+1
    32 				tmp							org *+1
    33
    34 				;*****	Platform Engine zero page variables
    35 				;
    36 				m_param00					org *+$01
    37 				m_param01					org *+$01
    38 				m_param02					org *+$01
    39 				m_param03					org *+$01
    40
    41 				m_saveRegA					org *+$01
    42 				m_saveRegX					org *+$01
    43 				m_saveRegY					org *+$01
    44
    45 				m_sfxEffect					org *+$01
    46
    47 				m_animMiscWidth				org *+$01
    48 				m_animMiscHeight			org *+$01
    49
    50 				m_redrawPlayerCounter		org *+$01
    51
    52 				m_missleBaseColor00			org *+$01
    53 				m_playerBaseColor00			org *+$01
    54 				m_playerBaseColor1A			org *+$01
    55 				m_playerBaseColor1B			org *+$01
    56
    57 				m_playerLevelLeftX_H2		org *+$01			; left side coordinate
    58 				m_playerLevelLeftX_H1		org *+$01
    59 				m_playerLevelLeftX_L1		org *+$01
    60
    61 				m_playerLevelRightX_H2		org *+$01			; right side coordinate
    62 				m_playerLevelRightX_H1		org *+$01
    63 				m_playerLevelRightX_L1		org *+$01
    64
    65 				m_playerLevelTopY_H2		org *+$01			; top line coordinate
    66 				m_playerLevelTopY_H1		org *+$01
    67 				m_playerLevelTopY_L1		org *+$01
    68
    69 				m_playerLevelBottomY_H2		org *+$01			; bottom line coordinate
    70 				m_playerLevelBottomY_H1		org *+$01
    71 				m_playerLevelBottomY_L1		org *+$01
    72
    73 				m_playerScreenLeftX			org *+$01
    74 				m_playerScreenTopY			org *+$01
    75
    76 				m_oldPlayerScreenLeftX		org *+$01
    77 				m_oldPlayerScreenTopY		org *+$01
    78
    79 				m_playerSizeX				org *+$01
    80 				m_playerSizeY				org *+$01
    81
    82 				m_playerSizeXMinusOne		org *+$01
    83 				m_playerSizeYMinusOne		org *+$01
    84
    85 				m_playerSideSpeed_H1		org *+$01
    86 				m_playerSideSpeed_L1		org *+$01
    87
    88 				m_playerMaxSideSpeed_H1		org *+$01
    89 				m_playerMaxSideSpeed_L1		org *+$01
    90
    91 				m_playerSideAccel_H1		org *+$01
    92 				m_playerSideAccel_L1		org *+$01
    93
    94 				m_playerSideDeaccel_H1		org *+$01
    95 				m_playerSideDeaccel_L1		org *+$01
    96
    97 				m_playerSpeedY_H1			org *+$01
    98 				m_playerSpeedY_L1			org *+$01
    99
   100 				m_playerJumpSpeed_H1		org *+$01
   101 				m_playerJumpSpeed_L1		org *+$01
   102
   103 				m_playerMaxFallSpeed_H1		org *+$01
   104 				m_playerMaxFallSpeed_L1		org *+$01
   105
   106 				m_playerGravityAccel_H1		org *+$01
   107 				m_playerGravityAccel_L1		org *+$01
   108
   109 				m_playerWaterAccelY_H1		org *+$01
   110 				m_playerWaterAccelY_L1		org *+$01
   111
   112 				m_playerMaxWaterSpeedY_H1	org *+$01
   113 				m_playerMaxWaterSpeedY_L1	org *+$01
   114
   115 				m_playerMoveWaterSpeedY_H1	org *+$01
   116 				m_playerMoveWaterSpeedY_L1	org *+$01
   117
   118 				m_playerNoJumpTimer			org *+$01			; for now this is used to disable the jump for some frames, after entering the water
   119 				m_playerHoldJumpCounter		org *+$01
   120
   121 				m_lastPlayerSideDirection	org *+$01			; 0 - none, 1 - right, 2 - left
   122 				m_lastPlayerShootDirection	org *+$01
   123
   124 				m_playerOverPlatformFlag	org *+$01			; is player over platform
   125 				m_playerTopCollisionFlag	org *+$01			; did player hit top
   126 				m_playerSideCollisionFlag	org *+$01			; did player hit side
   127
   128 				m_playerState				org *+$01			; 0-static, 1-over platform, 2-jumping up, 3-falling, 4-climbing, 5-in water, 6-gravity test
   129
   130 				m_pageZeroTempValue			org *+$01
   131
   132 				m_levelCharSizeX			org *+$01			; char size X goes from 1 to 255 characters, 0 = 256 characters
   133 				m_levelCharSizeY			org *+$01			; char size Y goes from 1 to 255 characters, 0 = 256 characters
   134
   135 				m_levelSizeX_H2				org *+$01
   136 				m_levelSizeX_H1				org *+$01
   137
   138 				m_levelSizeY_H2				org *+$01
   139 				m_levelSizeY_H1				org *+$01
   140
   141 				m_levelWindowX_H2			org *+$01
   142 				m_levelWindowX_H1			org *+$01
   143
   144 				m_levelWindowY_H2			org *+$01
   145 				m_levelWindowY_H1			org *+$01
   146
   147 				m_stick0					org *+$01
   148 				m_oldStick0					org *+$01
   149 				m_oldTrigger0				org *+$01
   150 				m_triggerState				org *+$01			; 0 - not pressed, 1 - just released, 2 - just pressed, 3 - pressed
   151 				m_currentTrigger0			org *+$01
   152
   153 				m_paramW01					org *+$02
   154 				m_paramW02					org *+$02
   155
   156 				m_ptrLevelAddr				org *+$02
   157 				m_ptrLevelLine				org *+$02
   158 				m_pageZeroTempPointer		org *+$02
   159 				m_playerMethodPointer		org *+$02
   160 				m_platformLevelPointer		org *+$02
   161
   162 				m_currChar					org *+$01
   163 				m_currLevelNum				org *+$01
   164
   165 				.PRINT "Zero Page Start : ", ZeroPageAddress, " Zero Page Length : ", * - ZeroPageAddress, " Total : ", *  
   165 				Zero Page Start : $0080 Zero Page Length : $0073 Total : $00F3
   166
   167 				.if * - ZeroPageAddress > $79
   168 					.error "Zero Page length address greater than $00FA!"
   169 				.endif
   170
    46 						icl "Constants.Asm"
Source: E:\_8BitProjects\Series\Scroller\Constants.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		Constants.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Constants
    15 				;
    16 				; remember, when going from NTSC to PAL:
    17 				;
    18 				; 	colors - 1 (same lum) .. here only color 7 (water blue) was left equal times multiplied by (5/6)
    19 				; 	speeds and accelerations multiplied by (6/5) .. maybe accelerations requires another adjustment
    20 				; 	some animations speed maybe should not (cannot) be converted, if they are not related to gameplay
    21 				; 		(for example the timing for the laser enabled/disabled states was converted)
    22 				; 	also, one extra precison byte (_L2) could be useful to get a better conversion in some cases
    23 				;
    24 				;**************************************************************************************************
    25 				;
    26 = B000			GAME_MEM					= GameMemoryAddress			; used in Camera.Asm. Must set this for camera to work			
    27 = 0E03			GAME_LMS1					= GameDspLstAddr+3			; used in Camera.Asm. Must set this for camera to work
    28
    29 = 0008			PLR_WIDTH					= 8							; must set this for player to work
    30 = 0015			PLR_HEIGHT					= 21						; must set this for player to work
    31
    32 				;*****	Music and Sound constants 
    33 = 0000			STEREOMODE					= 0
    34
    35 = 0000			MUSIC_MENU 					= 0
    36 = 000B			MUSIC_GAME 					= $0B
    37 = 000E			MUSIC_GAME_OVER 			= $0E
    38 = 0010			MUSIC_DUMMY 				= $10
    39
    40 = 0001			SFX_DIAMOND 				= 1
    41 = 000C			SFX_ALL_PICKED 				= 12
    42 = 000E			SFX_DEATH 					= 14
    43 = 0010			SFX_CONGRATULATIONS 		= 16
    44 = 0001			SFX_JUMP 					= 1
    45
    46 				;*****	Open Plat constants
    47 				;
    48 = 0000			PAL_VERSION					= 0
    49
    50 = 0028			MAX_ROWS					= 40
    51
    52 = 0004			CHAR_PIX.else_X				= 4
    53 = 0008			CHAR_PIX.else_Y				= 8
    54
    55 = 0052			LEVEL_CHAR_SIZE_X			= 82				; max level size now should be 256 x 255 lines	
    56 = 0018			LEVEL_CHAR_SIZE_Y			= 24
    57
    58 = 0028			WINDOW_CHAR_SIZE_X			= 40
    59 = 0018			WINDOW_CHAR_SIZE_Y			= 24
    60
    61 = 0030			PM_BASE_SCREEN_X			= 48
    62 = 0020			PM_BASE_SCREEN_Y			= 32
    63
    64 = 0000			PSD_NONE					= 0					; player side direction
    65 = 0001			PSD_RIGHT					= 1
    66 = 0002			PSD_LEFT					= 2
    67
    68 = 0000			PS_STATIC					= 0					; player states
    69 = 0001			PS_OVER_PLATFORM			= 1
    70 = 0002			PS_JUMPING					= 2
    71 = 0003			PS_FALLING					= 3
    72 = 0004			PS_CLIMBING					= 4
    73 = 0005			PS_IN_WATER					= 5
    74 = 0006			PS_GRAVITY_TEST				= 6
    75 = 0007			PS_LOSE						= 7
    76
    77 = 0000			CT_BLANK					= 0					; character types
    78 = 0001			CT_BLOCK					= 1
    79 = 0002			CT_COLLECTABLE				= 2
    80 = 0003			CT_DANGER					= 3
    81 = 0004			CT_LADDER					= 4
    82 = 0005			CT_WATER					= 5
    83 = 0006			CT_HEALTH					= 6
    84 = 0007			CT_FLOATPLATFORMH			= 7
    85 = 0008			CT_VLASER					= 8
    86 = 0009			CT_FLOATPLATFORMV			= 9
    87 = 000A			CT_HLASER					= 10
    88
    89 = 0000			TS_NOT_PRESSED				= 0					; trigger states
    90 = 0000			TS_JUST_RELEASED			= 0
    91 = 0000			TS_PRESSED					= 0
    92 = 0000			TS_JUST_PRESSED				= 0
    93
    94 = 0020			ENEMY_SHOOT_DELTA_Y			= 32
    95
    96 				;*****	Set these constants depending on TV system
    97 				; 
    98 				.if PAL_VERSION = 0
    99
   100 = 0006				TENTH_OF_SECOND_FRAMES	= 6
   101 = 0001				MINIMUM_CAMERA_STEP		= 1
   102 = 0008				JUMP_HOLD_FRAMES		= 8
   103 = 0040				JUMP_HSPEED_SLOWDOWN	= 64
   104 = 001E				WATER_NO_JUMP_FRAMES	= 30
   105
   106 = 0001				SIDE_SPEED_LAND_H1		= 1					; 001.160 --> 97.5 pixels per second (at 60 fps only!)
   107 = 0001				SIDE_SPEED_LAND_L1		= 1 ;64
   108 					
   109 = 0000				SIDE_ACCEL_LAND_H1		= 0					; 6 frames (at 60 fps only!) or 0.x seconds, to reach max speed
   110 = 0020				SIDE_ACCEL_LAND_L1		= 32
   111 					
   112 = 0000				SIDE_DEACCEL_LAND_H1	= 0					; 3 frames (at 60 fps only!) or 0.x seconds, to reach zero speed
   113 = 0080				SIDE_DEACCEL_LAND_L1	= 128
   114
   115 = 0000				SIDE_SPEED_WATER_H1		= 0
   116 = 0080				SIDE_SPEED_WATER_L1		= 128
   117
   118 = 0000				SIDE_ACCEL_WATER_H1		= 0					; _ frames (at 60 fps only!) or _ seconds, to reach max speed
   119 = 0004				SIDE_ACCEL_WATER_L1		= 4
   120
   121 = 0000				SIDE_DEACCEL_WATER_H1	= 0					; _ frames (at 60 fps only!) or _ seconds, to reach zero speed
   122 = 0004				SIDE_DEACCEL_WATER_L1	= 4
   123
   124 = 0001				SIDE_SPEED_AIR_H1		= 1					; 001.120 --> 88.125 pixels per second (at 60 fps only!)
   125 = 0020				SIDE_SPEED_AIR_L1		= 32
   126
   127 = 0000				SIDE_ACCEL_AIR_H1		= 0					; 17.3 frames (at 60 fps only!) or 0.288 seconds, to reach max speed
   128 = 0010				SIDE_ACCEL_AIR_L1		= 16
   129
   130 = 0000				SIDE_DEACCEL_AIR_H1		= 0					; 17.3 frames (at 60 fps only!) or 0.288 seconds, to reach zero speed
   131 = 0010				SIDE_DEACCEL_AIR_L1		= 16
   132
   133 = 0000				CLIMB_UP_SPEED_Y_H1		= 0
   134 = 00E0				CLIMB_UP_SPEED_Y_L1		= 224
   135
   136 = 0001				CLIMB_DOWN_SPEED_Y_H1	= 1
   137 = 0080				CLIMB_DOWN_SPEED_Y_L1	= 128
   138
   139 = 0280				PLAYER_MISSILE_SPEED_X	= 2*256+128
   140 = 0200				ENEMY_MISSILE_SPEED_X	= 2*256
   141 = 0078				ENEMY_INIT_TIMER		= 120
   142 = 003C				VLASER_DISABLED_INDEX	= 60
   143
   144 				.else
   145
   146 					TENTH_OF_SECOND_FRAMES	= 5
   147 					MINIMUM_CAMERA_STEP		= 1
   148 					JUMP_HOLD_FRAMES		= 6					; 6.67 for pal
   149 					JUMP_HSPEED_SLOWDOWN	= 77
   150 					WATER_NO_JUMP_FRAMES	= 25
   151
   152 					SIDE_SPEED_LAND_H1		= 1					;  pixels per second (at 50 fps only!)
   153 					SIDE_SPEED_LAND_L1		= 128
   154
   155 					SIDE_ACCEL_LAND_H1		= 0					;  frames (at 50 fps only!) or 0.x seconds, to reach max speed
   156 					SIDE_ACCEL_LAND_L1		= 38
   157
   158 					SIDE_DEACCEL_LAND_H1	= 0					;  frames (at 50 fps only!) or 0.x seconds, to reach zero speed
   159 					SIDE_DEACCEL_LAND_L1	= 154
   160
   161 					SIDE_SPEED_WATER_H1		= 0
   162 					SIDE_SPEED_WATER_L1		= 154
   163
   164 					SIDE_ACCEL_WATER_H1		= 0					; _ frames (at 50 fps only!) or _ seconds, to reach max speed
   165 					SIDE_ACCEL_WATER_L1		= 5
   166
   167 					SIDE_DEACCEL_WATER_H1	= 0					; _ frames (at 50 fps only!) or _ seconds, to reach zero speed
   168 					SIDE_DEACCEL_WATER_L1	= 5
   169
   170 					SIDE_SPEED_AIR_H1		= 1					;  pixels per second (at 50 fps only!)
   171 					SIDE_SPEED_AIR_L1		= 90
   172 					
   173 					SIDE_ACCEL_AIR_H1		= 0					;  frames (at 50 fps only!) or  seconds, to reach max speed
   174 					SIDE_ACCEL_AIR_L1		= 19
   175
   176 					SIDE_DEACCEL_AIR_H1		= 0					;  frames (at 50 fps only!) or  seconds, to reach zero speed
   177 					SIDE_DEACCEL_AIR_L1		= 19
   178
   179 					CLIMB_UP_SPEED_Y_H1		= 1
   180 					CLIMB_UP_SPEED_Y_L1		= 13
   181
   182 					CLIMB_DOWN_SPEED_Y_H1	= 1
   183 					CLIMB_DOWN_SPEED_Y_L1	= 205
   184
   185 					PLAYER_MISSILE_SPEED_X	= 3*256
   186 					ENEMY_MISSILE_SPEED_X	= 2*256+104
   187 					ENEMY_INIT_TIMER		= 100
   188 					VLASER_DISABLED_INDEX	= 50
   189
   190 				.endif
   191
   192 				;*****	Register bit settings
   193 				;
   194 = 0003			GRACTL_OPTIONS				= [ENABLE_MISSILES 	| ENABLE_PLAYERS]
   195 = 0031			PRIOR_OPTIONS				= [PM_PRIORITY_1   	| F.ifH_PLAYER        			| MULTICOLOR_PM]	
   196 = 003E			DMACTL_OPTIONS				= [ENABLE_DL_DMA 	| PLAYFIELD_WIDTH_NORMAL_MASK 	| ENABLE_PM_DMA 	| PM_1LINE_RESOLUTION] 
   197
   198 				;*****	Player missle address definitions
   199 				;
   200 = A300			ms_area_1 					= PmgAddress + $0300
   201 = A400			p0_area_1 					= PmgAddress + $0400
   202 = A500			p1_area_1 					= PmgAddress + $0500
   203 = A600			p2_area_1 					= PmgAddress + $0600
   204 = A700			p3_area_1 					= PmgAddress + $0700
   205
    47
    48 				;*****	Memory map
    49 				;
    50 = 0080			ZeroPageAddress				= $80				; 122 bytes zero page ($80 to $F9) 
    51 = 0E00			GameDspLstAddr				= $0E00				; 176 bytes for display list
    52
    53 = 0680			HudMemoryAddr				= $0680				; Heads up display are (80 bytes)
    54
    55 = 2400			SoundPlayerAddress			= $2400
    56 = 3000			DataAddress					= $3000				;  4K (size for data)
    57 = 4800			CodeAddress					= $4800				; 20K (22K zone)
    58
    59 = 4000			SoundAddress				= $4000
    60
    61 = A000			PmgAddress					= $A000				; 40K (2K size - 768 bytes)
    62 = A800			GameFontAddress				= $A800				; 42K (1K size)
    63 = AC00			TextFontAddress				= $AC00				; 39K (1K size)
    64
    65 = B000			GameMemoryAddress			= $B000				; 44K (4K size)
    66
    67 				;*****	moved here for better access
    68 				;
    69 = 0001			DEBUG_ON					= 1					 
    70
    71 				;
    72 				;**************************************************************************************************
    73 				; InitSystem - Start of code
    74 				;**************************************************************************************************
    75 				;
    76 						org CodeAddress
    77
    78 				InitSystem
    79
    80 FFFF> 4800-6C7B> AD 14 + 		lda PAL									; only run in the correct system
    81 4803 29 0E				and #14
    82
    83 				.if PAL_VERSION = 1
    84
    85 				NO_PAL_loop
    86 						bne NO_PAL_loop
    87
    88 				.else
    89
    90 4805			NO_NTSC_loop
    91 4805 F0 FE				beq NO_NTSC_loop
    92
    93 				.endif
    94
    95 4807					ClearSystem								; begin machine setup
Macro: CLEARSYSTEM [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     5 4807 18					clc
     6 4808 D8				    cld
     7 4809 78					sei
     9 480A A9 00			    lda #0									; clear interrupts and screen
    10 480C 8D 0E D2			    sta IRQEN	
    11 480F 8D 0E D4			    sta NMIEN
    12 4812 8D 00 D4			    sta DMACTL
    13 4815 8D 1A D0			    sta COLBK
    14 4818 8D 1D D0		      	sta GRACTL								; clear P/M
    15 481B 8D 0D D0				sta GRAFP0
    16 481E 8D 0E D0				sta GRAFP1
    17 4821 8D 0F D0				sta GRAFP2
    18 4824 8D 10 D0				sta GRAFP3
    19 4827 8D 11 D0				sta GRAFM
    21 482A 8D 00 D0				sta HPOSP0
    22 482D 8D 01 D0			    sta HPOSP1
    23 4830 8D 02 D0			    sta HPOSP2
    24 4833 8D 03 D0			    sta HPOSP3
    25 4836 8D 04 D0			    sta HPOSM0
    26 4839 8D 05 D0			    sta HPOSM1
    27 483C 8D 06 D0			    sta HPOSM2
    28 483F 8D 07 D0			    sta HPOSM3
    30 4842 8D 1B D0			    sta PRIOR								; clear GTIA also
    32 4845 8D 08 D2			    sta AUDCTL								; clear sound
    33 4848 8D 01 D2				sta AUDC1
    34 484B 8D 03 D2			    sta AUDC2
    35 484E 8D 05 D2			    sta AUDC3
    36 4851 8D 07 D2			    sta AUDC4
    38 4854 A9 03			    lda #3
    39 4856 8D 0F D2			    sta SKCTL
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
    96 4859					DisableBasic							; disable to use memory
Macro: DISABLEBASIC [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     5 4859 AD 01 D3					lda PORTB							; deactivate Basic
     6 485C 09 02			        ora #%00000010
     7 485E 8D 01 D3			        sta PORTB
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
    97 4861					DisableOperatingSystem					; disable to use memory	
Macro: DISABLEOPERATINGSYSTEM [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     5 4861 AD 01 D3					lda PORTB							; deactivate Operative System
     6 4864 29 FE					and #%11111110
     7 4866 8D 01 D3					sta PORTB
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
    98 					
    99 4869					SetRamTop #32							; pull memtop down 32 pages
Macro: SETRAMTOP [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4869 A5 6A		   		lda RAMTOP
     5 486B 38					sec
     6 486C E9 20				sbc #32
     7 486E 85 6A				sta RAMTOP
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   100 								
   101 4870					SetDisplayListInterrupt GameDli_01		; set the display list interrupts
Macro: SETDISPLAYLISTINTERRUPT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4870 A9 73		      	lda #<GAMEDLI_01
     5 4872 8D FA FF			    sta NMIH_VECTOR
     6 4875 A9 4E			    lda #>GAMEDLI_01
     7 4877 8D FB FF			    sta NMIH_VECTOR+1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   102
   103 487A					VcountWait 120							; make sure to wait so the setting take effect
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 487A A9 78				lda #120
     5 487C CD 0B D4		VWait1	cmp VCOUNT
     6 487F D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   104
   105 4881 A9 58				lda #GameDLEnd							; length of games display list data
   106 4883 85 92				sta m_param00 							; store it for the load routine									
   107 4885					SetVector m_paramW01, GameDL			; source of display list data
Macro: SETVECTOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4885 A9 DB		      	lda #<GAMEDL
     5 4887 85 E3			    sta M_PARAMW01
     6 4889 A9 35			    lda #>GAMEDL
     7 488B 85 E4			    sta M_PARAMW01+1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   108 488D					SetVector m_paramW02, GameDspLstAddr	; destination of display list data
Macro: SETVECTOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 488D A9 00		      	lda #<GAMEDSPLSTADDR
     5 488F 85 E5			    sta M_PARAMW02
     6 4891 A9 0E			    lda #>GAMEDSPLSTADDR
     7 4893 85 E6			    sta M_PARAMW02+1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   109 						
   110 4895 20 3A 6B				jsr LoadDisplayListData					; perform the DL data move
   111
   112 				;*****	Set the addresses
   113 				;
   114 4898			SetAddresses
   115
   116 4898					SetPMBaseAddress PmgAddress				; set the player missile address
Macro: SETPMBASEADDRESS [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4898 A9 A0		      lda #>PMGADDRESS
     5 489A 8D 07 D4		      sta PMBASE
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   117
   118 489D					SetFontAddress GameFontAddress			; set the starting font address
Macro: SETFONTADDRESS [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 489D A9 A8				lda #>GAMEFONTADDRESS
     5 489F 8D 09 D4			    sta CHBASE
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   119 48A2					SetDisplayListAddress GameDspLstAddr	; set the display list address	
Macro: SETDISPLAYLISTADDRESS [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 48A2 A9 00		      	lda #<GAMEDSPLSTADDR
     5 48A4 8D 02 D4			    sta DLISTL
     6 48A7 A9 0E			    lda #>GAMEDSPLSTADDR
     7 48A9 8D 03 D4			    sta DLISTL+1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   120
   121 48AC					VcountWait 120
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 48AC A9 78				lda #120
     5 48AE CD 0B D4		VWait1	cmp VCOUNT
     6 48B1 D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   122
   123 				;*****	Housekeeping
   124 				;
   125 48B3 20 51 6C				jsr SfxOff
   126 48B6 20 19 4B				jsr InitVars							; begin initialization
   127 48B9 20 D5 4B				jsr InitLevelTable						; set up the level table		
   128 								
   129 				;*****	InitHardware
   130 				;
   131 48BC			InitHardware
   132
   133 48BC A9 00				lda #0									; set the player info
   134 48BE 8D 08 D0				sta SIZEP0
   135
   136 48C1 A9 55				lda #%01010101							; double width for all missiles
   137 48C3 8D 0C D0				sta SIZEM
   138
   139 48C6 A9 0C				lda #12									; set the HSCROL value
   140 48C8 8D 04 D4				sta HSCROL
   141 					
   142 48CB A9 00				lda #0									; set the VSCROL value
   143 48CD 8D 05 D4				sta VSCROL
   144 						
   145 48D0 A9 80				lda #[NMI_DLI]							; enable DLI's (but no VBI's)
   146 48D2 8D 0E D4				sta NMIEN
   147 						
   148 48D5 A9 03				lda #GRACTL_OPTIONS						; apply GRACTL options
   149 48D7 8D 1D D0				sta GRACTL
   150
   151 48DA A9 31				lda #PRIOR_OPTIONS						; apply PRIOR options
   152 48DC 8D 1B D0				sta PRIOR
   153
   154 48DF A9 3E				lda #DMACTL_OPTIONS						; apply DMACTL options
   155 48E1 8D 00 D4				sta DMACTL
   156
   157 48E4 A9 00				lda #0									; clear the hit register
   158 48E6 8D 1E D0				sta HITCLR
   159
   160 				;*****	Load the starting level
   161 				;
   162 48E9 A9 00				lda #$00								; set the starting level
   163 48EB 85 F2				sta m_currLevelNum						; store it off
   164
   165 48ED 85 93				sta m_param01							; store it to the parameter
   166 48EF 20 47 6B				jsr LoadLevel							; load the level
   167
   168 48F2					VcountWait 120
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 48F2 A9 78				lda #120
     5 48F4 CD 0B D4		VWait1	cmp VCOUNT
     6 48F7 D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   169
   170 				;*****	Initialize Level
   171 				;
   172 48F9 20 64 4C				jsr InitPlatforms						; initialize floating platforms if any
   173 48FC 20 0E 4C				jsr InitGoldCounter						; gold initialization
   174 48FF 20 F4 4C				jsr InitEnemyManager					; enemy manager initialization
   175 4902 20 A7 4D				jsr InitMissileSystem					; missile system initialization
   176
   177 4905					VcountWait 120
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4905 A9 78				lda #120
     5 4907 CD 0B D4		VWait1	cmp VCOUNT
     6 490A D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   178 						
   179 				;*****	Set player position and draw
   180 				;		
   181 490C A5 F2				lda m_currLevelNum						; grab the current level
   182 490E 85 92				sta m_param00							; store it in the parameter
   183 4910 20 A7 54				jsr SetSpawnPos							; set the spawn position for this level
   184 						
   185 4913 20 C1 55				jsr SetPlayerScreenPos 					; fill in the players position
   186 4916 20 E0 55				jsr DrawPlayer							; draw the player
   187
   188 4919					VcountWait 120	
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4919 A9 78				lda #120
     5 491B CD 0B D4		VWait1	cmp VCOUNT
     6 491E D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   189 						
   190 				;*****	GameLoop
   191 				;
   192 4920			GameLoop
   193 						
   194 4920 A5 DE				lda m_stick0
   195 4922 29 0F				and #$0F
   196 4924 C9 0F				cmp #$0F
   197 4926 D0 03				bne CheckState
   198 4928 4C 3C 49				jmp CheckUserInput
   199
   200 492B			CheckState
   201 						
   202 492B A5 D2				lda m_playerState
   203 492D C9 02				cmp #$02		
   204 492F F0 07				beq JumpSound
   205
   206 4931 C9 03				cmp #$03
   207 4933 F0 03				beq JumpSound
   208 						
   209 4935 4C 3C 49				jmp CheckUserInput
   210 						
   211 4938			JumpSound
   212 						
   213 4938 A9 01				lda #SFX_JUMP
   214 493A 85 99				sta m_sfxEffect
   215
   216 				;*****	Check User Input
   217 				;		
   218 493C			CheckUserInput
   219
   220 				.if DEBUG_ON = 1
   221
   222 493C AE 73 32				ldx m_floatPlatformIdx
   223 493F CA					dex
   224 						
   225 4940 A5 D2				lda m_playerState
   226 4942 A0 28				ldy #40
   227 4944 20 BE 4A				jsr DisplayDebugInfoHexFF
   228 						
   229 4947 AD CD 32				lda m_leftBottomChar
   230 494A A0 2B				ldy #43
   231 494C 20 BE 4A				jsr DisplayDebugInfoHexFF
   232 						
   233 494F AD CE 32				lda m_rightBottomChar
   234 4952 A0 2E				ldy #46
   235 4954 20 BE 4A				jsr DisplayDebugInfoHexFF
   236 						
   237 4957 A5 A2				lda m_playerLevelLeftX_H1
   238 4959 A0 31				ldy #49
   239 495B 20 BE 4A				jsr DisplayDebugInfoHexFF	
   240 						
   241 495E A5 A1				lda m_playerLevelLeftX_H2
   242 4960 A0 34				ldy #52
   243 4962 20 BE 4A				jsr DisplayDebugInfoHexFF	
   244 						
   245 4965 BD 35 6A				lda PlatformLSB,x
   246 4968 A0 37				ldy #55
   247 496A 20 BE 4A				jsr DisplayDebugInfoHexFF	
   248 						 		
   249 496D BD 3D 6A				lda PlatformMSB,x
   250 4970 A0 3A				ldy #58
   251 4972 20 BE 4A				jsr DisplayDebugInfoHexFF	
   252 						 		
   253 4975 BD 71 6A				lda PlatformBaseLSB,x
   254 4978 A0 3D				ldy #61
   255 497A 20 BE 4A				jsr DisplayDebugInfoHexFF	
   256
   257 497D BD 79 6A				lda PlatformBaseMSB,x
   258 4980 A0 40				ldy #64
   259 4982 20 BE 4A				jsr DisplayDebugInfoHexFF	
   260
   261 				.endif
   262 						
   263 4985 20 CB 6B				jsr CheckInput
   264 4988 20 6C 4E				jsr UpdateTimers
   265 498B 6C ED 00				jmp (m_playerMethodPointer)
   266 					
   267 				;*****	PlayerMethodReturn
   268 				;
   269 498E			PlayerMethodReturn
   270 498E A5 D2				lda m_playerState
   271 4990 C9 07				cmp #PS_LOSE
   272 4992 F0 2B				beq PlayerEndStates
   273 					
   274 				;*****	PlayerNormalStates	
   275 				;
   276 4994			PlayerNormalStates
   277 4994 20 34 64				jsr UpdateCameraWindow
   278 4997 20 C1 55				jsr SetPlayerScreenPos
   279 499A 20 E0 55				jsr DrawPlayer
   280 							
   281 				;*****	EnemyUpdate
   282 				;
   283 499D			EnemyUpdate
   284 499D 20 56 68				jsr UpdateEnemyManager
   285 					
   286 				;*****	MissilesStep
   287 				;
   288 49A0			MissilesStep
   289 49A0 20 99 5D				jsr UpdateMissileSystem
   290 49A3 20 AF 69				jsr DrawEnemyExplosion
   291 					
   292 				;*****	GameAnimations
   293 				;
   294 49A6			GameAnimations
   295 					
   296 49A6 20 90 62				jsr DoFontAnimations
   297 49A9 20 D0 62				jsr UpdateCoinAnimations
   298 49AC 20 E8 4D				jsr UpdateInfoLine
   299 49AF 20 67 6C				jsr SfxUpdate
   300 								
   301 49B2					VcountWait 120
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 49B2 A9 78				lda #120
     5 49B4 CD 0B D4		VWait1	cmp VCOUNT
     6 49B7 D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   302 						
   303 49B9 20 04 6C				jsr CheckPMCollisions
   304 49BC 4C 20 49				jmp GameLoop
   305 					
   306 				;*****	PlayerEndStates
   307 				;
   308 49BF			PlayerEndStates
   309 					
   310 49BF 20 43 56				jsr DrawPlayerExplosion
   311 49C2 20 90 62				jsr DoFontAnimations
   312 49C5 20 D0 62				jsr UpdateCoinAnimations
   313 49C8 20 99 5D				jsr UpdateMissileSystem
   314 49CB 20 AF 69				jsr DrawEnemyExplosion
   315 49CE 20 E8 4D				jsr UpdateInfoLine
   316 49D1 20 A7 54				jsr SetSpawnPos
   317 49D4 20 67 6C				jsr SfxUpdate
   318 												
   319 49D7					VcountWait 120
Macro: VCOUNTWAIT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 49D7 A9 78				lda #120
     5 49D9 CD 0B D4		VWait1	cmp VCOUNT
     6 49DC D0 FB			    bne VWait1
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   320 						
   321 49DE A9 00				lda #0
   322 49E0 8D 1E D0				sta HITCLR	
   323 						
   324 49E3 4C 20 49				jmp GameLoop
   325
   326 				;*****	Includes base files
   327 				;
   328 49E6					icl "/Lib/SysProcs.Asm"
Source: E:\_8BitProjects\Series\Scroller\\Lib\SysProcs.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		SysProcs.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13
    14 				;****	Storage
    15 				;
    16 49E6 00			_productLo		.byte $00 
    17 49E7 00			_productHi		.byte $00 
    18 49E8 00			_multiplier		.byte $00 
    19 49E9 00			_multiplicand	.byte $00 
    20
    21 49EA 00			_divisor		.byte $00						; DIVISOR
    22 49EB 00			_quitient		.byte $00 						; QUOTIENT
    23 49EC 00			_remainder		.byte $00						; REMAINDER 
    24 49ED 00			_dividenLo		.byte $00						; LOW PART OF DIVIDEND
    25 49EE 00			_dividendHi		.byte $00						; HIGH PART OF DIVIDEND 
    26
    27 49EF			TabHexNibbleToScreenDigit
    28 49EF 10 11 12 13 14 15 + 	.sb "0123456789ABCDEF"
    29
    30 49FF			TabBinaryToBCD
    31 49FF 00 01 02 03 04 05 + 	.byte $00, $01, $02, $03, $04, $05, $06, $07, $08, $09
    32 4A09 10 11 12 13 14 15 + 	.byte $10, $11, $12, $13, $14, $15, $16, $17, $18, $19
    33 4A13 20 21 22 23 24 25 + 	.byte $20, $21, $22, $23, $24, $25, $26, $27, $28, $29
    34 4A1D 30 31 32 33 34 35 + 	.byte $30, $31, $32, $33, $34, $35, $36, $37, $38, $39
    35 4A27 40 41 42 43 44 45 + 	.byte $40, $41, $42, $43, $44, $45, $46, $47, $48, $49
    36 4A31 50 51 52 53 54 55 + 	.byte $50, $51, $52, $53, $54, $55, $56, $57, $58, $59
    37 4A3B 60 61 62 63 64 65 + 	.byte $60, $61, $62, $63, $64, $65, $66, $67, $68, $69
    38 4A45 70 71 72 73 74 75 + 	.byte $70, $71, $72, $73, $74, $75, $76, $77, $78, $79
    39 4A4F 80 81 82 83 84 85 + 	.byte $80, $81, $82, $83, $84, $85, $86, $87, $88, $89
    40 4A59 90 91 92 93 94 95 + 	.byte $90, $91, $92, $93, $94, $95, $96, $97, $98, $99
    41
    42 				;
    43 				;***************************************************************************************************
    44 				; WaitFrame
    45 				;***************************************************************************************************
    46 				;
    47 4A63			.proc WaitFrame
    48 						
    49 4A63 A5 14				lda RTCLOK60							; get frame/jiffy counter
    50
    51 4A65			WaitTick60
    52
    53 4A65 C5 14				cmp RTCLOK60							; Loop until the clock changes
    54 4A67 F0 FC				beq WaitTick60		
    55 4A69 60					rts
    56 				.endp			
    57
    58 				;
    59 				;***************************************************************************************************
    60 				; MultiplyAX
    61 				;***************************************************************************************************
    62 				;
    63 4A6A			.proc MultiplyAX  
    64 4A6A 8D E8 49				sta _multiplier
    65 4A6D 8E E9 49				stx _multiplicand 
    66 4A70 A9 00				lda #0 
    67 4A72 8D E6 49				sta _productLo 
    68 4A75 A2 08				ldx #8 
    69
    70 				;*************************************************
    71 				;		
    72 4A77			Loop
    73 4A77 4E E8 49			 	lsr _multiplier 
    74 4A7A 90 04				bcc NoAdd 
    75 4A7C 18					clc 
    76 4A7D 6D E9 49				adc _multiplicand 
    77
    78 				;*************************************************
    79 				;
    80 4A80			NoAdd
    81 4A80 6A				 	ror 
    82 4A81 6E E6 49				ror _productLo 
    83 4A84 CA					dex 
    84 4A85 D0 F0				bne Loop 
    85 4A87 8D E7 49				sta _productHi 
    86
    87 4A8A 60					rts 
    88 				.endp
    89
    90 				;
    91 				;***************************************************************************************************
    92 				; DivideAXY
    93 				;***************************************************************************************************
    94 				;
    95 4A8B			.proc DivideAXY
    96 						
    97 4A8B 8E EA 49				stx _divisor							; THE DIVISOR
    98 4A8E 8C ED 49				sty _dividenLo								
    99 4A91 8D EE 49				sta _dividendHi							; ACCUMULATOR WILL HOLD DVDH
   100 				 
   101 4A94 A2 08				ldx	#$08 								; FOR AN 8-BIT DIVISOR 
   102 4A96 38					sec 
   103 4A97 ED EA 49				sbc _divisor 
   104
   105 				;************************************************
   106 				;
   107 4A9A 08			DLOOP 	php										; THE LOOP THAT DIVIDES 
   108 4A9B 2E EB 49				rol _quitient 
   109 4A9E 0E ED 49				asl _dividenLo 
   110 4AA1 2A					rol  
   111 4AA2 28					plp 
   112 4AA3 90 06				bcc ADDIT 
   113 4AA5 ED EA 49				sbc _divisor 
   114 4AA8 4C AE 4A				jmp NEXT 
   115
   116 				;************************************************
   117 				;
   118 4AAB 6D EA 49		ADDIT 	adc _divisor 
   119
   120 				;************************************************
   121 				;
   122 4AAE CA			NEXT 	dex 
   123 4AAF D0 E9				bne	DLOOP 
   124 4AB1 B0 04				bcs FINI 
   125 4AB3 6D EA 49				ADC _divisor 
   126 4AB6 18					clc 
   127
   128 				;************************************************
   129 				;		
   130 4AB7 2E EB 49		FINI 	rol _quitient 
   131 4ABA 8D EC 49				sta _remainder 
   132 4ABD 60					rts 									; ENDIT
   133
   134 				.endp		
   135
   136 				;
   137 				;**************************************************************************************************
   138 				; DisplayDebugInfoHexFF
   139 				;
   140 				; 	display 2 digits with values from 00 to FF
   141 				; 	passs the value in A and the line row in Y
   142 				;
   143 				;**************************************************************************************************
   144 				;
   145 4ABE			.proc DisplayDebugInfoHexFF
   146
   147 4ABE 86 97				stx m_saveRegX
   148 4AC0 8D CF 4A				sta Save_Value+1						; place the value in A 1 location pasted the lda.   
   149 					
   150 4AC3 4A					lsr										; display 2 digits (from 0 to F)
   151 4AC4 4A					lsr
   152 4AC5 4A					lsr
   153 4AC6 4A					lsr
   154 4AC7 AA					tax
   155 4AC8 BD EF 49				lda TabHexNibbleToScreenDigit,x
   156 4ACB 99 80 06				sta HudMemoryAddr,y
   157
   158 4ACE			Save_Value
   159
   160 4ACE A9 FF				lda #$FF								; will hold the value in A on entry
   161 4AD0 29 0F				and #15
   162 4AD2 AA					tax
   163 4AD3 BD EF 49				lda TabHexNibbleToScreenDigit,x
   164 4AD6 99 81 06				sta HudMemoryAddr+1,y
   165 4AD9 A6 97				ldx m_saveRegX
   166 4ADB 60					rts
   167 				.endp	
   168
   169 				;
   170 				;**************************************************************************************************
   171 				; DisplayDebugInfoBinary99
   172 				;
   173 				;	display 2 digits with values from 00 to 99
   174 				; 	passs the value in A and the line row in Y
   175 				;
   176 				;**************************************************************************************************
   177 				;
   178 4ADC			.proc DisplayDebugInfoBinary99
   179
   180 4ADC 86 97				stx m_saveRegX
   181 4ADE AA					tax
   182 4ADF E0 64				cpx #100
   183 4AE1 90 02				bcc NoOverflow
   184 4AE3 A2 63				ldx #99
   185
   186 4AE5			NoOverflow
   187 4AE5 BD FF 49				lda TabBinaryToBCD,x
   188 4AE8 AA					tax
   189
   190 4AE9 4A					lsr										; display 2 digits (from 0 to 9)
   191 4AEA 4A					lsr
   192 4AEB 4A					lsr
   193 4AEC 4A					lsr
   194 4AED 09 10				ora #16									; add the "0" character value
   195 4AEF 99 80 06				sta HudMemoryAddr,y
   196
   197 4AF2 8A					txa
   198 4AF3 29 0F				and #15
   199 4AF5 09 10				ora #16									; add the "0" character value
   200 4AF7 99 81 06				sta HudMemoryAddr+1,y
   201
   202 4AFA A6 97				ldx m_saveRegX
   203 4AFC 60					rts
   204 				.endp		
   205
   206 				;
   207 				;**************************************************************************************************
   208 				; DisplayDebugInfoBinary9
   209 				;**************************************************************************************************
   210 				;
   211 4AFD			.proc DisplayDebugInfoBinary9
   212
   213 4AFD C9 0A				cmp #10
   214 4AFF 90 02				bcc NoOverflow2
   215 4B01 A9 09				lda #9
   216
   217 				;*************************************************
   218 				;
   219 4B03			NoOverflow2
   220 					
   221 4B03 09 10				ora #16									; display 1 digit (from 0 to 9) add the "0" character value
   222 4B05 99 80 06				sta HudMemoryAddr,y
   223
   224 4B08 60				rts
   225
   226 				.endp	
   227
   228 				;
   229 				;**************************************************************************************************
   230 				; ClearDebugLineInfo
   231 				;**************************************************************************************************
   232 				;
   233 4B09			.proc ClearDebugLineInfo
   234
   235 4B09 86 97				stx m_saveRegX
   236 4B0B A9 00				lda #0
   237 4B0D AA					tax
   238
   239 4B0E			CDI_loop
   240
   241 4B0E 9D 80 06				sta HudMemoryAddr,x
   242 4B11 E8					inx
   243 4B12 E0 28				cpx #40
   244 4B14 D0 F8				bne CDI_loop
   245 4B16 A6 97				ldx m_saveRegX
   246 						
   247 4B18 60					rts
   248
   249 				.endp
   329
   330 4B19					icl "Initialize.Asm"
Source: E:\_8BitProjects\Series\Scroller\Initialize.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		Initialize.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; InitVars
    15 				;**************************************************************************************************
    16 				;
    17 4B19			.proc InitVars
    18 					
    19 4B19 A9 01				lda #1									; input info
    20 4B1B 85 E2				sta m_currentTrigger0
    21 4B1D 85 E0				sta m_oldTrigger0
    22
    23 4B1F A9 00				lda #0
    24 4B21 85 E1				sta m_triggerState
    25
    26 4B23 A9 0F				lda #15
    27 4B25 85 DE				sta m_stick0
    28 4B27 85 DF				sta m_oldStick0
    29 						
    30 4B29 A9 00				lda #>[CHAR_PIX.else_X]					; level info
    31 4B2B 85 DA				sta m_levelWindowX_H2
    32 						
    33 4B2D A9 04				lda #<[CHAR_PIX.else_X]
    34 4B2F 85 DB				sta m_levelWindowX_H1
    35 						
    36 4B31 A9 00				lda #0
    37 4B33 85 DC				sta m_levelWindowY_H2
    38 						
    39 4B35 A9 00				lda #0
    40 4B37 85 DD				sta m_levelWindowY_H1
    41
    42 4B39 A9 52				lda #LEVEL_CHAR_SIZE_X
    43 4B3B 85 D4				sta m_levelCharSizeX
    44 						
    45 4B3D A9 18				lda #LEVEL_CHAR_SIZE_Y
    46 4B3F 85 D5				sta m_levelCharSizeY
    47
    48 4B41 A9 01				lda #>[LEVEL_CHAR_SIZE_X*CHAR_PIX.else_X]
    49 4B43 85 D6				sta m_levelSizeX_H2
    50 						
    51 4B45 A9 48				lda #<[LEVEL_CHAR_SIZE_X*CHAR_PIX.else_X]
    52 4B47 85 D7				sta m_levelSizeX_H1
    53
    54 4B49 A9 00				lda #>[LEVEL_CHAR_SIZE_Y*CHAR_PIX.else_Y]
    55 4B4B 85 D8				sta m_levelSizeY_H2
    56 						
    57 4B4D A9 C0				lda #<[LEVEL_CHAR_SIZE_Y*CHAR_PIX.else_Y]
    58 4B4F 85 D9				sta m_levelSizeY_H1
    59
    60 4B51 A9 00				lda #<GameMemoryAddress
    61 4B53 8D D9 32				sta m_currentLineAddress
    62 						
    63 4B56 A9 B0				lda #>GameMemoryAddress
    64 4B58 8D DA 32				sta m_currentLineAddress+1
    65 							
    66 						;************************************************
    67 						;
    68 						; player info
    69 						;
    70 						; 	remember that we don't use any speed over 1 char per frame right now,
    71 						; 	because we don't want to lose collisions (in that case case we should
    72 						; 	use 2 or more steps per frame, or a "sweep" collision method)
    73 						;
    74 						;************************************************
    75 						;
    76
    77 				.if PAL_VERSION = 0
    78 					
    79 4B5B A9 03				lda #3									; air vertical movement 240 pixels per second (at 60 fps only!)
    80 4B5D 85 BF				sta m_playerJumpSpeed_H1
    81 						
    82 4B5F A9 80				lda #128
    83 4B61 85 C0				sta m_playerJumpSpeed_L1
    84
    85 4B63 A9 06				lda #6									; near 400 pixels per second (1 character per frame at 50 fps, PAL friendly)
    86 4B65 85 C1				sta m_playerMaxFallSpeed_H1
    87 					
    88 4B67 A9 AA				lda #170
    89 4B69 85 C2				sta m_playerMaxFallSpeed_L1
    90
    91 4B6B A9 00				lda #0									; 12.8 frames (at 60 fps only!) to reach max speed (from zero)
    92 4B6D 85 C3				sta m_playerGravityAccel_H1
    93 					
    94 4B6F A9 70				lda #112
    95 4B71 85 C4				sta m_playerGravityAccel_L1
    96 								
    97 4B73 A9 00				lda #0									; water vertical movement
    98 4B75 85 C5				sta m_playerWaterAccelY_H1
    99 						
   100 4B77 A9 20				lda #32
   101 4B79 85 C6				sta m_playerWaterAccelY_L1
   102
   103 4B7B A9 00				lda #0
   104 4B7D 85 C7				sta m_playerMaxWaterSpeedY_H1
   105 					
   106 4B7F A9 80				lda #128
   107 4B81 85 C8				sta m_playerMaxWaterSpeedY_L1
   108
   109 4B83 A9 01				lda #1
   110 4B85 85 C9				sta m_playerMoveWaterSpeedY_H1
   111 					
   112 4B87 A9 00				lda #0
   113 4B89 85 CA				sta m_playerMoveWaterSpeedY_L1
   114
   115 				.else
   116
   117 						lda #4									; air vertical movement pixels per second (at 50 fps only!)
   118 						sta m_playerJumpSpeed_H1
   119 					
   120 						lda #51
   121 						sta m_playerJumpSpeed_L1
   122
   123 						lda #7									; near 400 pixels per second (1 character per frame at 50 fps, PAL friendly)
   124 						sta m_playerMaxFallSpeed_H1
   125 					
   126 						lda #255
   127 						sta m_playerMaxFallSpeed_L1
   128
   129 						lda #0									;  frames (at 50 fps only!) to reach max speed (from zero)
   130 						sta m_playerGravityAccel_H1
   131 						
   132 						lda #134
   133 						sta m_playerGravityAccel_L1
   134
   135 						lda #0									; water vertical movement
   136 						sta m_playerWaterAccelY_H1
   137 						
   138 						lda #38
   139 						sta m_playerWaterAccelY_L1
   140
   141 						lda #0
   142 						sta m_playerMaxWaterSpeedY_H1
   143 					
   144 						lda #154
   145 						sta m_playerMaxWaterSpeedY_L1
   146
   147 						lda #1
   148 						sta m_playerMoveWaterSpeedY_H1
   149 					
   150 						lda #51
   151 						sta m_playerMoveWaterSpeedY_L1
   152
   153 				.endif
   154 					
   155 4B8B A2 08				ldx #PLR_WIDTH							; set size in pixels
   156 4B8D 86 B1				stx m_playerSizeX
   157 4B8F CA					dex
   158 4B90 86 B3				stx m_playerSizeXMinusOne
   159 					
   160 4B92 A2 15				ldx #PLR_HEIGHT
   161 4B94 86 B2				stx m_playerSizeY
   162 4B96 CA					dex
   163 4B97 86 B4				stx m_playerSizeYMinusOne
   164 					
   165 4B99 20 9D 4B				jsr InitPlayerInfo
   166 						
   167 4B9C 60					rts
   168 					
   169 				.endp	
   170
   171 				;
   172 				;**************************************************************************************************
   173 				; InitPlayerInfo
   174 				;**************************************************************************************************
   175 				;
   176 4B9D			.proc InitPlayerInfo
   177
   178 4B9D A9 00				lda #0
   179 4B9F 85 CB				sta m_playerNoJumpTimer
   180 4BA1 85 CC				sta m_playerHoldJumpCounter
   181 4BA3 85 CF				sta m_playerOverPlatformFlag
   182 4BA5 85 D0				sta m_playerTopCollisionFlag
   183 4BA7 85 D1				sta m_playerSideCollisionFlag
   184
   185 4BA9 A2 01				ldx #PS_OVER_PLATFORM
   186 4BAB 20 F6 4E				jsr SetPlayerMethod
   187
   188
   189 4BAE A9 00				lda #0
   190 4BB0 85 B5				sta m_playerSideSpeed_H1
   191 4BB2 85 B6				sta m_playerSideSpeed_L1
   192 						
   193 						; set uo spawn position
   194 4BB4 20 A7 54				jsr SetSpawnPos
   195 4BB7 A9 02				lda #PSD_LEFT	
   196 4BB9 85 CD				sta m_lastPlayerSideDirection
   197 4BBB 85 CE				sta m_lastPlayerShootDirection
   198 4BBD A9 01				lda #1
   199 4BBF 85 9C				sta m_redrawPlayerCounter
   200 4BC1 20 E0 55				jsr DrawPlayer
   201 						
   202 4BC4 A9 01				lda #PSD_RIGHT	
   203 4BC6 85 CD				sta m_lastPlayerSideDirection
   204 4BC8 85 CE				sta m_lastPlayerShootDirection
   205 4BCA A9 01				lda #1
   206 4BCC 85 9C				sta m_redrawPlayerCounter
   207 4BCE 20 E0 55				jsr DrawPlayer	
   208
   209 4BD1 20 A6 55				jsr SetPlayerInfo	
   210 						
   211 4BD4 60					rts
   212
   213 				.endp		
   214
   215 				;
   216 				;**************************************************************************************************
   217 				; InitLevelTable
   218 				;**************************************************************************************************
   219 				;
   220 4BD5			.proc InitLevelTable
   221 						
   222 4BD5 A0 00				ldy #0
   223
   224 				;************************************************
   225 				;
   226 4BD7			ILTL_loop
   227
   228 4BD7 AD D9 32				lda m_currentLineAddress
   229 4BDA 99 DB 32				sta TabLevelLineAddressLSB,y
   230 						
   231 4BDD AD DA 32				lda m_currentLineAddress+1
   232 4BE0 99 DB 33				sta TabLevelLineAddressMSB,y
   233
   234 4BE3 A5 D4				lda m_levelCharSizeX
   235 4BE5 D0 06				bne ILTL_below_256
   236
   237 4BE7 EE DA 32				inc m_currentLineAddress+1				; if m_levelCharSizeX = 0, then add 256 chars
   238 4BEA 4C FC 4B				jmp ILTL_check_loop
   239
   240 				;************************************************
   241 				;
   242 4BED			ILTL_below_256
   243
   244 4BED 18					clc
   245 4BEE 6D D9 32				adc m_currentLineAddress				; from 1 to 255 chars
   246 4BF1 8D D9 32				sta m_currentLineAddress
   247
   248 4BF4 AD DA 32				lda m_currentLineAddress+1
   249 4BF7 69 00				adc #0
   250 4BF9 8D DA 32				sta m_currentLineAddress+1
   251
   252 				;************************************************
   253 				;
   254 4BFC			ILTL_check_loop
   255
   256 4BFC C8					iny
   257 4BFD C4 D5				cpy m_levelCharSizeY					; from 1 to 255 lines, 0 = 256 lines in this case
   258 4BFF D0 D6				bne ILTL_loop
   259 					
   260 4C01 AD D9 32				lda m_currentLineAddress				; add one more line definition to fix problem of ladders in the last line, but this is not going to work if there are 256 lines!
   261 4C04 99 DB 32				sta TabLevelLineAddressLSB,y
   262 					
   263 4C07 AD DA 32				lda m_currentLineAddress+1
   264 4C0A 99 DB 33				sta TabLevelLineAddressMSB,y
   265 					
   266 4C0D 60					rts
   267 						
   268 				.endp		
   269
   270 				;
   271 				;**************************************************************************************************
   272 				; InitGoldCounter
   273 				;**************************************************************************************************
   274 				;
   275 4C0E			.proc InitGoldCounter
   276
   277 4C0E A2 00				ldx #0									; line index
   278
   279 				;****	1st Loop
   280 				; 
   281 4C10			IGC_loop1
   282 					
   283 4C10 A0 00				ldy #0									; column index
   284 					
   285 4C12 BD DB 32				lda TabLevelLineAddressLSB,x
   286 4C15 85 E9				sta m_ptrLevelLine
   287 						
   288 4C17 BD DB 33				lda TabLevelLineAddressMSB,x
   289 4C1A 85 EA				sta m_ptrLevelLine+1
   290
   291 				;*****	2nd Loop
   292 				;
   293 4C1C			IGC_loop2
   294
   295 4C1C B1 E9				lda (m_ptrLevelLine),y
   296 4C1E 85 F1				sta m_currChar	
   297 4C20 86 D3				stx m_pageZeroTempValue
   298 4C22 AA					tax
   299 4C23 BD DB 34				lda TabCharDefinition,x
   300 4C26 A6 D3				ldx m_pageZeroTempValue
   301 					
   302 4C28 29 0F				and #15
   303 4C2A C9 02				cmp #CT_COLLECTABLE
   304 4C2C D0 06				bne WaterCheck
   305 					
   306 4C2E EE 78 32				inc m_goldCounter
   307 4C31 4C 59 4C				jmp IGC_no_gold
   308 						
   309 				;*****	Water Check
   310 				;		
   311 4C34			WaterCheck
   312
   313 4C34 C9 05				cmp #CT_WATER
   314 4C36 D0 06				bne HealthCheck
   315 						
   316 4C38 EE 7A 32				inc m_waterAvailable
   317 4C3B 4C 59 4C				jmp IGC_no_gold
   318 						
   319 				;*****	Health Check
   320 				;		
   321 4C3E			HealthCheck
   322
   323 4C3E C9 06				cmp #CT_HEALTH
   324 4C40 D0 06				bne VertLaserCheck
   325 						
   326 4C42 EE 79 32				inc m_healthCounter
   327 4C45 4C 59 4C				jmp IGC_no_gold		
   328 						
   329 				;*****	Vertical Check
   330 				;		
   331 4C48			VertLaserCheck
   332
   333 4C48 C9 08				cmp #CT_VLASER
   334 4C4A D0 06				bne HoriLaserCheck
   335 						
   336 4C4C EE 76 32				inc m_verticalLaserOn
   337 4C4F 4C 59 4C				jmp IGC_no_gold
   338
   339 				;*****	Horizontal Check
   340 				;		
   341 4C52			HoriLaserCheck
   342
   343 4C52 C9 0A				cmp #CT_HLASER
   344 4C54 D0 03				bne IGC_no_gold
   345
   346 4C56 EE 77 32				inc m_horizontalLaserOn
   347 							
   348 				;*****	No Gold
   349 				;	
   350 4C59			IGC_no_gold
   351
   352 4C59 C8					iny
   353 4C5A C4 D4				cpy m_levelCharSizeX
   354 4C5C D0 BE				bne IGC_loop2
   355
   356 				;*****	Check Loop Y
   357 				;
   358 4C5E			IGC_check_loop_Y
   359
   360 4C5E E8					inx
   361 4C5F E4 D5				cpx m_levelCharSizeY
   362 4C61 D0 AD				bne IGC_loop1	
   363 4C63 60					rts
   364
   365 				.endp	
   366
   367 				;
   368 				;**************************************************************************************************
   369 				; UpdateInfoLine
   370 				;**************************************************************************************************
   371 				;
   372 4C64			.proc InitPlatforms
   373
   374 4C64 A2 00				ldx #$00
   375 4C66 8E 71 32				stx m_floatPlatformV
   376 4C69 8E 72 32				stx m_floatPlatformH
   377 4C6C 8E 73 32				stx m_floatPlatformIdx		
   378 						
   379 				;*****	Beging loop
   380 				;
   381 4C6F			loop
   382 4C6F A0 00				ldy #0									; column index
   383 					
   384 4C71 BD DB 32				lda TabLevelLineAddressLSB,x		
   385 4C74 85 E9				sta m_ptrLevelLine
   386 						
   387 4C76 BD DB 33				lda TabLevelLineAddressMSB,x
   388 4C79 85 EA				sta m_ptrLevelLine+1
   389
   390 				;*****	Middle loop
   391 				;
   392 4C7B			loop1
   393
   394 4C7B B1 E9				lda (m_ptrLevelLine),y
   395 4C7D 85 F1				sta m_currChar	
   396 4C7F 86 D3				stx m_pageZeroTempValue
   397 4C81 AA					tax
   398 4C82 BD DB 34				lda TabCharDefinition,x
   399 4C85 A6 D3				ldx m_pageZeroTempValue
   400
   401 4C87 29 0F				and #15
   402 4C89 C9 07				cmp #CT_FLOATPLATFORMH
   403 4C8B F0 07				beq loopH
   404 						
   405 4C8D C9 09				cmp #CT_FLOATPLATFORMV
   406 4C8F F0 4F				beq loopV		
   407 4C91 4C E6 4C				jmp loop2	
   408
   409 4C94			loopH
   410 4C94 AD 6D 6A				lda PlatformCharH
   411 4C97 C5 F1				cmp m_currChar
   412 4C99 F0 0A				beq StartH
   413
   414 4C9B AD 6E 6A				lda PlatformCharH+1
   415 4C9E C5 F1				cmp m_currChar
   416 4CA0 F0 03				beq StartH
   417 4CA2 4C E6 4C				jmp loop2
   418 									
   419 4CA5			StartH	
   420 											 
   421 4CA5 8A					txa										; move x to a
   422 4CA6 48					pha										; store a
   423
   424 4CA7 98					tya										; move y to a
   425 4CA8 48					pha										; store a
   426 						
   427 4CA9 AC 73 32				ldy m_floatPlatformIdx					; put the current index in y
   428
   429 4CAC 48					pha
   430 4CAD BD DB 32				lda TabLevelLineAddressLSB,x
   431 4CB0 99 71 6A				sta PlatformBaseLSB,y
   432 4CB3 BD DB 33				lda TabLevelLineAddressMSB,x
   433 4CB6 99 79 6A				sta PlatformBaseMSB,y
   434 						
   435 4CB9 68					pla		
   436 4CBA 18					clc										; clear the carry
   437 4CBB 7D DB 32				adc TabLevelLineAddressLSB,x			; add the lsb screen address		
   438 4CBE 99 35 6A				sta PlatformLSB,y						; store it by index		
   439 						
   440 4CC1 BD DB 33				lda TabLevelLineAddressMSB,x			; get the msb screen address
   441 4CC4 69 00				adc #00									; account for carry
   442 4CC6 99 3D 6A				sta PlatformMSB,y						; store it by index
   443 						
   444 4CC9 A9 01				lda #01									; type 01 is horizontal
   445 4CCB 99 4D 6A				sta PlatformType,y						; store it by index
   446 						
   447 4CCE A9 00				lda #$00								; initialize the step
   448 4CD0 99 5D 6A				sta PlatformStepX,y						; store it by index
   449 								
   450 4CD3 EE 73 32				inc m_floatPlatformIdx					; increment the index
   451 4CD6 EE 72 32				inc m_floatPlatformH
   452 						
   453 4CD9 68					pla										; pull y
   454 4CDA A8					tay										; restore y
   455
   456 4CDB 68					pla										; pull x
   457 4CDC AA					tax										; restore x
   458
   459 4CDD 4C E6 4C				jmp loop2
   460 						
   461 4CE0			loopV	
   462 4CE0 BD DB 34				lda TabCharDefinition,x			
   463 4CE3 EE 71 32				inc m_floatPlatformV
   464 						
   465 				;*****	Loop on X 
   466 				;		
   467 4CE6			loop2	
   468 4CE6 C8					iny
   469 4CE7 C4 D4				cpy m_levelCharSizeX
   470 4CE9 D0 90				bne loop1
   471 						
   472 4CEB E8					inx
   473 4CEC E4 D5				cpx m_levelCharSizeY
   474 4CEE F0 03				beq Exit
   475 4CF0 4C 6F 4C				jmp loop
   476 						
   477 4CF3			Exit		
   478 4CF3 60					rts
   479
   480 				.endp
   481
   482 				;
   483 				;**************************************************************************************************
   484 				; InitEnemyManager
   485 				;
   486 				; parse every type of enemy, init its life, state, char index and position
   487 				; update total and active enemies
   488 				;
   489 				;**************************************************************************************************
   490 				;
   491 4CF4			.proc InitEnemyManager
   492
   493 						; parse enemy type 1 (only one for now)
   494 4CF4 A2 01				ldx #1							; enemy type index
   495 4CF6 BD 52 68				lda TabEnemyDefBaseChar,x
   496 4CF9 8D A3 32				sta m_searchEnemyChar
   497 4CFC BD 50 68				lda TabEnemyDefLife,x
   498 4CFF 8D A4 32				sta m_defEnemyLife
   499 					
   500 4D02 A6 D4				ldx m_levelCharSizeX
   501 4D04 CA					dex										; we search in a shorter line because this enemy has a width of 2 chars
   502 4D05 8E A5 32				stx m_numberOfValidRows
   503 					
   504 4D08 A2 00				ldx #0									; line index
   505 				;
   506 				;************************************************
   507 				;
   508 4D0A			IEM_loop1
   509 					
   510 4D0A A0 00				ldy #0									; column index	
   511 4D0C BD DB 32				lda TabLevelLineAddressLSB,x
   512 4D0F 85 E9				sta m_ptrLevelLine
   513 4D11 BD DB 33				lda TabLevelLineAddressMSB,x
   514 4D14 85 EA				sta m_ptrLevelLine+1
   515
   516 				;************************************************
   517 				;
   518 4D16			IEM_loop2
   519 					
   520 4D16 B1 E9				lda (m_ptrLevelLine),y
   521 4D18 CD A3 32				cmp m_searchEnemyChar
   522 4D1B D0 78				bne IEM_no_enemy
   523
   524 4D1D 8E A6 32				stx m_tempByte
   525 4D20 AE A1 32				ldx m_totalEnemies
   526
   527 						; init info for this enemy
   528 4D23 A9 01				lda #1
   529 4D25 9D 70 66				sta TabEnemyType,x
   530 						
   531 4D28 AD A4 32				lda m_defEnemyLife
   532 4D2B 9D 90 66				sta TabEnemyLife,x
   533 						
   534 4D2E A9 01				lda #1
   535 4D30 9D B0 66				sta TabEnemyState,x
   536 						
   537 4D33 A9 78				lda #ENEMY_INIT_TIMER					; dont allow enemy actions for the first 4 seconds
   538 4D35 9D D0 66				sta TabEnemyStateTimer,x
   539 						
   540 4D38 AD A3 32				lda m_searchEnemyChar
   541 4D3B 9D F0 66				sta TabEnemyBaseCharIndex,x
   542 4D3E 98					tya
   543 4D3F 9D 10 67				sta TabEnemyBaseCharX,x
   544 						
   545 4D42 AD A6 32				lda m_tempByte
   546 4D45 9D 30 67				sta TabEnemyBaseCharY,x
   547
   548 						; init level position
   549 						; TabEnemyLevelTopY_H2 starts as 0, now multiply by 8 to get the line
   550 4D48 0A					asl
   551 4D49 3E B0 67				rol TabEnemyLevelTopY_H2,x
   552 4D4C 0A					asl
   553 4D4D 3E B0 67				rol TabEnemyLevelTopY_H2,x
   554 4D50 0A					asl
   555 4D51 3E B0 67				rol TabEnemyLevelTopY_H2,x
   556 4D54 9D 90 67				sta TabEnemyLevelTopY_H1,x
   557 					
   558 						; TabEnemyLevelLeftX_H2 starts as 0, now multiply by 4 to get the horizontal pixel
   559 4D57 98					tya
   560 4D58 0A					asl
   561 4D59 3E 70 67				rol TabEnemyLevelLeftX_H2,x
   562 4D5C 0A					asl
   563 4D5D 3E 70 67				rol TabEnemyLevelLeftX_H2,x
   564 4D60 9D 50 67				sta TabEnemyLevelLeftX_H1,x
   565
   566 						; init shot creation position (offset x: 3, offset y: 1)
   567 4D63 BD 50 67				lda TabEnemyLevelLeftX_H1,x
   568 4D66 18					clc
   569 4D67 69 03				adc #3
   570 4D69 9D D0 67				sta TabEnemyShotLevelLeftX_H1,x
   571 4D6C BD 70 67				lda TabEnemyLevelLeftX_H2,x
   572 4D6F 69 00				adc #0
   573 4D71 9D F0 67				sta TabEnemyShotLevelLeftX_H2,x
   574 					
   575 4D74 BD 90 67				lda TabEnemyLevelTopY_H1,x
   576 4D77 18					clc
   577 4D78 69 01				adc #1
   578 4D7A 9D 10 68				sta TabEnemyShotLevelTopY_H1,x
   579 						
   580 4D7D BD B0 67				lda TabEnemyLevelTopY_H2,x
   581 4D80 69 00				adc #0
   582 4D82 9D 30 68				sta TabEnemyShotLevelTopY_H2,x
   583
   584 						; update number of enemies	
   585 4D85 EE A1 32				inc m_totalEnemies
   586 4D88 EE A2 32				inc m_activeEnemies
   587
   588 4D8B AD A1 32				lda m_totalEnemies
   589 4D8E C9 20				cmp #MAX_ENEMIES_PER_LEVEL
   590 4D90 F0 14				beq IEM_exit
   591 					
   592 4D92 AE A6 32				ldx m_tempByte
   593
   594 				;************************************************
   595 				;
   596 4D95			IEM_no_enemy
   597 						
   598 4D95 C8					iny
   599 4D96 CC A5 32				cpy m_numberOfValidRows
   600 4D99 F0 03				beq IEM_check_loop_Y
   601 4D9B 4C 16 4D				jmp IEM_loop2
   602
   603 				;************************************************
   604 				;
   605 4D9E			IEM_check_loop_Y
   606
   607 4D9E E8					inx
   608 4D9F E4 D5				cpx m_levelCharSizeY
   609 4DA1 F0 03				beq IEM_exit
   610 4DA3 4C 0A 4D				jmp IEM_loop1
   611
   612 				;************************************************
   613 				;
   614 4DA6			IEM_exit
   615 					
   616 4DA6 60					rts
   617 						
   618 				.endp		
   619
   620 				;
   621 				;**************************************************************************************************
   622 				; InitMissileSystem
   623 				;	
   624 				; 	Right now, the missile system is using a 1-on-1 relationship between
   625 				; 	a virtual missile and a hardware missile, so we have a max of 4 virtual
   626 				; 	missiles. If we want more virtual missiles we can only draw 4 every frame,
   627 				; 	so some of them can lose hardware collisions and they are going to flicker
   628 				;
   629 				;**************************************************************************************************
   630 				;
   631 4DA7			.proc InitMissileSystem
   632
   633 				.if PAL_VERSION = 0
   634 4DA7 A9 24				lda #[32+4]		; red color, change for pal
   635 				.else
   636 						lda #[16+4]
   637 				.endif
   638 4DA9 85 9D				sta m_missleBaseColor00
   639 						
   640 4DAB A9 00				lda #0
   641 4DAD 8D 9C 5C				sta m_currentVirtualMissiles
   642
   643 4DB0 A2 00				ldx #0
   644
   645 4DB2			IMS_loop
   646 4DB2 9D 9D 5C				sta TabMissileScreenLeftX,x
   647 4DB5 9D A1 5C				sta TabMissileScreenTopY,x
   648 4DB8 9D A5 5C				sta TabOldMissileScreenLeftX,x
   649 4DBB 9D A9 5C				sta TabOldMissileScreenTopY,x
   650
   651 4DBE 9D AD 5C				sta TabMissileLevelLeftX_H2,x
   652 4DC1 9D B1 5C				sta TabMissileLevelLeftX_H1,x
   653 4DC4 9D B5 5C				sta TabMissileLevelLeftX_L1,x
   654 4DC7 9D B9 5C				sta TabMissileLevelTopY_H2,x
   655 4DCA 9D BD 5C				sta TabMissileLevelTopY_H1,x
   656 4DCD 9D C1 5C				sta TabMissileLevelTopY_L1,x
   657
   658 4DD0 9D C5 5C				sta TabMissileSpeedX_H1,x
   659 4DD3 9D C9 5C				sta TabMissileSpeedX_L1,x
   660
   661 4DD6 9D CD 5C				sta TabMissileDirection,x
   662
   663 4DD9 9D D1 5C				sta TabMissileFrameCounter_H2,x
   664 4DDC 9D D5 5C				sta TabMissileFrameCounter_H1,x
   665
   666 4DDF 9D D9 5C				sta TabMissileOwner,x
   667
   668 4DE2 E8					inx
   669 4DE3 E0 04				cpx #MAX_VIRTUAL_MISSILES
   670 4DE5 D0 CB				bne IMS_loop
   671
   672 4DE7 60					rts
   673
   674 				.endp	
   675 					
   331 4DE8					icl "Utilities.Asm"				
Source: E:\_8BitProjects\Series\Scroller\Utilities.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		Utilities.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; UpdateInfoLine
    15 				;**************************************************************************************************
    16 				;
    17 4DE8			.proc UpdateInfoLine
    18 					
    19 4DE8 AD 78 32				lda m_goldCounter						; assuming 99 or less
    20 4DEB A0 04				ldy #4
    21 4DED 20 DC 4A				jsr DisplayDebugInfoBinary99
    22
    23 4DF0 AD A2 32				lda m_activeEnemies
    24 4DF3 A0 0C				ldy #12
    25 4DF5 20 DC 4A				jsr DisplayDebugInfoBinary99
    26
    27 4DF8 AD 79 32				lda m_healthCounter						; assuming 99 or less
    28 4DFB A0 1F				ldy #31
    29 4DFD 20 DC 4A				jsr DisplayDebugInfoBinary99
    30
    31 4E00 AD 7B 32				lda m_disableGameTimer					; update the time here also
    32 4E03 D0 66				bne UIL_exit
    33 					
    34 4E05 AD 78 32				lda m_goldCounter
    35 4E08 D0 0A				bne UIL_update_timer
    36 						
    37 4E0A AD A2 32				lda m_activeEnemies
    38 4E0D D0 05				bne UIL_update_timer
    39 					
    40 4E0F A9 01				lda #1
    41 4E11 8D 7B 32				sta m_disableGameTimer					; my record? 1:16.1 (NTSC, lost one life)
    42
    43 				;*****	allow the final update..
    44 				;
    45 4E14			UIL_update_timer
    46 					
    47 4E14 EE 7F 32				inc m_gameTSFrameCounter
    48 4E17 AD 7F 32				lda m_gameTSFrameCounter
    49 4E1A C9 06				cmp #TENTH_OF_SECOND_FRAMES
    50 4E1C D0 35				bne UIL_draw_timer
    51 					
    52 4E1E A9 00				lda #0
    53 4E20 8D 7F 32				sta m_gameTSFrameCounter
    54 4E23 EE 7E 32				inc m_gameTimerTSeconds
    55 						
    56 4E26 AD 7E 32				lda m_gameTimerTSeconds
    57 4E29 C9 0A				cmp #10
    58 4E2B D0 26				bne UIL_draw_timer
    59 					
    60 4E2D A9 00				lda #0
    61 4E2F 8D 7E 32				sta m_gameTimerTSeconds
    62 4E32 EE 7C 32				inc m_gameTimerSeconds
    63 					
    64 4E35 AD 7C 32				lda m_gameTimerSeconds
    65 4E38 C9 3C				cmp #60
    66 4E3A D0 17				bne UIL_draw_timer
    67 					
    68 4E3C A9 00				lda #0
    69 4E3E 8D 7C 32				sta m_gameTimerSeconds
    70 4E41 EE 7D 32				inc m_gameTimerMinutes
    71
    72 4E44 AD 7D 32				lda m_gameTimerMinutes
    73 4E47 C9 64				cmp #100
    74 4E49 D0 08				bne UIL_draw_timer
    75 					
    76 4E4B A9 01				lda #1
    77 4E4D 8D 7B 32				sta m_disableGameTimer
    78 4E50 4C 6B 4E				jmp UIL_exit							; final timer would be 99:99.9 in this case
    79
    80 				;*****	Draw Timer
    81 				;
    82 4E53			UIL_draw_timer
    83 					
    84 4E53 AD 7D 32				lda m_gameTimerMinutes
    85 4E56 A0 14				ldy #20
    86 4E58 20 DC 4A				jsr DisplayDebugInfoBinary99
    87 					
    88 4E5B AD 7C 32				lda m_gameTimerSeconds
    89 4E5E A0 17				ldy #23
    90 4E60 20 DC 4A				jsr DisplayDebugInfoBinary99
    91 					
    92 4E63 AD 7E 32				lda m_gameTimerTSeconds
    93 4E66 A0 1A				ldy #26
    94 4E68 20 FD 4A				jsr DisplayDebugInfoBinary9
    95
    96 				;*****	Exit
    97 				;
    98 4E6B			UIL_exit
    99 						
   100 4E6B 60					rts
   101 					
   102 				.endp	
   103
   104 				;
   105 				;**************************************************************************************************
   106 				; UpdateTimers
   107 				;**************************************************************************************************
   108 				;
   109 4E6C			.proc UpdateTimers
   110 						
   111 4E6C A5 CB				lda m_playerNoJumpTimer
   112 4E6E F0 02				beq UT_end_no_jump
   113 4E70 C6 CB				dec m_playerNoJumpTimer
   114 					
   115 				;************************************************
   116 				;	
   117 4E72			UT_end_no_jump		
   118 						
   119 4E72 60					rts
   120
   121 				.endp	
   122
   332 4E73					icl "DisplayListInterrupts.asm"
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		DisplayListInterrupts.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;	Color			Dec			HEX    	Color			Dec				HEX
    14 				;	-------------------------------		-----------------------------------
    15 				;	Black           00,			$00		Medium blue      08,    		$08
    16 				;	Rust            01,			$01		Dark blue        09,    		$09
    17 				;	Red-orange      02,			$02		Blue-grey      	 10,    		$0A
    18 				;	Dark orange     03,			$03		Olive green    	 11,    		$0B
    19 				;	Red             04,			$04		Medium green   	 12,    		$0C
    20 				;	Dk lavender     05,			$05		Dark green     	 13,    		$0D
    21 				;	Cobalt blue     06,			$06		Orange-green   	 14,    		$0E
    22 				;	Ultramarine     07,			$07		Orange         	 15,    		$0F
    23 				;
    24 				;**************************************************************************************************
    25 				; Display list 1 interruptions code
    26 				;**************************************************************************************************
    27 				;
    28 4E73			GameDli_01
    29 						
    30 4E73 48					pha
    31 4E74 98					tya
    32 4E75 48					pha
    33 						
    34 				.if PAL_VERSION = 0
    35
    36 4E76					SetColor $00, $03, $04
Macro: SETCOLOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     8 4E76 A9 34					lda #[$03 * 16 + $04]
     9 4E78 8D 16 D0					sta COLPF0+$00
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    37 4E7B					SetColor $01, $00, $0F
Macro: SETCOLOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     8 4E7B A9 0F					lda #[$00 * 16 + $0F]
     9 4E7D 8D 17 D0					sta COLPF0+$01
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    38 4E80					SetColor $02, $0D, $04
Macro: SETCOLOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     8 4E80 A9 D4					lda #[$0D * 16 + $04]
     9 4E82 8D 18 D0					sta COLPF0+$02
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    39 4E85					SetColor $03, $0F, $0C		
Macro: SETCOLOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     8 4E85 A9 FC					lda #[$0F * 16 + $0C]
     9 4E87 8D 19 D0					sta COLPF0+$03
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    40 						
    41 				.else
    42
    43 						SetColor 1, 15, 14		; yellow (collectables)
    44 						SetColor 2, 7, 2		; blue (water)
    45
    46 				.endif
    47 						
    48 4E8A A5 AD				lda m_playerScreenLeftX
    49 4E8C 8D 00 D0				sta HPOSP0
    50 4E8F 8D 01 D0				sta HPOSP1
    51 4E92 8D 02 D0				sta HPOSP2
    52
    53 4E95					SetFontAddress GameFontAddress
Macro: SETFONTADDRESS [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4E95 A9 A8				lda #>GAMEFONTADDRESS
     5 4E97 8D 09 D4			    sta CHBASE
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    54 4E9A 8D 0A D4		    	sta WSYNC   			; Wait off-screen
    55
    56 						
    57 4E9D					SetDisplayListInterrupt TextDli 
Macro: SETDISPLAYLISTINTERRUPT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4E9D A9 AB		      	lda #<TEXTDLI
     5 4E9F 8D FA FF			    sta NMIH_VECTOR
     6 4EA2 A9 4E			    lda #>TEXTDLI
     7 4EA4 8D FB FF			    sta NMIH_VECTOR+1
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    58
    59 4EA7 68					pla
    60 4EA8 A8					tay
    61 4EA9 68					pla
    62 						
    63 4EAA 40					rti
    64 				;
    65 				;**************************************************************************************************
    66 				; Display list 2 interruptions code
    67 				;**************************************************************************************************
    68 				;
    69 4EAB			TextDli
    70
    71 4EAB 48					pha
    72 4EAC 98					tya
    73 4EAD 48					pha
    74 							
    75 				.if PAL_VERSION = 0
    76
    77 4EAE					SetColor 1, $03, $0A
Macro: SETCOLOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     8 4EAE A9 3A					lda #[$03 * 16 + $0A]
     9 4EB0 8D 17 D0					sta COLPF0+1
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    78 4EB3					SetColor 2, $04, $01			
Macro: SETCOLOR [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     8 4EB3 A9 41					lda #[$04 * 16 + $01]
     9 4EB5 8D 18 D0					sta COLPF0+2
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    79 				.else
    80
    81 						SetColor 1, 15, 14		; yellow (collectables)
    82 						SetColor 2, 7, 2		; blue (water)
    83
    84 				.endif
    85 						
    86 4EB8					SetFontAddress TextFontAddress
Macro: SETFONTADDRESS [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4EB8 A9 AC				lda #>TEXTFONTADDRESS
     5 4EBA 8D 09 D4			    sta CHBASE
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    87 4EBD 8D 0A D4				STA WSYNC 				;Wait off-screen
    88
    89 						
    90 4EC0					SetDisplayListInterrupt GameDli_01 
Macro: SETDISPLAYLISTINTERRUPT [Source: E:\_8BitProjects\Series\Scroller\\Lib\SysMacros.Asm]
     4 4EC0 A9 73		      	lda #<GAMEDLI_01
     5 4EC2 8D FA FF			    sta NMIH_VECTOR
     6 4EC5 A9 4E			    lda #>GAMEDLI_01
     7 4EC7 8D FB FF			    sta NMIH_VECTOR+1
Source: E:\_8BitProjects\Series\Scroller\DisplayListInterrupts.asm
    91
    92 4ECA 68					pla
    93 4ECB A8					tay
    94 4ECC 68					pla
    95 						
    96 4ECD 40					rti
   333 4ECE					icl "PlayerStates.Asm"
Source: E:\_8BitProjects\Series\Scroller\PlayerStates.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		PlayerStates.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Local Storage
    15 				;**************************************************************************************************
    16 				;
    17 4ECE			TabPlayerMethodColor
    18 				.if PAL_VERSION = 0
    19 4ECE 0A BA 9A 9A 1C 78 + 	.byte 10, 11*16+10, 9*16+10, 9*16+10, 1*16+12, 7*16+8, 4, 2*16+6
    20 				.else
    21 					.byte 10, 10*16+10, 8*16+10, 8*16+10, 15*16+12, 7*16+8, 4, 1*16+6
    22 				.endif
    23
    24 4ED6			TabPlayerMethodLSB
    25 4ED6 C4 C2			.byte <PlayerMethodStatic, <PlayerMethodOverPlatform
    26 4ED8 FC 72			.byte <PlayerMethodJumping, <PlayerMethodFalling
    27 4EDA EB A7			.byte <PlayerMethodClimbing, <PlayerMethodInWater
    28 4EDC A1 A4			.byte <PlayerMethodGravityTest, <PlayerMethodLose
    29
    30 4EDE			TabPlayerMethodMSB
    31 4EDE 4F 50			.byte >PlayerMethodStatic, >PlayerMethodOverPlatform
    32 4EE0 51 52			.byte >PlayerMethodJumping, >PlayerMethodFalling
    33 4EE2 52 53			.byte >PlayerMethodClimbing, >PlayerMethodInWater
    34 4EE4 54 54			.byte >PlayerMethodGravityTest, >PlayerMethodLose
    35
    36 4EE6			TabPlayerMethodInitLSB
    37 4EE6 1B 1C			.byte <PlayerMethodInitStatic, <PlayerMethodInitOverPlatform
    38 4EE8 3B 60			.byte <PlayerMethodInitJumping, <PlayerMethodInitFalling
    39 4EEA 79 84			.byte <PlayerMethodInitClimbing, <PlayerMethodInitInWater
    40 4EEC B3 B4			.byte <PlayerMethodInitGravityTest, <PlayerMethodInitLose
    41
    42 4EEE			TabPlayerMethodInitMSB
    43 4EEE 4F 4F			.byte >PlayerMethodInitStatic, >PlayerMethodInitOverPlatform
    44 4EF0 4F 4F			.byte >PlayerMethodInitJumping, >PlayerMethodInitFalling
    45 4EF2 4F 4F			.byte >PlayerMethodInitClimbing, >PlayerMethodInitInWater
    46 4EF4 4F 4F			.byte >PlayerMethodInitGravityTest, >PlayerMethodInitLose
    47 				;
    48 				;**************************************************************************************************
    49 				; SetPlayerMethod
    50 				;**************************************************************************************************
    51 				;
    52 4EF6			SetPlayerMethod
    53 4EF6 86 D2			stx m_playerState
    54 					
    55 4EF8 BD D6 4E			lda TabPlayerMethodLSB,x
    56 4EFB 85 ED			sta m_playerMethodPointer
    57 					
    58 4EFD BD DE 4E			lda TabPlayerMethodMSB,x
    59 4F00 85 EE			sta m_playerMethodPointer+1
    60
    61 4F02 A9 8A			lda #$8A
    62 4F04 85 9E			sta m_playerBaseColor00	
    63 					
    64 4F06 A9 3A			lda #$3A
    65 4F08 85 9F			sta m_playerBaseColor1A
    66 						
    67 4F0A A9 0F			lda #$0F
    68 4F0C 85 A0			sta m_playerBaseColor1B
    69 						
    70 4F0E BD E6 4E			lda TabPlayerMethodInitLSB,x
    71 4F11 85 EB			sta m_pageZeroTempPointer
    72 					
    73 4F13 BD EE 4E			lda TabPlayerMethodInitMSB,x
    74 4F16 85 EC			sta m_pageZeroTempPointer+1
    75 					
    76 4F18 6C EB 00			jmp (m_pageZeroTempPointer)
    77 				;
    78 				;**************************************************************************************************
    79 				; PlayerMethodInitStatic
    80 				;**************************************************************************************************
    81 				;
    82 4F1B			PlayerMethodInitStatic
    83 4F1B 60				rts
    84 				;
    85 				;**************************************************************************************************
    86 				; PlayerMethodInitOverPlatform
    87 				;**************************************************************************************************
    88 				;
    89 4F1C			PlayerMethodInitOverPlatform
    90 4F1C A9 00			lda #0										; clear player speed in Y
    91 4F1E 85 BD			sta m_playerSpeedY_H1
    92 4F20 85 BE			sta m_playerSpeedY_L1
    93 					
    94 4F22 A9 01			lda #SIDE_SPEED_LAND_H1						; init max side speed
    95 4F24 85 B7			sta m_playerMaxSideSpeed_H1
    96 4F26 A9 01			lda #SIDE_SPEED_LAND_L1
    97 4F28 85 B8			sta m_playerMaxSideSpeed_L1
    98 					
    99 4F2A A9 00			lda #SIDE_ACCEL_LAND_H1						; init side accelerations
   100 4F2C 85 B9			sta m_playerSideAccel_H1
   101 4F2E A9 20			lda #SIDE_ACCEL_LAND_L1
   102 4F30 85 BA			sta m_playerSideAccel_L1
   103
   104 4F32 A9 00			lda #SIDE_DEACCEL_LAND_H1
   105 4F34 85 BB			sta m_playerSideDeaccel_H1
   106 4F36 A9 80			lda #SIDE_DEACCEL_LAND_L1
   107 4F38 85 BC			sta m_playerSideDeaccel_L1
   108 4F3A 60				rts
   109 				;
   110 				;**************************************************************************************************
   111 				; PlayerMethodInitJumping
   112 				;**************************************************************************************************
   113 				;
   114 4F3B			PlayerMethodInitJumping
   115
   116 4F3B A9 08			lda #JUMP_HOLD_FRAMES						; hold jump for this number of frames, if the button is still pressed
   117 4F3D 85 CC			sta m_playerHoldJumpCounter
   118
   119 4F3F A5 BF			lda m_playerJumpSpeed_H1
   120 4F41 85 BD			sta m_playerSpeedY_H1
   121 4F43 A5 C0			lda m_playerJumpSpeed_L1
   122 4F45 85 BE			sta m_playerSpeedY_L1
   123
   124 4F47 A9 01			lda #SIDE_SPEED_AIR_H1						; init max side speed
   125 4F49 85 B7			sta m_playerMaxSideSpeed_H1
   126 4F4B A9 20			lda #SIDE_SPEED_AIR_L1
   127 4F4D 85 B8			sta m_playerMaxSideSpeed_L1
   128
   129 4F4F A9 00			lda #SIDE_ACCEL_AIR_H1						; init side accelerations
   130 4F51 85 B9			sta m_playerSideAccel_H1
   131 4F53 A9 10			lda #SIDE_ACCEL_AIR_L1
   132 4F55 85 BA			sta m_playerSideAccel_L1
   133
   134 4F57 A9 00			lda #SIDE_DEACCEL_AIR_H1
   135 4F59 85 BB			sta m_playerSideDeaccel_H1
   136 4F5B A9 10			lda #SIDE_DEACCEL_AIR_L1
   137 4F5D 85 BC			sta m_playerSideDeaccel_L1
   138 4F5F 60				rts
   139 				;
   140 				;**************************************************************************************************
   141 				; PlayerMethodInitFalling
   142 				;**************************************************************************************************
   143 				;
   144 4F60			PlayerMethodInitFalling
   145
   146 4F60 A9 01			lda #SIDE_SPEED_AIR_H1						; init max side speed
   147 4F62 85 B7			sta m_playerMaxSideSpeed_H1
   148 4F64 A9 20			lda #SIDE_SPEED_AIR_L1
   149 4F66 85 B8			sta m_playerMaxSideSpeed_L1
   150
   151 4F68 A9 00			lda #SIDE_ACCEL_AIR_H1						; init side accelerations
   152 4F6A 85 B9			sta m_playerSideAccel_H1
   153 4F6C A9 10			lda #SIDE_ACCEL_AIR_L1
   154 4F6E 85 BA			sta m_playerSideAccel_L1
   155
   156 4F70 A9 00			lda #SIDE_DEACCEL_AIR_H1
   157 4F72 85 BB			sta m_playerSideDeaccel_H1
   158 4F74 A9 10			lda #SIDE_DEACCEL_AIR_L1
   159 4F76 85 BC			sta m_playerSideDeaccel_L1
   160
   161 4F78 60				rts
   162 				;
   163 				;**************************************************************************************************
   164 				; PlayerMethodInitClimbing
   165 				;**************************************************************************************************
   166 				;
   167 4F79			PlayerMethodInitClimbing
   168
   169 4F79 A9 00			lda #0										; clear player speed in X and Y
   170 4F7B 85 B5			sta m_playerSideSpeed_H1
   171 4F7D 85 B6			sta m_playerSideSpeed_L1
   172 4F7F 85 BD			sta m_playerSpeedY_H1
   173 4F81 85 BE			sta m_playerSpeedY_L1
   174
   175 4F83 60				rts
   176 				;
   177 				;**************************************************************************************************
   178 				; PlayerMethodInitInWater
   179 				;**************************************************************************************************
   180 				;
   181 4F84			PlayerMethodInitInWater
   182
   183 4F84 A9 01			lda #1										; set starting direction going down (0 = going up, 1 = going down)
   184 4F86 8D D4 32			sta m_waterPlayerDirectionFlag
   185
   186 4F89 A9 00			lda #0
   187 4F8B 8D D5 32			sta m_playerOnWaterSurfaceFlag
   188
   189 4F8E 46 BD			lsr m_playerSpeedY_H1						; reduce in half current falling speed
   190 4F90 66 BE			ror m_playerSpeedY_L1
   191
   192 4F92 46 B5			lsr m_playerSideSpeed_H1					; reduce in half current side speed
   193 4F94 66 B6			ror m_playerSideSpeed_L1
   194
   195 4F96 A9 00			lda #SIDE_SPEED_WATER_H1					; init max side speed
   196 4F98 85 B7			sta m_playerMaxSideSpeed_H1
   197 4F9A A9 80			lda #SIDE_SPEED_WATER_L1
   198 4F9C 85 B8			sta m_playerMaxSideSpeed_L1
   199
   200 4F9E A9 00			lda #SIDE_ACCEL_WATER_H1					; init side accelerations
   201 4FA0 85 B9			sta m_playerSideAccel_H1
   202 4FA2 A9 04			lda #SIDE_ACCEL_WATER_L1
   203 4FA4 85 BA			sta m_playerSideAccel_L1
   204
   205 4FA6 A9 00			lda #SIDE_DEACCEL_WATER_H1
   206 4FA8 85 BB			sta m_playerSideDeaccel_H1
   207 4FAA A9 04			lda #SIDE_DEACCEL_WATER_L1
   208 4FAC 85 BC			sta m_playerSideDeaccel_L1
   209
   210 4FAE A9 1E			lda #WATER_NO_JUMP_FRAMES					; disable jump for some frames
   211 4FB0 85 CB			sta m_playerNoJumpTimer
   212 					
   213 4FB2 60				rts
   214 				;
   215 				;**************************************************************************************************
   216 				; PlayerMethodInitGravityTest
   217 				;**************************************************************************************************
   218 				;
   219 4FB3			PlayerMethodInitGravityTest
   220 4FB3 60				rts
   221 				;
   222 				;**************************************************************************************************
   223 				; PlayerMethodInitLose
   224 				;**************************************************************************************************
   225 				;
   226 4FB4			PlayerMethodInitLose
   227 4FB4 A5 AE			lda m_playerScreenTopY
   228 4FB6 8D D6 32			sta m_playerExplosionScreenTopY_H1
   229 4FB9 A9 00			lda #0
   230 4FBB 8D D7 32			sta m_playerExplosionScreenTopY_L1
   231
   232 4FBE A9 01			lda #1
   233 4FC0 8D D2 32			sta m_playerExplosionStep
   234
   235 4FC3 60				rts
   236 				;
   237 				;**************************************************************************************************
   238 				; PlayerMethodInitLose
   239 				;**************************************************************************************************
   240 				;
   241 4FC4			PlayerMethodStatic
   242 4FC4 4C 8E 49			jmp PlayerMethodReturn
   243
   244 				;
   245 				;**************************************************************************************************
   246 				;
   247 				; 	CheckCollectable
   248 				;
   249 				;**************************************************************************************************
   250 				;
   251 4FC7			.proc CheckCollectable
   252
   253 4FC7 A9 04			lda #[PLR_WIDTH / 2]						; check middle left center pixel, to see if there is a collectable
   254 4FC9 8D D0 32			sta m_bottomPosOffsetX
   255 					
   256 4FCC A9 0A			lda #[PLR_HEIGHT / 2]
   257 4FCE 8D D1 32			sta m_bottomPosOffsetY
   258 					
   259 4FD1 20 2B 5C			jsr CheckPlayerBottomUpPos
   260
   261 4FD4 29 0F			and #15
   262 4FD6 C9 02			cmp #CT_COLLECTABLE
   263 4FD8 F0 07			beq DecrementCoins
   264 					
   265 4FDA C9 06			cmp	#CT_HEALTH
   266 4FDC F0 0D			beq DecrementHealth
   267 					
   268 				;	lda m_playerLevelLeftX_H1					; check if right side pixel is in other char
   269 				;	and #%11									; "m_playerSizeXMinusOne"
   270 				;	beq CC_exit
   271 				;
   272 				;	iny											; check the right side char then
   273 				;	lda (m_ptrLevelLine),y
   274 				;	tax
   275 				;	lda TabCharDefinition,x
   276 				;	
   277 				;	and #15	
   278 				;	cmp #CT_COLLECTABLE
   279 				;	beq DecrementCoins
   280 				;	
   281 				;	cmp	#CT_HEALTH
   282 				;	beq DecrementHealth
   283 					
   284 				;	inc m_middleBottomCharPosX
   285
   286 4FDE 4C 03 50			jmp CC_exit
   287 					
   288 				;***** Decrement Coins
   289 				;	
   290 4FE1			DecrementCoins
   291 					
   292 4FE1 CE 78 32			dec m_goldCounter
   293 4FE4 A9 01			lda #SFX_DIAMOND
   294 4FE6 85 99			sta m_sfxEffect
   295 4FE8 4C F2 4F			jmp CC_start_animation
   296 					
   297 				;***** Decrement Health
   298 				;	
   299 4FEB			DecrementHealth	
   300 					
   301 4FEB CE 79 32			dec m_healthCounter
   302 4FEE A9 01			lda #SFX_DIAMOND
   303 4FF0 85 99			sta m_sfxEffect
   304 						
   305 				;*****	Start Animation
   306 				;
   307 4FF2			CC_start_animation								; erase the collectable with the correct animation
   308 4FF2 A5 E9			lda m_ptrLevelLine
   309 4FF4 18				clc
   310 4FF5 6D D3 32			adc m_middleBottomCharPosX
   311 4FF8 85 EB			sta m_pageZeroTempPointer
   312 4FFA A5 EA			lda m_ptrLevelLine+1
   313 4FFC 69 00			adc #0
   314 4FFE 85 EC			sta m_pageZeroTempPointer+1
   315
   316 5000 20 A0 62			jsr AddCoinAnimation
   317 					
   318 				;*****	Exit Proc
   319 				;
   320 5003			CC_exit
   321 						
   322 5003 60					rts
   323 						
   324 				.endp
   325 						
   326 				;
   327 				;**************************************************************************************************
   328 				; DoSideMovement
   329 				;**************************************************************************************************
   330 				;
   331 5004			DoSideMovement
   332
   333 5004 A5 DE			lda m_stick0
   334 5006 29 0C			and #[STICK_RIGHT | STICK_LEFT]
   335 5008 C9 0C			cmp #[STICK_RIGHT | STICK_LEFT]
   336 500A D0 1F			bne DSM_check_right							; if one or both are pressed, just continue
   337
   338 				;**************************************************
   339 				;
   340 500C			DSM_check_deaccel_right
   341 500C A5 CD			lda m_lastPlayerSideDirection
   342 500E C9 01			cmp #PSD_RIGHT
   343 5010 D0 09			bne DSM_check_deaccel_left
   344
   345 5012 20 4B 5A			jsr SubstractSideDeaccelToSpeed
   346 5015 20 5F 5A			jsr AddSideSpeedToPosition
   347 5018 4C 64 50			jmp DSM_exit
   348
   349 				;**************************************************
   350 				;
   351 501B			DSM_check_deaccel_left
   352 501B C9 02			cmp #PSD_LEFT
   353 501D F0 03			beq DSM_cdl1
   354 501F 4C 64 50			jmp DSM_exit
   355
   356 				;**************************************************
   357 				;
   358 5022			DSM_cdl1
   359 5022 20 4B 5A			jsr SubstractSideDeaccelToSpeed
   360 5025 20 8B 5A			jsr SubstractSideSpeedToPosition
   361 5028 4C 64 50			jmp DSM_exit
   362
   363 				;**************************************************
   364 				;
   365 502B			DSM_check_right
   366 502B 29 08			and #STICK_RIGHT	; check right
   367 502D D0 19			bne DSM_check_left
   368
   369 502F A5 CD			lda m_lastPlayerSideDirection
   370 5031 C9 02			cmp #PSD_LEFT
   371 5033 D0 06			bne DSM_move_to_right
   372
   373 5035 A9 00			lda #0
   374 5037 85 B5			sta m_playerSideSpeed_H1
   375 5039 85 B6			sta m_playerSideSpeed_L1
   376
   377 				;**************************************************
   378 				;
   379 503B			DSM_move_to_right
   380 503B A9 01			lda #PSD_RIGHT
   381 503D 85 CD			sta m_lastPlayerSideDirection
   382 503F 20 29 5A			jsr AddSideAccelToSpeed
   383 5042 20 5F 5A			jsr AddSideSpeedToPosition
   384 5045 4C 64 50			jmp DSM_exit
   385
   386 				;**************************************************
   387 				;
   388 5048			DSM_check_left
   389 5048 A5 DE			lda m_stick0
   390 504A 29 04			and #STICK_LEFT						; check left
   391 504C D0 16			bne DSM_exit
   392
   393 504E A5 CD			lda m_lastPlayerSideDirection
   394 5050 C9 01			cmp #PSD_RIGHT
   395 5052 D0 06			bne DSM_move_to_left
   396
   397 5054 A9 00			lda #0
   398 5056 85 B5			sta m_playerSideSpeed_H1
   399 5058 85 B6			sta m_playerSideSpeed_L1
   400
   401 				;**************************************************
   402 				;
   403 505A			DSM_move_to_left
   404 505A A9 02			lda #PSD_LEFT
   405 505C 85 CD			sta m_lastPlayerSideDirection
   406 505E 20 29 5A			jsr AddSideAccelToSpeed
   407 5061 20 8B 5A			jsr SubstractSideSpeedToPosition
   408
   409 				;**************************************************
   410 				;
   411 5064			DSM_exit
   412 5064 60				rts
   413 				;
   414 				;**************************************************************************************************
   415 				; DoSideControl
   416 				;**************************************************************************************************
   417 				;
   418 5065			DoSideControl
   419
   420 5065 A5 DE			lda m_stick0
   421 5067 29 0C			and #[STICK_RIGHT | STICK_LEFT]
   422 5069 C9 0C			cmp #[STICK_RIGHT | STICK_LEFT]
   423 506B F0 41			beq DSC_check_right							; if neither is pressed, just continue
   424
   425 				;**************************************************
   426 				;
   427 506D			DSC_side_control_right
   428 506D 29 08			and #STICK_RIGHT
   429 506F D0 20			bne DSC_side_control_left
   430 5071 A5 CD			lda m_lastPlayerSideDirection
   431 5073 C9 01			cmp #PSD_RIGHT
   432 5075 D0 06			bne DSC_scr1
   433 5077 20 29 5A			jsr AddSideAccelToSpeed
   434 507A 4C AE 50			jmp DSC_check_right
   435
   436 				;**************************************************
   437 				;
   438 507D			DSC_scr1
   439 507D C9 02			cmp #PSD_LEFT
   440 507F D0 06			bne DSC_scr2
   441 5081 20 4B 5A			jsr SubstractSideDeaccelToSpeed
   442 5084 4C AE 50			jmp DSC_check_right
   443
   444 				;**************************************************
   445 				;
   446 5087			DSC_scr2
   447 5087 A9 01			lda #PSD_RIGHT
   448 5089 85 CD			sta m_lastPlayerSideDirection
   449 508B 20 29 5A			jsr AddSideAccelToSpeed
   450 508E 4C AE 50			jmp DSC_check_right
   451
   452 				;**************************************************
   453 				;
   454 5091			DSC_side_control_left
   455 5091 A5 CD			lda m_lastPlayerSideDirection
   456 5093 C9 02			cmp #PSD_LEFT
   457 5095 D0 06			bne DSC_scl1
   458 5097 20 29 5A			jsr AddSideAccelToSpeed
   459 509A 4C AE 50			jmp DSC_check_right
   460
   461 				;**************************************************
   462 				;
   463 509D			DSC_scl1
   464 509D C9 01			cmp #PSD_RIGHT
   465 509F D0 06			bne DSC_scl2
   466 50A1 20 4B 5A			jsr SubstractSideDeaccelToSpeed
   467 50A4 4C AE 50			jmp DSC_check_right
   468
   469 				;**************************************************
   470 				;
   471 50A7			DSC_scl2
   472 50A7 A9 02			lda #PSD_LEFT
   473 50A9 85 CD			sta m_lastPlayerSideDirection
   474 50AB 20 29 5A			jsr AddSideAccelToSpeed
   475
   476 				;**************************************************
   477 				;
   478 50AE			DSC_check_right
   479 50AE A5 CD			lda m_lastPlayerSideDirection
   480 50B0 C9 01			cmp #PSD_RIGHT
   481 50B2 D0 06			bne DSC_check_left
   482 50B4 20 5F 5A			jsr AddSideSpeedToPosition
   483 50B7 4C C1 50			jmp DSC_exit
   484
   485 				;**************************************************
   486 				;
   487 50BA			DSC_check_left
   488 50BA C9 02			cmp #PSD_LEFT
   489 50BC D0 03			bne DSC_exit
   490 50BE 20 8B 5A			jsr SubstractSideSpeedToPosition
   491
   492 				;**************************************************
   493 				;
   494 50C1			DSC_exit
   495 50C1 60				rts
   496 				;
   497 				;**************************************************************************************************
   498 				; Include Files
   499 				;**************************************************************************************************
   500 				;
   501 50C2				icl "StateInPlatform.Asm"
Source: E:\_8BitProjects\Series\Scroller\StateInPlatform.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		StateInPlatform.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 50C2			PlayerMethodOverPlatform
    14
    15 50C2 20 C7 4F				jsr CheckCollectable
    16 50C5 20 DD 5C				jsr CheckCreatePlayerMissile
    17 50C8 20 04 50				jsr DoSideMovement	
    18
    19 				;************************************************
    20 				;
    21 50CB			PMGT_check_up
    22 						
    23 50CB A5 DE				lda m_stick0
    24 50CD 29 01				and #STICK_UP						; check up
    25 50CF D0 66				bne PMGT_check_fall
    26
    27 50D1 A5 DF				lda m_oldStick0
    28 50D3 29 01				and #STICK_UP						; check old up (looking for "just pressed")
    29 50D5 F0 60				beq PMGT_check_fall
    30
    31
    32 50D7 A9 00				lda #0									; check bottom of a stair (left pixel)
    33 50D9 8D D0 32				sta m_bottomPosOffsetX
    34 					
    35 50DC A9 00				lda #0
    36 50DE 8D D1 32				sta m_bottomPosOffsetY
    37 						
    38 50E1 20 DE 5B				jsr CheckPlayerBottomDownPos
    39
    40 50E4 AD CF 32				lda m_middleBottomChar
    41 50E7 29 0F				and #15
    42 50E9 C9 04				cmp #CT_LADDER
    43 50EB F0 16				beq PMGT_snap_ladder_up
    44
    45 50ED A9 03				lda #3									; check bottom of a stair (right pixel)
    46 50EF 8D D0 32				sta m_bottomPosOffsetX
    47 						
    48 50F2 A9 00				lda #0
    49 50F4 8D D1 32				sta m_bottomPosOffsetY
    50 						
    51 50F7 20 DE 5B				jsr CheckPlayerBottomDownPos
    52
    53 50FA AD CF 32				lda m_middleBottomChar
    54 50FD 29 0F				and #15
    55 50FF C9 04				cmp #CT_LADDER
    56 5101 D0 19				bne PMGT_check_jump
    57
    58 				;************************************************
    59 				; snap player to center of the ladder
    60 				;
    61 5103			PMGT_snap_ladder_up
    62
    63 5103 A9 00				lda #0
    64 5105 85 A3				sta m_playerLevelLeftX_L1
    65 5107 85 A1				sta m_playerLevelLeftX_H2
    66
    67 5109 AD D3 32				lda m_middleBottomCharPosX
    68 510C 0A					asl
    69 510D 26 A1				rol m_playerLevelLeftX_H2				; x2
    70 510F 0A					asl
    71 5110 26 A1				rol m_playerLevelLeftX_H2				; x4 = CHAR_PIX.else_X
    72 5112 85 A2				sta m_playerLevelLeftX_H1
    73
    74 5114 A2 04				ldx #PS_CLIMBING						; start climbing state
    75 5116 20 F6 4E				jsr SetPlayerMethod
    76
    77 5119 4C F6 51				jmp PMGT_end
    78
    79 				;************************************************
    80 				; start jumping state
    81 				;
    82 511C			PMGT_check_jump
    83
    84 511C A2 02				ldx #PS_JUMPING
    85 511E 20 F6 4E				jsr SetPlayerMethod
    86
    87 5121 A5 B6				lda m_playerSideSpeed_L1				; reduce side speed a little
    88 5123 38					sec
    89 5124 E9 40				sbc #JUMP_HSPEED_SLOWDOWN
    90 5126 85 B6				sta m_playerSideSpeed_L1
    91 						
    92 5128 A5 B5				lda m_playerSideSpeed_H1
    93 512A E9 00				sbc #0
    94 512C B0 04				bcs PMGT_jump_side_speed
    95 						
    96 512E A9 00				lda #0
    97 5130 85 B6				sta m_playerSideSpeed_L1
    98
    99 				;************************************************
   100 				;
   101 5132			PMGT_jump_side_speed
   102 						
   103 5132 85 B5				sta m_playerSideSpeed_H1
   104 5134 4C F6 51				jmp PMGT_end
   105
   106 				;************************************************
   107 				;
   108 5137			PMGT_check_fall
   109
   110 5137 20 FF 56				jsr CheckHoleBelowPlayer
   111
   112 513A A5 CF				lda m_playerOverPlatformFlag
   113 513C D0 0C				bne CheckPlatformLeft
   114 					
   115 513E A2 03				ldx #PS_FALLING							; start falling state
   116 5140 20 F6 4E				jsr SetPlayerMethod
   117
   118 5143 46 B5				lsr m_playerSideSpeed_H1				; divide by 2 the side speed, if there was any movement previous to falling
   119 5145 66 B6				ror m_playerSideSpeed_L1
   120
   121 5147 4C F6 51				jmp PMGT_end
   122
   123 				;*****	Check Platform Left
   124 				;
   125 514A			CheckPlatformLeft
   126 						
   127 514A AD CD 32				lda m_leftBottomChar					; float Platform check
   128 514D 29 07				and #%00000111
   129 514F C9 07				cmp #CT_FLOATPLATFORMH
   130 5151 D0 03				bne CheckPlatformRight
   131 						
   132 5153 4C C1 51				jmp ClampPlayer
   133
   134 				;*****	Check Platform Right		
   135 5156			CheckPlatformRight		
   136 						
   137 5156 AD CE 32				lda m_rightBottomChar
   138 5159 29 07				and #%00000111
   139 515B C9 07				cmp #CT_FLOATPLATFORMH
   140 515D D0 03				bne PMGT_check_down	
   141
   142 515F 4C C1 51				jmp ClampPlayer
   143 						
   144 				;*****	Check down
   145 				;						
   146 5162			PMGT_check_down		
   147 5162 A5 DE				lda m_stick0
   148 5164 29 02				and #STICK_DOWN	
   149 5166 F0 03				beq SearchLadder
   150 						
   151 5168 4C F6 51				jmp PMGT_end
   152
   153 516B			SearchLadder
   154 516B A9 00				lda #0									; search for a ladder one char below (left pixel)
   155 516D 8D D0 32				sta m_bottomPosOffsetX
   156 5170 A9 09				lda #[CHAR_PIX.else_Y+1]
   157 5172 8D D1 32				sta m_bottomPosOffsetY
   158 5175 20 DE 5B				jsr CheckPlayerBottomDownPos
   159
   160 5178 AD CF 32				lda m_middleBottomChar
   161 517B 29 0F				and #15
   162 517D C9 04				cmp #CT_LADDER
   163 517F F0 16				beq PMGT_snap_ladder_down
   164
   165 5181 A9 03				lda #3									; search for a ladder one char below (right pixel)
   166 5183 8D D0 32				sta m_bottomPosOffsetX
   167 5186 A9 09				lda #[CHAR_PIX.else_Y+1]
   168 5188 8D D1 32				sta m_bottomPosOffsetY
   169 518B 20 DE 5B				jsr CheckPlayerBottomDownPos
   170
   171 518E AD CF 32				lda m_middleBottomChar
   172 5191 29 0F				and #15
   173 5193 C9 04				cmp #CT_LADDER
   174 5195 D0 5F				bne PMGT_end
   175
   176 				;************************************************
   177 				; snap player to center of the ladder
   178 				;
   179 5197			PMGT_snap_ladder_down
   180 					
   181 5197 A9 00				lda #0
   182 5199 85 A3				sta m_playerLevelLeftX_L1
   183 519B 85 A1				sta m_playerLevelLeftX_H2
   184
   185 519D AD D3 32				lda m_middleBottomCharPosX
   186 51A0 0A					asl
   187 51A1 26 A1				rol m_playerLevelLeftX_H2				; x2
   188 51A3 0A					asl
   189 51A4 26 A1				rol m_playerLevelLeftX_H2				; x4 = CHAR_PIX.else_X
   190 51A6 85 A2				sta m_playerLevelLeftX_H1
   191
   192 51A8 A9 00				lda #0									; put player one line below
   193 51AA 85 AC				sta m_playerLevelBottomY_L1
   194 						
   195 51AC A5 AB				lda m_playerLevelBottomY_H1
   196 51AE 18					clc
   197 51AF 69 01				adc #1
   198 51B1 85 AB				sta m_playerLevelBottomY_H1
   199 					
   200 51B3 A5 AA				lda m_playerLevelBottomY_H2
   201 51B5 69 00				adc #0
   202 51B7 85 AA				sta m_playerLevelBottomY_H2
   203
   204 51B9 A2 04				ldx #PS_CLIMBING						; start climbing state
   205 51BB 20 F6 4E				jsr SetPlayerMethod
   206 						
   207 51BE 4C F6 51				jmp PMGT_end
   208 						
   209 				;***** Clamp Player to platform
   210 51C1			ClampPlayer
   211
   212 51C1 A5 DE				lda m_stick0
   213 51C3 C9 0F				cmp #$0F
   214 51C5 D0 2F				bne PMGT_end
   215 						 
   216 51C7 AE 73 32				ldx m_floatPlatformIdx
   217 51CA CA					dex
   218 						
   219 51CB BD 45 6A				lda PlatformTime,x
   220 51CE C9 06				cmp #FLOAT_PLATFORM_TIMER
   221 51D0 D0 24				bne PMGT_end
   222 						
   223 51D2 BD 55 6A				lda PlatformDirX,x
   224 51D5 C9 00				cmp #00
   225 51D7 D0 10				bne ClampLeft
   226 						
   227 51D9 18					clc		
   228 						
   229 51DA A5 A2				lda m_playerLevelLeftX_H1	
   230 51DC 69 04				adc #$04
   231 51DE 85 A2				sta m_playerLevelLeftX_H1
   232 51E0 A5 A1				lda m_playerLevelLeftX_H2
   233 51E2 69 00				adc #00
   234 51E4 85 A1				sta m_playerLevelLeftX_H2		
   235
   236 51E6 4C F6 51				jmp PMGT_end 
   237 						
   238 51E9			ClampLeft		
   239 51E9 38					sec
   240 51EA A5 A2				lda m_playerLevelLeftX_H1
   241 51EC E9 04				sbc #$04
   242 51EE 85 A2				sta m_playerLevelLeftX_H1
   243 51F0 A5 A1				lda m_playerLevelLeftX_H2
   244 51F2 E9 00				sbc #00
   245 51F4 85 A1				sta m_playerLevelLeftX_H2		
   246 						
   247 				;************************************************
   248 				;
   249 51F6			PMGT_end
   250 						
   251 51F6 20 A6 55				jsr SetPlayerInfo
   252 51F9 4C 8E 49				jmp PlayerMethodReturn
   502 51FC				icl "StateJumping.Asm"
Source: E:\_8BitProjects\Series\Scroller\StateJumping.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		StateJumping.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 51FC			PlayerMethodJumping
    14
    15 51FC 20 C7 4F			jsr CheckCollectable
    16
    17 51FF 20 DD 5C			jsr CheckCreatePlayerMissile
    18
    19
    20 				; check input to grab a ladder while jumping
    21 5202 A5 DE			lda m_stick0
    22 5204 29 01			and #STICK_UP		; check if up is still pressed
    23 5206 D0 3B			bne PMJ_air_control
    24
    25 5208 A5 DE			lda m_stick0
    26 520A 29 0C			and #[STICK_LEFT|STICK_RIGHT]		; check if left or right are not pressed
    27 520C C9 0C			cmp #[STICK_LEFT|STICK_RIGHT]
    28 520E D0 33			bne PMJ_air_control
    29
    30
    31 				;----------------------------------------
    32 5210			PMJ_check_ladder
    33 				; search for a ladder (middle pixel)
    34 5210 A9 02			lda #2
    35 5212 8D D0 32			sta m_bottomPosOffsetX
    36 5215 A9 00			lda #0
    37 5217 8D D1 32			sta m_bottomPosOffsetY
    38 521A 20 DE 5B			jsr CheckPlayerBottomDownPos
    39
    40 521D AD CF 32			lda m_middleBottomChar
    41 5220 29 0F			and #15
    42 5222 C9 04			cmp #CT_LADDER
    43 5224 D0 1D			bne PMJ_air_control
    44
    45 				; snap player to center of the ladder
    46 5226			PMJ_snap_ladder
    47 5226 A9 00			lda #0
    48 5228 85 A3			sta m_playerLevelLeftX_L1
    49 522A 85 A1			sta m_playerLevelLeftX_H2
    50
    51 522C AD D3 32			lda m_middleBottomCharPosX
    52 522F 0A				asl
    53 5230 26 A1			rol m_playerLevelLeftX_H2	; x2
    54 5232 0A				asl
    55 5233 26 A1			rol m_playerLevelLeftX_H2	; x4 = CHAR_PIX.else_X
    56 5235 85 A2			sta m_playerLevelLeftX_H1
    57
    58 				; abort jumping state
    59 5237 A9 00			lda #0
    60 5239 85 CC			sta m_playerHoldJumpCounter	; forget hold jump counter
    61
    62 				; start climbing state
    63 523B A2 04			ldx #PS_CLIMBING
    64 523D 20 F6 4E			jsr SetPlayerMethod
    65
    66 5240 4C 6F 52			jmp PMJ_exit
    67
    68
    69 				;----------------------------------------
    70 5243			PMJ_air_control
    71 5243 20 65 50			jsr DoSideControl
    72
    73
    74 				;----------------------------------------
    75 5246			PMJ_update_jumping
    76 5246 A5 CC			lda m_playerHoldJumpCounter
    77 5248 F0 0F			beq PMJ_decay_jump_speed
    78
    79 524A A5 DE			lda m_stick0
    80 524C 29 01			and #STICK_UP		; check if up is still pressed
    81 524E D0 05			bne PMJ_stick_not_up
    82
    83 5250 C6 CC			dec m_playerHoldJumpCounter	; update hold jump counter
    84 5252 4C 5C 52			jmp PMJ_hold_jump_speed
    85
    86 5255			PMJ_stick_not_up
    87 5255 A9 00			lda #0
    88 5257 85 CC			sta m_playerHoldJumpCounter	; forget hold jump counter
    89
    90 5259			PMJ_decay_jump_speed
    91 5259 20 DF 5A			jsr SubstractGravityAccelToSpeed
    92
    93 525C			PMJ_hold_jump_speed
    94 525C 20 15 5B			jsr SubstractSpeedYToPosition
    95
    96 525F 20 A6 55			jsr SetPlayerInfo
    97
    98 				; check if the speed in Y is already 0
    99 5262 A5 BD			lda m_playerSpeedY_H1
   100 5264 D0 09			bne PMJ_exit
   101 5266 A5 BE			lda m_playerSpeedY_L1
   102 5268 D0 05			bne PMJ_exit
   103
   104 				; change to the falling state
   105 526A A2 03			ldx #PS_FALLING
   106 526C 20 F6 4E			jsr SetPlayerMethod
   107
   108 526F			PMJ_exit
   109 526F 4C 8E 49			jmp PlayerMethodReturn
   503 5272				icl "StateFalling.Asm"
Source: E:\_8BitProjects\Series\Scroller\StateFalling.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		StateFalling.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 5272			PlayerMethodFalling
    14
    15 5272 20 C7 4F			jsr CheckCollectable
    16
    17 5275 20 DD 5C			jsr CheckCreatePlayerMissile
    18
    19
    20 				; check input to grab a ladder while falling
    21 5278 A5 DE			lda m_stick0
    22 527A 29 01			and #STICK_UP		; check if up is still pressed
    23 527C D0 37			bne PMF_check_restart_jump
    24
    25 527E A5 DE			lda m_stick0
    26 5280 29 0C			and #[STICK_LEFT|STICK_RIGHT]		; check if left or right are not pressed
    27 5282 C9 0C			cmp #[STICK_LEFT|STICK_RIGHT]
    28 5284 D0 2F			bne PMF_check_restart_jump
    29
    30
    31 				;----------------------------------------
    32 5286			PMF_check_ladder
    33 				; search for a ladder (bottom middle pixel)
    34 5286 A9 02			lda #2
    35 5288 8D D0 32			sta m_bottomPosOffsetX
    36 528B A9 00			lda #0
    37 528D 8D D1 32			sta m_bottomPosOffsetY
    38 5290 20 DE 5B			jsr CheckPlayerBottomDownPos
    39
    40 5293 AD CF 32			lda m_middleBottomChar
    41 5296 29 0F			and #15
    42 5298 C9 04			cmp #CT_LADDER
    43 529A D0 19			bne PMF_check_restart_jump
    44
    45 				; snap player to center of the ladder
    46 529C			PMF_snap_ladder
    47 529C A9 00			lda #0
    48 529E 85 A3			sta m_playerLevelLeftX_L1
    49 52A0 85 A1			sta m_playerLevelLeftX_H2
    50
    51 52A2 AD D3 32			lda m_middleBottomCharPosX
    52 52A5 0A				asl
    53 52A6 26 A1			rol m_playerLevelLeftX_H2	; x2
    54 52A8 0A				asl
    55 52A9 26 A1			rol m_playerLevelLeftX_H2	; x4 = CHAR_PIX.else_X
    56 52AB 85 A2			sta m_playerLevelLeftX_H1
    57
    58 				; start climbing state
    59 52AD A2 04			ldx #PS_CLIMBING
    60 52AF 20 F6 4E			jsr SetPlayerMethod
    61
    62 52B2 4C E8 52			jmp PMF_exit
    63
    64
    65 				;----------------------------------------
    66 52B5			PMF_check_restart_jump
    67 				;
    68 				;	; uncomment this to allow infinite jumping
    69 				; 	lda m_stick0
    70 				; 	and #STICK_UP	; check up
    71 				; 	bne PMF_check_in_water
    72 				; 
    73 				; 	lda m_oldStick0
    74 				; 	and #STICK_UP	; check old up (looking for "just pressed")
    75 				; 	beq PMF_check_in_water
    76 				; 
    77 				;	; start jumping state
    78 				; 	ldx #PS_JUMPING
    79 				; 	jsr SetPlayerMethod
    80 				; 
    81 				; 	jmp PMF_exit
    82
    83
    84 				;----------------------------------------
    85 52B5			PMF_check_in_water
    86 				; search for water (center pixel)
    87 52B5 A9 02			lda #2
    88 52B7 8D D0 32			sta m_bottomPosOffsetX
    89 52BA A9 02			lda #2
    90 52BC 8D D1 32			sta m_bottomPosOffsetY
    91 52BF 20 2B 5C			jsr CheckPlayerBottomUpPos
    92
    93 52C2 AD CF 32			lda m_middleBottomChar
    94 52C5 29 0F			and #15
    95 52C7 C9 05			cmp #CT_WATER
    96 52C9 D0 08			bne PMF_air_control
    97
    98 				; start in water state
    99 52CB A2 05			ldx #PS_IN_WATER
   100 52CD 20 F6 4E			jsr SetPlayerMethod
   101
   102 52D0 4C E8 52			jmp PMF_exit
   103
   104
   105 				;----------------------------------------
   106 52D3			PMF_air_control
   107 52D3 20 65 50			jsr DoSideControl
   108
   109
   110 				;----------------------------------------
   111 52D6			PMF_update_falling
   112 52D6 20 BD 5A			jsr AddGravityAccelToSpeed
   113
   114 52D9 20 F3 5A			jsr AddSpeedYToPosition
   115
   116 52DC 20 A6 55			jsr SetPlayerInfo
   117
   118 52DF A5 CF			lda m_playerOverPlatformFlag
   119 52E1 F0 05			beq PMF_exit
   120
   121
   122 				; change to the over platform state
   123 52E3 A2 01			ldx #PS_OVER_PLATFORM
   124 52E5 20 F6 4E			jsr SetPlayerMethod
   125
   126
   127 52E8			PMF_exit
   128 52E8 4C 8E 49			jmp PlayerMethodReturn
   504 52EB				icl "StateClimbing.Asm"
Source: E:\_8BitProjects\Series\Scroller\StateClimbing.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		StateClimbing.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; PlayerMethodClimbing
    15 				;**************************************************************************************************
    16 				;
    17 52EB			PlayerMethodClimbing
    18
    19 52EB 20 DD 5C				jsr CheckCreatePlayerMissile
    20
    21 				;************************************************
    22 				;
    23 52EE			PMC_check_up
    24 						
    25 52EE A5 DE				lda m_stick0
    26 52F0 29 01				and #STICK_UP						; check up
    27 52F2 D0 41				bne PMC_check_down
    28
    29 52F4 A9 E0				lda #CLIMB_UP_SPEED_Y_L1
    30 52F6 85 BE				sta m_playerSpeedY_L1
    31 52F8 A9 00				lda #CLIMB_UP_SPEED_Y_H1
    32 52FA 85 BD				sta m_playerSpeedY_H1
    33
    34 						; update player position in Y
    35 52FC A5 AC				lda m_playerLevelBottomY_L1
    36 52FE 38					sec
    37 52FF E5 BE				sbc m_playerSpeedY_L1
    38 5301 85 AC				sta m_playerLevelBottomY_L1
    39 5303 A5 AB				lda m_playerLevelBottomY_H1
    40 5305 E5 BD				sbc m_playerSpeedY_H1
    41 5307 85 AB				sta m_playerLevelBottomY_H1
    42 5309 A5 AA				lda m_playerLevelBottomY_H2
    43 530B E9 00				sbc #0
    44 530D 85 AA				sta m_playerLevelBottomY_H2
    45
    46 						; search for an empty space at the middle bottom point of the player
    47 530F A9 06				lda #[PLR_WIDTH/2 + 2]
    48 5311 8D D0 32				sta m_bottomPosOffsetX
    49 5314 A9 00				lda #0
    50 5316 8D D1 32				sta m_bottomPosOffsetY
    51 5319 20 DE 5B				jsr CheckPlayerBottomDownPos
    52
    53 531C AD CF 32				lda m_middleBottomChar
    54 531F 29 0F				and #15
    55 5321 D0 0F				bne PMC_end_move_up
    56
    57 						; snap to the bottom and go to the platform state
    58 5323 A5 AB				lda m_playerLevelBottomY_H1
    59 5325 09 07				ora #[CHAR_PIX.else_Y-1]
    60 5327 85 AB				sta m_playerLevelBottomY_H1
    61
    62 5329 A9 00				lda #0
    63 532B 85 AC				sta m_playerLevelBottomY_L1
    64
    65 532D A2 01				ldx #PS_OVER_PLATFORM
    66 532F 20 F6 4E				jsr SetPlayerMethod
    67
    68 				;************************************************
    69 				;
    70 5332			PMC_end_move_up
    71 5332 4C A1 53				jmp PMC_exit
    72
    73
    74 				;************************************************
    75 				;
    76 5335			PMC_check_down
    77
    78 5335 A5 DE				lda m_stick0
    79 5337 29 02				and #STICK_DOWN					; check down
    80 5339 D0 66				bne PMC_exit
    81
    82 533B A9 80				lda #CLIMB_DOWN_SPEED_Y_L1
    83 533D 85 BE				sta m_playerSpeedY_L1
    84 533F A9 01				lda #CLIMB_DOWN_SPEED_Y_H1
    85 5341 85 BD				sta m_playerSpeedY_H1
    86
    87 						; update player position in Y
    88 5343 A5 AC				lda m_playerLevelBottomY_L1
    89 5345 18					clc
    90 5346 65 BE				adc m_playerSpeedY_L1
    91 5348 85 AC				sta m_playerLevelBottomY_L1
    92 534A A5 AB				lda m_playerLevelBottomY_H1
    93 534C 65 BD				adc m_playerSpeedY_H1
    94 534E 85 AB				sta m_playerLevelBottomY_H1
    95 5350 A5 AA				lda m_playerLevelBottomY_H2
    96 5352 69 00				adc #0
    97 5354 85 AA				sta m_playerLevelBottomY_H2
    98
    99 						; special check for the top char of a ladder (that is a platform)
   100 5356 A9 06				lda #[PLR_WIDTH/2 + 2]
   101 5358 8D D0 32				sta m_bottomPosOffsetX
   102 535B A9 08				lda #CHAR_PIX.else_Y
   103 535D 8D D1 32				sta m_bottomPosOffsetY
   104 5360 20 DE 5B				jsr CheckPlayerBottomDownPos
   105
   106 5363 AD CF 32				lda m_middleBottomChar
   107 5366 29 0F				and #15
   108 5368 C9 04				cmp #CT_LADDER
   109 536A F0 35				beq PMC_exit
   110
   111 						; search for a platform at the middle bottom point of the player
   112 536C A9 06				lda #[PLR_WIDTH/2 + 2]
   113 536E 8D D0 32				sta m_bottomPosOffsetX
   114 5371 A9 00				lda #0
   115 5373 8D D1 32				sta m_bottomPosOffsetY
   116 5376 20 DE 5B				jsr CheckPlayerBottomDownPos
   117
   118 5379 AD CF 32				lda m_middleBottomChar
   119 537C 29 01				and #01
   120 537E C9 01				cmp #CT_BLOCK
   121 5380 D0 1F				bne PMC_exit
   122
   123 5382 AD CF 32				lda m_middleBottomChar
   124 5385 29 10				and #%00010000
   125 5387 F0 18				beq PMC_exit
   126
   127 						; snap to the bottom and go to the platform state
   128 5389 A5 AB				lda m_playerLevelBottomY_H1
   129 538B 29 F8				and #%11111000
   130 538D 38					sec
   131 538E E9 01				sbc #1
   132 5390 85 AB				sta m_playerLevelBottomY_H1
   133 5392 A5 AA				lda m_playerLevelBottomY_H2
   134 5394 E9 00				sbc #0
   135 5396 85 AA				sta m_playerLevelBottomY_H2
   136
   137 5398 A9 00				lda #0
   138 539A 85 AC				sta m_playerLevelBottomY_L1
   139 					
   140 539C A2 01				ldx #PS_OVER_PLATFORM
   141 539E 20 F6 4E				jsr SetPlayerMethod
   142
   143 				;************************************************
   144 				;
   145 53A1			PMC_exit
   146
   147 53A1 20 A6 55				jsr SetPlayerInfo
   148 53A4 4C 8E 49				jmp PlayerMethodReturn
   505 53A7				icl "StateInWater.Asm"
Source: E:\_8BitProjects\Series\Scroller\StateInWater.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		StateInWater.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;***************************************************************************************************
    14 				;	PlayerMethodInWater
    15 				;***************************************************************************************************
    16 				;
    17 53A7			PlayerMethodInWater
    18
    19 53A7 20 C7 4F				jsr CheckCollectable					; add collectables in water for this	
    20 53AA 20 DD 5C				jsr CheckCreatePlayerMissile
    21
    22 						; search for water (top center pixel)		 
    23 53AD A9 02				lda #2
    24 53AF 8D D0 32				sta m_bottomPosOffsetX
    25 53B2 A9 07				lda #7
    26 53B4 8D D1 32				sta m_bottomPosOffsetY
    27 53B7 20 2B 5C				jsr CheckPlayerBottomUpPos
    28
    29 53BA AD CF 32				lda m_middleBottomChar
    30 53BD 29 0F				and #15
    31 53BF C9 05				cmp #CT_WATER
    32 53C1 F0 12				beq PMIW_check_water_moves
    33
    34 						; check jump input to go out of the water
    35 53C3 A5 DE				lda m_stick0
    36 53C5 29 01				and #STICK_UP							; check up
    37 53C7 D0 0C				bne PMIW_check_water_moves
    38
    39 53C9 A5 CB				lda m_playerNoJumpTimer
    40 53CB D0 08				bne PMIW_check_water_moves
    41 					
    42 						; start jumping state
    43 53CD A2 02				ldx #PS_JUMPING
    44 53CF 20 F6 4E				jsr SetPlayerMethod
    45
    46 53D2 4C 9E 54				jmp PMIW_exit
    47
    48 53D5			PMIW_check_water_moves
    49
    50 53D5 AD D5 32				lda m_playerOnWaterSurfaceFlag
    51 53D8 F0 03				beq PMIW_check_move_up
    52 53DA 4C 5E 54				jmp PMIW_on_surface
    53
    54 				;*****	check vertical movement
    55 				; 
    56 53DD			PMIW_check_move_up
    57 					
    58 53DD A5 DE				lda m_stick0
    59 53DF 29 01				and #STICK_UP							; check up
    60 53E1 D0 0E				bne PMIW_check_move_down
    61
    62 53E3 AD D4 32				lda m_waterPlayerDirectionFlag
    63 53E6 D0 06				bne PMIW_move_up_down
    64
    65 53E8			PMIW_move_up_up
    66 					
    67 53E8 20 8C 5B				jsr AddWaterMoveUpAccelToSpeed
    68 53EB 4C 2B 54				jmp PMIW_going_up_speed
    69
    70 53EE			PMIW_move_up_down
    71 					
    72 53EE 4C 4A 54				jmp PMIW_going_down
    73
    74 53F1			PMIW_check_move_down
    75
    76 53F1 A5 DE				lda m_stick0
    77 53F3 29 02				and #STICK_DOWN							; check down
    78 53F5 D0 2C				bne PMIW_under_surface
    79
    80 53F7 AD D4 32				lda m_waterPlayerDirectionFlag
    81 53FA D0 14				bne PMIW_move_down_down
    82
    83 53FC			PMIW_move_down_up
    84 					
    85 53FC 20 78 5B				jsr SubstractWaterAccelToSpeed
    86 53FF 20 15 5B				jsr SubstractSpeedYToPosition
    87
    88 5402 A5 BD				lda m_playerSpeedY_H1
    89 5404 05 BE				ora m_playerSpeedY_L1
    90 5406 D0 18				bne PMIW_check_move_exit
    91
    92 5408 A9 01				lda #1
    93 540A 8D D4 32				sta m_waterPlayerDirectionFlag
    94
    95 540D 4C 98 54				jmp PMIW_check_side_moves
    96
    97 5410			PMIW_move_down_down
    98 						
    99 5410 20 AE 5B				jsr AddWaterMoveDownAccelToSpeed
   100 5413 20 F3 5A				jsr AddSpeedYToPosition
   101
   102 5416 A5 CF				lda m_playerOverPlatformFlag
   103 5418 F0 06				beq PMIW_check_move_exit
   104
   105 						; reset speed in Y after a bottom collision
   106 541A A9 00				lda #0
   107 541C 85 BD				sta m_playerSpeedY_H1
   108 541E 85 BE				sta m_playerSpeedY_L1
   109
   110 5420			PMIW_check_move_exit
   111 					
   112 5420 4C 98 54				jmp PMIW_check_side_moves
   113
   114 5423			PMIW_under_surface
   115
   116 5423 AD D4 32				lda m_waterPlayerDirectionFlag
   117 5426 D0 22				bne PMIW_going_down
   118
   119 5428			PMIW_going_up
   120 						
   121 5428 20 56 5B				jsr AddWaterAccelToSpeed
   122
   123 542B			PMIW_going_up_speed
   124 						
   125 542B 20 15 5B				jsr SubstractSpeedYToPosition
   126
   127 				;*****	check if we are emerging from water (middle height, center pixel)
   128 				;
   129 542E			PMIW_emerging
   130 					
   131 542E A9 02				lda #2
   132 5430 8D D0 32				sta m_bottomPosOffsetX
   133 5433 A9 03				lda #3
   134 5435 8D D1 32				sta m_bottomPosOffsetY
   135 5438 20 2B 5C				jsr CheckPlayerBottomUpPos
   136
   137 543B AD CF 32				lda m_middleBottomChar
   138 543E 29 0F				and #15
   139 5440 D0 56				bne PMIW_check_side_moves
   140
   141 5442 A9 01				lda #1
   142 5444 8D D5 32				sta m_playerOnWaterSurfaceFlag
   143
   144 5447 4C 98 54				jmp PMIW_check_side_moves
   145
   146 544A			PMIW_going_down
   147
   148 544A 20 78 5B				jsr SubstractWaterAccelToSpeed
   149
   150 544D			PMIW_going_down_speed
   151 					
   152 544D 20 F3 5A				jsr AddSpeedYToPosition
   153
   154 5450			PMIW_check_down_speed
   155 					
   156 5450 A5 BD				lda m_playerSpeedY_H1
   157 5452 05 BE				ora m_playerSpeedY_L1
   158 5454 D0 42				bne PMIW_check_side_moves
   159
   160 5456			PMIW_change_dir_to_up
   161 						
   162 5456 A9 00				lda #0
   163 5458 8D D4 32				sta m_waterPlayerDirectionFlag
   164
   165 545B 4C 98 54				jmp PMIW_check_side_moves
   166
   167 545E			PMIW_on_surface
   168
   169 						; check water "buoyancy"
   170 545E AD D4 32				lda m_waterPlayerDirectionFlag
   171 5461 D0 14				bne PMIW_going_down_surface
   172
   173 5463			PMIW_going_up_surface
   174
   175 5463 20 78 5B				jsr SubstractWaterAccelToSpeed
   176 5466 20 15 5B				jsr SubstractSpeedYToPosition
   177
   178 5469 A5 BD				lda m_playerSpeedY_H1
   179 546B 05 BE				ora m_playerSpeedY_L1
   180 546D D0 29				bne PMIW_check_side_moves
   181
   182 546F A9 01				lda #1
   183 5471 8D D4 32				sta m_waterPlayerDirectionFlag
   184
   185 5474 4C 98 54				jmp PMIW_check_side_moves
   186
   187 5477			PMIW_going_down_surface
   188
   189 5477 20 56 5B				jsr AddWaterAccelToSpeed
   190 547A 20 F3 5A				jsr AddSpeedYToPosition
   191
   192 						; search for water (top center pixel)
   193 547D A9 02				lda #2
   194 547F 8D D0 32				sta m_bottomPosOffsetX
   195 5482 A9 07				lda #7
   196 5484 8D D1 32				sta m_bottomPosOffsetY
   197 5487 20 2B 5C				jsr CheckPlayerBottomUpPos
   198
   199 548A AD CF 32				lda m_middleBottomChar
   200 548D 29 0F				and #15
   201 548F C9 05				cmp #CT_WATER
   202 5491 D0 05				bne PMIW_check_side_moves
   203
   204 5493 A9 00				lda #0
   205 5495 8D D5 32				sta m_playerOnWaterSurfaceFlag
   206
   207 5498			PMIW_check_side_moves
   208
   209 5498 20 04 50				jsr DoSideMovement
   210
   211 549B			PMIW_update_pos
   212 						
   213 549B 20 A6 55				jsr SetPlayerInfo
   214
   215 549E			PMIW_exit
   216 						
   217 549E 4C 8E 49				jmp PlayerMethodReturn
   506 				;	
   507 				;**************************************************************************************************
   508 				;
   509 				;**************************************************************************************************
   510 				; PlayerMethodGravityTest
   511 				;**************************************************************************************************
   512 				;
   513 54A1			PlayerMethodGravityTest
   514 54A1 4C 8E 49			jmp PlayerMethodReturn
   515 				;
   516 				;**************************************************************************************************
   517 				; PlayerMethodLose
   518 				;**************************************************************************************************
   519 				;
   520 54A4			PlayerMethodLose
   521 54A4 4C 8E 49			jmp PlayerMethodReturn
   334 54A7					icl "PlayerMovement.Asm"
Source: E:\_8BitProjects\Series\Scroller\PlayerMovement.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		PlayerMoveent.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				;
    15 				;	SetSpawnPos
    16 				;
    17 				;		Set the initial position of the player.
    18 				;		Uses PARAM00 as the level number.		
    19 				;
    20 				;**************************************************************************************************
    21 				;
    22 54A7			.proc SetSpawnPos
    23
    24 						; set spawn position
    25 54A7 A6 92				ldx m_param00
    26 						
    27 54A9 A9 00				lda #0
    28 54AB 85 A1				sta m_playerLevelLeftX_H2
    29 54AD BD 00 30				lda LevelsPlayer_X,x
    30 54B0 85 A2				sta m_playerLevelLeftX_H1
    31 						
    32 54B2 A9 00				lda #0
    33 54B4 85 A3				sta m_playerLevelLeftX_L1				; fractional part
    34 54B6 85 AA				sta m_playerLevelBottomY_H2
    35 						
    36 54B8 A6 F2				ldx m_currLevelNum
    37 54BA BD 01 30				lda LevelsPlayer_Y,x
    38 54BD A2 08				ldx #8 
    39 54BF 20 6A 4A				jsr MultiplyAX
    40 54C2 AD E6 49				lda _productLo
    41 54C5 69 07				adc #7		
    42 54C7 85 AB				sta m_playerLevelBottomY_H1
    43 						
    44 54C9 A9 00				lda #0
    45 54CB 85 AC				sta m_playerLevelBottomY_L1				; fractional part
    46
    47 54CD 20 A6 55				jsr SetPlayerInfo						; Set the players info	
    48 					
    49 54D0 60					rts
    50
    51 				.endp	
    52
    53 				;
    54 				;**************************************************************************************************
    55 				; SetAnimationIndex
    56 				;**************************************************************************************************
    57 				;
    58 54D1			.proc SetAnimationIndex
    59
    60 54D1			CheckState
    61 54D1 A5 D2				lda m_playerState
    62 54D3 C9 01				cmp #PS_OVER_PLATFORM
    63 54D5 F0 19				beq CheckWalking	
    64 54D7 C9 00				cmp #PS_STATIC
    65 54D9 F0 5B				beq StandingIndex
    66 54DB C9 02				cmp #PS_JUMPING
    67 54DD F0 52				beq JumpFallIndex
    68 54DF C9 03				cmp #PS_FALLING
    69 54E1 F0 4E				beq JumpFallIndex		
    70 54E3 C9 04				cmp #PS_CLIMBING
    71 54E5 F0 4F				beq StandingIndex		
    72 54E7 C9 05				cmp #PS_IN_WATER
    73 54E9 F0 4B				beq StandingIndex		
    74 54EB C9 07				cmp #PS_LOSE
    75 54ED 4C 36 55				jmp StandingIndex		
    76 						 
    77 54F0			CheckWalking
    78 54F0 A5 DE				lda m_stick0
    79 54F2 29 0C				and #[STICK_RIGHT | STICK_LEFT]
    80 54F4 C9 0C				cmp #[STICK_RIGHT | STICK_LEFT]
    81 54F6 D0 03				bne ProcessFrame
    82 54F8 4C 36 55				jmp StandingIndex
    83 							
    84 54FB			ProcessFrame		
    85 						; Process frame 
    86 54FB AD C6 32				lda m_animFrame
    87 54FE 69 01				adc #$01
    88 5500 8D C6 32				sta m_animFrame
    89 						
    90 5503			IsWalking
    91 5503 29 0C				and #12
    92 5505 C9 0C				cmp #12
    93 5507 D0 03				bne check_one
    94 5509 4C 2C 55				jmp WalkingIndex1
    95 						
    96 550C			check_one
    97 550C AD C6 32				lda m_animFrame
    98 550F 29 08				and #8		
    99 5511 C9 08				cmp #8
   100 5513 D0 03				bne check_two
   101 5515 4C 36 55				jmp StandingIndex
   102 						
   103 5518			check_two
   104 5518 AD C6 32				lda m_animFrame
   105 551B 29 04				and #4
   106 551D C9 04				cmp #4
   107 551F D0 03				bne check_three		
   108 5521 4C 27 55				jmp WalkingIndex
   109
   110 5524			check_three
   111 5524 4C 36 55				jmp StandingIndex		
   112
   113 5527			WalkingIndex
   114 5527 A9 03				lda #$03
   115 5529 4C 38 55				jmp Return_Exit		
   116
   117 552C			WalkingIndex1
   118 552C A9 06				lda #$06
   119 552E 4C 38 55				jmp Return_Exit		
   120
   121 5531			JumpFallIndex
   122 5531 A9 09				lda #$09
   123 5533 4C 38 55				jmp Return_Exit
   124 						
   125 5536			StandingIndex
   126 5536 A9 00				lda #0	
   127 								
   128 5538			Return_Exit
   129 5538 8D C7 32				sta m_animIndex
   130 553B AA					tax	
   131 553C BD 33 36				lda TabAnimationMap,x
   132 553F 8D C9 32				sta m_animOffset
   133 5542 BD 34 36				lda TabAnimationMap+1,x
   134 5545 8D C8 32				sta m_animHeight
   135 								
   136 5548 60					rts		
   137 				.endp
   138 				;
   139 				;**************************************************************************************************
   140 				; FlipPlayer
   141 				;**************************************************************************************************
   142 				;
   143 5549			.proc FlipPlayer
   144 					
   145 5549 48					pha
   146 554A 8A					txa
   147 554B 48					pha
   148 554C 98					tya
   149 554D 48					pha	
   150 							
   151 554E BD 35 36				lda TabAnimationMap[0]+2,x	
   152 5551 C5 CD				cmp m_lastplayerSideDirection
   153 5553 F0 38				beq FlipExit
   154
   155 5555 BD 33 36				lda TabAnimationMap[0],x
   156 5558 8D C4 32				sta m_revOffset
   157 								
   158 555B BD 34 36				lda TabAnimationMap[0]+1,x
   159 555E 8D C3 32				sta m_revHeight
   160 						
   161 5561 A5 CD				lda m_lastPlayerSideDirection
   162 5563 9D 35 36				sta TabAnimationMap[0]+2,x		
   163 						
   164 5566 A0 00				ldy #0
   165 5568 AE C4 32				ldx m_revOffset				
   166 556B BD 49 36		Flip	lda TabPlayerShape_01,x
   167 556E 20 93 55				jsr ReverseSprite 
   168 5571 9D 49 36				sta TabPlayerShape_01,x
   169 						
   170 5574 BD 9D 36				lda TabPlayerShape_01A,x
   171 5577 20 93 55				jsr ReverseSprite 
   172 557A 9D 9D 36				sta TabPlayerShape_01A,x
   173 						
   174 557D BD F1 36				lda TabPlayerShape_01B,x
   175 5580 20 93 55				jsr ReverseSprite 
   176 5583 9D F1 36				sta TabPlayerShape_01B,x
   177 5586 E8					inx
   178 5587 C8					iny
   179 5588 CC C3 32				cpy m_revHeight
   180 558B D0 DE				bne Flip
   181 						
   182 558D			FlipExit
   183 558D 68					pla
   184 558E A8					tay
   185 558F 68					pla
   186 5590 AA					tax
   187 5591 68					pla
   188 5592 60					rts
   189 				.endp
   190 				;
   191 				;**************************************************************************************************
   192 				; ReverseSprite
   193 				;**************************************************************************************************
   194 				;
   195 5593			.proc ReverseSprite
   196 5593 8D BE 32				sta m_hldA
   197 5596 8C BF 32				sty m_hldY
   198 5599 A0 07			 	ldy #$07 
   199 559B 0E BE 32		loop1   asl m_hldA
   200 559E 6A			        ror 
   201 559F 88			        dey 
   202 55A0 10 F9		        bpl loop1        
   203 55A2 AC BF 32		        ldy m_hldY
   204 55A5 60			        rts
   205 				.endp         	
   206 				;
   207 				;**************************************************************************************************
   208 				; SetPlayerInfo
   209 				;**************************************************************************************************
   210 				;
   211 55A6			.proc SetPlayerInfo
   212
   213 55A6 A5 A2				lda m_playerLevelLeftX_H1				; update right coordinate
   214 55A8 18					clc
   215 55A9 65 B3				adc m_playerSizeXMinusOne
   216 55AB 85 A5				sta m_playerLevelRightX_H1
   217 55AD A5 A1				lda m_playerLevelLeftX_H2
   218 55AF 69 00				adc #0
   219 55B1 85 A4				sta m_playerLevelRightX_H2
   220
   221 55B3 A5 AB				lda m_playerLevelBottomY_H1				; update top coordinate
   222 55B5 38					sec
   223 55B6 E5 B4				sbc m_playerSizeYMinusOne
   224 55B8 85 A8				sta m_playerLevelTopY_H1
   225 55BA A5 AA				lda m_playerLevelBottomY_H2
   226 55BC E9 00				sbc #0
   227 55BE 85 A7				sta m_playerLevelTopY_H2
   228
   229 55C0 60					rts
   230 						
   231 				.endp		
   232 				;
   233 				;**************************************************************************************************
   234 				; SetPlayerScreenPos
   235 				;**************************************************************************************************
   236 				;
   237 55C1			.proc SetPlayerScreenPos
   238
   239 55C1 A5 AD				lda m_playerScreenLeftX					; save old screen pos
   240 55C3 85 AF				sta m_oldPlayerScreenLeftX
   241
   242 55C5 A5 AE				lda m_playerScreenTopY
   243 55C7 85 B0				sta m_oldPlayerScreenTopY
   244 						;
   245 						; get new screen pos
   246 						;
   247 						; 	(this should use the "_H2" positions if the delta between the player
   248 						; 	and the camera is too big, 64 chars in X, or 32 chars in Y)
   249 						;
   250 55C9 A5 A2				lda m_playerLevelLeftX_H1
   251 55CB 38					sec
   252 55CC E5 DB				sbc m_levelWindowX_H1
   253 55CE 18					clc
   254 55CF 69 30				adc #PM_BASE_SCREEN_X
   255 55D1 85 AD				sta m_playerScreenLeftX
   256
   257 55D3 A5 A8				lda m_playerLevelTopY_H1
   258 55D5 38					sec
   259 55D6 E5 DD				sbc m_levelWindowY_H1
   260 55D8 18					clc
   261 55D9 69 20				adc #PM_BASE_SCREEN_Y
   262 55DB 85 AE				sta m_playerScreenTopY
   263
   264 55DD E6 9C				inc m_redrawPlayerCounter				; signal for the DLI to redraw the player
   265
   266 55DF 60					rts
   267
   268 				.endp		
   269 				;
   270 				;**************************************************************************************************
   271 				; DrawPlayer
   272 				;**************************************************************************************************
   273 				;
   274 55E0			.proc DrawPlayer
   275
   276 55E0 A5 9E				lda m_playerBaseColor00
   277 55E2 8D 12 D0				sta COLPM0
   278 55E5 A5 9F				lda m_playerBaseColor1A
   279 55E7 8D 13 D0				sta COLPM1
   280 55EA A5 A0				lda m_playerBaseColor1B
   281 55EC 8D 14 D0				sta COLPM2
   282
   283 55EF A5 9C				lda m_redrawPlayerCounter
   284 55F1 D0 03				bne zdraw		
   285 55F3 4C 42 56				jmp DP_exit				
   286
   287 55F6			zdraw
   288 55F6 A9 00				lda #0
   289 55F8 85 9C				sta m_redrawPlayerCounter
   290 						
   291 55FA 20 D1 54				jsr SetAnimationIndex
   292
   293 55FD A9 00				lda #0
   294 55FF A2 00				ldx #0
   295 5601 A4 B0				ldy m_oldPlayerScreenTopY	
   296 5603			zfill	
   297 5603 99 00 A4				sta p0_area_1,y
   298 5606 99 00 A5				sta p1_area_1,y
   299 5609 99 00 A6				sta p2_area_1,y
   300 560C C8					iny
   301 560D E8					inx
   302 560E EC C3 32				cpx m_revHeight
   303 5611 D0 F0				bne zfill
   304
   305 5613 AE C7 32				ldx m_animIndex
   306 5616 20 49 55				jsr FlipPlayer		
   307
   308 5619 A9 00				lda #$00
   309 561B 8D C5 32				sta m_animCount
   310 561E AE C9 32				ldx m_animOffset
   311 5621 A4 AE				ldy m_playerScreenTopY	
   312 5623			fill01
   313 5623 BD 49 36				lda TabPlayerShape_01,x
   314 5626 99 00 A4				sta p0_area_1,y		
   315 						
   316 5629 BD 9D 36				lda TabPlayerShape_01A,x
   317 562C 99 00 A5				sta p1_area_1,y
   318 						
   319 562F BD F1 36				lda TabPlayerShape_01B,x
   320 5632 99 00 A6				sta p2_area_1,y
   321 						
   322 5635 C8					iny
   323 5636 E8					inx
   324 5637 EE C5 32				inc m_animCount
   325 563A AD C5 32				lda m_animCount
   326 563D CD C8 32				cmp m_animHeight
   327 5640 90 E1				bcc fill01
   328
   329 5642			DP_exit
   330 5642 60					rts
   331 				.endp		
   332 				;
   333 				;**************************************************************************************************
   334 				; DrawPlayerExplosion
   335 				;**************************************************************************************************
   336 				;
   337 5643			.proc DrawPlayerExplosion
   338 5643 A5 9D				lda m_missleBaseColor00
   339 5645 8D 12 D0				sta COLPM0
   340
   341 				;************************************************
   342 				;
   343 5648			DPE_erase										; erase previous player explosion frame
   344 5648 A2 00				ldx #0
   345 564A AC D6 32				ldy m_playerExplosionScreenTopY_H1
   346
   347 				;************************************************
   348 				;
   349 564D			DPE_erase_loop
   350 564D A9 00				lda #0
   351 564F 99 00 A4				sta p0_area_1,y
   352 5652 99 00 A5				sta p1_area_1,y
   353 5655 99 00 A6				sta p2_area_1,y
   354 						
   355 5658 98					tya
   356 5659 18					clc
   357 565A 6D D2 32				adc m_playerExplosionStep
   358 565D B0 06				bcs DPE_update_frame
   359 565F A8					tay
   360
   361 5660 E8					inx
   362 5661 E4 B2				cpx m_playerSizeY
   363 5663 D0 E8				bne DPE_erase_loop
   364
   365 				;************************************************
   366 				; 	update step and explosion starting line
   367 				; 	if step +1 --> line - 3.5
   368 				; 	if step +2 --> line - 7.0
   369 				;
   370 5665			DPE_update_frame
   371 5665 AD D7 32				lda m_playerExplosionScreenTopY_L1
   372 5668 38					sec
   373 5669 E9 80				sbc #$80
   374 566B 8D D7 32				sta m_playerExplosionScreenTopY_L1
   375
   376 566E AD D6 32				lda m_playerExplosionScreenTopY_H1
   377 5671 E9 03				sbc #$03
   378 5673 B0 06				bcs DPE_do_update
   379
   380 5675 20 9D 4B				jsr InitPlayerInfo						; reached top of the screen, end explosion, respawn player
   381 5678 4C AB 56				jmp DPE_exit
   382 					
   383 				;************************************************
   384 				;
   385 567B			DPE_do_update
   386 567B 8D D6 32				sta m_playerExplosionScreenTopY_H1
   387 567E EE D2 32				inc m_playerExplosionStep				; step +1
   388
   389 				;************************************************
   390 				; draw new player explosion frame
   391 5681			DPE_draw										
   392 5681 A2 00				ldx #0
   393 5683 AC D6 32				ldy m_playerExplosionScreenTopY_H1
   394
   395 				;************************************************
   396 				;
   397 5686			DPE_draw_loop
   398 5686 BD 49 36				lda TabPlayerShape_01,x
   399 5689 F0 03				beq DPE_draw_p1
   400 568B 99 00 A4				sta p0_area_1,y
   401
   402 				;************************************************
   403 				;
   404 568E			DPE_draw_p1
   405 568E BD 9D 36				lda TabPlayerShape_01A,x
   406 5691 F0 03				beq DPE_draw_p2	
   407 5693 99 00 A5				sta p1_area_1,y
   408
   409 				;************************************************
   410 				;
   411 5696			DPE_draw_p2	
   412 5696 BD F1 36				lda TabPlayerShape_01B,x
   413 5699 F0 03				beq DPE_draw_end
   414 569B 99 00 A6				sta p2_area_1,y
   415
   416 				;************************************************
   417 				;
   418 569E			DPE_draw_end
   419 569E 98					tya
   420 569F 18					clc
   421 56A0 6D D2 32				adc m_playerExplosionStep
   422 56A3 B0 06				bcs DPE_exit
   423 56A5 A8					tay
   424 56A6 E8					inx
   425 56A7 E4 B2				cpx m_playerSizeY
   426 56A9 D0 DB				bne DPE_draw_loop
   427
   428 				;************************************************
   429 				;
   430 56AB			DPE_exit
   431 						
   432 56AB 60					rts
   433
   434 				.endp		
   435 				;
   436 				;**************************************************************************************************
   437 				; CheckPlayerInLevelRightLimit
   438 				;**************************************************************************************************
   439 				;
   440 56AC			.proc CheckPlayerInLevelRightLimit
   441
   442 56AC A5 A2				lda m_playerLevelLeftX_H1				; update right coordinate
   443 56AE 18					clc
   444 56AF 65 B3				adc m_playerSizeXMinusOne
   445 56B1 85 A5				sta m_playerLevelRightX_H1
   446 56B3 A5 A1				lda m_playerLevelLeftX_H2
   447 56B5 69 00				adc #0
   448 56B7 85 A4				sta m_playerLevelRightX_H2
   449
   450 56B9 C5 D6				cmp m_levelSizeX_H2
   451 56BB 90 1D				bcc CPILRL_exit
   452 56BD D0 06				bne CPILRL_reset_pos
   453
   454 56BF A5 A5				lda m_playerLevelRightX_H1
   455 56C1 C5 D7				cmp m_levelSizeX_H1
   456 56C3 90 15				bcc CPILRL_exit
   457
   458 				;************************************************
   459 				;
   460 56C5			CPILRL_reset_pos
   461 56C5 A9 00				lda #0
   462 56C7 85 A3				sta m_playerLevelLeftX_L1
   463
   464 56C9 A5 D7				lda m_levelSizeX_H1
   465 56CB 38					sec
   466 56CC E5 B1				sbc m_playerSizeX
   467 56CE 85 A2				sta m_playerLevelLeftX_H1
   468 56D0 A5 D6				lda m_levelSizeX_H2
   469 56D2 E9 00				sbc #0
   470 56D4 85 A1				sta m_playerLevelLeftX_H2
   471
   472 56D6 A9 01				lda #1
   473 56D8 85 D1				sta m_playerSideCollisionFlag
   474
   475 				;************************************************
   476 				;
   477 56DA			CPILRL_exit
   478 					
   479 56DA 60				rts
   480 					
   481 				.endp	
   482 				;
   483 				;**************************************************************************************************
   484 				; CheckPlayerInLevelBottomLimit
   485 				;**************************************************************************************************
   486 				;
   487 56DB			.proc CheckPlayerInLevelBottomLimit
   488
   489 56DB A5 AA				lda m_playerLevelBottomY_H2
   490 56DD C5 D8				cmp m_levelSizeY_H2
   491 56DF 90 1D				bcc Exit
   492 56E1 D0 06				bne Reset_Pos
   493
   494 56E3 A5 AB				lda m_playerLevelBottomY_H1
   495 56E5 C5 D9				cmp m_levelSizeY_H1
   496 56E7 90 15				bcc Exit
   497
   498 				;************************************************
   499 				;
   500 56E9			Reset_Pos
   501 56E9 A9 00				lda #0
   502 56EB 85 AC				sta m_playerLevelBottomY_L1
   503
   504 56ED A5 D9				lda m_levelSizeY_H1
   505 56EF 38					sec
   506 56F0 E9 01				sbc #1
   507 56F2 85 AB				sta m_playerLevelBottomY_H1
   508 56F4 A5 D8				lda m_levelSizeY_H2
   509 56F6 E9 00				sbc #0
   510 56F8 85 AA				sta m_playerLevelBottomY_H2
   511
   512 56FA A9 01				lda #1
   513 56FC 85 CF				sta m_playerOverPlatformFlag
   514
   515 				;************************************************
   516 				;
   517 56FE			Exit
   518 56FE 60					rts
   519
   520 				.endp		
   521 				;
   522 				;**************************************************************************************************
   523 				; CheckHoleBelowPlayer
   524 				;**************************************************************************************************
   525 				;
   526 56FF			.proc CheckHoleBelowPlayer
   527
   528 						; get bottom char line
   529 56FF A5 AA				lda m_playerLevelBottomY_H2
   530 5701 8D CC 32				sta m_charBuffer_H2
   531 5704 A5 AB				lda m_playerLevelBottomY_H1
   532 5706 18					clc
   533 5707 69 01				adc #1									; check one pixel below the bottom line of the player
   534 5709 90 03				bcc CHBP_get_char_line
   535 570B EE CC 32				inc m_charBuffer_H2
   536
   537 				;************************************************
   538 				;
   539 570E			CHBP_get_char_line
   540 						
   541 570E 4E CC 32				lsr m_charBuffer_H2						; /2
   542 5711 6A					ror
   543 5712 4E CC 32				lsr m_charBuffer_H2						; /4
   544 5715 6A					ror
   545 5716 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
   546 5719 6A					ror
   547
   548 						; check bottom level limit
   549 571A C5 D5				cmp m_levelCharSizeY
   550 571C B0 6F				bcs CHBP_no_hole
   551
   552 571E			GetLevelLine
   553
   554 571E AA					tax
   555 571F BD DB 32				lda TabLevelLineAddressLSB,x
   556 5722 85 E9				sta m_ptrLevelLine
   557 5724 BD DB 33				lda TabLevelLineAddressMSB,x
   558 5727 85 EA				sta m_ptrLevelLine+1
   559
   560 						; update right coordinate
   561 5729 A5 A2				lda m_playerLevelLeftX_H1
   562 572B 18					clc
   563 572C 65 B3				adc m_playerSizeXMinusOne
   564 572E 85 A5				sta m_playerLevelRightX_H1
   565 5730 A5 A1				lda m_playerLevelLeftX_H2
   566 5732 69 00				adc #0
   567 5734 85 A4				sta m_playerLevelRightX_H2
   568
   569 						; get left point char column
   570 5736 A5 A1				lda m_playerLevelLeftX_H2
   571 5738 8D CC 32				sta m_charBuffer_H2
   572 573B A5 A2				lda m_playerLevelLeftX_H1
   573 573D 4E CC 32				lsr m_charBuffer_H2						; /2
   574 5740 6A					ror
   575 5741 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   576 5744 6A					ror
   577
   578 5745 A8					tay
   579 5746 B1 E9				lda (m_ptrLevelLine),y
   580 5748 AA					tax
   581 5749 BD DB 34				lda TabCharDefinition,x
   582 574C 8D CD 32				sta m_leftBottomChar
   583
   584 						; get right point char column
   585 574F A5 A4				lda m_playerLevelRightX_H2
   586 5751 8D CC 32				sta m_charBuffer_H2
   587 5754 A5 A5				lda m_playerLevelRightX_H1
   588 5756 4E CC 32				lsr m_charBuffer_H2						; /2
   589 5759 6A					ror
   590 575A 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   591 575D 6A					ror
   592
   593 575E A8					tay
   594 575F B1 E9				lda (m_ptrLevelLine),y
   595 5761 AA					tax
   596 5762 BD DB 34				lda TabCharDefinition,x
   597 5765 8D CE 32				sta m_rightBottomChar
   598 					
   599 						; fast collision check
   600 5768 AD CD 32				lda m_leftBottomChar
   601 576B 29 01				and #01
   602 576D C9 01				cmp #CT_BLOCK
   603 576F D0 07				bne CHBP_check_next_char
   604
   605 5771 AD CD 32				lda m_leftBottomChar
   606 5774 29 10				and #%00010000
   607 5776 D0 15				bne CHBP_no_hole
   608
   609 				;************************************************
   610 				;
   611 5778			CHBP_check_next_char
   612 						
   613 5778 AD CE 32				lda m_rightBottomChar
   614 577B 29 01				and #01
   615 577D C9 01				cmp #CT_BLOCK
   616 577F D0 07				bne CHBP_hole
   617
   618 5781 AD CE 32				lda m_rightBottomChar
   619 5784 29 10				and #%00010000
   620 5786 D0 05				bne CHBP_no_hole
   621
   622 				;************************************************
   623 				;
   624 5788			CHBP_hole
   625
   626 						; need to change the player to the falling state
   627 5788 A9 00				lda #0
   628 578A 85 CF				sta m_playerOverPlatformFlag
   629 578C 60					rts
   630
   631 				;************************************************
   632 				;
   633 578D			CHBP_no_hole
   634
   635 578D A9 01				lda #1
   636 578F 85 CF				sta m_playerOverPlatformFlag
   637 5791 60					rts
   638 				.endp
   639 				;
   640 				;**************************************************************************************************
   641 				; CheckPlayerBottomCollision
   642 				;**************************************************************************************************
   643 				;
   644 5792			.proc CheckPlayerBottomCollision
   645
   646 						; get bottom char line
   647 5792 A5 AA				lda m_playerLevelBottomY_H2
   648 5794 8D CC 32				sta m_charBuffer_H2
   649 5797 A5 AB				lda m_playerLevelBottomY_H1
   650
   651 5799 4E CC 32				lsr m_charBuffer_H2						; /2
   652 579C 6A					ror
   653 579D 4E CC 32				lsr m_charBuffer_H2						; /4
   654 57A0 6A					ror
   655 57A1 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
   656 57A4 6A					ror
   657
   658 57A5 AA					tax
   659 57A6 BD DB 32				lda TabLevelLineAddressLSB,x
   660 57A9 85 E9				sta m_ptrLevelLine
   661 57AB BD DB 33				lda TabLevelLineAddressMSB,x
   662 57AE 85 EA				sta m_ptrLevelLine+1
   663
   664 						; update right coordinate
   665 57B0 A5 A2				lda m_playerLevelLeftX_H1
   666 57B2 18					clc
   667 57B3 65 B3				adc m_playerSizeXMinusOne
   668 57B5 85 A5				sta m_playerLevelRightX_H1
   669 57B7 A5 A1				lda m_playerLevelLeftX_H2
   670 57B9 69 00				adc #0
   671 57BB 85 A4				sta m_playerLevelRightX_H2
   672
   673 						; get left point char column
   674 57BD A5 A1				lda m_playerLevelLeftX_H2
   675 57BF 8D CC 32				sta m_charBuffer_H2
   676 57C2 A5 A2				lda m_playerLevelLeftX_H1
   677 57C4 4E CC 32				lsr m_charBuffer_H2						; /2
   678 57C7 6A					ror
   679 57C8 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   680 57CB 6A					ror
   681
   682 57CC A8					tay
   683 57CD B1 E9				lda (m_ptrLevelLine),y
   684 57CF AA					tax
   685 57D0 BD DB 34				lda TabCharDefinition,x
   686 57D3 8D CD 32				sta m_leftBottomChar
   687
   688 						; get right point char column
   689 57D6 A5 A4				lda m_playerLevelRightX_H2
   690 57D8 8D CC 32				sta m_charBuffer_H2
   691 57DB A5 A5				lda m_playerLevelRightX_H1
   692 57DD 4E CC 32				lsr m_charBuffer_H2						; /2
   693 57E0 6A					ror
   694 57E1 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   695 57E4 6A					ror
   696
   697 57E5 A8					tay
   698 57E6 B1 E9				lda (m_ptrLevelLine),y
   699 57E8 AA					tax
   700 57E9 BD DB 34				lda TabCharDefinition,x
   701 57EC 8D CE 32				sta m_rightBottomChar
   702
   703 						; fast collision check
   704 57EF AD CD 32				lda m_leftBottomChar
   705 57F2 29 01				and #01
   706 57F4 C9 01				cmp #CT_BLOCK
   707 57F6 D0 07				bne CPBC_check_next_char
   708
   709 57F8 AD CD 32				lda m_leftBottomChar
   710 57FB 29 10				and #%00010000
   711 57FD D0 10				bne CPBC_found_collision
   712
   713 				;************************************************
   714 				;
   715 57FF			CPBC_check_next_char
   716
   717 57FF AD CE 32				lda m_rightBottomChar
   718 5802 29 01				and #01
   719 5804 C9 01				cmp #CT_BLOCK
   720 5806 D0 1E				bne CPBC_exit
   721
   722 5808 AD CE 32				lda m_rightBottomChar
   723 580B 29 10				and #%00010000
   724 580D F0 17				beq CPBC_exit
   725
   726 				;************************************************
   727 				;
   728 580F			CPBC_found_collision
   729
   730 						; need to move the player up and change to the platform state
   731 580F A9 01				lda #1
   732 5811 85 CF				sta m_playerOverPlatformFlag
   733
   734 5813 A9 00				lda #0
   735 5815 85 AC				sta m_playerLevelBottomY_L1
   736
   737 5817 A5 AB				lda m_playerLevelBottomY_H1
   738 5819 29 F8				and #%11111000		; mask for CHAR_PIX.else_Y
   739 581B 38					sec
   740 581C E9 01				sbc #1
   741 581E 85 AB				sta m_playerLevelBottomY_H1
   742 5820 A5 AA				lda m_playerLevelBottomY_H2
   743 5822 E9 00				sbc #0
   744 5824 85 AA				sta m_playerLevelBottomY_H2
   745
   746 				;************************************************
   747 				;
   748 5826			CPBC_exit
   749 5826 60					rts
   750
   751 				.endp		
   752 				;
   753 				;**************************************************************************************************
   754 				; CheckPlayerTopCollision
   755 				;**************************************************************************************************
   756 				;
   757 5827			.proc CheckPlayerTopCollision
   758
   759 5827 A5 AB				lda m_playerLevelBottomY_H1				; update top coordinate
   760 5829 38					sec
   761 582A E5 B4				sbc m_playerSizeYMinusOne
   762 582C 85 A8				sta m_playerLevelTopY_H1
   763 						
   764 582E A5 AA				lda m_playerLevelBottomY_H2
   765 5830 E9 00				sbc #0
   766 5832 85 A7				sta m_playerLevelTopY_H2
   767
   768 5834 A5 A7				lda m_playerLevelTopY_H2				; get top char line
   769 5836 8D CC 32				sta m_charBuffer_H2
   770 5839 A5 A8				lda m_playerLevelTopY_H1
   771
   772 583B 4E CC 32				lsr m_charBuffer_H2						; /2
   773 583E 6A					ror
   774 583F 4E CC 32				lsr m_charBuffer_H2						; /4
   775 5842 6A					ror
   776 5843 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
   777 5846 6A					ror
   778
   779 5847 AA					tax
   780 5848 BD DB 32				lda TabLevelLineAddressLSB,x
   781 584B 85 E9				sta m_ptrLevelLine
   782 						
   783 584D BD DB 33				lda TabLevelLineAddressMSB,x
   784 5850 85 EA				sta m_ptrLevelLine+1
   785
   786 5852 A5 A2				lda m_playerLevelLeftX_H1				; update right coordinate
   787 5854 18					clc
   788 5855 65 B3				adc m_playerSizeXMinusOne
   789 5857 85 A5				sta m_playerLevelRightX_H1
   790 						
   791 5859 A5 A1				lda m_playerLevelLeftX_H2
   792 585B 69 00				adc #0
   793 585D 85 A4				sta m_playerLevelRightX_H2
   794
   795 585F A5 A1				lda m_playerLevelLeftX_H2				; get left point char column
   796 5861 8D CC 32				sta m_charBuffer_H2
   797 						
   798 5864 A5 A2				lda m_playerLevelLeftX_H1
   799 5866 4E CC 32				lsr m_charBuffer_H2						; /2
   800 5869 6A					ror
   801 586A 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   802 586D 6A					ror
   803
   804 586E A8					tay
   805 586F B1 E9				lda (m_ptrLevelLine),y
   806 						
   807 5871 AA					tax		
   808 5872 BD DB 34				lda TabCharDefinition,x
   809 5875 8D CA 32				sta m_leftTopChar
   810
   811 5878 A5 A4				lda m_playerLevelRightX_H2				; get right point char column	
   812 587A 8D CC 32				sta m_charBuffer_H2
   813 						
   814 587D A5 A5				lda m_playerLevelRightX_H1
   815 587F 4E CC 32				lsr m_charBuffer_H2						; /2
   816 5882 6A					ror
   817 5883 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   818 5886 6A					ror
   819
   820 5887 A8					tay
   821 5888 B1 E9				lda (m_ptrLevelLine),y
   822 588A AA					tax
   823 588B BD DB 34				lda TabCharDefinition,x
   824 588E 8D CB 32				sta m_rightTopChar
   825
   826 5891 AD CA 32				lda m_leftTopChar						; fast collision check	
   827 5894 29 01				and #01
   828 5896 C9 01				cmp #CT_BLOCK
   829 5898 D0 07				bne CPTC_check_next_char
   830
   831 589A AD CA 32				lda m_leftTopChar
   832 589D 29 20				and #%00100000
   833 589F D0 10				bne CPTC_found_collision
   834
   835 				;**************************************************
   836 				;
   837 58A1			CPTC_check_next_char
   838 						
   839 58A1 AD CB 32				lda m_rightTopChar
   840 58A4 29 01				and #01
   841 58A6 C9 01				cmp #CT_BLOCK
   842 58A8 D0 2B				bne CPTC_exit
   843
   844 58AA AD CB 32				lda m_rightTopChar
   845 58AD 29 20				and #%00100000
   846 58AF F0 24				beq CPTC_exit
   847
   848 				;**************************************************
   849 				;
   850 58B1			CPTC_found_collision
   851
   852 58B1 A9 01				lda #1									; need to move the player down
   853 58B3 85 D0				sta m_playerTopCollisionFlag
   854
   855 58B5 A9 00				lda #0
   856 58B7 85 AC				sta m_playerLevelBottomY_L1
   857
   858 58B9 A5 A8				lda m_playerLevelTopY_H1
   859 58BB 29 F8				and #%11111000							; mask for CHAR_PIX.else_Y
   860 58BD 18					clc
   861 58BE 69 08				adc #CHAR_PIX.else_Y 						; +m_playerSizeY
   862 58C0 85 AB				sta m_playerLevelBottomY_H1
   863 						
   864 58C2 A5 A7				lda m_playerLevelTopY_H2
   865 58C4 69 00				adc #0
   866 58C6 85 AA				sta m_playerLevelBottomY_H2
   867
   868 58C8 A5 AB				lda m_playerLevelBottomY_H1
   869 58CA 18					clc
   870 58CB 65 B4				adc m_playerSizeYMinusOne
   871 58CD 85 AB				sta m_playerLevelBottomY_H1
   872 						
   873 58CF A5 AA				lda m_playerLevelBottomY_H2
   874 58D1 69 00				adc #0
   875 58D3 85 AA				sta m_playerLevelBottomY_H2
   876
   877 				;**************************************************
   878 				;
   879 58D5			CPTC_exit
   880 58D5 60					rts
   881
   882 				.endp		
   883 				;
   884 				;**************************************************************************************************
   885 				; CheckPlayerLeftCollision
   886 				;**************************************************************************************************
   887 				;
   888 58D6			.proc CheckPlayerLeftCollision
   889
   890 58D6 A5 AB				lda m_playerLevelBottomY_H1				; update top coordinate
   891 58D8 38					sec
   892 58D9 E5 B4				sbc m_playerSizeYMinusOne
   893 58DB 85 A8				sta m_playerLevelTopY_H1
   894 						
   895 58DD A5 AA				lda m_playerLevelBottomY_H2
   896 58DF E9 00				sbc #0
   897 58E1 85 A7				sta m_playerLevelTopY_H2
   898
   899 58E3 A5 A1				lda m_playerLevelLeftX_H2				; get left point char column
   900 58E5 8D CC 32				sta m_charBuffer_H2
   901 58E8 A5 A2				lda m_playerLevelLeftX_H1
   902
   903 58EA 4E CC 32				lsr m_charBuffer_H2						; /2
   904 58ED 6A					ror
   905 58EE 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
   906 58F1 6A					ror
   907
   908 58F2 A8					tay
   909 58F3 A5 A7				lda m_playerLevelTopY_H2				; get top char line	
   910 58F5 8D CC 32				sta m_charBuffer_H2
   911 58F8 A5 A8				lda m_playerLevelTopY_H1
   912
   913 58FA 4E CC 32				lsr m_charBuffer_H2						; /2
   914 58FD 6A					ror
   915 58FE 4E CC 32				lsr m_charBuffer_H2						; /4
   916 5901 6A					ror
   917 5902 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
   918 5905 6A					ror
   919
   920 5906 AA					tax
   921 5907 BD DB 32				lda TabLevelLineAddressLSB,x
   922 590A 85 E9				sta m_ptrLevelLine
   923 590C BD DB 33				lda TabLevelLineAddressMSB,x
   924 590F 85 EA				sta m_ptrLevelLine+1
   925
   926 5911 B1 E9				lda (m_ptrLevelLine),y
   927 5913 AA					tax
   928 5914 BD DB 34				lda TabCharDefinition,x
   929 5917 8D CA 32				sta m_leftTopChar
   930
   931 591A A5 AA				lda m_playerLevelBottomY_H2				; get bottom char line
   932 591C 8D CC 32				sta m_charBuffer_H2
   933 591F A5 AB				lda m_playerLevelBottomY_H1
   934
   935 5921 4E CC 32				lsr m_charBuffer_H2						; /2
   936 5924 6A					ror
   937 5925 4E CC 32				lsr m_charBuffer_H2						; /4
   938 5928 6A					ror
   939 5929 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
   940 592C 6A					ror
   941
   942 592D AA					tax
   943 592E BD DB 32				lda TabLevelLineAddressLSB,x
   944 5931 85 E9				sta m_ptrLevelLine
   945 						
   946 5933 BD DB 33				lda TabLevelLineAddressMSB,x
   947 5936 85 EA				sta m_ptrLevelLine+1
   948
   949 5938 B1 E9				lda (m_ptrLevelLine),y
   950 593A AA					tax
   951 						
   952 593B BD DB 34				lda TabCharDefinition,x
   953 593E 8D CD 32				sta m_leftBottomChar
   954
   955 5941 AD CA 32				lda m_leftTopChar						; fast collision check
   956 5944 29 0F				and #15
   957 5946 C9 01				cmp #CT_BLOCK
   958 5948 D0 07				bne CPLC_check_next_char
   959
   960 594A AD CA 32				lda m_leftTopChar
   961 594D 29 80				and #%10000000
   962 594F D0 10				bne CPLC_found_collision
   963
   964 				;**************************************************
   965 				;
   966 5951			CPLC_check_next_char
   967
   968 5951 AD CD 32				lda m_leftBottomChar
   969 5954 29 01				and #01
   970 5956 C9 01				cmp #CT_BLOCK
   971 5958 D0 1E				bne CPLC_exit
   972
   973 595A AD CD 32				lda m_leftBottomChar
   974 595D 29 80				and #%10000000
   975 595F F0 17				beq CPLC_exit
   976
   977 				;**************************************************
   978 				;
   979 5961			CPLC_found_collision
   980
   981 5961 A9 01				lda #1
   982 5963 85 D1				sta m_playerSideCollisionFlag
   983
   984 5965 A9 00				lda #0									; need to move the player to the right
   985 5967 85 A3				sta m_playerLevelLeftX_L1
   986
   987 5969 A5 A2				lda m_playerLevelLeftX_H1
   988 596B 29 FC				and #%11111100							; mask for CHAR_PIX.else_X
   989 596D 18					clc
   990 596E 69 04				adc #CHAR_PIX.else_X
   991 5970 85 A2				sta m_playerLevelLeftX_H1
   992 						
   993 5972 A5 A1				lda m_playerLevelLeftX_H2
   994 5974 69 00				adc #0
   995 5976 85 A1				sta m_playerLevelLeftX_H2
   996
   997 				;**************************************************
   998 				;
   999 5978			CPLC_exit	
  1000 5978 60					rts
  1001
  1002 				.endp	
  1003 				;
  1004 				;**************************************************************************************************
  1005 				; CheckPlayerRightCollision
  1006 				;**************************************************************************************************
  1007 				;
  1008 5979			.proc CheckPlayerRightCollision
  1009
  1010 5979 A5 AB				lda m_playerLevelBottomY_H1				; update top coordinate
  1011 597B 38					sec
  1012 597C E5 B4				sbc m_playerSizeYMinusOne
  1013 597E 85 A8				sta m_playerLevelTopY_H1
  1014 					
  1015 5980 A5 AA				lda m_playerLevelBottomY_H2
  1016 5982 E9 00				sbc #0
  1017 5984 85 A7				sta m_playerLevelTopY_H2
  1018
  1019 5986 A5 A2				lda m_playerLevelLeftX_H1				; update right coordinate
  1020 5988 18					clc
  1021 5989 65 B3				adc m_playerSizeXMinusOne
  1022 598B 85 A5				sta m_playerLevelRightX_H1
  1023 					
  1024 598D A5 A1				lda m_playerLevelLeftX_H2
  1025 598F 69 00				adc #0
  1026 5991 85 A4				sta m_playerLevelRightX_H2
  1027
  1028 5993 A5 A4				lda m_playerLevelRightX_H2				; get right point char column
  1029 5995 8D CC 32				sta m_charBuffer_H2
  1030 						
  1031 5998 A5 A5				lda m_playerLevelRightX_H1
  1032 599A 4E CC 32				lsr m_charBuffer_H2						; /2
  1033 599D 6A					ror
  1034 599E 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
  1035 59A1 6A					ror
  1036 59A2 A8					tay
  1037
  1038 59A3 A5 A7				lda m_playerLevelTopY_H2				; get top char line
  1039 59A5 8D CC 32				sta m_charBuffer_H2
  1040 					
  1041 59A8 A5 A8				lda m_playerLevelTopY_H1
  1042 59AA 4E CC 32				lsr m_charBuffer_H2						; /2
  1043 59AD 6A					ror
  1044 59AE 4E CC 32				lsr m_charBuffer_H2						; /4
  1045 59B1 6A					ror
  1046 59B2 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
  1047 59B5 6A					ror	
  1048
  1049 59B6 AA					tax
  1050 59B7 BD DB 32				lda TabLevelLineAddressLSB,x
  1051 59BA 85 E9				sta m_ptrLevelLine
  1052 					
  1053 59BC BD DB 33				lda TabLevelLineAddressMSB,x
  1054 59BF 85 EA				sta m_ptrLevelLine+1
  1055
  1056 59C1 B1 E9				lda (m_ptrLevelLine),y
  1057 59C3 AA					tax
  1058 					
  1059 59C4 BD DB 34				lda TabCharDefinition,x
  1060 59C7 8D CB 32				sta m_rightTopChar
  1061
  1062 59CA A5 AA				lda m_playerLevelBottomY_H2				; get bottom char line
  1063 59CC 8D CC 32				sta m_charBuffer_H2
  1064 59CF A5 AB				lda m_playerLevelBottomY_H1
  1065
  1066 59D1 4E CC 32				lsr m_charBuffer_H2						; /2
  1067 59D4 6A					ror
  1068 59D5 4E CC 32				lsr m_charBuffer_H2						; /4
  1069 59D8 6A					ror
  1070 59D9 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
  1071 59DC 6A					ror
  1072
  1073 59DD AA					tax
  1074 59DE BD DB 32				lda TabLevelLineAddressLSB,x
  1075 59E1 85 E9				sta m_ptrLevelLine
  1076 					
  1077 59E3 BD DB 33				lda TabLevelLineAddressMSB,x
  1078 59E6 85 EA				sta m_ptrLevelLine+1
  1079
  1080 59E8 B1 E9				lda (m_ptrLevelLine),y
  1081 59EA AA					tax	
  1082 59EB BD DB 34				lda TabCharDefinition,x
  1083 59EE 8D CE 32				sta m_rightBottomChar
  1084
  1085 59F1 AD CB 32				lda m_rightTopChar						; fast collision check
  1086 59F4 29 01				and #01
  1087 59F6 C9 01				cmp #CT_BLOCK
  1088 59F8 D0 07				bne CPRC_check_next_char
  1089
  1090 59FA AD CB 32				lda m_rightTopChar
  1091 59FD 29 40				and #%01000000
  1092 59FF D0 10				bne CPRC_found_collision
  1093
  1094 				;**************************************************
  1095 				;
  1096 5A01			CPRC_check_next_char
  1097 						
  1098 5A01 AD CE 32				lda m_rightBottomChar
  1099 5A04 29 01				and #01
  1100 5A06 C9 01				cmp #CT_BLOCK
  1101 5A08 D0 1E				bne CPRC_exit
  1102
  1103 5A0A AD CE 32				lda m_rightBottomChar
  1104 5A0D 29 40				and #%01000000
  1105 5A0F F0 17				beq CPRC_exit
  1106
  1107 				;**************************************************
  1108 				;
  1109 5A11			CPRC_found_collision
  1110 5A11 A9 01				lda #1
  1111 5A13 85 D1				sta m_playerSideCollisionFlag
  1112
  1113 5A15 A9 00				lda #0									; need to move the player to the left
  1114 5A17 85 A3				sta m_playerLevelLeftX_L1
  1115 					
  1116 5A19 A5 A5				lda m_playerLevelRightX_H1
  1117 5A1B 29 FC				and #%11111100							; mask for CHAR_PIX.else_X
  1118 5A1D 38					sec
  1119 5A1E E5 B1				sbc m_playerSizeX
  1120 5A20 85 A2				sta m_playerLevelLeftX_H1
  1121 					
  1122 5A22 A5 A4				lda m_playerLevelRightX_H2
  1123 5A24 E9 00				sbc #0
  1124 5A26 85 A1				sta m_playerLevelLeftX_H2
  1125
  1126 				;**************************************************
  1127 				;
  1128 5A28			CPRC_exit
  1129 5A28 60					rts
  1130 						
  1131 				.endp		
  1132 				;
  1133 				;**************************************************************************************************
  1134 				; AddSideAccelToSpeed
  1135 				;**************************************************************************************************
  1136 				;
  1137 5A29			.proc AddSideAccelToSpeed
  1138
  1139 5A29 A5 B6				lda m_playerSideSpeed_L1				; update frame speed with frame accel	
  1140 5A2B 18					clc
  1141 5A2C 65 BA				adc m_playerSideAccel_L1
  1142 5A2E 85 B6				sta m_playerSideSpeed_L1
  1143 						
  1144 5A30 A5 B5				lda m_playerSideSpeed_H1
  1145 5A32 65 B9				adc m_playerSideAccel_H1
  1146
  1147 				;**************************************************
  1148 				;
  1149 5A34			ASATS_entry_point
  1150 						
  1151 5A34 85 B5				sta m_playerSideSpeed_H1
  1152 5A36 C5 B7				cmp m_playerMaxSideSpeed_H1				; check max frame speed
  1153 5A38 90 10				bcc ASATS_exit							; lower than max speed
  1154 5A3A D0 06				bne ASATS_max_speed						; greater than max speed
  1155
  1156 5A3C A5 B8				lda m_playerMaxSideSpeed_L1				; need to check the low byte
  1157 5A3E C5 B6				cmp m_playerSideSpeed_L1
  1158 5A40 B0 08				bcs ASATS_exit							; lower or equal to max speed
  1159
  1160 				;**************************************************
  1161 				;
  1162 5A42			ASATS_max_speed									
  1163 						
  1164 5A42 A5 B7				lda m_playerMaxSideSpeed_H1				; is higher than the max speed
  1165 5A44 85 B5				sta m_playerSideSpeed_H1
  1166 						
  1167 5A46 A5 B8				lda m_playerMaxSideSpeed_L1
  1168 5A48 85 B6				sta m_playerSideSpeed_L1
  1169
  1170 				;**************************************************
  1171 				;
  1172 5A4A			ASATS_exit		
  1173 5A4A 60					rts
  1174
  1175 				.endp
  1176 				;
  1177 				;**************************************************************************************************
  1178 				; SubstractSideDeaccelToSpeed
  1179 				;**************************************************************************************************
  1180 				;
  1181 5A4B			SubstractSideDeaccelToSpeed
  1182
  1183 5A4B A5 B6				lda m_playerSideSpeed_L1					; update frame speed with frame accel
  1184 5A4D 38					sec
  1185 5A4E E5 BC				sbc m_playerSideDeaccel_L1
  1186 5A50 85 B6				sta m_playerSideSpeed_L1
  1187
  1188 5A52 A5 B5				lda m_playerSideSpeed_H1
  1189 5A54 E5 BB				sbc m_playerSideDeaccel_H1
  1190 5A56 B0 04				bcs SSDTS_dont_reset_speed
  1191
  1192 				;************************************************
  1193 				;
  1194 5A58			SSDTS_reset_speed
  1195 5A58 A9 00				lda #0
  1196 5A5A 85 B6				sta m_playerSideSpeed_L1
  1197
  1198 				;************************************************
  1199 				;
  1200 5A5C			SSDTS_dont_reset_speed
  1201 5A5C 85 B5				sta m_playerSideSpeed_H1
  1202
  1203 5A5E 60					rts	
  1204 				;
  1205 				;**************************************************************************************************
  1206 				; AddSideSpeedToPosition
  1207 				;**************************************************************************************************
  1208 				;
  1209 5A5F			.proc AddSideSpeedToPosition
  1210
  1211 5A5F A5 A3				lda m_playerLevelLeftX_L1				; update player side position
  1212 5A61 18					clc
  1213 5A62 65 B6				adc m_playerSideSpeed_L1
  1214 5A64 85 A3				sta m_playerLevelLeftX_L1
  1215 						
  1216 5A66 A5 A2				lda m_playerLevelLeftX_H1		
  1217 5A68 65 B5				adc m_playerSideSpeed_H1
  1218 5A6A 85 A2				sta m_playerLevelLeftX_H1
  1219 						
  1220 5A6C A5 A1				lda m_playerLevelLeftX_H2
  1221 5A6E 69 00				adc #0
  1222 5A70 85 A1				sta m_playerLevelLeftX_H2
  1223
  1224 5A72 A9 00				lda #0									; check collisions for a player moving to the right	
  1225 5A74 85 D1				sta m_playerSideCollisionFlag
  1226
  1227 5A76 20 AC 56				jsr CheckPlayerInLevelRightLimit		; check level right side limit
  1228 					
  1229 5A79 A5 D1				lda m_playerSideCollisionFlag
  1230 5A7B D0 07				bne ASSTP_found_collision
  1231
  1232 5A7D 20 79 59				jsr CheckPlayerRightCollision
  1233
  1234 5A80 A5 D1				lda m_playerSideCollisionFlag
  1235 5A82 F0 06				beq ASSTP_exit
  1236
  1237 				;************************************************
  1238 				;
  1239 5A84			ASSTP_found_collision
  1240 						
  1241 5A84 A9 00				lda #0
  1242 5A86 85 B5				sta m_playerSideSpeed_H1
  1243 5A88 85 B6				sta m_playerSideSpeed_L1
  1244
  1245 				;************************************************
  1246 				;
  1247 5A8A			ASSTP_exit
  1248 						
  1249 5A8A 60					rts
  1250
  1251 				.endp
  1252 				;
  1253 				;**************************************************************************************************
  1254 				; SubstractSideSpeedToPosition
  1255 				;**************************************************************************************************
  1256 				;
  1257 5A8B			.proc SubstractSideSpeedToPosition
  1258
  1259 5A8B A5 A3				lda m_playerLevelLeftX_L1	; update player side position
  1260 5A8D 38					sec
  1261 5A8E E5 B6				sbc m_playerSideSpeed_L1
  1262 5A90 85 A3				sta m_playerLevelLeftX_L1
  1263 						
  1264 5A92 A5 A2				lda m_playerLevelLeftX_H1
  1265 5A94 E5 B5				sbc m_playerSideSpeed_H1
  1266 5A96 85 A2				sta m_playerLevelLeftX_H1
  1267 						
  1268 5A98 A5 A1				lda m_playerLevelLeftX_H2
  1269 5A9A E9 00				sbc #0
  1270 5A9C 85 A1				sta m_playerLevelLeftX_H2
  1271
  1272 						; check collisions for a player moving to the left
  1273 5A9E B0 0B				bcs SSSTP_check_left_collision			; check level left side limit
  1274 5AA0 A9 00				lda #0
  1275 5AA2 85 A1				sta m_playerLevelLeftX_H2
  1276 5AA4 85 A2				sta m_playerLevelLeftX_H1
  1277 5AA6 85 A3				sta m_playerLevelLeftX_L1
  1278 5AA8 4C B6 5A				jmp SSSTP_found_collision
  1279
  1280 				;************************************************
  1281 				;
  1282 5AAB			SSSTP_check_left_collision
  1283 						
  1284 5AAB A9 00				lda #0
  1285 5AAD 85 D1				sta m_playerSideCollisionFlag
  1286
  1287 5AAF 20 D6 58				jsr CheckPlayerLeftCollision
  1288
  1289 5AB2 A5 D1				lda m_playerSideCollisionFlag
  1290 5AB4 F0 06				beq SSSTP_exit
  1291
  1292 				;************************************************
  1293 				;
  1294 5AB6			SSSTP_found_collision
  1295 						
  1296 5AB6 A9 00				lda #0
  1297 5AB8 85 B5				sta m_playerSideSpeed_H1
  1298 5ABA 85 B6				sta m_playerSideSpeed_L1
  1299
  1300 5ABC			SSSTP_exit
  1301 5ABC 60					rts
  1302 						
  1303 				.endp		
  1304 				;
  1305 				;**************************************************************************************************
  1306 				; AddGravityAccelToSpeed
  1307 				;**************************************************************************************************
  1308 				;
  1309 5ABD			.proc AddGravityAccelToSpeed
  1310
  1311 5ABD A5 BE				lda m_playerSpeedY_L1					; update frame speed with frame accel
  1312 5ABF 18					clc
  1313 5AC0 65 C4				adc m_playerGravityAccel_L1
  1314 5AC2 85 BE				sta m_playerSpeedY_L1
  1315 						
  1316 5AC4 A5 BD				lda m_playerSpeedY_H1
  1317 5AC6 65 C3				adc m_playerGravityAccel_H1
  1318 5AC8 85 BD				sta m_playerSpeedY_H1
  1319
  1320 5ACA C5 C1				cmp m_playerMaxFallSpeed_H1				; check max frame speed
  1321 5ACC 90 10				bcc AGATS_exit							; lower than max speed
  1322 5ACE D0 06				bne AGATS_max_speed						; greater than max speed
  1323
  1324 5AD0 A5 C2				lda m_playerMaxFallSpeed_L1				; need to check the low byte
  1325 5AD2 C5 BE				cmp m_playerSpeedY_L1
  1326 5AD4 B0 08				bcs AGATS_exit							; lower or equal to max speed
  1327
  1328 				;************************************************
  1329 				;
  1330 5AD6			AGATS_max_speed			
  1331
  1332 5AD6 A5 C1				lda m_playerMaxFallSpeed_H1				; is higher than the max speed
  1333 5AD8 85 BD				sta m_playerSpeedY_H1
  1334 						
  1335 5ADA A5 C2				lda m_playerMaxFallSpeed_L1
  1336 5ADC 85 BE				sta m_playerSpeedY_L1
  1337
  1338 				;************************************************
  1339 				;
  1340 5ADE			AGATS_exit
  1341 5ADE 60					rts
  1342 						
  1343 				.endp		
  1344 				;
  1345 				;**************************************************************************************************
  1346 				; SubstractGravityAccelToSpeed
  1347 				;**************************************************************************************************
  1348 				;
  1349 5ADF			.proc SubstractGravityAccelToSpeed
  1350 						
  1351 5ADF A5 BE				lda m_playerSpeedY_L1					; update frame speed with frame accel
  1352 5AE1 38					sec
  1353 5AE2 E5 C4				sbc m_playerGravityAccel_L1
  1354 5AE4 85 BE				sta m_playerSpeedY_L1
  1355 						
  1356 5AE6 A5 BD				lda m_playerSpeedY_H1
  1357 5AE8 E5 C3				sbc m_playerGravityAccel_H1
  1358 5AEA B0 04				bcs SGATS_dont_reset_speed
  1359
  1360 				;************************************************
  1361 				;
  1362 5AEC			SGATS_reset_speed
  1363 5AEC A9 00				lda #0
  1364 5AEE 85 BE				sta m_playerSpeedY_L1
  1365
  1366 				;************************************************
  1367 				;
  1368 5AF0			SGATS_dont_reset_speed
  1369 5AF0 85 BD				sta m_playerSpeedY_H1
  1370 5AF2 60					rts
  1371
  1372 				.endp
  1373 				;
  1374 				;**************************************************************************************************
  1375 				; AddSpeedYToPosition
  1376 				;**************************************************************************************************
  1377 				;
  1378 5AF3			.proc AddSpeedYToPosition
  1379
  1380 5AF3 A5 AC				lda m_playerLevelBottomY_L1				; update player position in Y
  1381 5AF5 18					clc
  1382 5AF6 65 BE				adc m_playerSpeedY_L1
  1383 5AF8 85 AC				sta m_playerLevelBottomY_L1
  1384 						
  1385 5AFA A5 AB				lda m_playerLevelBottomY_H1
  1386 5AFC 65 BD				adc m_playerSpeedY_H1
  1387 5AFE 85 AB				sta m_playerLevelBottomY_H1
  1388 						
  1389 5B00 A5 AA				lda m_playerLevelBottomY_H2
  1390 5B02 69 00				adc #0
  1391 5B04 85 AA				sta m_playerLevelBottomY_H2
  1392
  1393 5B06 A9 00				lda #0									; check collisions for a player moving down
  1394 5B08 85 CF				sta m_playerOverPlatformFlag
  1395
  1396 5B0A 20 DB 56				jsr CheckPlayerInLevelBottomLimit		; check level bottom limit collision
  1397
  1398 5B0D A5 CF				lda m_playerOverPlatformFlag
  1399 5B0F D0 03				bne ASYTP_exit
  1400
  1401 5B11 20 92 57				jsr CheckPlayerBottomCollision			; check collision with the top of a platform
  1402
  1403 				;************************************************
  1404 				;
  1405 5B14			ASYTP_exit
  1406 5B14 60					rts
  1407 						
  1408 				.endp		
  1409 				;
  1410 				;**************************************************************************************************
  1411 				; SubstractSpeedYToPosition
  1412 				;**************************************************************************************************
  1413 				;
  1414 5B15			.proc SubstractSpeedYToPosition
  1415
  1416 5B15 A5 AC				lda m_playerLevelBottomY_L1				; update player position in Y
  1417 5B17 38					sec
  1418 5B18 E5 BE				sbc m_playerSpeedY_L1
  1419 5B1A 85 AC				sta m_playerLevelBottomY_L1
  1420 5B1C A5 AB				lda m_playerLevelBottomY_H1
  1421 5B1E E5 BD				sbc m_playerSpeedY_H1
  1422 5B20 85 AB				sta m_playerLevelBottomY_H1
  1423 5B22 A5 AA				lda m_playerLevelBottomY_H2
  1424 5B24 E9 00				sbc #0
  1425 5B26 85 AA				sta m_playerLevelBottomY_H2
  1426
  1427 5B28 A5 AB				lda m_playerLevelBottomY_H1				; update top coordinate
  1428 5B2A 38					sec
  1429 5B2B E5 B4				sbc m_playerSizeYMinusOne
  1430 5B2D 85 A8				sta m_playerLevelTopY_H1
  1431 5B2F A5 AA				lda m_playerLevelBottomY_H2
  1432 5B31 E9 00				sbc #0
  1433 5B33 85 A7				sta m_playerLevelTopY_H2
  1434
  1435 5B35 B0 0D				bcs SSYTP_check_platform_bottom			; check collisions for a player moving up check level top limit collision
  1436
  1437 5B37 A9 00				lda #0
  1438 5B39 85 AC				sta m_playerLevelBottomY_L1
  1439 5B3B 85 AA				sta m_playerLevelBottomY_H2
  1440
  1441 5B3D A5 B4				lda m_playerSizeYMinusOne
  1442 5B3F 85 AB				sta m_playerLevelBottomY_H1
  1443
  1444 5B41 4C 4F 5B				jmp SSYTP_found_collision
  1445
  1446 5B44			SSYTP_check_platform_bottom
  1447 					
  1448 5B44 A9 00				lda #0									; check collision with the bottom of a platform
  1449 5B46 85 D0				sta m_playerTopCollisionFlag
  1450
  1451 5B48 20 27 58				jsr CheckPlayerTopCollision
  1452
  1453 5B4B A5 D0				lda m_playerTopCollisionFlag
  1454 5B4D F0 06				beq SSYTP_exit
  1455
  1456 5B4F			SSYTP_found_collision
  1457 5B4F A9 00				lda #0
  1458 5B51 85 BD				sta m_playerSpeedY_H1
  1459 5B53 85 BE				sta m_playerSpeedY_L1
  1460
  1461 5B55			SSYTP_exit
  1462 5B55 60					rts
  1463
  1464 				.endp		
  1465 				;
  1466 				;**************************************************************************************************
  1467 				; AddWaterAccelToSpeed
  1468 				;**************************************************************************************************
  1469 				;
  1470 5B56			.proc AddWaterAccelToSpeed
  1471
  1472 5B56 A5 BE				lda m_playerSpeedY_L1					; update frame speed with frame accel
  1473 5B58 18					clc
  1474 5B59 65 C6				adc m_playerWaterAccelY_L1
  1475 5B5B 85 BE				sta m_playerSpeedY_L1
  1476 5B5D A5 BD				lda m_playerSpeedY_H1
  1477 5B5F 65 C5				adc m_playerWaterAccelY_H1
  1478 5B61 85 BD				sta m_playerSpeedY_H1
  1479
  1480
  1481 5B63 C5 C7				cmp m_playerMaxWaterSpeedY_H1			; check max frame speed
  1482 5B65 90 10				bcc AWATS_exit							; lower than max speed
  1483 5B67 D0 06				bne AWATS_max_speed						; greater than max speed
  1484
  1485 					
  1486 5B69 A5 C8				lda m_playerMaxWaterSpeedY_L1			; need to check the low byte
  1487 5B6B C5 BE				cmp m_playerSpeedY_L1
  1488 5B6D B0 08				bcs AWATS_exit							; lower or equal to max speed
  1489
  1490 				;************************************************
  1491 				;
  1492 5B6F			AWATS_max_speed			
  1493
  1494 5B6F A5 C7				lda m_playerMaxWaterSpeedY_H1			; is higher than the max speed
  1495 5B71 85 BD				sta m_playerSpeedY_H1
  1496 5B73 A5 C8				lda m_playerMaxWaterSpeedY_L1
  1497 5B75 85 BE				sta m_playerSpeedY_L1
  1498
  1499 				;************************************************
  1500 				;
  1501 5B77			AWATS_exit
  1502 5B77 60					rts
  1503 					
  1504 				.endp	
  1505 				;
  1506 				;**************************************************************************************************
  1507 				; SubstractWaterAccelToSpeed
  1508 				;**************************************************************************************************
  1509 				;
  1510 5B78			.proc SubstractWaterAccelToSpeed
  1511
  1512 5B78 A5 BE				lda m_playerSpeedY_L1					; update frame speed with frame accel
  1513 5B7A 38					sec
  1514 5B7B E5 C6				sbc m_playerWaterAccelY_L1
  1515 5B7D 85 BE				sta m_playerSpeedY_L1
  1516 5B7F A5 BD				lda m_playerSpeedY_H1
  1517 5B81 E5 C5				sbc m_playerWaterAccelY_H1
  1518 5B83 B0 04				bcs SWATS_dont_reset_speed
  1519
  1520 				;************************************************
  1521 				;
  1522 5B85			SWATS_reset_speed
  1523 5B85 A9 00				lda #0
  1524 5B87 85 BE				sta m_playerSpeedY_L1
  1525
  1526 				;************************************************
  1527 				;
  1528 5B89			SWATS_dont_reset_speed
  1529 5B89 85 BD				sta m_playerSpeedY_H1
  1530
  1531 5B8B 60					rts
  1532 						
  1533 				.endp		
  1534 				;
  1535 				;**************************************************************************************************
  1536 				; AddWaterMoveUpAccelToSpeed
  1537 				;**************************************************************************************************
  1538 				;
  1539 5B8C			.proc AddWaterMoveUpAccelToSpeed
  1540
  1541 5B8C A5 BE				lda m_playerSpeedY_L1					; update frame speed with frame accel
  1542 5B8E 18					clc
  1543 5B8F 65 C6				adc m_playerWaterAccelY_L1
  1544 5B91 85 BE				sta m_playerSpeedY_L1
  1545 5B93 A5 BD				lda m_playerSpeedY_H1
  1546 5B95 65 C5				adc m_playerWaterAccelY_H1
  1547 5B97 85 BD				sta m_playerSpeedY_H1
  1548
  1549 5B99 C5 C9				cmp m_playerMoveWaterSpeedY_H1			; check max frame speed
  1550 5B9B 90 10				bcc AWMUATS_exit						; lower than max speed
  1551 5B9D D0 06				bne AWMUATS_max_speed					; greater than max speed
  1552
  1553 5B9F A5 CA				lda m_playerMoveWaterSpeedY_L1			; need to check the low byte
  1554 5BA1 C5 BE				cmp m_playerSpeedY_L1
  1555 5BA3 B0 08				bcs AWMUATS_exit						; lower or equal to max speed
  1556
  1557 				;************************************************
  1558 				;
  1559 5BA5			AWMUATS_max_speed								; is higher than the max speed
  1560 						
  1561 5BA5 A5 C9				lda m_playerMoveWaterSpeedY_H1
  1562 5BA7 85 BD				sta m_playerSpeedY_H1
  1563 5BA9 A5 CA				lda m_playerMoveWaterSpeedY_L1
  1564 5BAB 85 BE				sta m_playerSpeedY_L1
  1565
  1566 				;************************************************
  1567 				;
  1568 5BAD			AWMUATS_exit
  1569 5BAD 60					rts
  1570
  1571 				.endp	
  1572 				;
  1573 				;**************************************************************************************************
  1574 				; AddWaterMoveDownAccelToSpeed
  1575 				;**************************************************************************************************
  1576 				;
  1577 5BAE			.proc AddWaterMoveDownAccelToSpeed
  1578
  1579 5BAE A5 C7				lda m_playerMaxWaterSpeedY_H1			; check max frame speed
  1580 5BB0 C5 BD				cmp m_playerSpeedY_H1
  1581 5BB2 90 29				bcc AWMAATS_exit						; greater than max speed, exit
  1582 5BB4 D0 06				bne AWMAATS_add							; lower than the max, continue with the add
  1583
  1584 5BB6 A5 BE				lda m_playerSpeedY_L1					; need to check the low byte
  1585 5BB8 C5 C8				cmp m_playerMaxWaterSpeedY_L1
  1586 5BBA B0 21				bcs AWMAATS_exit						; greater or equal to max speed, exit
  1587
  1588 				;************************************************
  1589 				;
  1590 5BBC			AWMAATS_add
  1591
  1592 5BBC A5 BE				lda m_playerSpeedY_L1					; update frame speed with frame accel
  1593 5BBE 18					clc
  1594 5BBF 65 C6				adc m_playerWaterAccelY_L1
  1595 5BC1 85 BE				sta m_playerSpeedY_L1
  1596 5BC3 A5 BD				lda m_playerSpeedY_H1
  1597 5BC5 65 C5				adc m_playerWaterAccelY_H1
  1598 5BC7 85 BD				sta m_playerSpeedY_H1
  1599
  1600 5BC9 C5 C7				cmp m_playerMaxWaterSpeedY_H1			; check max frame speed
  1601 5BCB 90 10				bcc AWMAATS_exit						; lower than max speed
  1602 5BCD D0 06				bne AWMAATS_max_speed					; greater than max speed
  1603
  1604 5BCF A5 C8				lda m_playerMaxWaterSpeedY_L1			; need to check the low byte
  1605 5BD1 C5 BE				cmp m_playerSpeedY_L1
  1606 5BD3 B0 08				bcs AWMAATS_exit						; lower or equal to max speed
  1607
  1608 				;************************************************
  1609 				;
  1610 5BD5			AWMAATS_max_speed			
  1611 5BD5 A5 C7				lda m_playerMaxWaterSpeedY_H1			; is higher than the max speed
  1612 5BD7 85 BD				sta m_playerSpeedY_H1
  1613 5BD9 A5 C8				lda m_playerMaxWaterSpeedY_L1
  1614 5BDB 85 BE				sta m_playerSpeedY_L1
  1615
  1616 				;************************************************
  1617 				;
  1618 5BDD			AWMAATS_exit
  1619 						
  1620 5BDD 60					rts
  1621 					
  1622 				.endp	
  1623 				;
  1624 				;**************************************************************************************************
  1625 				; CheckPlayerBottomDownPos
  1626 				;**************************************************************************************************
  1627 				;
  1628 5BDE			.proc CheckPlayerBottomDownPos
  1629
  1630 5BDE A5 AA				lda m_playerLevelBottomY_H2				; get bottom char line
  1631 5BE0 8D CC 32				sta m_charBuffer_H2
  1632
  1633 5BE3 A5 AB				lda m_playerLevelBottomY_H1
  1634 5BE5 18					clc
  1635 5BE6 6D D1 32				adc m_bottomPosOffsetY
  1636 5BE9 90 03				bcc CPBDP_offset_no_carry
  1637 5BEB EE CC 32				inc m_charBuffer_H2
  1638
  1639 				;************************************************
  1640 				;
  1641 5BEE			CPBDP_offset_no_carry
  1642 5BEE 4E CC 32				lsr m_charBuffer_H2						; /2
  1643 5BF1 6A					ror
  1644 5BF2 4E CC 32				lsr m_charBuffer_H2						; /4
  1645 5BF5 6A					ror
  1646 5BF6 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
  1647 5BF9 6A					ror
  1648
  1649 5BFA AA					tax
  1650 5BFB BD DB 32				lda TabLevelLineAddressLSB,x
  1651 5BFE 85 E9				sta m_ptrLevelLine
  1652 						
  1653 5C00 BD DB 33				lda TabLevelLineAddressMSB,x
  1654 5C03 85 EA				sta m_ptrLevelLine+1
  1655 					
  1656 5C05 A5 A1				lda m_playerLevelLeftX_H2				; get left to right point char column
  1657 5C07 8D CC 32				sta m_charBuffer_H2
  1658
  1659 5C0A A5 A2				lda m_playerLevelLeftX_H1
  1660 5C0C 18					clc
  1661 5C0D 6D D0 32				adc m_bottomPosOffsetX
  1662 5C10 90 03				bcc CPBDP_no_carry
  1663 5C12 EE CC 32				inc m_charBuffer_H2
  1664 					
  1665 				;************************************************
  1666 				;
  1667 5C15			CPBDP_no_carry
  1668
  1669 5C15 4E CC 32				lsr m_charBuffer_H2						; /2
  1670 5C18 6A					ror
  1671 5C19 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
  1672 5C1C 6A					ror
  1673
  1674 5C1D A8					tay
  1675 5C1E 8C D3 32				sty m_middleBottomCharPosX
  1676 5C21 B1 E9				lda (m_ptrLevelLine),y
  1677 5C23 AA					tax
  1678 5C24 BD DB 34				lda TabCharDefinition,x
  1679 5C27 8D CF 32				sta m_middleBottomChar
  1680
  1681 5C2A 60					rts
  1682 					
  1683 				.endp	
  1684 				;
  1685 				;**************************************************************************************************
  1686 				; CheckPlayerBottomUpPos
  1687 				;**************************************************************************************************
  1688 				;
  1689 5C2B			.proc CheckPlayerBottomUpPos
  1690
  1691 5C2B A5 AA				lda m_playerLevelBottomY_H2				; get bottom char line
  1692 5C2D 8D CC 32				sta m_charBuffer_H2
  1693
  1694 5C30 A5 AB				lda m_playerLevelBottomY_H1
  1695 5C32 38					sec
  1696 5C33 ED D1 32				sbc m_bottomPosOffsetY
  1697 5C36 B0 03				bcs CPBUP_offset_no_carry
  1698 5C38 CE CC 32				dec m_charBuffer_H2
  1699
  1700 				;************************************************
  1701 				;
  1702 5C3B			CPBUP_offset_no_carry
  1703
  1704 5C3B 4E CC 32				lsr m_charBuffer_H2						; /2
  1705 5C3E 6A					ror
  1706 5C3F 4E CC 32				lsr m_charBuffer_H2						; /4
  1707 5C42 6A					ror
  1708 5C43 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIX.else_Y
  1709 5C46 6A					ror
  1710
  1711 5C47 AA					tax
  1712 5C48 BD DB 32				lda TabLevelLineAddressLSB,x
  1713 5C4B 85 E9				sta m_ptrLevelLine
  1714 					
  1715 5C4D BD DB 33				lda TabLevelLineAddressMSB,x
  1716 5C50 85 EA				sta m_ptrLevelLine+1
  1717
  1718 5C52 A5 A1				lda m_playerLevelLeftX_H2				; get left to right point char column
  1719 5C54 8D CC 32				sta m_charBuffer_H2
  1720
  1721 5C57 A5 A2				lda m_playerLevelLeftX_H1
  1722 5C59 18					clc
  1723 5C5A 6D D0 32				adc m_bottomPosOffsetX
  1724 5C5D 90 03				bcc CPBUP_no_carry
  1725 5C5F EE CC 32				inc m_charBuffer_H2
  1726
  1727 				;************************************************
  1728 				;
  1729 5C62			CPBUP_no_carry
  1730
  1731 5C62 4E CC 32				lsr m_charBuffer_H2						; /2
  1732 5C65 6A					ror
  1733 5C66 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIX.else_X
  1734 5C69 6A					ror
  1735
  1736 5C6A A8					tay
  1737 5C6B 8C D3 32				sty m_middleBottomCharPosX
  1738 5C6E B1 E9				lda (m_ptrLevelLine),y
  1739 5C70 AA					tax
  1740 5C71 BD DB 34				lda TabCharDefinition,x
  1741 5C74 8D CF 32				sta m_middleBottomChar
  1742
  1743 5C77 60					rts
  1744
  1745 				.endp	
   335 5C78					icl "MissileSystem.Asm"	
Source: E:\_8BitProjects\Series\Scroller\MissileSystem.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		MissileSystem.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Missle Storage
    15 				;**************************************************************************************************
    16 				;
    17 = 00FC			CLEAR_MASK_M0 				= %11111100
    18 = 00F3			CLEAR_MASK_M1 				= %11110011
    19 = 00CF			CLEAR_MASK_M2 				= %11001111
    20 = 003F			CLEAR_MASK_M3 				= %00111111
    21
    22 = 0003			SET_MASK_M0 				= %00000011
    23 = 000C			SET_MASK_M1 				= %00001100
    24 = 0030			SET_MASK_M2 				= %00110000
    25 = 00C0			SET_MASK_M3 				= %11000000
    26
    27 = 0002			SET_MASK_M0_R_L1 			= %00000010
    28 = 0001			SET_MASK_M0_R_L2 			= %00000001
    29 = 0002			SET_MASK_M0_R_L3 			= %00000010
    30 = 0001			SET_MASK_M0_L_L1 			= %00000001
    31 = 0002			SET_MASK_M0_L_L2 			= %00000010
    32 = 0001			SET_MASK_M0_L_L3 			= %00000001
    33
    34 = 0008			SET_MASK_M1_R_L1 			= %00001000
    35 = 0004			SET_MASK_M1_R_L2 			= %00000100
    36 = 0008			SET_MASK_M1_R_L3 			= %00001000
    37 = 0004			SET_MASK_M1_L_L1 			= %00000100
    38 = 0008			SET_MASK_M1_L_L2 			= %00001000
    39 = 0004			SET_MASK_M1_L_L3 			= %00000100
    40
    41 = 0020			SET_MASK_M2_R_L1 			= %00100000
    42 = 0010			SET_MASK_M2_R_L2 			= %00010000
    43 = 0020			SET_MASK_M2_R_L3 			= %00100000
    44 = 0010			SET_MASK_M2_L_L1 			= %00010000
    45 = 0020			SET_MASK_M2_L_L2 			= %00100000
    46 = 0010			SET_MASK_M2_L_L3 			= %00010000
    47
    48 = 0080			SET_MASK_M3_R_L1 			= %10000000
    49 = 0040			SET_MASK_M3_R_L2 			= %01000000
    50 = 0080			SET_MASK_M3_R_L3 			= %10000000
    51 = 0040			SET_MASK_M3_L_L1 			= %01000000
    52 = 0080			SET_MASK_M3_L_L2 			= %10000000
    53 = 0040			SET_MASK_M3_L_L3 			= %01000000
    54
    55 				; virtual missiles tables
    56 = 0004			MAX_VIRTUAL_MISSILES = 4
    57
    58 5C78 FC F3 CF 3F		TabClearMissileMask			.byte CLEAR_MASK_M0, CLEAR_MASK_M1, CLEAR_MASK_M2, CLEAR_MASK_M3
    59
    60 5C7C 02 08 20 80		TabSetMissileToRightMaskL1	.byte SET_MASK_M0_R_L1, SET_MASK_M1_R_L1, SET_MASK_M2_R_L1, SET_MASK_M3_R_L1
    61
    62 5C80 01 04 10 40		TabSetMissileToRightMaskL2	.byte SET_MASK_M0_R_L2, SET_MASK_M1_R_L2, SET_MASK_M2_R_L2, SET_MASK_M3_R_L2
    63
    64 5C84 02 08 20 80		TabSetMissileToRightMaskL3	.byte SET_MASK_M0_R_L3, SET_MASK_M1_R_L3, SET_MASK_M2_R_L3, SET_MASK_M3_R_L3
    65
    66 5C88 01 04 10 40		TabSetMissileToLeftMaskL1	.byte SET_MASK_M0_L_L1, SET_MASK_M1_L_L1, SET_MASK_M2_L_L1, SET_MASK_M3_L_L1
    67
    68 5C8C 02 08 20 80		TabSetMissileToLeftMaskL2	.byte SET_MASK_M0_L_L2, SET_MASK_M1_L_L2, SET_MASK_M2_L_L2, SET_MASK_M3_L_L2
    69
    70 5C90 01 04 10 40		TabSetMissileToLeftMaskL3	.byte SET_MASK_M0_L_L3, SET_MASK_M1_L_L3, SET_MASK_M2_L_L3, SET_MASK_M3_L_L3
    71
    72 5C94 08 31 5A 97		TabDrawMissileMethodLSB		.byte <DrawMissileM0, <DrawMissileM1, <DrawMissileM2, <DrawMissileM3
    73
    74 5C98 5F 5F 5F 5F		TabDrawMissileMethodMSB		.byte >DrawMissileM0, >DrawMissileM1, >DrawMissileM2, >DrawMissileM3
    75
    76 5C9C 00			m_currentVirtualMissiles 	.byte 0
    77
    78 5C9D 00 00 00 00		TabMissileScreenLeftX		:MAX_VIRTUAL_MISSILES .byte 0
    79
    80 5CA1 00 00 00 00		TabMissileScreenTopY		:MAX_VIRTUAL_MISSILES .byte 0
    81
    82 5CA5 00 00 00 00		TabOldMissileScreenLeftX	:MAX_VIRTUAL_MISSILES .byte 0
    83
    84 5CA9 00 00 00 00		TabOldMissileScreenTopY		:MAX_VIRTUAL_MISSILES .byte 0
    85
    86 5CAD 00 00 00 00		TabMissileLevelLeftX_H2		:MAX_VIRTUAL_MISSILES .byte 0
    87
    88 5CB1 00 00 00 00		TabMissileLevelLeftX_H1		:MAX_VIRTUAL_MISSILES .byte 0
    89
    90 5CB5 00 00 00 00		TabMissileLevelLeftX_L1		:MAX_VIRTUAL_MISSILES .byte 0
    91
    92 5CB9 00 00 00 00		TabMissileLevelTopY_H2		:MAX_VIRTUAL_MISSILES .byte 0
    93
    94 5CBD 00 00 00 00		TabMissileLevelTopY_H1		:MAX_VIRTUAL_MISSILES .byte 0
    95
    96 5CC1 00 00 00 00		TabMissileLevelTopY_L1		:MAX_VIRTUAL_MISSILES .byte 0
    97
    98 5CC5 00 00 00 00		TabMissileSpeedX_H1			:MAX_VIRTUAL_MISSILES .byte 0
    99
   100 5CC9 00 00 00 00		TabMissileSpeedX_L1			:MAX_VIRTUAL_MISSILES .byte 0
   101
   102 5CCD 00 00 00 00		TabMissileDirection			:MAX_VIRTUAL_MISSILES .byte 0
   103
   104 5CD1 00 00 00 00		TabMissileFrameCounter_H2	:MAX_VIRTUAL_MISSILES .byte 0
   105
   106 5CD5 00 00 00 00		TabMissileFrameCounter_H1	:MAX_VIRTUAL_MISSILES .byte 0
   107
   108 5CD9 00 00 00 00		TabMissileOwner				:MAX_VIRTUAL_MISSILES .byte 0
   109
   110 				;
   111 				;**************************************************************************************************
   112 				;	CheckCreatePlayerMissile	
   113 				;**************************************************************************************************
   114 				;
   115 5CDD			.proc CheckCreatePlayerMissile
   116
   117 5CDD A5 E1				lda m_triggerState
   118 5CDF C9 02				cmp #2									; check just pressed
   119 5CE1 D0 4D				bne CCPM_exit
   120
   121 5CE3 20 78 5D				jsr GetFreeMissileIndex
   122 5CE6 E0 02				cpx #2									; only use index 0 and 1 for the player missiles
   123 5CE8 B0 46				bcs CCPM_exit
   124 					
   125 5CEA A9 02				lda #>[PLAYER_MISSILE_SPEED_X]
   126 5CEC 9D C5 5C				sta TabMissileSpeedX_H1,x
   127 5CEF A9 80				lda #<[PLAYER_MISSILE_SPEED_X]
   128 5CF1 9D C9 5C				sta TabMissileSpeedX_L1,x
   129
   130 5CF4 A5 CE				lda m_lastPlayerShootDirection
   131 5CF6 C9 01				cmp #PSD_RIGHT
   132 5CF8 F0 08				beq CCPM_shoot_right
   133
   134 5CFA			CCPM_shoot_left
   135
   136 5CFA A9 02				lda #2
   137 5CFC 9D CD 5C				sta TabMissileDirection,x
   138
   139 5CFF 4C 07 5D				jmp CCPM_init_position
   140
   141 5D02			CCPM_shoot_right
   142 					
   143 5D02 A9 01				lda #1
   144 5D04 9D CD 5C				sta TabMissileDirection,x
   145
   146 5D07			CCPM_init_position
   147 					
   148 5D07 A5 A2				lda m_playerLevelLeftX_H1
   149 5D09 9D B1 5C				sta TabMissileLevelLeftX_H1,x
   150 					
   151 5D0C A5 A1				lda m_playerLevelLeftX_H2
   152 5D0E 9D AD 5C				sta TabMissileLevelLeftX_H2,x
   153
   154 5D11 A5 A8				lda m_playerLevelTopY_H1
   155 5D13 18					clc
   156 5D14 69 02				adc #2
   157 5D16 9D BD 5C				sta TabMissileLevelTopY_H1,x
   158 					
   159 5D19 A5 A7				lda m_playerLevelTopY_H2
   160 5D1B 69 00				adc #0
   161 5D1D 9D B9 5C				sta TabMissileLevelTopY_H2,x
   162
   163 5D20 A9 00				lda #0
   164 5D22 9D B5 5C				sta TabMissileLevelLeftX_L1,x
   165 5D25 9D C1 5C				sta TabMissileLevelTopY_L1,x
   166
   167 5D28 A9 01				lda #1									; player owner
   168 5D2A 9D D9 5C				sta TabMissileOwner,x
   169
   170 						; before this, call GetFreeMissileIndex and then init..
   171 5D2D 20 87 5D				jsr CreateMissile
   172
   173 5D30			CCPM_exit
   174 						
   175 5D30 60					rts
   176
   177 				.endp
   178
   179 				;
   180 				;**************************************************************************************************
   181 				;	CheckCreateEnemyMissile	
   182 				;**************************************************************************************************
   183 				;
   184 5D31			.proc CheckCreateEnemyMissile
   185
   186 						; check for a free missile index
   187 5D31 A2 02				ldx #2
   188 5D33 BD D9 5C				lda TabMissileOwner,x
   189 5D36 F0 07				beq CCEM_found_one_free
   190 					
   191 5D38 A2 03				ldx #3
   192 5D3A BD D9 5C				lda TabMissileOwner,x
   193 5D3D D0 38				bne CCEM_exit
   194 					
   195 5D3F			CCEM_found_one_free
   196 						
   197 5D3F A9 02				lda #>[ENEMY_MISSILE_SPEED_X]
   198 5D41 9D C5 5C				sta TabMissileSpeedX_H1,x
   199 						
   200 5D44 A9 00				lda #<[ENEMY_MISSILE_SPEED_X]
   201 5D46 9D C9 5C				sta TabMissileSpeedX_L1,x
   202 					
   203 5D49 AD A9 32				lda m_enemyShootDirection
   204 5D4C 9D CD 5C				sta TabMissileDirection,x
   205
   206 						; init position
   207 5D4F AD AA 32				lda m_enemyShotLevelLeftX_H1
   208 5D52 9D B1 5C				sta TabMissileLevelLeftX_H1,x
   209 						
   210 5D55 AD AB 32				lda m_enemyShotLevelLeftX_H2
   211 5D58 9D AD 5C				sta TabMissileLevelLeftX_H2,x
   212
   213 5D5B AD AC 32				lda m_enemyShotLevelTopY_H1
   214 5D5E 9D BD 5C				sta TabMissileLevelTopY_H1,x
   215 					
   216 5D61 AD AD 32				lda m_enemyShotLevelTopY_H2
   217 5D64 9D B9 5C				sta TabMissileLevelTopY_H2,x
   218
   219 5D67 A9 00				lda #0
   220 5D69 9D B5 5C				sta TabMissileLevelLeftX_L1,x
   221 5D6C 9D C1 5C				sta TabMissileLevelTopY_L1,x
   222
   223 5D6F A9 02				lda #2									; enemy owner
   224 5D71 9D D9 5C				sta TabMissileOwner,x
   225
   226 5D74 20 87 5D				jsr CreateMissile
   227
   228 5D77			CCEM_exit
   229
   230 5D77 60					rts
   231 					
   232 				.endp
   233
   234 				;
   235 				;**************************************************************************************************
   236 				;	GetFreeMissileIndex	
   237 				;**************************************************************************************************
   238 				;
   239 5D78			.proc GetFreeMissileIndex
   240
   241 						; return in X the index of the free virtual missile
   242 5D78 A2 00				ldx #0
   243
   244 5D7A			GFMI_loop
   245 5D7A BD D9 5C				lda TabMissileOwner,x	; if the owner is 0, the slot is free
   246 5D7D F0 07				beq GFMI_exit
   247
   248 5D7F E8					inx
   249 5D80 E0 04				cpx #MAX_VIRTUAL_MISSILES
   250 5D82 D0 F6				bne GFMI_loop
   251
   252 5D84 A2 FF				ldx #255		; value for: "there is no free index"
   253
   254 5D86			GFMI_exit
   255 						
   256 5D86 60					rts
   257
   258 				.endp
   259
   260 				;
   261 				;**************************************************************************************************
   262 				;	CreateMissile	
   263 				;
   264 				; 		before this, call GetFreeMissileIndex and then init:
   265 				; 		TabMissileLevelLeftX_H2/H1/L1, TabMissileLevelTopY_H2/H1/L1,
   266 				; 		TabMissileSpeedX_H1/L1 (negative if going to the left)
   267 				; 		and TabMissileOwner (different than 0)
   268 				;
   269 				;**************************************************************************************************
   270 				;
   271 5D87			.proc CreateMissile
   272
   273 						; use X as a parameter (the index of the virtual missile)
   274 5D87 A9 00				lda #0
   275 5D89 9D D1 5C				sta TabMissileFrameCounter_H2,x
   276 5D8C 9D D5 5C				sta TabMissileFrameCounter_H1,x
   277
   278 5D8F 20 9C 5E				jsr SetMissileScreenPos
   279
   280 						; maybe should check screen position before creating the missile
   281 5D92 20 F4 5E				jsr DrawMissileMX
   282 5D95 EE 9C 5C				inc m_currentVirtualMissiles
   283
   284 5D98 60					rts
   285 						
   286 				.endp
   287
   288 				;
   289 				;**************************************************************************************************
   290 				;	UpdateMissileSystem
   291 				;
   292 				; 		should call this every frame, before calling CreateMissile in that frame (?)
   293 				;
   294 				;**************************************************************************************************
   295 				;	
   296 5D99			.proc UpdateMissileSystem
   297
   298 5D99 A2 00				ldx #0
   299
   300 5D9B			UMS_loop
   301 5D9B BD D9 5C				lda TabMissileOwner,x	; if the owner is 0, the slot is free
   302 5D9E D0 03				bne UMS_update
   303 5DA0 4C 93 5E				jmp UMS_next
   304
   305 				;*****	update frame counter (life time)
   306 				;
   307 5DA3			UMS_update
   308 						
   309 5DA3 FE D5 5C				inc TabMissileFrameCounter_H1,x
   310 5DA6 D0 03				bne UMS_check_collision
   311 5DA8 FE D1 5C				inc TabMissileFrameCounter_H2,x
   312
   313 				;*****	check if we need to destroy the missile by a hardware collision
   314 				;
   315 5DAB			UMS_check_collision
   316
   317 5DAB 20 3E 60				jsr GetPlayerMissileFrontChar
   318
   319 5DAE BD D9 5C				lda TabMissileOwner,x
   320 5DB1 C9 01				cmp #1
   321 5DB3 F0 0C				beq UMS_player_owner
   322
   323 				;******	the collision check is a lot simpler for enemies
   324 				;
   325 5DB5			UMS_enemy_owner			
   326
   327 5DB5 AD BB 32				lda m_charDef
   328 5DB8 29 0F				and #15
   329 5DBA C9 01				cmp #CT_BLOCK
   330 5DBC D0 55				bne UMS_update_position
   331 5DBE 4C 6F 5E				jmp UMS_destroy
   332 					
   333 5DC1			UMS_player_owner
   334 					
   335 5DC1 AD BB 32				lda m_charDef
   336 5DC4 29 0F				and #15
   337
   338 5DC6			UMS_check_block
   339 						
   340 5DC6 C9 01				cmp #CT_BLOCK
   341 5DC8 D0 05				bne UMS_check_danger
   342 						
   343 5DCA A9 04				lda #4									; gray color
   344 5DCC 4C 10 5E				jmp TEST_B1
   345
   346 5DCF			UMS_check_danger
   347 						
   348 5DCF C9 03				cmp #CT_DANGER
   349 5DD1 D0 40				bne UMS_update_position
   350
   351 				;*****	check for a disabed vertical laser
   352 				;
   353 5DD3			UMS_check_vlaser
   354 						
   355 5DD3 AD BA 32				lda m_charRaw
   356 5DD6 C9 90				cmp #[128+16]							; danger plus vertical laser char index
   357 5DD8 D0 0A				bne UMS_check_enemy1_left
   358 					
   359 5DDA AD 87 32				lda m_animLaserCurrentFrame
   360 5DDD C9 3C				cmp #VLASER_DISABLED_INDEX				; disabled state index
   361 5DDF F0 32				beq UMS_update_position
   362 5DE1 4C 10 5E				jmp UMS_danger
   363
   364 5DE4			UMS_check_enemy1_left
   365
   366 5DE4 C9 C0				cmp #[128+64]							; danger plus enemy 1 left char index
   367 5DE6 D0 12				bne UMS_check_enemy1_right
   368 					
   369 5DE8 AD B6 32				lda m_charPositionX
   370 5DEB 8D 9C 32				sta m_enemyCharPosX
   371 5DEE AD B7 32				lda m_charPositionY
   372 5DF1 8D 9D 32				sta m_enemyCharPosY
   373 					
   374 5DF4 20 FC 68				jsr HitEnemy	
   375 5DF7 4C 10 5E				jmp UMS_danger
   376 					
   377 5DFA			UMS_check_enemy1_right
   378 					
   379 5DFA C9 C1				cmp #[128+65]							; danger plus enemy 1 right char index
   380 5DFC D0 12				bne UMS_danger
   381 					
   382 5DFE AD B6 32				lda m_charPositionX
   383 5E01 8D 9C 32				sta m_enemyCharPosX
   384 5E04 CE 9C 32				dec m_enemyCharPosX
   385 5E07 AD B7 32				lda m_charPositionY
   386 5E0A 8D 9D 32				sta m_enemyCharPosY
   387 					
   388 5E0D 20 FC 68				jsr HitEnemy
   389 								
   390 5E10			UMS_danger
   391 5E10			TEST_B1	
   392 5E10 4C 6F 5E				jmp UMS_destroy
   393
   394 				;*****	update position using the missile speed
   395 5E13			UMS_update_position
   396 					
   397 5E13 BD CD 5C				lda TabMissileDirection,x
   398 5E16 C9 01				cmp #1
   399 5E18 D0 21				bne UMS_move_left
   400
   401 5E1A			UMS_move_right
   402 						
   403 5E1A BD B5 5C				lda TabMissileLevelLeftX_L1,x
   404 5E1D 18					clc
   405 5E1E 7D C9 5C				adc TabMissileSpeedX_L1,x
   406 5E21 9D B5 5C				sta TabMissileLevelLeftX_L1,x
   407
   408 5E24 BD B1 5C				lda TabMissileLevelLeftX_H1,x
   409 5E27 7D C5 5C				adc TabMissileSpeedX_H1,x
   410 5E2A 9D B1 5C				sta TabMissileLevelLeftX_H1,x
   411
   412 5E2D BD AD 5C				lda TabMissileLevelLeftX_H2,x
   413 5E30 69 00				adc #0
   414 5E32 9D AD 5C				sta TabMissileLevelLeftX_H2,x
   415
   416 5E35 20 9C 5E				jsr SetMissileScreenPos
   417 5E38 4C 59 5E				jmp UMS_check_screen_limits
   418
   419 5E3B			UMS_move_left
   420
   421 5E3B BD B5 5C				lda TabMissileLevelLeftX_L1,x
   422 5E3E 38					sec
   423 5E3F FD C9 5C				sbc TabMissileSpeedX_L1,x
   424 5E42 9D B5 5C				sta TabMissileLevelLeftX_L1,x
   425
   426 5E45 BD B1 5C				lda TabMissileLevelLeftX_H1,x
   427 5E48 FD C5 5C				sbc TabMissileSpeedX_H1,x
   428 5E4B 9D B1 5C				sta TabMissileLevelLeftX_H1,x
   429
   430 5E4E BD AD 5C				lda TabMissileLevelLeftX_H2,x
   431 5E51 E9 00				sbc #0
   432 5E53 9D AD 5C				sta TabMissileLevelLeftX_H2,x
   433
   434 5E56 20 9C 5E				jsr SetMissileScreenPos
   435
   436 				;*****	check outside screen position, to destroy the missile
   437 				;
   438 5E59			UMS_check_screen_limits
   439
   440 5E59 BD 9D 5C				lda TabMissileScreenLeftX,x
   441 5E5C C9 30				cmp #[PM_BASE_SCREEN_X]					; screen left limit
   442 5E5E 90 0F				bcc UMS_destroy
   443 5E60 C9 CD				cmp #[PM_BASE_SCREEN_X+160-3]			; screen right limit (minus width of the missile)
   444 5E62 B0 0B				bcs UMS_destroy
   445
   446 5E64 BD A1 5C				lda TabMissileScreenTopY,x
   447 5E67 C9 20				cmp #[PM_BASE_SCREEN_Y]					; screen top limit
   448 5E69 90 04				bcc UMS_destroy
   449 5E6B C9 DE				cmp #[PM_BASE_SCREEN_Y+192-2]			; screen bottom limit (minus height of the missile)
   450 					
   451 5E6D 90 21				bcc UMS_draw
   452
   453 5E6F			UMS_destroy
   454
   455 5E6F BD D9 5C				lda TabMissileOwner,x
   456 5E72 C9 02				cmp #2
   457 5E74 D0 03				bne UMS_not_from_enemy
   458 5E76 CE A8 32				dec m_enemyMissilesActive
   459 					
   460 5E79			UMS_not_from_enemy
   461 					
   462 5E79 A9 00				lda #0
   463 5E7B 9D D9 5C				sta TabMissileOwner,x
   464
   465 5E7E BC A9 5C				ldy TabOldMissileScreenTopY,x
   466 5E81 20 0C 60				jsr ClearMissileLines
   467
   468 5E84 BC A1 5C				ldy TabMissileScreenTopY,x
   469 5E87 20 0C 60				jsr ClearMissileLines
   470
   471 5E8A CE 9C 5C				dec m_currentVirtualMissiles
   472
   473 5E8D 4C 93 5E				jmp UMS_next
   474
   475 				;*****	draw the missile
   476 				;
   477 5E90			UMS_draw
   478 					
   479 5E90 20 F4 5E				jsr DrawMissileMX
   480
   481 5E93			UMS_next
   482
   483 5E93 E8					inx
   484 5E94 E0 04				cpx #MAX_VIRTUAL_MISSILES
   485 5E96 F0 03				beq UMS_exit
   486 5E98 4C 9B 5D				jmp UMS_loop
   487
   488 5E9B			UMS_exit
   489 						
   490 5E9B 60					rts
   491
   492 				.endp
   493
   494 				;
   495 				;**************************************************************************************************
   496 				;	SetMissileScreenPos
   497 				;
   498 				; 		use X as a parameter (the index of the virtual missile)
   499 				;
   500 				;**************************************************************************************************
   501 				;	
   502 5E9C			.proc SetMissileScreenPos
   503
   504 						; save old screen pos
   505 5E9C BD 9D 5C				lda TabMissileScreenLeftX,x
   506 5E9F 9D A5 5C				sta TabOldMissileScreenLeftX,x
   507 						
   508 5EA2 BD A1 5C				lda TabMissileScreenTopY,x
   509 5EA5 9D A9 5C				sta TabOldMissileScreenTopY,x
   510
   511 						; get new screen pos
   512 						; this must use the "_H2" positions for 
   513 						; when the delta between the missile and 
   514 						; the camera is too big (64 chars in X, or 32 chars in Y)
   515 						;
   516 5EA8 BD B1 5C				lda TabMissileLevelLeftX_H1,x
   517 5EAB 38					sec
   518 5EAC E5 DB				sbc m_levelWindowX_H1
   519 5EAE 8D BD 32				sta m_screenDelta_H1
   520 5EB1 BD AD 5C				lda TabMissileLevelLeftX_H2,x
   521 5EB4 E5 DA				sbc m_levelWindowX_H2
   522 5EB6 90 33				bcc SMSP_set_outside					; this is not totally correct, because it doesn't use the width of the missile
   523 5EB8 8D BC 32				sta m_screenDelta_H2					; (but if we do it correctly we should clip the missile graphics)
   524
   525 5EBB D0 2E				bne SMSP_set_outside					; could remove the bcc and only use this..
   526 5EBD AD BD 32				lda m_screenDelta_H1
   527 5EC0 C9 9F				cmp #[160-1]							; 40 chars x 4 pixels, minus (missile width - 1)
   528 5EC2 B0 27				bcs SMSP_set_outside
   529 					
   530 5EC4 69 30				adc #PM_BASE_SCREEN_X
   531 5EC6 9D 9D 5C				sta TabMissileScreenLeftX,x
   532 					
   533 5EC9 BD BD 5C				lda TabMissileLevelTopY_H1,x
   534 5ECC 38					sec
   535 5ECD E5 DD				sbc m_levelWindowY_H1
   536 5ECF 8D BD 32				sta m_screenDelta_H1
   537 5ED2 BD B9 5C				lda TabMissileLevelTopY_H2,x
   538 5ED5 E5 DC				sbc m_levelWindowY_H2
   539 5ED7 90 12				bcc SMSP_set_outside					; this is not totally correct, because it doesn't use the height of the missile
   540 5ED9 8D BC 32				sta m_screenDelta_H2					; (but if we do it correctly we should clip the missile graphics)
   541
   542 5EDC D0 0D				bne SMSP_set_outside					; could remove the bcc and only use this..
   543 5EDE AD BD 32				lda m_screenDelta_H1
   544 5EE1 C9 BF				cmp #[193-2]							; 24 chars x 8 scan lines, plus one extra scan line, minus (missile height - 1)
   545 5EE3 B0 06				bcs SMSP_set_outside
   546 					
   547 5EE5 69 20				adc #PM_BASE_SCREEN_Y
   548 5EE7 9D A1 5C				sta TabMissileScreenTopY,x
   549
   550 5EEA 60					rts
   551 					
   552 				; if outside the visible range in X or Y, just set it out of the screen (for a p/m the screen coordinate 0 is outside the visible range)
   553 5EEB			SMSP_set_outside
   554 						
   555 5EEB A9 00				lda #0
   556 5EED 9D 9D 5C				sta TabMissileScreenLeftX,x
   557 5EF0 9D A1 5C				sta TabMissileScreenTopY,x
   558 					
   559 5EF3 60					rts
   560 					
   561 				.endp
   562 					
   563 				;
   564 				;**************************************************************************************************
   565 				;	DrawMissileMX
   566 				;
   567 				; 		draw missiles, use X as a parameter (the index of the virtual missile)
   568 				;
   569 				;**************************************************************************************************
   570 				;	
   571 5EF4			.proc DrawMissileMX
   572 					
   573 5EF4 BD 94 5C				lda TabDrawMissileMethodLSB,x
   574 5EF7 85 EB				sta m_pageZeroTempPointer
   575 						
   576 5EF9 BD 98 5C				lda TabDrawMissileMethodMSB,x
   577 5EFC 85 EC				sta m_pageZeroTempPointer+1
   578
   579 5EFE A9 5F				lda #>(Exit -1)
   580 5F00 48					pha
   581 5F01 A9 06				lda #<(Exit -1)
   582 5F03 48					pha
   583
   584 5F04 6C EB 00				jmp (m_pageZeroTempPointer)
   585
   586 5F07			Exit
   587
   588 5F07 60					rts
   589
   590 				.endp
   591
   592 				;
   593 				;**************************************************************************************************
   594 				;	DrawMissileM0
   595 				;**************************************************************************************************
   596 				;	
   597 5F08			.proc DrawMissileM0
   598 						
   599 5F08 BD 9D 5C				lda TabMissileScreenLeftX,x
   600 5F0B 8D 04 D0				sta HPOSM0
   601
   602 						; clear old position first
   603 5F0E BC A9 5C				ldy TabOldMissileScreenTopY,x
   604
   605 5F11 20 0C 60				jsr ClearMissileLines
   606
   607 						; draw shape in new position
   608 5F14 BC A1 5C				ldy TabMissileScreenTopY,x
   609
   610 5F17 BD CD 5C				lda TabMissileDirection,x
   611 5F1A C9 01				cmp #1
   612 						
   613 5F1C D0 09				bne DMM0_left
   614 						
   615 5F1E A9 5F				lda #>(Exit -1)
   616 5F20 48					pha
   617 5F21 A9 2F				lda #<(Exit -1)
   618 5F23 48					pha
   619
   620 5F24 4C D4 5F				jmp SetMissileToRightLines
   621
   622 5F27			DMM0_left
   623 						
   624 5F27 A9 5F				lda #>(Exit -1)
   625 5F29 48					pha
   626 5F2A A9 2F				lda #<(Exit -1)
   627 5F2C 48					pha
   628
   629 5F2D 4C F0 5F				jmp SetMissileToLeftLines
   630
   631 5F30			Exit
   632
   633 5F30 60					rts
   634
   635 				.endp
   636
   637 				;
   638 				;**************************************************************************************************
   639 				;	DrawMissileM1
   640 				;**************************************************************************************************
   641 				;	
   642 5F31			.proc DrawMissileM1
   643 					
   644 5F31 BD 9D 5C				lda TabMissileScreenLeftX,x
   645 5F34 8D 05 D0				sta HPOSM1
   646
   647 						; clear old position first
   648 5F37 BC A9 5C				ldy TabOldMissileScreenTopY,x
   649
   650 5F3A 20 0C 60				jsr ClearMissileLines
   651
   652 						; draw shape in new position
   653 5F3D BC A1 5C				ldy TabMissileScreenTopY,x
   654
   655 5F40 BD CD 5C				lda TabMissileDirection,x
   656 5F43 C9 01				cmp #1
   657 5F45 D0 09				bne DMM1_left
   658
   659 5F47 A9 5F				lda #>(Exit -1)
   660 5F49 48					pha
   661 5F4A A9 58				lda #<(Exit -1)
   662 5F4C 48					pha
   663 5F4D 4C D4 5F				jmp SetMissileToRightLines
   664
   665 5F50			DMM1_left
   666
   667 5F50 A9 5F				lda #>(Exit -1)
   668 5F52 48					pha
   669 5F53 A9 58				lda #<(Exit -1)
   670 5F55 48					pha
   671 5F56 4C F0 5F				jmp SetMissileToLeftLines
   672
   673 5F59			Exit
   674
   675 5F59 60					rts
   676
   677 				.endp
   678
   679 				;
   680 				;**************************************************************************************************
   681 				;	DrawMissileM2
   682 				;**************************************************************************************************
   683 				;	
   684 5F5A			.proc DrawMissileM2
   685 						
   686 5F5A BD 9D 5C				lda TabMissileScreenLeftX,x
   687 5F5D 8D 06 D0				sta HPOSM2
   688
   689 						; clear old position first
   690 5F60 BC A9 5C				ldy TabOldMissileScreenTopY,x
   691
   692 5F63 B9 00 A3				lda ms_area_1,y
   693 5F66 29 CF				and #CLEAR_MASK_M2
   694 5F68 99 00 A3				sta ms_area_1,y
   695 						
   696 5F6B B9 01 A3				lda ms_area_1+1,y
   697 5F6E 29 CF				and #CLEAR_MASK_M2
   698 5F70 99 01 A3				sta ms_area_1+1,y
   699 						
   700 5F73 B9 02 A3				lda ms_area_1+2,y
   701 5F76 29 CF				and #CLEAR_MASK_M2
   702 5F78 99 02 A3				sta ms_area_1+2,y
   703
   704 						; draw shape in new position
   705 5F7B BC A1 5C				ldy TabMissileScreenTopY,x
   706
   707 5F7E B9 00 A3				lda ms_area_1,y
   708 5F81 09 30				ora #SET_MASK_M2
   709 5F83 99 00 A3				sta ms_area_1,y
   710 						
   711 5F86 B9 01 A3				lda ms_area_1+1,y
   712 5F89 09 30				ora #SET_MASK_M2
   713 5F8B 99 01 A3				sta ms_area_1+1,y
   714 						
   715 5F8E B9 02 A3				lda ms_area_1+2,y
   716 5F91 09 30				ora #SET_MASK_M2
   717 5F93 99 02 A3				sta ms_area_1+2,y
   718
   719 5F96 60					rts
   720
   721 				.endp
   722
   723 				;
   724 				;**************************************************************************************************
   725 				;	DrawMissileM3
   726 				;**************************************************************************************************
   727 				;	
   728 5F97			.proc DrawMissileM3
   729 					
   730 5F97 BD 9D 5C				lda TabMissileScreenLeftX,x
   731 5F9A 8D 07 D0				sta HPOSM3
   732
   733 						; clear old position first
   734 5F9D BC A9 5C				ldy TabOldMissileScreenTopY,x
   735
   736 5FA0 B9 00 A3				lda ms_area_1,y
   737 5FA3 29 3F				and #CLEAR_MASK_M3
   738 5FA5 99 00 A3				sta ms_area_1,y
   739 						
   740 5FA8 B9 01 A3				lda ms_area_1+1,y
   741 5FAB 29 3F				and #CLEAR_MASK_M3
   742 5FAD 99 01 A3				sta ms_area_1+1,y
   743 					
   744 5FB0 B9 02 A3				lda ms_area_1+2,y
   745 5FB3 29 3F				and #CLEAR_MASK_M3
   746 5FB5 99 02 A3				sta ms_area_1+2,y
   747
   748 						; draw shape in new position
   749 5FB8 BC A1 5C				ldy TabMissileScreenTopY,x
   750
   751 5FBB B9 00 A3				lda ms_area_1,y
   752 5FBE 09 C0				ora #SET_MASK_M3
   753 5FC0 99 00 A3				sta ms_area_1,y
   754 					
   755 5FC3 B9 01 A3				lda ms_area_1+1,y
   756 5FC6 09 C0				ora #SET_MASK_M3
   757 5FC8 99 01 A3				sta ms_area_1+1,y
   758 					
   759 5FCB B9 02 A3				lda ms_area_1+2,y
   760 5FCE 09 C0				ora #SET_MASK_M3
   761 5FD0 99 02 A3				sta ms_area_1+2,y
   762
   763 5FD3 60					rts
   764
   765 				.endp
   766
   767 				;
   768 				;**************************************************************************************************
   769 				;	SetMissileToRightLines
   770 				;**************************************************************************************************
   771 				;	
   772 5FD4			.proc SetMissileToRightLines
   773
   774 5FD4 B9 00 A3				lda ms_area_1,y
   775 5FD7 1D 7C 5C				ora TabSetMissileToRightMaskL1,x	; this "x" should be a hardware missile index
   776 5FDA 99 00 A3				sta ms_area_1,y
   777 						
   778 5FDD B9 01 A3				lda ms_area_1+1,y
   779 5FE0 1D 80 5C				ora TabSetMissileToRightMaskL2,x	; this "x" should be a hardware missile index
   780 5FE3 99 01 A3				sta ms_area_1+1,y
   781 						
   782 5FE6 B9 02 A3				lda ms_area_1+2,y
   783 5FE9 1D 84 5C				ora TabSetMissileToRightMaskL3,x	; this "x" should be a hardware missile index
   784 5FEC 99 02 A3				sta ms_area_1+2,y
   785
   786 5FEF 60					rts
   787
   788 				.endp
   789 						
   790 				;
   791 				;**************************************************************************************************
   792 				;	SetMissileToLeftLines
   793 				;**************************************************************************************************
   794 				;	
   795 5FF0			.proc SetMissileToLeftLines
   796
   797 5FF0 B9 00 A3				lda ms_area_1,y
   798 5FF3 1D 88 5C				ora TabSetMissileToLeftMaskL1,x	; this "x" should be a hardware missile index
   799 5FF6 99 00 A3				sta ms_area_1,y
   800 						
   801 5FF9 B9 01 A3				lda ms_area_1+1,y
   802 5FFC 1D 8C 5C				ora TabSetMissileToLeftMaskL2,x	; this "x" should be a hardware missile index
   803 5FFF 99 01 A3				sta ms_area_1+1,y
   804 						
   805 6002 B9 02 A3				lda ms_area_1+2,y
   806 6005 1D 90 5C				ora TabSetMissileToLeftMaskL3,x	; this "x" should be a hardware missile index
   807 6008 99 02 A3				sta ms_area_1+2,y
   808
   809 600B 60					rts
   810
   811 				.endp
   812
   813 				;
   814 				;**************************************************************************************************
   815 				;	ClearMissileLines
   816 				;**************************************************************************************************
   817 				;	
   818 600C			.proc ClearMissileLines
   819
   820 600C B9 00 A3				lda ms_area_1,y
   821 600F 3D 78 5C				and TabClearMissileMask,x				; this "x" should be a hardware missile index
   822 6012 99 00 A3				sta ms_area_1,y
   823 						
   824 6015 B9 01 A3				lda ms_area_1+1,y
   825 6018 3D 78 5C				and TabClearMissileMask,x				; this "x" should be a hardware missile index
   826 601B 99 01 A3				sta ms_area_1+1,y
   827 						
   828 601E B9 02 A3				lda ms_area_1+2,y
   829 6021 3D 78 5C				and TabClearMissileMask,x				; this "x" should be a hardware missile index
   830 6024 99 02 A3				sta ms_area_1+2,y
   831
   832 6027 60					rts
   833 						
   834 				.endp
   835
   836 				;
   837 				;**************************************************************************************************
   838 				;	ClearAllMissiles
   839 				;**************************************************************************************************
   840 				;	
   841 6028			.proc ClearAllMissiles
   842 						
   843 6028 A2 00				ldx #0
   844 602A A9 00				lda #0
   845
   846 602C			CAM_loop
   847 						
   848 602C BC A1 5C				ldy TabMissileScreenTopY,x
   849 602F 99 00 A3				sta ms_area_1,y
   850 6032 99 01 A3				sta ms_area_1+1,y
   851 6035 99 02 A3				sta ms_area_1+2,y
   852
   853 6038 E8					inx
   854 6039 E0 04				cpx #MAX_VIRTUAL_MISSILES
   855 603B D0 EF				bne CAM_loop
   856
   857 603D 60					rts
   858 						
   859 				.endp
   860 						
   861 				;
   862 				;**************************************************************************************************
   863 				;
   864 				;	GetPlayerMissileFrontChar
   865 				;
   866 				; 		use X as a parameter (the index of the virtual missile)
   867 				; 		return in A the character definition value
   868 				;
   869 				;**************************************************************************************************
   870 				;
   871 603E			.proc GetPlayerMissileFrontChar
   872
   873 						; get front point char column
   874 603E BD CD 5C				lda TabMissileDirection,x
   875 6041 C9 01				cmp #1
   876 6043 D0 14				bne GMFC_left
   877
   878 				;*****	moving to the right, use right side pixel
   879 				;
   880 6045			GMFC_right
   881 					
   882 6045 BD B1 5C				lda TabMissileLevelLeftX_H1,x
   883 6048 18					clc
   884 6049 69 03				adc #3									; missile X size minus one
   885 604B 8D B3 32				sta m_pixelPositionX_H1
   886 604E BD AD 5C				lda TabMissileLevelLeftX_H2,x
   887 6051 69 00				adc #0
   888 6053 8D B2 32				sta m_pixelPositionX_H2
   889
   890 6056 4C 65 60				jmp GMFC_middle_line
   891
   892 				;*****	moving to the left, use left side pixel
   893 				;
   894 6059			GMFC_left
   895 						
   896 6059 BD B1 5C				lda TabMissileLevelLeftX_H1,x
   897 605C 8D B3 32				sta m_pixelPositionX_H1
   898 605F BD AD 5C				lda TabMissileLevelLeftX_H2,x
   899 6062 8D B2 32				sta m_pixelPositionX_H2
   900
   901 				;*****	get middle char line
   902 				;
   903 6065			GMFC_middle_line
   904 					
   905 6065 BD BD 5C				lda TabMissileLevelTopY_H1,x
   906 6068 18					clc
   907 6069 69 01				adc #1									; because the height is 3 lines
   908 606B 8D B5 32				sta m_pixelPositionY_H1
   909 606E BD B9 5C				lda TabMissileLevelTopY_H2,x
   910 6071 69 00				adc #0
   911 6073 8D B4 32				sta m_pixelPositionY_H2
   912
   913 6076 A9 60				lda #>(Exit -1)
   914 6078 48					pha
   915 6079 A9 7E				lda #<(Exit -1)
   916 607B 48					pha
   917
   918 607C 4C 80 60				jmp GetCharDefinitionFromPixelPos
   919
   920 607F			Exit
   921 607F 60					rts
   922
   923 				.endp		
   924
   925 				;
   926 				;**************************************************************************************************
   927 				;
   928 				;	GetCharDefinitionFromPixelPos
   929 				;
   930 				; 		put coord "x" in m_pixelPositionX_H2/_H1 and coord "y" in m_pixelPositionY_H2/_H1
   931 				; 		return in A the character definition value (and also use the Y register)
   932 				; 		(this assume that there no more than 256 chars in x or in y, in a room)
   933 				;
   934 				;**************************************************************************************************
   935 				;
   936 6080			.proc GetCharDefinitionFromPixelPos
   937
   938
   939 						; get char line, divide by 8 (put in Y)
   940 6080 AD B4 32				lda m_pixelPositionY_H2
   941 6083 8D CC 32				sta m_charBuffer_H2
   942 6086 AD B5 32				lda m_pixelPositionY_H1
   943 6089 4E CC 32				lsr m_charBuffer_H2						; /2
   944 608C 6A					ror
   945 608D 4E CC 32				lsr m_charBuffer_H2						; /4
   946 6090 6A					ror
   947 6091 4E CC 32				lsr m_charBuffer_H2						; /8 = CHAR_PIXELS_Y
   948 6094 6A					ror
   949
   950 6095 8D B7 32				sta m_charPositionY
   951 6098 A8					tay
   952
   953 						; init pointer to char
   954 6099 B9 DB 32				lda TabLevelLineAddressLSB,y
   955 609C 8D C1 60				sta GCDFPP_pointer+1
   956 609F 8D B8 32				sta m_lineAddressLSB
   957 					
   958 60A2 B9 DB 33				lda TabLevelLineAddressMSB,y
   959 60A5 8D C2 60				sta GCDFPP_pointer+2
   960 60A8 8D B9 32				sta m_lineAddressMSB
   961
   962 						; get char column, divide by 4 (put in Y)
   963 60AB AD B2 32				lda m_pixelPositionX_H2
   964 60AE 8D CC 32				sta m_charBuffer_H2
   965 60B1 AD B3 32				lda m_pixelPositionX_H1
   966 60B4 4E CC 32				lsr m_charBuffer_H2						; /2
   967 60B7 6A					ror
   968 60B8 4E CC 32				lsr m_charBuffer_H2						; /4 = CHAR_PIXELS_X
   969 60BB 6A					ror
   970
   971 60BC 8D B6 32				sta m_charPositionX
   972 60BF A8					tay
   973
   974 60C0			GCDFPP_pointer
   975 						
   976 60C0 B9 FF FF				lda $FFFF,y
   977 60C3 8D BA 32				sta m_charRaw
   978
   979 60C6 A8					tay
   980 60C7 B9 DB 34				lda TabCharDefinition,y
   981 60CA 8D BB 32				sta m_charDef
   982
   983 60CD 60					rts
   984
   985 				.endp
   336 60CE					icl "AnimationsLogic.Asm"	
Source: E:\_8BitProjects\Series\Scroller\AnimationsLogic.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		AnimationsLogic.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;*****	Local to Animations Logic
    14 				;
    15 = 000A			ANIM_COIN_CHAR1 			= $0A
    16 = 0006			ANIM_COIN_FRAMES 			= $06
    17 = 0008			ANIM_COIN_MAX_NUMBER 		= $08
    18
    19 = 0004			ANIM_MISC_FRAME_TIME		= $04
    20 = 0004			ANIM_SEA_TOP_FRAME_TIME 	= $04
    21
    22 60CE 00 00 00 00 00 00 + TabCoinAnimFrame			.byte $00, $00, $00, $00, $00, $00, $00, $00
    23
    24 60D6 00 00 00 00 00 00 + TabCoinAnimTimer			.byte $00, $00, $00, $00, $00, $00, $00, $00
    25
    26 60DE 02 02 02 02 02 02	TabCoinAnimCharTime			.byte $02, $02, $02, $02, $02, $02
    27
    28 60E4 00 00 00 00 00 00 + TabCoinAnimAddressLSB		.byte $00, $00, $00, $00, $00, $00, $00, $00
    29 60EC 00 00 00 00 00 00 + TabCoinAnimAddressMSB		.byte $00, $00, $00, $00, $00, $00, $00, $00
    30
    31 				; vertical line, dither (red)
    32 60F4 30 0C 30 0C 30 0C + TabAnimLaserFrame_01		.byte %00110000,%00001100,%00110000,%00001100,%00110000,%00001100,%00110000,%00001100
    33 60FC 0C 30 0C 30 0C 30 + TabAnimLaserFrame_02		.byte %00001100,%00110000,%00001100,%00110000,%00001100,%00110000,%00001100,%00110000
    34 6104 00 00 00 00 00 00 + TabAnimLaserFrame_03		.byte %00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000,%00000000
    35
    36 				; hoizontal line, dither (red)
    37 610C 33 CC 33		TabAnimHLaserFrame_01		.byte %00110011, %11001100, %00110011
    38 610F CC 33 CC		TabAnimHLaserFrame_02		.byte %11001100, %00110011, %11001100
    39 6112 00 00 00 00 00 00 + TabAnimHLaserFrame_03		.byte %00000000, %00000000, %00000000, %00000000, %00000000, %00000000, %00000000, %00000000
    40
    41 				; sea top (blue)
    42 611A 0F			TabAnimSeaTopLeftFrame_01	.byte %00001111
    43 611B 3F										.byte %00111111
    44 611C FF										.byte %11111111
    45 611D FF										.byte %11111111
    46
    47 611E 00			TabAnimSeaTopRightFrame_01	.byte %00000000
    48 611F C0										.byte %11000000
    49 6120 F0										.byte %11110000
    50 6121 FF										.byte %11111111
    51
    52 				.if PAL_VERSION = 0
    53 					
    54 = 003D				ANIM_LASER_FRAMES 		= $3D
    55 = 003D				ANIM_HLASER_FRAMES 		= $3D
    56 					
    57 6122 F4 FC F4 FC F4 FC + TabAnimLaserFrameAddressLSB		:30 .byte <TabAnimLaserFrame_01, <TabAnimLaserFrame_02
    58 615E 04												.byte <TabAnimLaserFrame_03
    59 										
    60 615F 60 60 60 60 60 60 + TabAnimLaserFrameAddressMSB		:30 .byte >TabAnimLaserFrame_01, >TabAnimLaserFrame_02
    61 619B 61												.byte >TabAnimLaserFrame_03
    62
    63 619C 0C 0F 0C 0F 0C 0F + TabAnimHLaserFrameAddressLSB	:30 .byte <TabAnimHLaserFrame_01, <TabAnimHLaserFrame_02
    64 61D8 12												.byte <TabAnimHLaserFrame_03
    65
    66 61D9 61 61 61 61 61 61 + TabAnimHLaserFrameAddressMSB	:30 .byte >TabAnimHLaserFrame_01, >TabAnimHLaserFrame_02
    67 6215 61												.byte >TabAnimHLaserFrame_03
    68
    69 				; right now, if the index to these tables is 60, then we are in the "disabled" state
    70 6216 01 01 01 01 01 01 + TabAnimHLaserFrameTime			:30 .byte $01, $01
    71 6252 5A												.byte $5A
    72
    73 				; right now, if the index to these tables is 60, then we are in the "disabled" state
    74 6253 01 01 01 01 01 01 + TabAnimLaserFrameTime			:30 .byte $01, $01
    75 628F 3C												.byte $3C
    76
    77 				.else
    78
    79 					ANIM_LASER_FRAMES 		= $33
    80 					ANIM_HLASER_FRAMES 		= $33
    81
    82 				TabAnimLaserFrameAddressLSB		:25 .byte <TabAnimLaserFrame_01, <TabAnimLaserFrame_02
    83 													.byte <TabAnimLaserFrame_03
    84 											
    85 				TabAnimLaserFrameAddressMSB		:25 .byte >TabAnimLaserFrame_01, >TabAnimLaserFrame_02
    86 													.byte >TabAnimLaserFrame_03
    87
    88 				TabAnimHLaserFrameAddressLSB	:25 .byte <TabAnimHLaserFrame_01, <TabAnimHLaserFrame_02
    89 													.byte <TabAnimHLaserFrame_03
    90
    91 				TabAnimHLaserFrameAddressMSB	:25 .byte >TabAnimHLaserFrame_01, >TabAnimHLaserFrame_02
    92 													.byte >TabAnimHLaserFrame_03
    93
    94 				; right now, if the index to these tables is 60, then we are in the "disabled" state
    95 				TabAnimHLaserFrameTime			:25 .byte $01, $01
    96 													.byte $4B
    97
    98 				; right now, if the index to these tables is 60, then we are in the "disabled" state
    99 				TabAnimLaserFrameTime			:25 .byte $01, $01
   100 													.byte $32
   101
   102 				.endif
   103
   104 				;
   105 				;**************************************************************************************************
   106 				; DoFontAnimations	
   107 				;**************************************************************************************************
   108 				;
   109 6290			.proc DoFontAnimations
   110 					
   111 6290 20 29 63				jsr AnimateWater
   112 6293 20 69 63				jsr AnimateVerticalLaser
   113 6296 20 9E 63				jsr AnimateHorizontalLaser
   114 6299 20 D3 63				jsr AnimateMisc		
   115 629C 20 81 6A				jsr PlatformControlH
   116 						
   117 629F 60					rts
   118 						
   119 				.endp
   120
   121 				;
   122 				;**************************************************************************************************
   123 				;
   124 				;	AddCoinAnimation
   125 				;
   126 				;		the word "m_pageZeroTempPointer" has the address of the char to animate
   127 				;	
   128 				;**************************************************************************************************
   129 				;
   130 62A0			.proc AddCoinAnimation
   131 					
   132 62A0 AD 83 32				lda m_currentCoinAnimations					
   133 62A3 C9 08				cmp #ANIM_COIN_MAX_NUMBER
   134 62A5 F0 28				beq Exit
   135 						
   136 62A7 EE 83 32				inc m_currentCoinAnimations
   137 62AA AE 82 32				ldx m_emptyCoinAnimIndex
   138 					
   139 62AD A5 EB				lda m_pageZeroTempPointer
   140 62AF 9D E4 60				sta TabCoinAnimAddressLSB,x
   141 						
   142 62B2 A5 EC				lda m_pageZeroTempPointer+1
   143 62B4 9D EC 60				sta TabCoinAnimAddressMSB,x
   144
   145 62B7 A9 00				lda #0										; use first frame
   146 62B9 9D CE 60				sta TabCoinAnimFrame,x
   147 					
   148 62BC AD DE 60				lda TabCoinAnimCharTime						; use first element of the table
   149 62BF 9D D6 60				sta TabCoinAnimTimer,x
   150
   151 62C2 A0 00				ldy #0
   152 62C4 A9 0A				lda #ANIM_COIN_CHAR1
   153 62C6 91 EB				sta (m_pageZeroTempPointer),y				; update screen
   154
   155 62C8 E8					inx
   156 62C9 8A					txa
   157 62CA 29 07				and #%111
   158 62CC 8D 82 32				sta m_emptyCoinAnimIndex
   159
   160 				;*****	Add Coin Animation Exit
   161 				;
   162 62CF			Exit
   163 62CF 60					rts
   164
   165 				.endp
   166 					
   167 				;
   168 				;**************************************************************************************************
   169 				; 	UpdateCoinAnimations	
   170 				;
   171 				;		update coin animations every frame
   172 				;
   173 				;**************************************************************************************************
   174 				;
   175 62D0			.proc UpdateCoinAnimations
   176
   177 62D0 AD 83 32				lda m_currentCoinAnimations					
   178 62D3 F0 53				beq UCA_exit
   179 						
   180 62D5 AE 81 32				ldx m_firstCoinAnimIndex
   181
   182 				;*****	UCA Loop
   183 				;
   184 62D8			UCA_loop
   185 					
   186 62D8 DE D6 60				dec TabCoinAnimTimer,x
   187 62DB D0 41				bne UCA_check_loop
   188
   189 62DD FE CE 60				inc TabCoinAnimFrame,x
   190 62E0 BD CE 60				lda TabCoinAnimFrame,x
   191 62E3 C9 06				cmp #ANIM_COIN_FRAMES
   192 62E5 F0 19				beq UCA_clear_anim
   193
   194 				;*****	UCA Update Animation
   195 				;
   196 62E7			UCA_update_anim
   197 					
   198 62E7 A8					tay
   199 62E8 B9 DE 60				lda TabCoinAnimCharTime,y					; #ANIM_COIN_TIME
   200 62EB 9D D6 60				sta TabCoinAnimTimer,x
   201
   202 62EE BD E4 60				lda TabCoinAnimAddressLSB,x
   203 62F1 8D FB 62				sta UCA_char_pointer+1
   204 62F4 BD EC 60				lda TabCoinAnimAddressMSB,x
   205 62F7 8D FC 62				sta UCA_char_pointer+2
   206
   207 				;*****	UCA Character Pointer
   208 				;
   209 62FA			UCA_char_pointer
   210 					
   211 62FA EE FF FF				inc $FFFF									; update the animation frame, increment the char on screen
   212 62FD 4C 1E 63				jmp UCA_check_loop
   213
   214 				;*****	UCA Clear Animation
   215 				;
   216 6300			UCA_clear_anim
   217 					
   218 6300 BD E4 60				lda TabCoinAnimAddressLSB,x
   219 6303 8D 0F 63				sta UCA_clear_char_pointer+1
   220 6306 BD EC 60				lda TabCoinAnimAddressMSB,x
   221 6309 8D 10 63				sta UCA_clear_char_pointer+2
   222 630C A9 00				lda #0
   223
   224 				;*****	UCA Clear Character Pointer
   225 				;
   226 630E			UCA_clear_char_pointer
   227 					
   228 630E 8D FF FF				sta $FFFF									; clear the char on screen
   229 6311 CE 83 32				dec m_currentCoinAnimations
   230 6314 AC 81 32				ldy m_firstCoinAnimIndex
   231 6317 C8					iny
   232 6318 98					tya
   233 6319 29 07				and #%111
   234 631B 8D 81 32				sta m_firstCoinAnimIndex
   235
   236 				;*****	UCA Check Loop
   237 				;
   238 631E			UCA_check_loop
   239 						
   240 631E E8					inx
   241 631F 8A					txa
   242 6320 29 07				and #%111
   243 6322 AA					tax
   244 6323 EC 82 32				cpx m_emptyCoinAnimIndex
   245 6326 D0 B0				bne UCA_loop
   246
   247 				;*****	UCA Exit
   248 				;
   249 6328			UCA_exit
   250 						
   251 6328 60					rts
   252 					
   253 				.endp	
   254
   255 				;
   256 				;***************************************************************************************************
   257 				;	
   258 				;	AnimateWater
   259 				;	
   260 				; 		do sea top animation (chars 70, 71)
   261 				; 
   262 				;***************************************************************************************************
   263 				;	
   264 6329			.proc AnimateWater
   265
   266 6329 AD 7A 32			lda m_waterAvailable
   267 632C F0 3A			beq Exit
   268 					
   269 632E CE 80 32			dec m_animSeaTopTimer
   270 6331 D0 35			bne Exit
   271
   272 6333 A9 04			lda #ANIM_SEA_TOP_FRAME_TIME
   273 6335 8D 80 32			sta m_animSeaTopTimer
   274
   275 6338 AD 38 AA			lda GameFontAddress+8*71
   276 633B 4A				lsr											; put left bit in the carry
   277 633C 6E 30 AA			ror GameFontAddress+8*70
   278 633F 6E 38 AA			ror GameFontAddress+8*71
   279 6342 6E 30 AA			ror GameFontAddress+8*70
   280 6345 6E 38 AA			ror GameFontAddress+8*71
   281
   282 6348 AD 39 AA			lda GameFontAddress+8*71+1
   283 634B 4A				lsr											; put left bit in the carry
   284 634C 6E 31 AA			ror GameFontAddress+8*70+1
   285 634F 6E 39 AA			ror GameFontAddress+8*71+1
   286 6352 6E 31 AA			ror GameFontAddress+8*70+1
   287 6355 6E 39 AA			ror GameFontAddress+8*71+1
   288
   289 6358 AD 3A AA			lda GameFontAddress+8*71+2
   290 635B 4A				lsr											; put left bit in the carry
   291 635C 6E 32 AA			ror GameFontAddress+8*70+2
   292 635F 6E 3A AA			ror GameFontAddress+8*71+2
   293 6362 6E 32 AA			ror GameFontAddress+8*70+2
   294 6365 6E 3A AA			ror GameFontAddress+8*71+2
   295
   296 				;*****	Exit
   297 				;
   298 6368			Exit
   299 6368 60					rts
   300
   301 				.endp	
   302
   303 				;
   304 				;***************************************************************************************************
   305 				;	
   306 				;	AnimateVerticalLaser
   307 				;	
   308 				; 		do vertical line dither, laser animation (char 20, 21, 22)
   309 				; 
   310 				;***************************************************************************************************
   311 				;	
   312 6369			.proc AnimateVerticalLaser
   313
   314 6369 AD 76 32				lda m_verticalLaserOn
   315 636C F0 2F				beq Exit
   316 						
   317 636E CE 86 32				dec m_animLaserTimer						
   318 6371 D0 2A				bne Exit
   319
   320 6373 AE 87 32				ldx m_animLaserCurrentFrame
   321 6376 E8					inx
   322 6377 E0 3D				cpx #ANIM_LASER_FRAMES
   323 6379 D0 02				bne NextFrame
   324 						
   325 637B A2 00				ldx #0
   326
   327 				;*****	Animate Vertical Laser Next Frame
   328 				;
   329 637D			NextFrame
   330
   331 637D 8E 87 32				stx m_animLaserCurrentFrame
   332
   333 6380 BD 53 62				lda TabAnimLaserFrameTime,x
   334 6383 8D 86 32				sta m_animLaserTimer
   335
   336 6386 BD 22 61				lda TabAnimLaserFrameAddressLSB,x
   337 6389 8D 95 63				sta CopyFrame+1
   338
   339 638C BD 5F 61				lda TabAnimLaserFrameAddressMSB,x
   340 638F 8D 96 63				sta CopyFrame+2
   341
   342 6392 A0 07				ldy #7
   343 					
   344 				;*****	Animate Vertical Laser Copy Frame
   345 				;
   346 6394			CopyFrame
   347 					
   348 6394 B9 FF FF				lda $FFFF,y
   349 6397 99 A8 A8				sta GameFontAddress+8*21,y
   350 639A 88					dey
   351 639B 10 F7				bpl CopyFrame
   352
   353 				;*****	Animate Vertical Laser End
   354 				;
   355 639D			Exit
   356 						
   357 639D 60					rts
   358
   359 				.endp
   360
   361 				;
   362 				;***************************************************************************************************
   363 				;	
   364 				;	AnimateHorizontalLaser
   365 				;	
   366 				; 		do horizontal line dither, laser animation (char 23, 24, 25)
   367 				; 
   368 				;***************************************************************************************************
   369 				;	
   370 639E			.proc AnimateHorizontalLaser
   371
   372 639E AD 77 32				lda m_horizontalLaserOn
   373 63A1 F0 2F				beq Exit
   374
   375 63A3 CE 84 32				dec m_animHLaserTimer						
   376 63A6 D0 2A				bne Exit
   377
   378 63A8 AE 85 32				ldx m_animHLaserCurrentFrame
   379 63AB E8					inx
   380 63AC E0 3D				cpx #ANIM_HLASER_FRAMES
   381 63AE D0 02				bne NextFrame
   382 						
   383 63B0 A2 00				ldx #0
   384
   385 				;******	Animate Horizontal Laser Next Frame
   386 				;
   387 63B2			NextFrame
   388 						
   389 63B2 8E 85 32				stx m_animHLaserCurrentFrame
   390 63B5 BD 16 62				lda TabAnimHLaserFrameTime,x
   391 63B8 8D 84 32				sta m_animHLaserTimer
   392
   393 63BB BD 9C 61				lda TabAnimHLaserFrameAddressLSB,x
   394 63BE 8D CA 63				sta CopyFrame+1
   395 						
   396 63C1 BD D9 61				lda TabAnimHLaserFrameAddressMSB,x
   397 63C4 8D CB 63				sta CopyFrame+2
   398
   399 63C7 A0 02				ldy #2
   400
   401 				;*****	Animate Horizontal Laser Copy Frame
   402 				;
   403 63C9			CopyFrame
   404 					
   405 63C9 B9 FF FF				lda $FFFF,y
   406 63CC 99 CA A8				sta GameFontAddress+8*25+2,y
   407 63CF 88					dey
   408 63D0 10 F7				bpl CopyFrame
   409
   410 				;*****	Animate Horizontal Laser Exit
   411 				;
   412 63D2			Exit
   413 63D2 60					rts
   414
   415 				.endp
   416
   417 				;
   418 				;***************************************************************************************************
   419 				;	
   420 				;	AnimateMisc
   421 				;	
   422 				; 		do misc animation
   423 				; 
   424 				;***************************************************************************************************
   425 				;	
   426 63D3			.proc AnimateMisc
   427
   428 63D3 A2 00				ldx #$00
   429
   430 63D5 BD 3F 36				lda TabAnimationMiscMap[0], x
   431 63D8 85 E3				sta m_paramW01
   432
   433 63DA BD 40 36				lda TabAnimationMiscMap[0]+1, x
   434 63DD 85 E4				sta m_paramW01+1
   435 						
   436 63DF BD 42 36				lda TabAnimationMiscMap[0]+3, x
   437 63E2 85 9A				sta m_animMiscWidth
   438
   439 63E4 BD 43 36				lda TabAnimationMiscMap[0]+4, x
   440 63E7 85 9B				sta m_animMiscHeight
   441 					
   442 63E9 A5 AE				lda m_playerScreenTopY
   443 63EB A4 9B				ldy m_animMiscHeight		
   444 63ED			Sub1
   445 63ED 38					sec
   446 63EE E9 01				sbc #$01
   447 63F0 88					dey
   448 63F1 D0 FA				bne Sub1
   449 						
   450 								 
   451 						
   452 63F3			Loop
   453 								
   454
   455 				;*****	Exit Method
   456 63F3			Exit
   457
   458 63F3 60					rts
   459
   460 				.endp
   337 63F4					icl "CameraLogic.Asm"
Source: E:\_8BitProjects\Series\Scroller\CameraLogic.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		CameraLogic.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Local Storage
    15 				;**************************************************************************************************
    16 				;
    17 63F4 0C 0B 0A 09		TabOffsetForHSCROL			.byte 12,11,10,9
    18 63F8 00 01 02 03 04 05 + TabOffsetForVSCROL			.byte 0,1,2,3,4,5,6,7
    19
    20 6400			TabMultiply82_LSB			
    21 6400 00 52 A4 F6 48 9A + 	:26 .byte <[#*LEVEL_CHAR_SIZE_X]
    22
    23 641A			TabMultiply82_MSB
    24 641A 00 00 00 00 01 01 + 	:26 .byte >[#*LEVEL_CHAR_SIZE_X]
    25 				;
    26 				;**************************************************************************************************
    27 				; UpdateCameraWindow
    28 				;
    29 				; 	update target window pos (m_windowTargetPos*_*), using the player level position,
    30 				; 	correct (clamp) target window pos with level limits if necessary
    31 				;
    32 				;**************************************************************************************************
    33 				;
    34 6434			.proc UpdateCameraWindow
    35
    36 				;************************************************
    37 				;
    38 6434			UCW_check_left_limit
    39 					
    40 						; check left limit (clamp to the left)
    41 6434 A5 A1				lda m_playerLevelLeftX_H2				
    42 6436 C9 00				cmp #>[[[WINDOW_CHAR_SIZE_X*CHAR_PIX.else_X]/2+CHAR_PIX.else_X]-2]						; [[[40 * 4] / 2 + 4] - 2]
    43 6438 90 08				bcc UCW_force_left_limit
    44 643A D0 13				bne UCW_check_right_limit
    45 						
    46 643C A5 A2				lda m_playerLevelLeftX_H1
    47 643E C9 52				cmp #<[[[WINDOW_CHAR_SIZE_X*CHAR_PIX.else_X]/2+CHAR_PIX.else_X]-2]						; [[[40 * 4] / 2 + 4] - 2]
    48 6440 B0 0D				bcs UCW_check_right_limit
    49
    50 				;************************************************
    51 				;
    52 6442			UCW_force_left_limit
    53 						
    54 6442 A9 00				lda #>[CHAR_PIX.else_X]
    55 6444 8D 8D 32				sta m_windowTargetPosX_H2
    56 						
    57 6447 A9 04				lda #<[CHAR_PIX.else_X]
    58 6449 8D 8C 32				sta m_windowTargetPosX_H1
    59 						
    60 644C 4C 79 64				jmp UCW_check_top_limit
    61
    62 				;************************************************
    63 				;
    64 644F			UCW_check_right_limit
    65 					
    66 						; check right limit (clamp to the right)
    67 644F A9 00				lda #>[[[LEVEL_CHAR_SIZE_X-WINDOW_CHAR_SIZE_X/2]*CHAR_PIX.else_X-CHAR_PIX.else_X]+1]	; [[[82-40 / 2] * 4 - 4] + 1]
    68 																											; [[[ 62 ] * 4 - 4] + 1]
    69 																											; [ 244 + 1] = 245	
    70 6451 C5 A4				cmp m_playerLevelRightX_H2	
    71 6453 90 08				bcc UCW_force_right_limit
    72 6455 D0 13				bne UCW_set_target_x
    73 						
    74 6457 A9 F5				lda #<[[[LEVEL_CHAR_SIZE_X-WINDOW_CHAR_SIZE_X/2]*CHAR_PIX.else_X-CHAR_PIX.else_X]+1]	; [[[82-40 / 2] * 4 - 4] + 1]
    75 																											; [[[ 62 ] * 4 - 4] + 1]
    76 																											; [ 244 + 1] = 245	
    77 6459 C5 A5				cmp m_playerLevelRightX_H1
    78 645B B0 0D				bcs UCW_set_target_x
    79
    80 				;************************************************
    81 				;
    82 645D			UCW_force_right_limit
    83 					
    84 645D A9 00				lda #>[[LEVEL_CHAR_SIZE_X-WINDOW_CHAR_SIZE_X]*CHAR_PIX.else_X-CHAR_PIX.else_X]
    85 645F 8D 8D 32				sta m_windowTargetPosX_H2
    86 					
    87 6462 A9 A4				lda #<[[LEVEL_CHAR_SIZE_X-WINDOW_CHAR_SIZE_X]*CHAR_PIX.else_X-CHAR_PIX.else_X]
    88 6464 8D 8C 32				sta m_windowTargetPosX_H1
    89 					
    90 6467 4C 79 64				jmp UCW_check_top_limit
    91
    92 				;************************************************
    93 				; no clamp, use current player X position 
    94 				; and substract half the window size
    95 				;
    96 646A			UCW_set_target_x
    97 					
    98 646A A5 A2				lda m_playerLevelLeftX_H1
    99 646C 38					sec
   100 646D E9 4E				sbc #<[[[WINDOW_CHAR_SIZE_X*CHAR_PIX.else_X]/2]-2]
   101 646F 8D 8C 32				sta m_windowTargetPosX_H1
   102 					
   103 6472 A5 A1				lda m_playerLevelLeftX_H2
   104 6474 E9 00				sbc #>[[[WINDOW_CHAR_SIZE_X*CHAR_PIX.else_X]/2]-2]
   105 6476 8D 8D 32				sta m_windowTargetPosX_H2
   106
   107 				;************************************************
   108 				; check top limit (clamp to the top)
   109 				; 
   110 6479			UCW_check_top_limit
   111 						
   112 6479 A5 A7				lda m_playerLevelTopY_H2
   113 647B C9 00				cmp #>[[WINDOW_CHAR_SIZE_Y*CHAR_PIX.else_Y/2]-4]
   114 647D 90 08				bcc UCW_force_top_limit
   115 647F D0 13				bne UCW_check_bottom_limit
   116 						
   117 6481 A5 A8				lda m_playerLevelTopY_H1
   118 6483 C9 5C				cmp #<[[WINDOW_CHAR_SIZE_Y*CHAR_PIX.else_Y/2]-4]
   119 6485 B0 0D				bcs UCW_check_bottom_limit
   120
   121 				;************************************************
   122 				;
   123 6487			UCW_force_top_limit
   124 						
   125 6487 A9 00				lda #>[0]
   126 6489 8D 8F 32				sta m_windowTargetPosY_H2
   127 					
   128 648C A9 00				lda #<[0]
   129 648E 8D 8E 32				sta m_windowTargetPosY_H1
   130 					
   131 6491 4C BE 64				jmp UCW_get_deltas
   132
   133 				;************************************************
   134 				; check bottom limit (clamp to the bottom)
   135 				;
   136 6494			UCW_check_bottom_limit
   137 						
   138 6494 A9 00				lda #>[[[LEVEL_CHAR_SIZE_Y-WINDOW_CHAR_SIZE_Y/2]*CHAR_PIX.else_Y]+3]
   139 6496 C5 AA				cmp m_playerLevelBottomY_H2
   140 6498 90 08				bcc UCW_force_bottom_limit
   141 649A D0 13				bne UCW_set_target_y
   142 						
   143 649C A9 63				lda #<[[[LEVEL_CHAR_SIZE_Y-WINDOW_CHAR_SIZE_Y/2]*CHAR_PIX.else_Y]+3]
   144 649E C5 AB				cmp m_playerLevelBottomY_H1
   145 64A0 B0 0D				bcs UCW_set_target_y
   146
   147 				;************************************************
   148 				;
   149 64A2			UCW_force_bottom_limit
   150 					
   151 64A2 A9 00				lda #>[[LEVEL_CHAR_SIZE_Y-WINDOW_CHAR_SIZE_Y]*CHAR_PIX.else_Y]
   152 64A4 8D 8F 32				sta m_windowTargetPosY_H2
   153 					
   154 64A7 A9 00				lda #<[[LEVEL_CHAR_SIZE_Y-WINDOW_CHAR_SIZE_Y]*CHAR_PIX.else_Y]
   155 64A9 8D 8E 32				sta m_windowTargetPosY_H1
   156 						
   157 64AC 4C BE 64				jmp UCW_get_deltas
   158
   159 				;************************************************
   160 				; no clamp, use current player Y position and substract half the window size
   161 				;
   162 64AF			UCW_set_target_y
   163 					
   164 64AF A5 A8				lda m_playerLevelTopY_H1
   165 64B1 38					sec		
   166 64B2 E9 5C				sbc #<[[WINDOW_CHAR_SIZE_Y*CHAR_PIX.else_Y/2]-4]
   167 64B4 8D 8E 32				sta m_windowTargetPosY_H1
   168 					
   169 64B7 A5 A7				lda m_playerLevelTopY_H2
   170 64B9 E9 00				sbc #>[[WINDOW_CHAR_SIZE_Y*CHAR_PIX.else_Y/2]-4]
   171 64BB 8D 8F 32				sta m_windowTargetPosY_H2
   172
   173 				;************************************************
   174 				; calculate deltas in X and Y for the current and
   175 				; the target window pos, update the current window
   176 				; pos according to the distance to the target
   177 				; (compare the level window with the target pos, 
   178 				; get the delta and divide it by 8, so the movement 
   179 				; speed is proportional to the distance, with a minimum step of 1)
   180 				;
   181 64BE			UCW_get_deltas
   182
   183 				;************************************************
   184 				;
   185 64BE			UCW_check_deltaX								
   186 						
   187 64BE A5 DA				lda m_levelWindowX_H2					; compare target X and current X
   188 64C0 CD 8D 32				cmp m_windowTargetPosX_H2
   189 64C3 90 4D				bcc UCW_deltaX_positive
   190 64C5 D0 0C				bne UCW_deltaX_negative
   191 					
   192 64C7 A5 DB				lda m_levelWindowX_H1
   193 64C9 CD 8C 32				cmp m_windowTargetPosX_H1
   194 												
   195 64CC 90 44				bcc UCW_deltaX_positive					; target X equal to current X
   196 64CE D0 03				bne UCW_deltaX_negative
   197 64D0 4C 4E 65				jmp UCW_deltaX_exit						; target X equal to current X
   198
   199 				;************************************************
   200 				;
   201 64D3			UCW_deltaX_negative								
   202 64D3 A5 DB				lda m_levelWindowX_H1 					; target X lower than current X
   203 64D5 38					sec
   204 64D6 ED 8C 32				sbc m_windowTargetPosX_H1
   205 64D9 8D 90 32				sta m_windowTargetDeltaX_H1
   206 					
   207 64DC A5 DA				lda m_levelWindowX_H2
   208 64DE ED 8D 32				sbc m_windowTargetPosX_H2
   209 64E1 8D 91 32				sta m_windowTargetDeltaX_H2
   210
   211 				;************************************************
   212 				;
   213 64E4			UCW_dxn_divide
   214
   215 64E4 AD 91 32				lda m_windowTargetDeltaX_H2
   216 64E7 4A					lsr
   217 64E8 6E 90 32				ror m_windowTargetDeltaX_H1				; /2
   218 64EB 4A					lsr
   219 64EC 6E 90 32				ror m_windowTargetDeltaX_H1				; /4
   220 64EF 4A					lsr
   221 64F0 6E 90 32				ror m_windowTargetDeltaX_H1				; /8
   222 64F3 8D 91 32				sta m_windowTargetDeltaX_H2
   223
   224 64F6 0D 90 32				ora m_windowTargetDeltaX_H1				; check that delta X is greater than zero
   225 64F9 D0 05				bne UCW_apply_negative_deltaX
   226 						
   227 64FB A9 01				lda #MINIMUM_CAMERA_STEP
   228 64FD 8D 90 32				sta m_windowTargetDeltaX_H1
   229 					
   230 				;************************************************
   231 				;
   232 6500			UCW_apply_negative_deltaX
   233 					
   234 6500 A5 DB				lda m_levelWindowX_H1
   235 6502 38					sec
   236 6503 ED 90 32				sbc m_windowTargetDeltaX_H1
   237 6506 85 DB				sta m_levelWindowX_H1
   238 6508 A5 DA				lda m_levelWindowX_H2
   239 650A ED 91 32				sbc m_windowTargetDeltaX_H2
   240 650D 85 DA				sta m_levelWindowX_H2
   241
   242 				;************************************************
   243 				;
   244 650F			UCW_deltaX_exit_jmp
   245 					
   246 650F 4C 4E 65				jmp UCW_deltaX_exit
   247
   248 				;************************************************
   249 				;
   250 6512			UCW_deltaX_positive								
   251 						
   252 6512 AD 8C 32				lda m_windowTargetPosX_H1				; target X greater than current X
   253 6515 38					sec
   254 6516 E5 DB				sbc m_levelWindowX_H1
   255 6518 8D 90 32				sta m_windowTargetDeltaX_H1
   256 					
   257 651B AD 8D 32				lda m_windowTargetPosX_H2
   258 651E E5 DA				sbc m_levelWindowX_H2
   259 6520 8D 91 32				sta m_windowTargetDeltaX_H2
   260
   261 				;************************************************
   262 				;
   263 6523			UCW_dxp_divide
   264 						
   265 6523 AD 91 32				lda m_windowTargetDeltaX_H2
   266 6526 4A					lsr
   267 6527 6E 90 32				ror m_windowTargetDeltaX_H1				; /2
   268 652A 4A					lsr
   269 652B 6E 90 32				ror m_windowTargetDeltaX_H1				; /4
   270 652E 4A					lsr
   271 652F 6E 90 32				ror m_windowTargetDeltaX_H1				; /8
   272 6532 8D 91 32				sta m_windowTargetDeltaX_H2
   273
   274 6535 0D 90 32				ora m_windowTargetDeltaX_H1				; check that delta X is greater than zero
   275 6538 D0 05				bne UCW_apply_positive_deltaX
   276 						
   277 653A A9 01				lda #MINIMUM_CAMERA_STEP
   278 653C 8D 90 32				sta m_windowTargetDeltaX_H1
   279
   280 				;************************************************
   281 				;
   282 653F			UCW_apply_positive_deltaX
   283 						
   284 653F A5 DB				lda m_levelWindowX_H1
   285 6541 18					clc
   286 6542 6D 90 32				adc m_windowTargetDeltaX_H1
   287 6545 85 DB				sta m_levelWindowX_H1
   288 						
   289 6547 A5 DA				lda m_levelWindowX_H2
   290 6549 6D 91 32				adc m_windowTargetDeltaX_H2
   291 654C 85 DA				sta m_levelWindowX_H2
   292
   293 				;************************************************
   294 				;
   295 654E			UCW_deltaX_exit
   296
   297 				;************************************************
   298 				;
   299 654E			UCW_check_deltaY								
   300 						
   301 654E A5 DC				lda m_levelWindowY_H2					; compare target Y and current Y	
   302 6550 CD 8F 32				cmp m_windowTargetPosY_H2
   303 6553 90 44				bcc UCW_deltaY_positive
   304 6555 D0 09				bne UCW_deltaY_negative
   305 					
   306 6557 A5 DD				lda m_levelWindowY_H1
   307 6559 CD 8E 32				cmp m_windowTargetPosY_H1
   308 655C F0 71				beq UCW_deltaY_exit						; target Y equal to current Y
   309 655E 90 39				bcc UCW_deltaY_positive
   310
   311 				;************************************************
   312 				;
   313 6560			UCW_deltaY_negative								
   314 						
   315 6560 A5 DD				lda m_levelWindowY_H1					; target Y lower than current Y
   316 6562 38					sec
   317 6563 ED 8E 32				sbc m_windowTargetPosY_H1
   318 6566 8D 92 32				sta m_windowTargetDeltaY_H1
   319 						
   320 6569 A5 DC				lda m_levelWindowY_H2
   321 656B ED 8F 32				sbc m_windowTargetPosY_H2
   322
   323 656E 4A					lsr
   324 656F 6E 92 32				ror m_windowTargetDeltaY_H1				; /2
   325 6572 4A					lsr
   326 6573 6E 92 32				ror m_windowTargetDeltaY_H1				; /4
   327 6576 4A					lsr
   328 6577 6E 92 32				ror m_windowTargetDeltaY_H1				; /8
   329 657A 8D 93 32				sta m_windowTargetDeltaY_H2
   330
   331 657D 0D 92 32				ora m_windowTargetDeltaY_H1				; check that delta Y is greater than zero
   332 6580 D0 05				bne UCW_apply_negative_deltaY
   333 						
   334 6582 A9 01				lda #MINIMUM_CAMERA_STEP
   335 6584 8D 92 32				sta m_windowTargetDeltaY_H1
   336 				;
   337 				;**************************************************************************************************
   338 				;
   339 6587			UCW_apply_negative_deltaY
   340 						
   341 6587 A5 DD				lda m_levelWindowY_H1
   342 6589 38					sec
   343 658A ED 92 32				sbc m_windowTargetDeltaY_H1
   344 658D 85 DD				sta m_levelWindowY_H1
   345 						
   346 658F A5 DC				lda m_levelWindowY_H2
   347 6591 ED 93 32				sbc m_windowTargetDeltaY_H2
   348 6594 85 DC				sta m_levelWindowY_H2
   349
   350 6596 4C CF 65				jmp UCW_deltaY_exit
   351 				;
   352 				;**************************************************************************************************
   353 				;
   354 6599			UCW_deltaY_positive								
   355 						
   356 6599 AD 8E 32				lda m_windowTargetPosY_H1				; target Y greater than current Y
   357 659C 38					sec
   358 659D E5 DD				sbc m_levelWindowY_H1
   359 659F 8D 92 32				sta m_windowTargetDeltaY_H1
   360 						
   361 65A2 AD 8F 32				lda m_windowTargetPosY_H2
   362 65A5 E5 DC				sbc m_levelWindowY_H2
   363
   364 65A7 4A					lsr
   365 65A8 6E 92 32				ror m_windowTargetDeltaY_H1				; /2
   366 65AB 4A					lsr
   367 65AC 6E 92 32				ror m_windowTargetDeltaY_H1				; /4
   368 65AF 4A					lsr
   369 65B0 6E 92 32				ror m_windowTargetDeltaY_H1				; /8
   370 65B3 8D 93 32				sta m_windowTargetDeltaY_H2
   371
   372 65B6 0D 92 32				ora m_windowTargetDeltaY_H1				; check that delta Y is greater than zero
   373 65B9 D0 05				bne UCW_apply_positive_deltaY
   374 						
   375 65BB A9 01				lda #MINIMUM_CAMERA_STEP
   376 65BD 8D 92 32				sta m_windowTargetDeltaY_H1
   377
   378 				;************************************************
   379 				;
   380 65C0			UCW_apply_positive_deltaY
   381 						
   382 65C0 A5 DD				lda m_levelWindowY_H1
   383 65C2 18					clc
   384 65C3 6D 92 32				adc m_windowTargetDeltaY_H1
   385 65C6 85 DD				sta m_levelWindowY_H1
   386 						
   387 65C8 A5 DC				lda m_levelWindowY_H2
   388 65CA 6D 93 32				adc m_windowTargetDeltaY_H2
   389 65CD 85 DC				sta m_levelWindowY_H2
   390
   391 				;************************************************
   392 				;
   393 65CF			UCW_deltaY_exit
   394
   395 				;************************************************
   396 				; update all LMS in the display list
   397 				;
   398 65CF			UCW_update_LMS
   399 						
   400 65CF A5 DA				lda m_levelWindowX_H2
   401 65D1 8D 89 32				sta m_screenBaseAddress1+1
   402 						
   403 65D4 A5 DB				lda m_levelWindowX_H1
   404 65D6 4E 89 32				lsr m_screenBaseAddress1+1
   405 65D9 6A					ror										; /2
   406 65DA 4E 89 32				lsr m_screenBaseAddress1+1
   407 65DD 6A					ror										; /4 == CHAR_PIX.else_X
   408
   409 65DE 18					clc
   410 65DF 69 FF				adc #<[GAME_MEM-1]
   411 65E1 8D 8A 32				sta m_screenBaseAddress2
   412 						
   413 65E4 AD 89 32				lda m_screenBaseAddress1+1
   414 65E7 69 AF				adc #>[GAME_MEM-1]
   415 65E9 8D 8B 32				sta m_screenBaseAddress2+1
   416
   417
   418 65EC A5 DC				lda m_levelWindowY_H2
   419 65EE 8D 89 32				sta m_screenBaseAddress1+1
   420 65F1 A5 DD				lda m_levelWindowY_H1
   421
   422 65F3 4E 89 32				lsr m_screenBaseAddress1+1
   423 65F6 6A					ror										; /2
   424 65F7 4E 89 32				lsr m_screenBaseAddress1+1
   425 65FA 6A					ror										; /4
   426 65FB 4E 89 32				lsr m_screenBaseAddress1+1
   427 65FE 6A					ror										; /8 == CHAR_PIX.else_Y
   428
   429 65FF AA					tax
   430 6600 BD 00 64				lda TabMultiply82_LSB,x
   431 6603 18					clc
   432 6604 6D 8A 32				adc m_screenBaseAddress2
   433 6607 8D 8A 32				sta m_screenBaseAddress2
   434 					
   435 660A BD 1A 64				lda TabMultiply82_MSB,x
   436 660D 6D 8B 32				adc m_screenBaseAddress2+1
   437 6610 8D 8B 32				sta m_screenBaseAddress2+1
   438
   439 6613 A2 00				ldx #0
   440
   441 				;************************************************
   442 				;
   443 6615			UCW_update_LMS_loop
   444
   445 6615 AD 8A 32				lda m_screenBaseAddress2
   446 6618 9D 04 0E				sta GAME_LMS1+1,x						; should update this outside the screen zone!
   447 						
   448 661B AD 8B 32				lda m_screenBaseAddress2+1
   449 661E 9D 05 0E				sta GAME_LMS1+2,x						; should update this outside the screen zone!
   450
   451 6621 AD 8A 32				lda m_screenBaseAddress2
   452 6624 18					clc
   453 6625 69 52				adc #LEVEL_CHAR_SIZE_X
   454 6627 8D 8A 32				sta m_screenBaseAddress2
   455 						
   456 662A AD 8B 32				lda m_screenBaseAddress2+1
   457 662D 69 00				adc #0
   458 662F 8D 8B 32				sta m_screenBaseAddress2+1
   459
   460 6632 E8					inx
   461 6633 E8					inx
   462 6634 E8					inx
   463 6635 E0 4B				cpx #[[WINDOW_CHAR_SIZE_Y+1]*3]
   464 6637 D0 DC				bne UCW_update_LMS_loop
   465
   466 				;************************************************
   467 				; update HSCROL and VSCROL with the offsets of the window pos
   468 				;
   469 6639 A5 DB				lda m_levelWindowX_H1
   470 663B 29 03				and #[CHAR_PIX.else_X-1]
   471 663D AA					tax
   472 						
   473 663E BD F4 63				lda TabOffsetForHSCROL,x
   474 6641 8D 04 D4				sta HSCROL								; should update this outside the screen zone!
   475
   476 6644 A5 DD				lda m_levelWindowY_H1
   477 6646 29 07				and #[CHAR_PIX.else_Y-1]
   478 6648 AA					tax
   479 					
   480 6649 BD F8 63				lda TabOffsetForVSCROL,x
   481 664C 8D 05 D4				sta VSCROL								; should update this outside the screen zone!
   482 						
   483 664F 60					rts
   484 					
   485 				.endp	
   338 6650					icl "EnemyManager.Asm"
Source: E:\_8BitProjects\Series\Scroller\EnemyManager.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		EnemyManager.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Local Storage
    15 				;**************************************************************************************************
    16 				;
    17 = 0020			MAX_ENEMIES_PER_LEVEL 			= 32
    18 = 0002			MAX_ENEMY_MISSILES 				= 2
    19 = 0016			MAX_EXPLOSION_STEPS 			= 22
    20
    21 				.if PAL_VERSION = 0
    22 = 002A			ENEMY_EXPLOSION_COLOR 			= 32+10
    23 				.else
    24 				ENEMY_EXPLOSION_COLOR 			= 16+10
    25 				.endif
    26
    27 6650			TabEnemyExplosionColor
    28 				.if PAL_VERSION = 0
    29 6650 20 0E 0E 0E 0C 0C + 								.byte +32, 14, 14, 14, 12, 12, 12, 10, 10, 10, 8, 8, 8, 6, 6, 6, 4, 4, 4, 2, 2, 2, 0
    30 				.else
    31 												.byte +16, 14, 14, 14, 12, 12, 12, 10, 10, 10, 8, 8, 8, 6, 6, 6, 4, 4, 4, 2, 2, 2, 0
    32 				.endif
    33
    34 6667 08			TabEnemyShapeSizeY				.byte 8
    35
    36 6668			TabEnemyShape_01
    37 6668 3C											.byte %00111100
    38 6669 E7											.byte %11100111
    39 666A 18											.byte %00011000
    40 666B E7											.byte %11100111
    41 666C 3C											.byte %00111100
    42 666D 00											.byte %00000000
    43 666E 3C											.byte %00111100
    44 666F 7E											.byte %01111110
    45
    46
    47 6670 00 00 00 00 00 00 + TabEnemyType					:MAX_ENEMIES_PER_LEVEL .byte $00
    48 					
    49
    50 				; this table could be per level, if we can go back to the same screen
    51 6690 00 00 00 00 00 00 + TabEnemyLife					:MAX_ENEMIES_PER_LEVEL .byte $00
    52 					                        	
    53 				                            	
    54 66B0 00 00 00 00 00 00 + TabEnemyState					:MAX_ENEMIES_PER_LEVEL .byte $00
    55 					                        	
    56 66D0 00 00 00 00 00 00 + TabEnemyStateTimer				:MAX_ENEMIES_PER_LEVEL .byte $00
    57 					                        	
    58 				                            	
    59 66F0 00 00 00 00 00 00 + TabEnemyBaseCharIndex			:MAX_ENEMIES_PER_LEVEL .byte $00	
    60 					
    61 6710 00 00 00 00 00 00 + TabEnemyBaseCharX				:MAX_ENEMIES_PER_LEVEL .byte $00
    62 6730 00 00 00 00 00 00 + TabEnemyBaseCharY				:MAX_ENEMIES_PER_LEVEL .byte $00
    63
    64 6750 00 00 00 00 00 00 + TabEnemyLevelLeftX_H1			:MAX_ENEMIES_PER_LEVEL .byte $00
    65 6770 00 00 00 00 00 00 + TabEnemyLevelLeftX_H2			:MAX_ENEMIES_PER_LEVEL .byte $00
    66 6790 00 00 00 00 00 00 + TabEnemyLevelTopY_H1			:MAX_ENEMIES_PER_LEVEL .byte $00
    67 67B0 00 00 00 00 00 00 + TabEnemyLevelTopY_H2			:MAX_ENEMIES_PER_LEVEL .byte $00
    68
    69 67D0 00 00 00 00 00 00 + TabEnemyShotLevelLeftX_H1		:MAX_ENEMIES_PER_LEVEL .byte $00
    70 67F0 00 00 00 00 00 00 + TabEnemyShotLevelLeftX_H2		:MAX_ENEMIES_PER_LEVEL .byte $00
    71 6810 00 00 00 00 00 00 + TabEnemyShotLevelTopY_H1		:MAX_ENEMIES_PER_LEVEL .byte $00
    72 6830 00 00 00 00 00 00 + TabEnemyShotLevelTopY_H2		:MAX_ENEMIES_PER_LEVEL .byte $00
    73
    74
    75 				; enemy definition tables (index or type 0 is not used)
    76 6850 00 01		TabEnemyDefLife					.byte $00, $01
    77
    78 6852 00 C0		TabEnemyDefBaseChar				.byte $00, $C0
    79
    80 6854			TabEnemyDefShootCooldown		
    81 				.if PAL_VERSION = 0
    82 6854 00 78										.byte $00, $78
    83 				.else
    84 												.byte $00, $64
    85 				.endif
    86
    87 6856			UpdateEnemyManager
    88
    89 				; update one enemy per frame, rotate through all active enemies
    90 6856 AD A2 32			lda m_activeEnemies
    91 6859 D0 03			bne UEM_active_enemies
    92 685B 4C FB 68			jmp UEM_exit
    93
    94 685E			UEM_active_enemies
    95 				; update state timer for all enemies (if we don't want to do this, we should use a general time stamp system)
    96 685E A2 00			ldx #0
    97 6860			UEM_loop1
    98 6860 BD D0 66			lda TabEnemyStateTimer,x
    99 6863 F0 03			beq UEM_next_timer
   100 6865 DE D0 66			dec TabEnemyStateTimer,x
   101 6868			UEM_next_timer
   102 6868 E8				inx
   103 6869 EC A1 32			cpx m_totalEnemies
   104 686C D0 F2			bne UEM_loop1
   105
   106 				; iterate until we find the next active enemy
   107 686E AE A7 32			ldx m_lastEnemyIndexUpdated
   108 					
   109 6871			UEM_loop2
   110 6871 E8				inx
   111 6872 EC A1 32			cpx m_totalEnemies
   112 6875 D0 02			bne UEM_no_loop_back
   113 6877 A2 00			ldx #0
   114 6879			UEM_no_loop_back
   115 6879 BD B0 66			lda TabEnemyState,x		; state 0 implies a disabled enemy
   116 687C F0 F3			beq UEM_loop2
   117 687E 8E A7 32			stx m_lastEnemyIndexUpdated
   118
   119 				; should use the enemy type to jump to the correct update for that type
   120
   121 				; check state timer, update state if is 0
   122 6881 BD D0 66			lda TabEnemyStateTimer,x
   123 6884 D0 75			bne UEM_exit
   124
   125 				; timer is 0, check if the player is near enough to shoot, in what direction, and if there are missiles available
   126 				; (maybe check against the maximum number of enemy missiles possible)
   127 6886			UEM_check_shoot
   128 6886 AD A8 32			lda m_enemyMissilesActive
   129 6889 C9 02			cmp #MAX_ENEMY_MISSILES
   130 688B F0 6E			beq UEM_exit
   131 					
   132 				; check delta Y between the player and the enemy
   133 688D A5 A8			lda m_playerLevelTopY_H1
   134 688F 38				sec
   135 6890 FD 90 67			sbc TabEnemyLevelTopY_H1,x
   136 6893 85 EB			sta m_pageZeroTempPointer
   137 6895 A5 A7			lda m_playerLevelTopY_H2
   138 6897 FD B0 67			sbc TabEnemyLevelTopY_H2,x
   139 689A 85 EC			sta m_pageZeroTempPointer+1
   140
   141 689C A5 EB			lda m_pageZeroTempPointer
   142 689E 18				clc
   143 689F 69 20			adc #ENEMY_SHOOT_DELTA_Y
   144 68A1 85 EB			sta m_pageZeroTempPointer
   145 68A3 A5 EC			lda m_pageZeroTempPointer+1
   146 68A5 69 00			adc #0
   147 68A7 85 EC			sta m_pageZeroTempPointer+1
   148 68A9 D0 50			bne UEM_exit	; abort if the high byte is already greater than 0
   149
   150 				; this works for a delta Y lower than 128 (lines)
   151 68AB A5 EB			lda m_pageZeroTempPointer
   152 68AD C9 40			cmp #[ENEMY_SHOOT_DELTA_Y*2]
   153 68AF B0 4A			bcs UEM_exit
   154 					
   155 68B1			UEM_shot
   156 68B1 BC 70 66			ldy TabEnemyType,x
   157 68B4 B9 54 68			lda TabEnemyDefShootCooldown,y
   158 68B7 9D D0 66			sta TabEnemyStateTimer,x					; set shoot cooldown
   159
   160 				; update m_enemyShootDirection (1 - right, 2 - left)
   161
   162 				; player width = 4 pixels, enemy1 width = 8 pixels
   163 				; compare to see if: px + (pw/2) == ex + (ew/2) (the center of the player and the enemy)
   164 				; if player info is equal or greater, then player is to the right of the enemy
   165 68BA A5 A2			lda m_playerLevelLeftX_H1
   166 68BC 38				sec
   167 68BD E9 04			sbc #4
   168 68BF 85 D3			sta m_pageZeroTempValue
   169 68C1 A5 A1			lda m_playerLevelLeftX_H2
   170 68C3 E9 00			sbc #0
   171
   172 68C5 DD 70 67			cmp TabEnemyLevelLeftX_H2,x
   173 68C8 90 0E			bcc UEM_shoot_left
   174 68CA D0 07			bne UEM_shoot_right
   175 					
   176 68CC A5 D3			lda m_pageZeroTempValue
   177 68CE DD 50 67			cmp TabEnemyLevelLeftX_H1,x
   178 68D1 90 05			bcc UEM_shoot_left
   179 					
   180 68D3			UEM_shoot_right
   181 68D3 A9 01			lda #1
   182 68D5 4C DA 68			jmp UEM_just_shoot
   183 68D8			UEM_shoot_left
   184 68D8 A9 02			lda #2
   185 68DA			UEM_just_shoot
   186 68DA 8D A9 32			sta m_enemyShootDirection
   187
   188 				; update shot creation pos (assuming left and right pos are the same in this case)
   189 68DD BD D0 67			lda TabEnemyShotLevelLeftX_H1,x
   190 68E0 8D AA 32			sta m_enemyShotLevelLeftX_H1
   191 68E3 BD F0 67			lda TabEnemyShotLevelLeftX_H2,x
   192 68E6 8D AB 32			sta m_enemyShotLevelLeftX_H2
   193 					
   194 68E9 BD 10 68			lda TabEnemyShotLevelTopY_H1,x
   195 68EC 8D AC 32			sta m_enemyShotLevelTopY_H1
   196 68EF BD 30 68			lda TabEnemyShotLevelTopY_H2,x
   197 68F2 8D AD 32			sta m_enemyShotLevelTopY_H2
   198
   199 68F5 20 31 5D			jsr CheckCreateEnemyMissile
   200 					
   201 68F8 EE A8 32			inc m_enemyMissilesActive
   202 					
   203 68FB			UEM_exit
   204 				/*
   205 					lda m_lastEnemyIndexUpdated
   206 					ldy #23
   207 					jsr DisplayDebugInfoHexFF	
   208 				*/
   208
   209 68FB 60				rts
   210
   211 					
   212 				;================================================================================
   213
   214 68FC			HitEnemy
   215
   216 				; should not use x register
   217 68FC 8E 9F 32			stx m_hitEnemySaveX
   218
   219 				; pass parameters in m_enemyCharPosX and m_enemyCharPosY
   220 				; get address of that char (clear it and the next one) --> comes in m_lineAddressLSB, m_lineAddressMSB
   221 				; get pixel xpos for pm hpos, get pixel ypos for explosion start line
   222
   223 				; search for enemy index at the left char position
   224 68FF A2 00			ldx #0
   225
   226 6901			HE_loop	
   227 6901 BD 10 67			lda TabEnemyBaseCharX,x
   228 6904 CD 9C 32			cmp m_enemyCharPosX
   229 6907 D0 1A			bne HE_next_enemy
   230 6909 BD 30 67			lda TabEnemyBaseCharY,x
   231 690C CD 9D 32			cmp m_enemyCharPosY
   232 690F D0 12			bne HE_next_enemy
   233
   234 6911			HE_found_pos
   235 6911 BD B0 66			lda TabEnemyState,x
   236 6914 F0 66			beq HE_exit				; already disabled
   237 					
   238 6916 BD 90 66			lda TabEnemyLife,x
   239 6919 F0 61			beq HE_exit				; already destroyed
   240
   241 691B DE 90 66			dec TabEnemyLife,x
   242 691E F0 0C			beq HE_destroy_enemy	; life reached 0
   243 					
   244 6920 4C 7C 69			jmp HE_exit				; still alive (no feedback for now?)
   245
   246 6923			HE_next_enemy
   247 6923 E8				inx
   248 6924 EC A1 32			cpx m_totalEnemies
   249 6927 D0 D8			bne HE_loop
   250 6929 4C 7C 69			jmp HE_exit
   251 					
   252 692C			HE_destroy_enemy
   253 692C A9 00			lda #0
   254 692E 9D B0 66			sta TabEnemyState,x
   255 					
   256 6931 CE A2 32			dec m_activeEnemies
   257 					
   258 6934 AD B8 32			lda m_lineAddressLSB
   259 6937 85 E9			sta m_ptrLevelLine
   260 6939 AD B9 32			lda m_lineAddressMSB
   261 693C 85 EA			sta m_ptrLevelLine+1
   262 					
   263 693E AC 9C 32			ldy m_enemyCharPosX
   264 6941 A9 00			lda #0
   265 6943 91 E9			sta (m_ptrLevelLine),y
   266 6945 C8				iny
   267 6946 91 E9			sta (m_ptrLevelLine),y
   268
   269 				; init explosion info (clear previous explosion if there was one active)
   270 6948 AD A0 32			lda m_numEnemyExplosions
   271 694B F0 03			beq HE_no_explosions
   272 					
   273 694D 20 80 69			jsr EraseExplosionFrame
   274
   275 6950			HE_no_explosions
   276 6950 BD 70 67			lda TabEnemyLevelLeftX_H2,x
   277 6953 8D 95 32			sta m_enemyExplosionLevelLeftX_H2
   278 6956 BD 50 67			lda TabEnemyLevelLeftX_H1,x
   279 6959 8D 94 32			sta m_enemyExplosionLevelLeftX_H1
   280 					
   281 695C BD B0 67			lda TabEnemyLevelTopY_H2,x
   282 695F 8D 97 32			sta m_enemyExplosionLevelTopY_H2
   283 6962 BD 90 67			lda TabEnemyLevelTopY_H1,x
   284 6965 8D 96 32			sta m_enemyExplosionLevelTopY_H1
   285 6968 A9 00			lda #0
   286 696A 8D 98 32			sta m_enemyExplosionLevelTopY_L1
   287
   288 696D A9 01			lda #1
   289 696F 8D 9B 32			sta m_enemyExplosionStep
   290 6972 A9 00			lda #0
   291 6974 8D 9E 32			sta m_enemyExplosionStepIndex
   292
   293 6977 A9 01			lda #1
   294 6979 8D A0 32			sta m_numEnemyExplosions		; 1 max for now
   295
   296 697C			HE_exit
   297 697C AE 9F 32			ldx m_hitEnemySaveX
   298 					
   299 697F 60				rts
   300
   301 				;------------------------------------------------------------
   302 				; also clear enemy explosion if the player respawns
   303 				; also clear enemy missiles and m_enemyMissilesActive
   304
   305 6980			EraseExplosionFrame
   306 6980 A2 00			ldx #0
   307 6982 AC 99 32			ldy m_enemyExplosionScreenTopY_H1
   308
   309 6985			EEF_loop
   310 6985 A9 00			lda #0
   311 6987 99 00 A5			sta p1_area_1,y
   312
   313 698A 98				tya
   314 698B 18				clc
   315 698C 6D 9B 32			adc m_enemyExplosionStep
   316 					;bcs EEF_exit				; comment this to allow "wrap around"
   317 698F A8				tay
   318
   319 6990 E8				inx
   320 6991 EC 67 66			cpx TabEnemyShapeSizeY		; should use and index here, if there is more than one enemy explosion
   321 6994 D0 EF			bne EEF_loop
   322
   323 6996			EEF_exit
   324 6996 60				rts
   325
   326 				;------------------------------------------------------------
   327 6997			DrawExplosionFrame
   328 6997 A2 00			ldx #0
   329 6999 AC 99 32			ldy m_enemyExplosionScreenTopY_H1
   330
   331 699C			DEF_loop
   332 699C BD 68 66			lda TabEnemyShape_01,x
   333 699F 99 00 A5			sta p1_area_1,y
   334
   335 69A2 98				tya
   336 69A3 18				clc
   337 69A4 6D 9B 32			adc m_enemyExplosionStep
   338 					;bcs DEF_exit				; comment this to allow "wrap around"
   339 69A7 A8				tay
   340
   341 69A8 E8				inx
   342 69A9 EC 67 66			cpx TabEnemyShapeSizeY		; should use and index here, if there is more than one enemy explosion
   343 69AC D0 EE			bne DEF_loop
   344
   345 69AE			DEF_exit
   346 69AE 60				rts
   347
   348 				;------------------------------------------------------------
   349 69AF			DrawEnemyExplosion
   350 69AF AD A0 32			lda m_numEnemyExplosions
   351 69B2 D0 03			bne DEE_erase
   352 69B4 4C 2E 6A			jmp DEE_exit
   353 					
   354 				; erase previous enemy explosion frame
   355 69B7			DEE_erase
   356 69B7 20 80 69			jsr EraseExplosionFrame
   357
   358 69BA			DEE_update_frame
   359 69BA EE 9E 32			inc m_enemyExplosionStepIndex
   360 69BD AE 9E 32			ldx m_enemyExplosionStepIndex
   361 69C0 E0 16			cpx #MAX_EXPLOSION_STEPS
   362 69C2 90 08			bcc DEE_do_update
   363 					
   364 				; reached end of the explosion
   365 69C4 A9 00			lda #0
   366 69C6 8D A0 32			sta m_numEnemyExplosions
   367
   368 69C9 4C 2E 6A			jmp DEE_exit
   369
   370 69CC			DEE_do_update
   371 69CC BD 50 66			lda TabEnemyExplosionColor,x
   372 69CF 8D 13 D0			sta COLPM1
   373
   374 				; update step and explosion starting line
   375 				; if step +1 --> line - 3.5
   376 				; if step +2 --> line - 7.0
   377 69D2 AD 98 32			lda m_enemyExplosionLevelTopY_L1
   378 69D5 38				sec
   379 69D6 E9 80			sbc #128
   380 69D8 8D 98 32			sta m_enemyExplosionLevelTopY_L1
   381
   382 69DB AD 96 32			lda m_enemyExplosionLevelTopY_H1
   383 69DE E9 03			sbc #3
   384 69E0 8D 96 32			sta m_enemyExplosionLevelTopY_H1
   385
   386 69E3 AD 97 32			lda m_enemyExplosionLevelTopY_H2
   387 69E6 E9 00			sbc #0
   388 69E8 8D 97 32			sta m_enemyExplosionLevelTopY_H2
   389
   390 69EB EE 9B 32			inc m_enemyExplosionStep	; step +1 (delta between every explosion line, in this frame)
   391
   392 				; get new screen pos for the explosion
   393 				; this must use the "_H2" positions for when the delta between the explosion and the camera is too big (64 chars in X, or 32 chars in Y)
   394
   395 69EE AD 94 32			lda m_enemyExplosionLevelLeftX_H1
   396 69F1 38				sec
   397 69F2 E5 DB			sbc m_levelWindowX_H1
   398 69F4 8D BD 32			sta m_screenDelta_H1
   399
   400 69F7 AD 95 32			lda m_enemyExplosionLevelLeftX_H2
   401 69FA E5 DA			sbc m_levelWindowX_H2
   402 69FC 90 1F			bcc DEE_set_outside			; this is not totally correct, because it doesn't use the width of the missile
   403 69FE 8D BC 32			sta m_screenDelta_H2		; (but if we do it correctly we should clip the missile graphics)
   404
   405 6A01 D0 1A			bne DEE_set_outside			; could remove the bcc and only use this..
   406 6A03 AD BD 32			lda m_screenDelta_H1
   407 6A06 C9 A0			cmp #[160]					; 40 chars x 4 pixels
   408 6A08 B0 13			bcs DEE_set_outside
   409 					
   410 6A0A 69 30			adc #PM_BASE_SCREEN_X
   411 6A0C 8D 9A 32			sta m_enemyExplosionScreenLeftX_H1
   412 					
   413
   414 6A0F AD 96 32			lda m_enemyExplosionLevelTopY_H1
   415 6A12 38				sec
   416 6A13 E5 DD			sbc m_levelWindowY_H1
   417
   418 6A15 69 20			adc #PM_BASE_SCREEN_Y
   419 6A17 8D 99 32			sta m_enemyExplosionScreenTopY_H1
   420
   421 6A1A 4C 25 6A			jmp DEE_update_hpos
   422
   423
   424 				; if outside the visible range in X or Y, just set it out of the screen (for a p/m the screen coordinate 0 is outside the visible range)
   425 6A1D			DEE_set_outside
   426 6A1D A9 00			lda #0
   427 6A1F 8D 9A 32			sta m_enemyExplosionScreenLeftX_H1
   428 6A22 8D 99 32			sta m_enemyExplosionScreenTopY_H1
   429
   430
   431 6A25			DEE_update_hpos
   432 6A25 AD 9A 32			lda m_enemyExplosionScreenLeftX_H1
   433 6A28 8D 01 D0			sta HPOSP1
   434
   435 				; draw new enemy explosion frame
   436 6A2B			DEE_draw
   437 6A2B 20 97 69			jsr DrawExplosionFrame
   438
   439
   440 6A2E			DEE_exit
   441 6A2E 60				rts
   442
   339 6A2F					icl "FloatPlatform.Asm"
Source: E:\_8BitProjects\Series\Scroller\FloatPlatform.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		FloatPlatform.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Local Storage
    15 				;**************************************************************************************************
    16 				;
    17 = 0006			FLOAT_PLATFORM_CHR_X    = 6
    18
    19 = 000F			FLOAT_PLATFORM_MAX_X	= 15
    20
    21 = 0005			FLOAT_PLATFORM_MAX_Y	= 5
    22
    23 = 0006			FLOAT_PLATFORM_TIMER	= 6
    24
    25 6A2F 00 26 27 28 29 00	PlatformCharX			.byte $00, $26, $27, $28, $29, $00
    26
    27 6A35 00 00 00 00 00 00 + PlatformLSB				.byte $00, $00, $00, $00, $00, $00, $00, $00 
    28
    29 6A3D 00 00 00 00 00 00 + PlatformMSB				.byte $00, $00, $00, $00, $00, $00, $00, $00 
    30
    31 6A45 00 00 00 00 00 00 + PlatformTime 			.byte $00, $00, $00, $00, $00, $00, $00, $00 
    32
    33 6A4D 00 00 00 00 00 00 + PlatformType 			.byte $00, $00, $00, $00, $00, $00, $00, $00 
    34
    35 6A55 00 00 00 00 00 00 + PlatformDirX			.byte $00, $00, $00, $00, $00, $00, $00, $00
    36
    37 6A5D 00 00 00 00 00 00 + PlatformStepX			.byte $00, $00, $00, $00, $00, $00, $00, $00
    38
    39 6A65 00 00 00 00 00 00 + PlatformStepY			.byte $00, $00, $00, $00, $00, $00, $00, $00
    40
    41 6A6D 26 A6		PlatformCharH			.byte $26, $A6
    42
    43 6A6F 00 00		PlatformCharY			.byte $00, $00
    44
    45 6A71 00 00 00 00 00 00 + PlatformBaseLSB			.byte $00, $00, $00, $00, $00, $00, $00, $00 
    46
    47 6A79 00 00 00 00 00 00 + PlatformBaseMSB			.byte $00, $00, $00, $00, $00, $00, $00, $00 
    48
    49 				;
    50 				;**************************************************************************************************
    51 				; PlatformControlH
    52 				;**************************************************************************************************
    53 6A81			.proc PlatformControlH
    54
    55 6A81 85 96				sta m_SaveRegA
    56 6A83 86 97				stx m_SaveRegX
    57 6A85 84 98				sty m_SaveRegY
    58 					
    59 6A87 AD 72 32				lda m_floatPlatformH
    60 6A8A D0 03				bne LoadIndex
    61 6A8C 4C 33 6B				jmp Exit 
    62 					
    63 6A8F			LoadIndex
    64 				 
    65 6A8F AE 73 32				ldx m_floatPlatformIdx
    66 6A92 CA					dex 
    67 6A93 86 92				stx m_param00
    68 					
    69 6A95 BD 45 6A				lda PlatformTime, x
    70 6A98 C9 06				cmp #FLOAT_PLATFORM_TIMER
    71 6A9A F0 09				beq PerformAnimation
    72 					
    73 6A9C 18					clc
    74 6A9D 69 01				adc #01
    75 6A9F 9D 45 6A				sta PlatformTime, x
    76
    77 6AA2 4C 33 6B				jmp Exit
    78 					
    79 6AA5			PerformAnimation
    80 					
    81 6AA5 BD 35 6A				lda PlatformLSB,x
    82 6AA8 85 EF				sta m_platformLevelPointer
    83 						
    84 6AAA BD 3D 6A				lda PlatformMSB,x
    85 6AAD 85 F0				sta m_platformLevelPointer+1
    86
    87 6AAF BD 55 6A				lda PlatformDirX, x
    88 6AB2 C9 00				cmp #$00
    89 6AB4 F0 07				beq MoveForward
    90 					
    91 6AB6 C5 01				cmp $01
    92 6AB8 F0 35				beq MoveBack 		
    93 					
    94 6ABA 4C 33 6B				jmp Exit
    95 						
    96 6ABD			MoveForward
    97 					
    98 6ABD A0 00				ldy #$00	
    99 6ABF A2 00				ldx #$00	
   100
   101 6AC1			moveF
   102 					
   103 6AC1 BD 2F 6A				lda PlatformCharX, x
   104 6AC4 91 EF				sta (m_platformLevelPointer), y
   105 6AC6 C8					iny
   106 6AC7 E8					inx
   107 6AC8 E0 06				cpx #FLOAT_PLATFORM_CHR_X
   108 6ACA D0 F5				bne moveF
   109
   110 6ACC A6 92				ldx m_param00		
   111
   112 6ACE 18					clc
   113 6ACF BD 5D 6A				lda PlatformStepX, x
   114 6AD2 69 01				adc #$01		
   115 6AD4 9D 5D 6A				sta PlatformStepX, x
   116 6AD7 C9 0F				cmp #FLOAT_PLATFORM_MAX_X	
   117 6AD9 F0 46				beq SetBackDir	
   118 					
   119 6ADB 18					clc
   120 6ADC BD 35 6A				lda PlatformLSB,x
   121 6ADF 69 01				adc #$01
   122 6AE1 9D 35 6A				sta PlatformLSB,x
   123 6AE4 BD 3D 6A				lda PlatformMSB,x
   124 6AE7 69 00				adc #$00
   125 6AE9 9D 3D 6A				sta PlatformMSB,x
   126 					
   127 6AEC 4C 2E 6B				jmp ResetTime
   128 								 	
   129 6AEF			MoveBack
   130 					
   131 6AEF A0 05				ldy #FLOAT_PLATFORM_CHR_X - 1	
   132 6AF1 A2 05				ldx #FLOAT_PLATFORM_CHR_X - 1
   133 					
   134 6AF3			moveB
   135 					
   136 6AF3 BD 2F 6A				lda PlatformCharX, x
   137 6AF6 91 EF				sta (m_platformLevelPointer), y
   138 6AF8 88					dey
   139 6AF9 CA					dex
   140 6AFA E0 00				cpx #$00
   141 6AFC D0 F5				bne moveB
   142 					
   143 6AFE A6 92				ldx m_param00	
   144 					
   145 6B00 38					sec
   146 6B01 BD 5D 6A				lda PlatformStepX, x
   147 6B04 E9 01				sbc #$01
   148 6B06 9D 5D 6A				sta PlatformStepX, x
   149 6B09 C9 00				cmp #$00
   150 6B0B F0 1C				beq SetForwardDir	
   151 						
   152 6B0D 38					sec
   153 6B0E BD 35 6A				lda PlatformLSB,x
   154 6B11 E9 01				sbc #$01
   155 6B13 9D 35 6A				sta PlatformLSB,x
   156 6B16 BD 3D 6A				lda PlatformMSB,x	
   157 6B19 E9 00				sbc #0
   158 6B1B 9D 3D 6A				sta PlatformMSB,x
   159 						
   160 6B1E 4C 2E 6B				jmp ResetTime
   161
   162 6B21			SetBackDir
   163 					
   164 6B21 A9 01				lda #$01
   165 6B23 9D 55 6A				sta PlatformDirX, x
   166 6B26 4C 2E 6B				jmp ResetTime
   167
   168 6B29			SetForwardDir
   169 					
   170 6B29 A9 00				lda #$00
   171 6B2B 9D 55 6A				sta PlatformDirX, x
   172 					
   173 6B2E			ResetTime
   174
   175 6B2E A9 00				lda #00
   176 6B30 9D 45 6A				sta PlatformTime, x
   177 					
   178
   179 				;*****	Exit
   180 				;
   181 6B33			Exit
   182
   183 6B33 A5 96				lda m_SaveRegA
   184 6B35 A6 97				ldx m_SaveRegX
   185 6B37 A4 98				ldy m_SaveRegY
   186 					
   187 6B39 60					rts
   188
   189 				.endp	
   340 6B3A					icl "LevelLoader.Asm"
Source: E:\_8BitProjects\Series\Scroller\LevelLoader.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		LevelLoader.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; Constants
    15 				;**************************************************************************************************
    16 				;
    17 = 00FD			LN_BRK				= $FD
    18 = 00FE			LN_CRG				= $FE
    19 = 00FF			LN_EOD				= $FF
    20
    21 				;
    22 				;**************************************************************************************************
    23 				; 	LoadDisplayListData
    24 				;
    25 				;		Routine to load the desired display list data to Atari's LISTL and LISTH location.
    26 				;
    27 				;		Parameters:		m_param00	-	Length of data
    28 				;						m_paramW01	-	Source of data
    29 				;						m_paramW02	-	Destination of data
    30 				;
    31 				;		Destroy's A, X, and Y registers 
    32 				;
    33 				;**************************************************************************************************
    34 6B3A			.proc LoadDisplayListData
    35
    36 6B3A A6 92				ldx m_param00
    37 6B3C A0 00				ldy #$00
    38
    39 				;*****	Loop until data length is reached	
    40 6B3E			loop
    41 6B3E B1 E3				lda (m_paramW01), y
    42 6B40 91 E5				sta (m_paramW02), y
    43 6B42 C8					iny
    44 6B43 CA					dex
    45 6B44 D0 F8				bne loop
    46 						
    47 6B46 60					rts
    48
    49 				.endp
    50
    51 				;
    52 				;**************************************************************************************************
    53 				; LoadLevel
    54 				;
    55 				;	Level index is passed in zero page PARAM01
    56 				;
    57 				;**************************************************************************************************
    58 6B47			.proc LoadLevel
    59
    60 6B47 A6 93				ldx m_param01
    61 								
    62 6B49 BD 02 30				lda LevelsAddr_LSB,x					; get the LSB for the requested levels data
    63 6B4C 85 E7				sta m_ptrLevelAddr						; store it in our zero page pointer
    64 6B4E BD 03 30				lda LevelsAddr_MSB,x					; get the MSB for the requested levels data
    65 6B51 85 E8				sta m_ptrLevelAddr + 1					; store it in our zero page pointer
    66 						
    67 6B53 A9 00				lda #$00								; initialize the counters
    68 6B55 8D B0 32				sta m_scrYCount		
    69 6B58 8D B1 32				sta m_datYCount
    70 						
    71 6B5B A8					tay										; begin with the Y register set
    72
    73 				;************************************************
    74 				;
    75 6B5C			GetNextRowCol		
    76 						
    77 6B5C AC B1 32				ldy m_datYCount		
    78 6B5F B1 E7				lda (m_ptrLevelAddr), y					; make sure this level is valid (while not EOD)
    79 6B61 C9 FF				cmp #LN_EOD								; check for eof of level data
    80 6B63 F0 65				beq ExitLoadLevel						; true jump to exit
    81
    82 6B65			StoreRow
    83 						
    84 6B65 8D AE 32				sta	m_currRow							; save off the first byte the current row
    85
    86 6B68 EE B1 32				inc m_datYCount							; increment for COLS value
    87 6B6B AC B1 32				ldy m_datYCount							; use it
    88 6B6E B1 E7				lda (m_ptrLevelAddr),y					; make sure this level is valid
    89 6B70 8D AF 32				sta m_currCol							; now we have the current column
    90 						
    91 6B73 AE AF 32				ldx m_currCol
    92 6B76 BD DB 32				lda TabLevelLineAddressLSB,x			; get the low part of the screen address by row
    93 6B79 18					clc
    94 6B7A 6D AE 32				adc m_currRow		
    95 6B7D 85 E9				sta m_ptrLevelLine						; save it off to the current line address		
    96 6B7F BD DB 33				lda TabLevelLineAddressMSB,x			; get the low part of the screen address by row
    97 6B82 69 00				adc #$00
    98 6B84 85 EA				sta m_ptrLevelLine + 1					; save it off to the current line address
    99
   100 				;************************************************
   101 				;
   102 6B86			SetCharacter
   103 				  		
   104 6B86 EE B1 32		  		inc m_datYCount							; increment for next COLS value
   105 6B89 AC B1 32				ldy m_datYCount							; use the value
   106
   107 6B8C B1 E7				lda (m_ptrLevelAddr),y					; check for line break
   108 6B8E C9 FD				cmp #LN_BRK								; did we hit it 
   109 6B90 F0 0B				beq GetNextDataLine						; go reset the counters and test for carriage return  
   110
   111 				;		sta mm_currChar							; hold the maps character		
   112 				;		lda mm_currChar							; get the character back
   113
   114 6B92 AC B0 32				ldy m_scrYCount
   115 6B95 91 E9				sta (m_ptrLevelLine),y					; store it at location
   116 6B97 EE B0 32				inc m_scrYCount
   117 						
   118 6B9A 4C 86 6B				jmp SetCharacter						; do the process all over
   119 						
   120 				;************************************************
   121 				;
   122 6B9D			GetNextDataLine
   123 						
   124 6B9D A9 00				lda #$00
   125 6B9F 8D B0 32				sta m_scrYCount
   126 						
   127 6BA2 EE B1 32		  		inc m_datYCount							; increment for next COLS value
   128 6BA5 AC B1 32				ldy m_datYCount							; use the value
   129 6BA8 B1 E7				lda (m_ptrLevelAddr), y					; load up the next level data item
   130 						
   131 6BAA C9 FE				cmp #LN_CRG								; check for carraige return
   132 6BAC F0 03				beq SetNextRowCol						; true get the next row of data
   133 						
   134 6BAE 4C 65 6B				jmp StoreRow		
   135
   136 6BB1			SetNextRowCol
   137 6BB1 EE B1 32				inc m_datYCount		
   138 						
   139 6BB4 18					clc
   140 6BB5 A5 E7				lda m_ptrLevelAddr					; get the LSB for the requested levels data
   141 6BB7 6D B1 32				adc m_datYCount
   142 6BBA 85 E7				sta m_ptrLevelAddr
   143 6BBC A5 E8				lda m_ptrLevelAddr + 1
   144 6BBE 69 00				adc #$00
   145 6BC0 85 E8				sta m_ptrLevelAddr + 1					; store it in our zero page pointer
   146
   147 6BC2 A9 00				lda #$00
   148 6BC4 8D B1 32				sta m_datYCount
   149
   150 6BC7 4C 5C 6B				jmp GetNextRowCol			
   151 				 
   152 				;************************************************
   153 				;
   154 6BCA			ExitLoadLevel
   155
   156 6BCA 60					rts
   157 					
   158 				.endp			
   341 6BCB					icl "JoyKeyAndCollision.Asm"
Source: E:\_8BitProjects\Series\Scroller\JoyKeyAndCollision.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		JoyKeyAndCollision.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;**************************************************************************************************
    14 				; CheckInput
    15 				;**************************************************************************************************
    16 				;
    17 6BCB			.proc CheckInput
    18
    19 				;*****	Check Stick
    20 				;
    21 6BCB			CI_check_stick
    22 						
    23 6BCB A5 DE				lda m_stick0
    24 6BCD 85 DF				sta m_oldStick0
    25
    26 6BCF AD 00 D3				lda PORTA
    27 6BD2 29 0F				and #15
    28 6BD4 85 DE				sta m_stick0
    29
    30 				;*****	Check Shoot Right
    31 				;
    32 6BD6			CI_check_shoot_right
    33 						
    34 6BD6 C9 08				cmp #%1000								; right
    35 6BD8 B0 07				bcs CI_check_shoot_left
    36 						
    37 6BDA A9 01				lda #PSD_RIGHT
    38 6BDC 85 CE				sta m_lastPlayerShootDirection
    39 6BDE 4C E9 6B				jmp CI_check_trigger
    40
    41 				;*****	Check Shoot Left
    42 				;
    43 6BE1			CI_check_shoot_left
    44 						
    45 6BE1 29 04				and #%0100								; left
    46 6BE3 D0 04				bne CI_check_trigger
    47 					
    48 6BE5 A9 02				lda #PSD_LEFT
    49 6BE7 85 CE				sta m_lastPlayerShootDirection
    50
    51 				;*****	Check Trigger
    52 				;
    53 6BE9			CI_check_trigger
    54 					
    55 6BE9 A5 E2				lda m_currentTrigger0
    56 6BEB 85 E0				sta m_oldTrigger0
    57
    58 6BED AD 10 D0				lda TRIG0								; 0 - not pressed, 1 - just released, 2 - just pressed, 3 - pressed
    59 6BF0 85 E2				sta m_currentTrigger0	
    60 6BF2 0A					asl
    61 6BF3 05 E0				ora m_oldTrigger0
    62 6BF5 49 03				eor #%11
    63 6BF7 85 E1				sta m_triggerState
    64 							
    65 6BF9 A9 03				lda #0+GRACTL_OPTIONS					; reset trigger latches	
    66 6BFB 8D 1D D0				sta GRACTL								; reset triggers latch mode
    67 					
    68 6BFE A9 07				lda #4+GRACTL_OPTIONS
    69 6C00 8D 1D D0				sta GRACTL								; set triggers latch mode
    70
    71 6C03 60					rts
    72 						
    73 				.endp	
    74 					
    75 				;
    76 				;**************************************************************************************************
    77 				; CheckPMCollisions
    78 				;**************************************************************************************************
    79 				;
    80 6C04			.proc CheckPMCollisions
    81 					
    82 				;*****	Check Player 0 Playfield 3
    83 				;
    84 6C04 AD 0A D0				lda M2PL
    85 6C07 29 0B				and #%1011
    86 6C09 F0 08				beq check_p0_pf3
    87 								
    88 6C0B A2 07				ldx #PS_LOSE
    89 6C0D 20 F6 4E				jsr SetPlayerMethod
    90 6C10 4C 3D 6C				jmp CPMC_check_m0_pf0_3
    91
    92 				;*****	Check Player 0 Playfield 3
    93 				;
    94 6C13			check_p0_pf3
    95 						
    96 6C13 AD 04 D0				lda P0PF
    97 6C16 29 08				and #%1000
    98 6C18 F0 08				beq CPMC_check_m2_pl0
    99
   100 6C1A A2 07				ldx #PS_LOSE
   101 6C1C 20 F6 4E				jsr SetPlayerMethod
   102 6C1F 4C 3D 6C				jmp CPMC_check_m0_pf0_3
   103 						
   104 				;*****	Check Missile 2 Player 0
   105 				;
   106 6C22			CPMC_check_m2_pl0
   107 					
   108 6C22 AD 0A D0				lda M2PL
   109 6C25 29 01				and #%0001
   110 6C27 F0 08				beq CPMC_check_m3_pl0
   111
   112 6C29 A2 07				ldx #PS_LOSE
   113 6C2B 20 F6 4E				jsr SetPlayerMethod
   114 6C2E 4C 3D 6C				jmp CPMC_check_m0_pf0_3
   115
   116 				;*****	Check Missile 3 Player 0
   117 				;
   118 6C31			CPMC_check_m3_pl0
   119
   120 6C31 AD 0B D0				lda M3PL
   121 6C34 29 01				and #%0001
   122 6C36 F0 05				beq CPMC_check_m0_pf0_3
   123
   124 6C38 A2 07				ldx #PS_LOSE
   125 6C3A 20 F6 4E				jsr SetPlayerMethod
   126
   127 				;*****	Check Missile 0 Player 0-3
   128 				;
   129 6C3D			CPMC_check_m0_pf0_3
   130 					
   131 6C3D AD 00 D0				lda M0PF
   132 6C40 29 09				and #%1001
   133 6C42 F0 00				beq CPMC_check_m1_pf0_3
   134
   135 				;*****	Check Missile 1 Player 0-3
   136 				;
   137 6C44			CPMC_check_m1_pf0_3
   138 					
   139 6C44 AD 01 D0				lda M1PF
   140 6C47 29 09				and #%1001
   141 6C49 F0 00				beq ClearPMCollisions
   142
   143 				;*****	Check PM Collisions
   144 				;
   145 6C4B			ClearPMCollisions
   146
   147 6C4B A9 00				lda #0
   148 6C4D 8D 1E D0				sta HITCLR		
   149 						
   150 6C50 60					rts
   151
   152 				.endp		
   153
   342 6C51					icl "AudioManager.Asm"
Source: E:\_8BitProjects\Series\Scroller\AudioManager.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		AudioManager.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13
    14 6C51			.proc	SfxOff
    15
    16 6C51 A9 F0			lda #$f0					;initial value
    17 6C53 8D 4E 25			sta RMTSFXVOLUME			;sfx note volume * 16 (0,16,32,...,240)
    18 				;
    19 6C56 A9 FF			lda #$ff					;initial value
    20 6C58 85 99			sta m_sfxEffect
    21 				;
    22 6C5A A2 00			ldx #<SoundAddress					;low byte of RMT module to X reg
    23 6C5C A0 40			ldy #>SoundAddress					;hi byte of RMT module to Y reg
    24 6C5E A9 02			lda #$02						;starting song line 0-255 to A reg
    25 6C60 20 00 24			jsr RASTERMUSICTRACKER		;Init
    26
    27 				; 		 lda #0             ; silence sound output
    28 				;	     sta m_sfxBusy
    29 				;         sta m_sfxLEFT
    30 				;         sta m_sfxRIGHT
    31 				;         
    32 				;         sta AUDCTL								; clear sound
    33 				;		 
    34 				;		 sta AUDC1
    35 				;	     sta AUDC2
    36 				;	     sta AUDC3
    37 				;	     sta AUDF4
    38 				;		 
    39 				;		 sta AUDF1
    40 				;	     sta AUDF2
    41 				;	     sta AUDF3
    42 				;	     sta AUDF4
    43 					     
    44 6C63 60			         rts
    45 				.endp
    46
    47 6C64			.proc SfxTrigger
    48 						 
    49 				;		 lda m_sfxBusy
    50 				;		 cmp #$01
    51 				;	 	 bne seteffect
    52 				;		 
    53 				;		 rts
    54 				;		 
    55 6C64			seteffect
    56 				;         ldx m_sfxLEFT       ; test left channel
    57 				;         lda SFX_CV,x        ; CV value will be 0 if channel is idle 
    58 				;         bne leftnotfree   ; if not 0 then skip ahead
    59 				;         sty m_sfxLEFT       ; channel is idle, use it
    60 				;		 lda #$01
    61 				;		 sta m_sfxBusy
    62 				;         rts                ; all done
    63 				;
    64 6C64			leftnotfree 
    65 				;         ldx m_sfxRIGHT      ; test right channel
    66 				;         lda SFX_CV,x        ; CV value will be 0 if channel is idle
    67 				;         bne rightnotfree  ; if not 0 then skip ahead
    68 				;         sty m_sfxRIGHT      ; channel is idle, use it
    69 				;		 lda #$01
    70 				;		 sta m_sfxBusy
    71 6C64 60			         rts                ; all done
    72
    73 6C65			rightnotfree
    74 				;         cpy m_sfxLEFT       ; test sfx priority with left channel
    75 				;         bcc leftnotlower  ; skip ahead if new sfx has lower priority than active sfx
    76 				;         sty m_sfxLEFT       ; new sfx has higher priority so use left channel
    77 				;		 lda #$01
    78 				;		 sta m_sfxBusy
    79 6C65 60			         rts                ; all done
    80
    81 6C66			leftnotlower 
    82 				;         cpy m_sfxRIGHT      ; test sfx with right channel
    83 				;         bcc rightnotlower ; skip ahead if new sfx has lower priority than active sfx
    84 				;         sty m_sfxRIGHT      ; new sfx has higher priority so use right channel
    85 				; 		 lda #$01
    86 				;		 sta m_sfxBusy
    87 						 
    88 6C66			rightnotlower
    89 						
    90 						
    91 6C66 60			        rts
    92
    93 				.endp
    94
    95
    96 6C67			.proc SfxUpdate
    97 6C67 A5 99			lda m_sfxEffect
    98 6C69 30 0D			bmi lab2
    99 6C6B 0A				asl 						; * 2
   100 6C6C A8				tay							;Y = 2,4,..,16	instrument number * 2 (0,2,4,..,126)
   101 6C6D A2 03			ldx #3						;X = 3			channel (0..3 or 0..7 for stereo module)
   102 6C6F A9 0C			lda #12						;A = 12			note (0..60)
   103 6C71 20 0F 24			jsr RASTERMUSICTRACKER+15	;RMT_SFX start tone (It works only if FEAT_SFX is enabled !!!)
   104 				;
   105 6C74 A9 FF			lda #$ff
   106 6C76 85 99			sta m_sfxEffect				;reinit value
   107 				;
   108 6C78			lab2
   109 6C78 20 03 24			jsr RASTERMUSICTRACKER+3	;1 play
   110 6C7B 60				rts
   111 					
   112 				;	lda #%11101010
   113 				;	sta AUDCTL
   114 				;	ldx m_sfxLEFT       ; get the pointer for the left channel
   115 				;    lda SFX_F,x         ; get the Frequency value
   116 				;    sta AUDF1          ; update the Frequency register
   117 				;    lda SFX_CV,x        ; get the combined Control and Volume value
   118 				;    sta AUDC1          ; update the Volume register
   119 				;    lsr                ; prep the Control value,
   120 				;    lsr                ;   it's stored in the upper nybble
   121 				;	lsr                ;   but must be in the lower nybble
   122 				;	lsr                ;   when Control is updated
   123 				;	sta AUDC1          ; update the Control register
   124 				;	beq skipleftdec   ; skip ahead if Control = 0
   125 				;	dec m_sfxLEFT       ; update pointer for left channel
   126 				;skipleftdec 
   127 				;	ldx m_sfxRIGHT      ; get the pointer for the right channel
   128 				;	lda SFX_F,x         ; get the Frequency value
   129 				;	sta AUDF2          ; update the Frequency register
   130 				;	lda SFX_CV,x        ; get the combined Control and Volume value
   131 				;    sta AUDC2          ; update the Volume register
   132 				;    lsr                ; prep the Control value,
   133 				;    lsr                ;   it's stored in the upper nybble
   134 				;    lsr                ;   but must be in the lower nybble
   135 				;    lsr                ;   when Control is updated
   136 				;    sta AUDC2         ; update the Control register
   137 				;	beq skiprightdec  ; skip ahead if Control = 0
   138 				;    dec m_sfxRIGHT      ; update pointer for right channel
   139 				;skiprightdec
   140 				;	lda m_sfxLeft
   141 				;	cmp #$00
   142 				;	bne noreset
   143 				;	sta m_sfxBusy
   144 				;noreset	
   145 				;    rts                ; all done
   146 				.endp
   147
   343 6C7C					icl "rmtplayr.asm"
Source: E:\_8BitProjects\Series\Scroller\rmtplayr.asm
     1 				;*
     2 				;* Raster Music Tracker, RMT Atari routine version 1.20090108
     3 				;* (c) Radek Sterba, Raster/C.P.U., 2002 - 2009
     4 				;* http://raster.atari.org
     5 				;*
     6 				;* Warnings:
     7 				;*
     8 				;* 1. RMT player routine needs 19 itself reserved bytes in zero page (no accessed
     9 				;*    from any other routines) as well as cca 1KB of memory before the "PLAYER"
    10 				;*    address for frequency tables and functionary variables. It's:
    11 				;*	  a) from PLAYER-$03c0 to PLAYER for stereo RMTplayer
    12 				;*    b) from PLAYER-$0320 to PLAYER for mono RMTplayer
    13 				;*
    14 				;* 2. RMT player routine MUST (!!!) be compiled from the begin of the memory page.
    15 				;*    i.e. "PLAYER" address can be $..00 only!
    16 				;*
    17 				;* 3. Because of RMTplayer provides a lot of effects, it spent a lot of CPU time.
    18 				;*
    19 				;* STEREOMODE	equ 0..3			;0 => compile RMTplayer for 4 tracks mono
    20 				;*									;1 => compile RMTplayer for 8 tracks stereo
    21 				;*									;2 => compile RMTplayer for 4 tracks stereo L1 R2 R3 L4
    22 				;*									;3 => compile RMTplayer for 4 tracks stereo L1 L2 R3 R4
    23 				;*
    24 					IFT STEREOMODE==1
    25 				TRACKS		equ 8
    26 					ELS
    27 = 0004			TRACKS		equ 4
    28 					EIF
    29 				;*
    30 = 2400			PLAYER		equ SoundPlayerAddress
    31 				;*
    32 				;* RMT FEATures definitions file
    33 				;* For optimizations of RMT player routine to concrete RMT modul only!
    34 6C7C				icl "rmt_feat.asm"
Source: E:\_8BitProjects\Series\Scroller\rmt_feat.asm
     1 				;*
     2 				;* RMT FEATures definitions
     3 				;*
     4 				;* For optimizations of RMT player routine to concrete RMT modul only!
     5 				;* --------BEGIN--------
     6 				;* asm_src/sfx/sfx.rmt
     7 = 0001			FEAT_SFX		equ 1
     8 = 0000			FEAT_GLOBALVOLUMEFADE	equ 0		;RMTGLOBALVOLUMEFADE variable
     9 = 0000			FEAT_NOSTARTINGSONGLINE	equ 0
    10 = 0001			FEAT_INSTRSPEED		equ 1
    11 = 0009			FEAT_CONSTANTSPEED		equ 9		;(0 times)
    12 = 0001			FEAT_COMMAND1		equ 1		;(96 times)
    13 = 0000			FEAT_COMMAND2		equ 0		;(0 times)
    14 = 0001			FEAT_COMMAND3		equ 1		;(1 times)
    15 = 0001			FEAT_COMMAND4		equ 1		;(1 times)
    16 = 0000			FEAT_COMMAND5		equ 0		;(0 times)
    17 = 0000			FEAT_COMMAND6		equ 0		;(0 times)
    18 = 0001			FEAT_COMMAND7SETNOTE		equ 1		;(1 times)
    19 = 0000			FEAT_COMMAND7VOLUMEONLY		equ 0		;(0 times)
    20 = 0000			FEAT_PORTAMENTO		equ 0		;(0 times)
    21 = 0000			FEAT_FILTER		equ 0		;(0 times)
    22 = 0000			FEAT_FILTERG0L		equ 0		;(0 times)
    23 = 0000			FEAT_FILTERG1L		equ 0		;(0 times)
    24 = 0000			FEAT_FILTERG0R		equ 0		;(0 times)
    25 = 0000			FEAT_FILTERG1R		equ 0		;(0 times)
    26 = 0000			FEAT_BASS16		equ 0		;(0 times)
    27 = 0000			FEAT_BASS16G1L		equ 0		;(0 times)
    28 = 0000			FEAT_BASS16G3L		equ 0		;(0 times)
    29 = 0000			FEAT_BASS16G1R		equ 0		;(0 times)
    30 = 0000			FEAT_BASS16G3R		equ 0		;(0 times)
    31 = 0000			FEAT_VOLUMEONLYG0L		equ 0		;(0 times)
    32 = 0000			FEAT_VOLUMEONLYG2L		equ 0		;(0 times)
    33 = 0000			FEAT_VOLUMEONLYG3L		equ 0		;(0 times)
    34 = 0000			FEAT_VOLUMEONLYG0R		equ 0		;(0 times)
    35 = 0000			FEAT_VOLUMEONLYG2R		equ 0		;(0 times)
    36 = 0000			FEAT_VOLUMEONLYG3R		equ 0		;(0 times)
    37 = 0000			FEAT_TABLETYPE		equ 0		;(0 times)
    38 = 0000			FEAT_TABLEMODE		equ 0		;(0 times)
    39 = 0000			FEAT_TABLEGO		equ 0		;(0 times)
    40 = 0000			FEAT_AUDCTLMANUALSET		equ 0		;(0 times)
    41 = 0000			FEAT_VOLUMEMIN		equ 0		;(0 times)
    42 = 0000			FEAT_EFFECTVIBRATO		equ 0		;(0 times)
    43 = 0000			FEAT_EFFECTFSHIFT		equ 0		;(0 times)
    44 				;* --------END--------
    35 				;*
    36 				;* RMT ZeroPage addresses
    37 					;org $80
    38 					IFT FEAT_COMMAND2
    39 				frqaddcmd2					org *+1
    40 					EIF
    41
    42 					IFT TRACKS>4
    43 					org PLAYER-$400+$40
    44 					ELS
    45 6C7C				org PLAYER-$400+$e0
    46 					EIF
    47 					
    48 20E0			track_variables
    49 20E0			trackn_db	org *+TRACKS
    50 20E4			trackn_hb	org *+TRACKS
    51 20E8			trackn_idx	org *+TRACKS
    52 20EC			trackn_pause	org *+TRACKS
    53 20F0			trackn_note	org *+TRACKS
    54 20F4			trackn_volume	org *+TRACKS
    55 20F8			trackn_distor 	org *+TRACKS
    56 20FC			trackn_shiftfrq	org *+TRACKS
    57 					IFT FEAT_PORTAMENTO
    58 				trackn_portafrqc org *+TRACKS
    59 				trackn_portafrqa org *+TRACKS
    60 				trackn_portaspeed org *+TRACKS
    61 				trackn_portaspeeda org *+TRACKS
    62 				trackn_portadepth org *+TRACKS
    63 					EIF
    64 2100			trackn_instrx2	org *+TRACKS
    65 2104			trackn_instrdb	org *+TRACKS
    66 2108			trackn_instrhb	org *+TRACKS
    67 210C			trackn_instridx	org *+TRACKS
    68 2110			trackn_instrlen	org *+TRACKS
    69 2114			trackn_instrlop	org *+TRACKS
    70 2118			trackn_instrreachend	org *+TRACKS
    71 211C			trackn_volumeslidedepth org *+TRACKS
    72 2120			trackn_volumeslidevalue org *+TRACKS
    73 					IFT FEAT_VOLUMEMIN
    74 				trackn_volumemin		org *+TRACKS
    75 					EIF
    76 = 0000			FEAT_EFFECTS equ FEAT_EFFECTVIBRATO||FEAT_EFFECTFSHIFT
    77 					IFT FEAT_EFFECTS
    78 				trackn_effdelay			org *+TRACKS
    79 					EIF
    80 					IFT FEAT_EFFECTVIBRATO
    81 				trackn_effvibratoa		org *+TRACKS
    82 					EIF
    83 					IFT FEAT_EFFECTFSHIFT
    84 				trackn_effshift		org *+TRACKS
    85 					EIF
    86 2124			trackn_tabletypespeed org *+TRACKS
    87 					IFT FEAT_TABLEMODE
    88 				trackn_tablemode	org *+TRACKS
    89 					EIF
    90 2128			trackn_tablenote	org *+TRACKS
    91 212C			trackn_tablea		org *+TRACKS
    92 2130			trackn_tableend		org *+TRACKS
    93 					IFT FEAT_TABLEGO
    94 				trackn_tablelop		org *+TRACKS
    95 					EIF
    96 2134			trackn_tablespeeda	org *+TRACKS
    97 					IFT FEAT_FILTER||FEAT_BASS16
    98 				trackn_command		org *+TRACKS
    99 					EIF
   100 					IFT FEAT_BASS16
   101 				trackn_outnote		org *+TRACKS
   102 					EIF
   103 					IFT FEAT_FILTER
   104 				trackn_filter		org *+TRACKS
   105 					EIF
   106 2138			trackn_audf	org *+TRACKS
   107 213C			trackn_audc	org *+TRACKS
   108 					IFT FEAT_AUDCTLMANUALSET
   109 				trackn_audctl	org *+TRACKS
   110 					EIF
   111 2140			v_aspeed		org *+1
   112 2141			track_endvariables
   113 2141					org PLAYER-$100-$140-$40+2
   114 = 000C			INSTRPAR	equ 12
   115 2182			tabbeganddistor
   116 2182-2191> 80 00		 dta frqtabpure-frqtab,$00
   117 2184 80 20		 dta frqtabpure-frqtab,$20
   118 2186 80 40		 dta frqtabpure-frqtab,$40
   119 2188 00 C0		 dta frqtabbass1-frqtab,$c0
   120 218A 80 80		 dta frqtabpure-frqtab,$80
   121 218C 80 A0		 dta frqtabpure-frqtab,$a0
   122 218E 00 C0		 dta frqtabbass1-frqtab,$c0
   123 2190 40 C0		 dta frqtabbass2-frqtab,$c0
   124 						IFT FEAT_EFFECTVIBRATO
   125 				vibtabbeg dta 0,vib1-vib0,vib2-vib0,vib3-vib0
   126 				vib0	dta 0
   127 				vib1	dta 1,-1,-1,1
   128 				vib2	dta 1,0,-1,-1,0,1
   129 				vib3	dta 1,1,0,-1,-1,-1,-1,0,1,1
   130 				vibtabnext
   131 						dta vib0-vib0+0
   132 						dta vib1-vib0+1,vib1-vib0+2,vib1-vib0+3,vib1-vib0+0
   133 						dta vib2-vib0+1,vib2-vib0+2,vib2-vib0+3,vib2-vib0+4,vib2-vib0+5,vib2-vib0+0
   134 						dta vib3-vib0+1,vib3-vib0+2,vib3-vib0+3,vib3-vib0+4,vib3-vib0+5,vib3-vib0+6,vib3-vib0+7,vib3-vib0+8,vib3-vib0+9,vib3-vib0+0
   135 						EIF
   136 2192					org PLAYER-$100-$140
   137 					IFT FEAT_BASS16
   138 				frqtabbasslo
   139 					dta $F2,$33,$96,$E2,$38,$8C,$00,$6A,$E8,$6A,$EF,$80,$08,$AE,$46,$E6
   140 					dta $95,$41,$F6,$B0,$6E,$30,$F6,$BB,$84,$52,$22,$F4,$C8,$A0,$7A,$55
   141 					dta $34,$14,$F5,$D8,$BD,$A4,$8D,$77,$60,$4E,$38,$27,$15,$06,$F7,$E8
   142 					dta $DB,$CF,$C3,$B8,$AC,$A2,$9A,$90,$88,$7F,$78,$70,$6A,$64,$5E,$00
   143 					EIF
   144 21C0					org PLAYER-$100-$100
   145 2200			frqtab
   146 					ERT [<frqtab]!=0	;* frqtab must begin at the memory page bound! (i.e. $..00 address)
   147 2200			frqtabbass1
   148 2200-22BF> BF B6 AA A1 + 	dta $BF,$B6,$AA,$A1,$98,$8F,$89,$80,$F2,$E6,$DA,$CE,$BF,$B6,$AA,$A1
   149 2210 98 8F 89 80 7A 71 + 	dta $98,$8F,$89,$80,$7A,$71,$6B,$65,$5F,$5C,$56,$50,$4D,$47,$44,$3E
   150 2220 3C 38 35 32 2F 2D + 	dta $3C,$38,$35,$32,$2F,$2D,$2A,$28,$25,$23,$21,$1F,$1D,$1C,$1A,$18
   151 2230 17 16 14 13 12 11 + 	dta $17,$16,$14,$13,$12,$11,$10,$0F,$0E,$0D,$0C,$0B,$0A,$09,$08,$07
   152 2240			frqtabbass2
   153 2240 FF F1 E4 D8 CA C0 + 	dta $FF,$F1,$E4,$D8,$CA,$C0,$B5,$AB,$A2,$99,$8E,$87,$7F,$79,$73,$70
   154 2250 66 61 5A 55 52 4B + 	dta $66,$61,$5A,$55,$52,$4B,$48,$43,$3F,$3C,$39,$37,$33,$30,$2D,$2A
   155 2260 28 25 24 21 1F 1E + 	dta $28,$25,$24,$21,$1F,$1E,$1C,$1B,$19,$17,$16,$15,$13,$12,$11,$10
   156 2270 0F 0E 0D 0C 0B 0A + 	dta $0F,$0E,$0D,$0C,$0B,$0A,$09,$08,$07,$06,$05,$04,$03,$02,$01,$00
   157 2280			frqtabpure
   158 2280 F3 E6 D9 CC C1 B5 + 	dta $F3,$E6,$D9,$CC,$C1,$B5,$AD,$A2,$99,$90,$88,$80,$79,$72,$6C,$66
   159 2290 60 5B 55 51 4C 48 + 	dta $60,$5B,$55,$51,$4C,$48,$44,$40,$3C,$39,$35,$32,$2F,$2D,$2A,$28
   160 22A0 25 23 21 1F 1D 1C + 	dta $25,$23,$21,$1F,$1D,$1C,$1A,$18,$17,$16,$14,$13,$12,$11,$10,$0F
   161 22B0 0E 0D 0C 0B 0A 09 + 	dta $0E,$0D,$0C,$0B,$0A,$09,$08,$07,$06,$05,$04,$03,$02,$01,$00,$00
   162 					IFT FEAT_BASS16
   163 				frqtabbasshi
   164 					dta $0D,$0D,$0C,$0B,$0B,$0A,$0A,$09,$08,$08,$07,$07,$07,$06,$06,$05
   165 					dta $05,$05,$04,$04,$04,$04,$03,$03,$03,$03,$03,$02,$02,$02,$02,$02
   166 					dta $02,$02,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$00,$00
   167 					dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   168 					EIF
   169 22C0					org PLAYER-$0100
   170 2300			volumetab
   171 2300-271F> 00 00 00 00 + 	dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   172 2310 00 00 00 00 00 00 + 	dta $00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01
   173 2320 00 00 00 00 01 01 + 	dta $00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01,$02,$02,$02,$02
   174 2330 00 00 00 01 01 01 + 	dta $00,$00,$00,$01,$01,$01,$01,$01,$02,$02,$02,$02,$02,$03,$03,$03
   175 2340 00 00 01 01 01 01 + 	dta $00,$00,$01,$01,$01,$01,$02,$02,$02,$02,$03,$03,$03,$03,$04,$04
   176 2350 00 00 01 01 01 02 + 	dta $00,$00,$01,$01,$01,$02,$02,$02,$03,$03,$03,$04,$04,$04,$05,$05
   177 2360 00 00 01 01 02 02 + 	dta $00,$00,$01,$01,$02,$02,$02,$03,$03,$04,$04,$04,$05,$05,$06,$06
   178 2370 00 00 01 01 02 02 + 	dta $00,$00,$01,$01,$02,$02,$03,$03,$04,$04,$05,$05,$06,$06,$07,$07
   179 2380 00 01 01 02 02 03 + 	dta $00,$01,$01,$02,$02,$03,$03,$04,$04,$05,$05,$06,$06,$07,$07,$08
   180 2390 00 01 01 02 02 03 + 	dta $00,$01,$01,$02,$02,$03,$04,$04,$05,$05,$06,$07,$07,$08,$08,$09
   181 23A0 00 01 01 02 03 03 + 	dta $00,$01,$01,$02,$03,$03,$04,$05,$05,$06,$07,$07,$08,$09,$09,$0A
   182 23B0 00 01 01 02 03 04 + 	dta $00,$01,$01,$02,$03,$04,$04,$05,$06,$07,$07,$08,$09,$0A,$0A,$0B
   183 23C0 00 01 02 02 03 04 + 	dta $00,$01,$02,$02,$03,$04,$05,$06,$06,$07,$08,$09,$0A,$0A,$0B,$0C
   184 23D0 00 01 02 03 03 04 + 	dta $00,$01,$02,$03,$03,$04,$05,$06,$07,$08,$09,$0A,$0A,$0B,$0C,$0D
   185 23E0 00 01 02 03 04 05 + 	dta $00,$01,$02,$03,$04,$05,$06,$07,$07,$08,$09,$0A,$0B,$0C,$0D,$0E
   186 23F0 00 01 02 03 04 05 + 	dta $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0A,$0B,$0C,$0D,$0E,$0F
   187 2400				org PLAYER
   188 				;*
   189 				;* Set of RMT main vectors:
   190 				;*
   191 2400			RASTERMUSICTRACKER
   192 2400 4C 12 24			jmp rmt_init
   193 2403 4C A4 25			jmp rmt_play
   194 2406 4C BE 25			jmp rmt_p3
   195 2409 4C 4D 24			jmp rmt_silence
   196 240C 4C EA 26			jmp SetPokey
   197 					IFT FEAT_SFX
   198 240F 4C 4A 25			jmp rmt_sfx			;* A=note(0,..,60),X=channel(0,..,3 or 0,..,7),Y=instrument*2(0,2,4,..,126)
   199 					EIF
   200 2412			rmt_init
   201 2412 86 88			stx ns
   202 2414 84 89			sty ns+1
   203 					IFT FEAT_NOSTARTINGSONGLINE==0
   204 2416 48				pha
   205 					EIF
   206 					IFT track_endvariables-track_variables>255
   207 					ldy #0
   208 					tya
   209 				ri0	sta track_variables,y
   210 					sta track_endvariables-$100,y
   211 					iny
   212 					bne ri0
   213 					ELS
   214 2417 A0 61			ldy #track_endvariables-track_variables
   215 2419 A9 00			lda #0
   216 241B 99 DF 20		ri0	sta track_variables-1,y
   217 241E 88				dey
   218 241F D0 FA			bne ri0
   219 					EIF
   220 2421 A0 04			ldy #4
   221 2423 B1 88			lda (ns),y
   222 2425 8D B2 25			sta v_maxtracklen
   223 2428 C8				iny
   224 					IFT FEAT_CONSTANTSPEED==0
   225 					lda (ns),y
   226 					sta v_speed
   227 					EIF
   228 					IFT FEAT_INSTRSPEED==0
   229 					iny
   230 					lda (ns),y
   231 					sta v_instrspeed
   232 					sta v_ainstrspeed
   233 					ELI FEAT_INSTRSPEED>1
   234 					lda #FEAT_INSTRSPEED
   235 					sta v_ainstrspeed
   236 					EIF
   237 2429 A0 08			ldy #8
   238 242B B1 88		ri1	lda (ns),y
   239 242D 99 78 00			sta p_tis-8,y
   240 2430 C8				iny
   241 2431 C0 10			cpy #8+8
   242 2433 D0 F6			bne ri1
   243 					IFT FEAT_NOSTARTINGSONGLINE==0
   244 2435 68				pla
   245 2436 48				pha
   246 					IFT TRACKS>4
   247 					asl @
   248 					asl @
   249 					asl @
   250 					clc
   251 					adc p_song
   252 					sta p_song
   253 					pla
   254 					php
   255 					and #$e0
   256 					asl @
   257 					rol @
   258 					rol @
   259 					rol @
   260 					ELS
   261 2437 0A				asl @
   262 2438 0A				asl @
   263 2439 18				clc
   264 243A 65 86			adc p_song
   265 243C 85 86			sta p_song
   266 243E 68				pla
   267 243F 08				php
   268 2440 29 C0			and #$c0
   269 2442 0A				asl @
   270 2443 2A				rol @
   271 2444 2A				rol @
   272 					EIF
   273 2445 28				plp
   274 2446 65 87			adc p_song+1
   275 2448 85 87			sta p_song+1
   276 					EIF
   277 244A 20 62 24			jsr GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   278 244D			rmt_silence
   279 					IFT STEREOMODE>0
   280 					lda #0
   281 					sta $d208
   282 					sta $d218
   283 					ldy #3
   284 					sty $d20f
   285 					sty $d21f
   286 					ldy #8
   287 				si1	sta $d200,y
   288 					sta $d210,y
   289 					dey
   290 					bpl si1
   291 					ELS
   292 244D A9 00			lda #0
   293 244F 8D 08 D2			sta $d208
   294 2452 A0 03			ldy #3
   295 2454 8C 0F D2			sty $d20f
   296 2457 A0 08			ldy #8
   297 2459 99 00 D2		si1	sta $d200,y
   298 245C 88				dey
   299 245D 10 FA			bpl si1
   300 					EIF
   301 					IFT FEAT_INSTRSPEED==0
   302 					lda v_instrspeed
   303 					ELS
   304 245F A9 01			lda #FEAT_INSTRSPEED
   305 					EIF
   306 2461 60				rts
   307 2462			GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   308 2462			GetSongLine
   309 2462 A2 00			ldx #0
   310 2464 8E B0 25			stx v_abeat
   311 2467			nn0
   312 2467 8A			nn1	txa
   313 2468 A8				tay
   314 2469 B1 86			lda (p_song),y
   315 246B C9 FE			cmp #$fe
   316 246D B0 2D			bcs nn2
   317 246F A8				tay
   318 2470 B1 82			lda (p_trackslbstable),y
   319 2472 9D E0 20			sta trackn_db,x
   320 2475 B1 84			lda (p_trackshbstable),y
   321 2477 9D E4 20		nn1a sta trackn_hb,x
   322 247A A9 00			lda #0
   323 247C 9D E8 20			sta trackn_idx,x
   324 247F A9 01			lda #1
   325 2481 9D EC 20		nn1a2 sta trackn_pause,x
   326 2484 A9 80			lda #$80
   327 2486 9D 00 21			sta trackn_instrx2,x
   328 2489 E8				inx
   329 248A E0 04		xtracks01	cpx #TRACKS
   330 248C D0 D9			bne nn1
   331 248E A5 86			lda p_song
   332 2490 18				clc
   333 2491 69 04		xtracks02	adc #TRACKS
   334 2493 85 86			sta p_song
   335 2495 90 1B			bcc GetTrackLine
   336 2497 E6 87			inc p_song+1
   337 2499			nn1b
   338 2499 4C B2 24			jmp GetTrackLine
   339 249C			nn2
   340 249C F0 04			beq nn3
   341 249E			nn2a
   342 249E A9 00			lda #0
   343 24A0 F0 DF			beq nn1a2
   344 24A2			nn3
   345 24A2 A0 02			ldy #2
   346 24A4 B1 86			lda (p_song),y
   347 24A6 AA				tax
   348 24A7 C8				iny
   349 24A8 B1 86			lda (p_song),y
   350 24AA 85 87			sta p_song+1
   351 24AC 86 86			stx p_song
   352 24AE A2 00			ldx #0
   353 24B0 F0 B5			beq nn0
   354 24B2			GetTrackLine
   355 24B2			oo0
   356 24B2			oo0a
   357 					IFT FEAT_CONSTANTSPEED==0
   358 					lda #$ff
   359 				v_speed equ *-1
   360 					sta v_bspeed
   361 					EIF
   362 24B2 A2 FF			ldx #-1
   363 24B4			oo1
   364 24B4 E8				inx
   365 24B5 DE EC 20			dec trackn_pause,x
   366 24B8 D0 42			bne oo1x
   367 24BA			oo1b
   368 24BA BD E0 20			lda trackn_db,x
   369 24BD 85 88			sta ns
   370 24BF BD E4 20			lda trackn_hb,x
   371 24C2 85 89			sta ns+1
   372 24C4			oo1i
   373 24C4 BC E8 20			ldy trackn_idx,x
   374 24C7 FE E8 20			inc trackn_idx,x
   375 24CA B1 88			lda (ns),y
   376 24CC 85 8E			sta reg1
   377 24CE 29 3F			and #$3f
   378 24D0 C9 3D			cmp #61
   379 24D2 F0 0E			beq oo1a
   380 24D4 B0 32			bcs oo2
   381 24D6 9D F0 20			sta trackn_note,x
   382 					IFT FEAT_BASS16
   383 					sta trackn_outnote,x
   384 					EIF
   385 24D9 C8				iny
   386 24DA B1 88			lda (ns),y
   387 24DC 4A				lsr @
   388 24DD 29 7E			and #$3f*2
   389 24DF 9D 00 21			sta trackn_instrx2,x
   390 24E2			oo1a
   391 24E2 A9 01			lda #1
   392 24E4 9D EC 20			sta trackn_pause,x
   393 24E7 BC E8 20			ldy trackn_idx,x
   394 24EA FE E8 20			inc trackn_idx,x
   395 24ED B1 88			lda (ns),y
   396 24EF 4A				lsr @
   397 24F0 66 8E			ror reg1
   398 24F2 4A				lsr @
   399 24F3 66 8E			ror reg1
   400 24F5 A5 8E			lda reg1
   401 					IFT FEAT_GLOBALVOLUMEFADE
   402 					sec
   403 					sbc #$00
   404 				RMTGLOBALVOLUMEFADE equ *-1
   405 					bcs voig
   406 					lda #0
   407 				voig
   408 					EIF
   409 24F7 29 F0			and #$f0
   410 24F9 9D F4 20			sta trackn_volume,x
   411 24FC			oo1x
   412 24FC E0 03		xtracks03sub1	cpx #TRACKS-1
   413 24FE D0 B4			bne oo1
   414 					IFT FEAT_CONSTANTSPEED==0
   415 					lda #$ff
   416 				v_bspeed equ *-1
   417 					sta v_speed
   418 					ELS
   419 2500 A9 09			lda #FEAT_CONSTANTSPEED
   420 					EIF
   421 2502 8D 40 21			sta v_aspeed
   422 2505 4C 3F 25			jmp InitOfNewSetInstrumentsOnly
   423 2508			oo2
   424 2508 C9 3F			cmp #63
   425 250A F0 1B			beq oo63
   426 250C A5 8E			lda reg1
   427 250E 29 C0			and #$c0
   428 2510 F0 09			beq oo62_b
   429 2512 0A				asl @
   430 2513 2A				rol @
   431 2514 2A				rol @
   432 2515 9D EC 20			sta trackn_pause,x
   433 2518 4C FC 24			jmp oo1x
   434 251B			oo62_b
   435 251B C8				iny
   436 251C B1 88			lda (ns),y
   437 251E 9D EC 20			sta trackn_pause,x
   438 2521 FE E8 20			inc trackn_idx,x
   439 2524 4C FC 24			jmp oo1x
   440 2527			oo63
   441 2527 A5 8E			lda reg1
   442 					IFT FEAT_CONSTANTSPEED==0
   443 					bmi oo63_1X
   444 					iny
   445 					lda (ns),y
   446 					sta v_bspeed
   447 					inc trackn_idx,x
   448 					jmp oo1i
   449 				oo63_1X
   450 					EIF
   451 2529 C9 FF			cmp #255
   452 252B F0 09			beq oo63_11
   453 252D C8				iny
   454 252E B1 88			lda (ns),y
   455 2530 9D E8 20			sta trackn_idx,x
   456 2533 4C C4 24			jmp oo1i
   457 2536			oo63_11
   458 2536 4C 62 24			jmp GetSongLine
   459 2539 4C BE 25		p2xrmtp3	jmp rmt_p3
   460 253C CA			p2x0 dex
   461 253D 30 FA			 bmi p2xrmtp3
   462 253F			InitOfNewSetInstrumentsOnly
   463 253F BC 00 21		p2x1 ldy trackn_instrx2,x
   464 2542 30 F8			bmi p2x0
   465 					IFT FEAT_SFX
   466 2544 20 52 25			jsr SetUpInstrumentY2
   467 2547 4C 3C 25			jmp p2x0
   468 254A			rmt_sfx
   469 254A 9D F0 20			sta trackn_note,x
   470 					IFT FEAT_BASS16
   471 					sta trackn_outnote,x
   472 					EIF
   473 254D A9 F0			lda #$f0				;* sfx note volume*16
   474 = 254E			RMTSFXVOLUME equ *-1		;* label for sfx note volume parameter overwriting
   475 254F 9D F4 20			sta trackn_volume,x
   476 					EIF
   477 2552			SetUpInstrumentY2
   478 2552 B1 80			lda (p_instrstable),y
   479 2554 9D 04 21			sta trackn_instrdb,x
   480 2557 85 8C			sta nt
   481 2559 C8				iny
   482 255A B1 80			lda (p_instrstable),y
   483 255C 9D 08 21			sta trackn_instrhb,x
   484 255F 85 8D			sta nt+1
   485 					IFT FEAT_FILTER
   486 					lda #1
   487 					sta trackn_filter,x
   488 					EIF
   489 					IFT FEAT_TABLEGO
   490 					IFT FEAT_FILTER
   491 					tay
   492 					ELS
   493 					ldy #1
   494 					EIF
   495 					lda (nt),y
   496 					sta trackn_tablelop,x
   497 					iny
   498 					ELS
   499 2561 A0 02			ldy #2
   500 					EIF
   501 2563 B1 8C			lda (nt),y
   502 2565 9D 10 21			sta trackn_instrlen,x
   503 2568 C8				iny
   504 2569 B1 8C			lda (nt),y
   505 256B 9D 14 21			sta trackn_instrlop,x
   506 256E C8				iny
   507 256F B1 8C			lda (nt),y
   508 2571 9D 24 21			sta trackn_tabletypespeed,x
   509 					IFT FEAT_TABLETYPE||FEAT_TABLEMODE
   510 					and #$3f
   511 					EIF
   512 2574 9D 34 21			sta trackn_tablespeeda,x
   513 					IFT FEAT_TABLEMODE
   514 					lda (nt),y
   515 					and #$40
   516 					sta trackn_tablemode,x
   517 					EIF
   518 					IFT FEAT_AUDCTLMANUALSET
   519 					iny
   520 					lda (nt),y
   521 					sta trackn_audctl,x
   522 					iny
   523 					ELS
   524 2577 A0 06			ldy #6
   525 					EIF
   526 2579 B1 8C			lda (nt),y
   527 257B 9D 1C 21			sta trackn_volumeslidedepth,x
   528 					IFT FEAT_VOLUMEMIN
   529 					iny
   530 					lda (nt),y
   531 					sta trackn_volumemin,x
   532 					IFT FEAT_EFFECTS
   533 					iny
   534 					EIF
   535 					ELS
   536 					IFT FEAT_EFFECTS
   537 					ldy #8
   538 					EIF
   539 					EIF
   540 					IFT FEAT_EFFECTS
   541 					lda (nt),y
   542 					sta trackn_effdelay,x
   543 					IFT FEAT_EFFECTVIBRATO
   544 					iny
   545 					lda (nt),y
   546 					tay
   547 					lda vibtabbeg,y
   548 					sta trackn_effvibratoa,x
   549 					EIF
   550 					IFT FEAT_EFFECTFSHIFT
   551 					ldy #10
   552 					lda (nt),y
   553 					sta trackn_effshift,x
   554 					EIF
   555 					EIF
   556 257E A9 80			lda #128
   557 2580 9D 20 21			sta trackn_volumeslidevalue,x
   558 2583 9D 00 21			sta trackn_instrx2,x
   559 2586 0A				asl @
   560 2587 9D 18 21			sta trackn_instrreachend,x
   561 258A 9D FC 20			sta trackn_shiftfrq,x
   562 258D A8				tay
   563 258E B1 8C			lda (nt),y
   564 2590 9D 30 21			sta trackn_tableend,x
   565 2593 69 00			adc #0
   566 2595 9D 0C 21			sta trackn_instridx,x
   567 2598 A9 0C			lda #INSTRPAR
   568 259A 9D 2C 21			sta trackn_tablea,x
   569 259D A8				tay
   570 259E B1 8C			lda (nt),y
   571 25A0 9D 28 21			sta trackn_tablenote,x
   572 25A3			xata_rtshere
   573 					IFT FEAT_SFX
   574 25A3 60				rts
   575 					ELS
   576 					jmp p2x0
   577 					EIF
   578 25A4			rmt_play
   579 25A4			rmt_p0
   580 25A4 20 EA 26			jsr SetPokey
   581 25A7			rmt_p1
   582 					IFT FEAT_INSTRSPEED==0||FEAT_INSTRSPEED>1
   583 					dec v_ainstrspeed
   584 					bne rmt_p3
   585 					EIF
   586 					IFT FEAT_INSTRSPEED==0
   587 					lda #$ff
   588 				v_instrspeed	equ *-1
   589 					sta v_ainstrspeed
   590 					ELI FEAT_INSTRSPEED>1
   591 					lda #FEAT_INSTRSPEED
   592 					sta v_ainstrspeed
   593 					EIF
   594 25A7			rmt_p2
   595 25A7 CE 40 21			dec v_aspeed
   596 25AA D0 12			bne rmt_p3
   597 25AC EE B0 25			inc v_abeat
   598 25AF A9 FF			lda #$ff
   599 = 25B0			v_abeat equ *-1
   600 25B1 C9 FF			cmp #$ff
   601 = 25B2			v_maxtracklen equ *-1
   602 25B3 F0 03			beq p2o3
   603 25B5 4C B2 24			jmp GetTrackLine
   604 25B8			p2o3
   605 25B8 4C 62 24			jmp GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   606 25BB 4C D9 26		go_ppnext	jmp ppnext
   607 25BE			rmt_p3
   608 25BE A9 22			lda #>frqtab
   609 25C0 85 8B			sta nr+1
   610 25C2 A2 03		xtracks05sub1	ldx #TRACKS-1
   611 25C4			pp1
   612 25C4 BD 08 21			lda trackn_instrhb,x
   613 25C7 F0 F2			beq go_ppnext
   614 25C9 85 89			sta ns+1
   615 25CB BD 04 21			lda trackn_instrdb,x
   616 25CE 85 88			sta ns
   617 25D0 BC 0C 21			ldy trackn_instridx,x
   618 25D3 B1 88			lda (ns),y
   619 25D5 85 8E			sta reg1
   620 25D7 C8				iny
   621 25D8 B1 88			lda (ns),y
   622 25DA 85 8F			sta reg2
   623 25DC C8				iny
   624 25DD B1 88			lda (ns),y
   625 25DF 85 90			sta reg3
   626 25E1 C8				iny
   627 25E2 98				tya
   628 25E3 DD 10 21			cmp trackn_instrlen,x
   629 25E6 90 0A			bcc pp2
   630 25E8 F0 08			beq pp2
   631 25EA A9 80			lda #$80
   632 25EC 9D 18 21			sta trackn_instrreachend,x
   633 25EF			pp1b
   634 25EF BD 14 21			lda trackn_instrlop,x
   635 25F2 9D 0C 21		pp2	sta trackn_instridx,x
   636 25F5 A5 8E			lda reg1
   637 					IFT TRACKS>4
   638 					cpx #4
   639 					bcc pp2s
   640 					lsr @
   641 					lsr @
   642 					lsr @
   643 					lsr @
   644 				pp2s
   645 					EIF
   646 25F7 29 0F			and #$0f
   647 25F9 1D F4 20			ora trackn_volume,x
   648 25FC A8				tay
   649 25FD B9 00 23			lda volumetab,y
   650 2600 85 91			sta tmp
   651 2602 A5 8F			lda reg2
   652 2604 29 0E			and #$0e
   653 2606 A8				tay
   654 2607 B9 82 21			lda tabbeganddistor,y
   655 260A 85 8A			sta nr
   656 260C A5 91			lda tmp
   657 260E 19 83 21			ora tabbeganddistor+1,y
   658 2611 9D 3C 21			sta trackn_audc,x
   659 2614			InstrumentsEffects
   660 					IFT FEAT_EFFECTS
   661 					lda trackn_effdelay,x
   662 					beq ei2
   663 					cmp #1
   664 					bne ei1
   665 					lda trackn_shiftfrq,x
   666 					IFT FEAT_EFFECTFSHIFT
   667 					clc
   668 					adc trackn_effshift,x
   669 					EIF
   670 					IFT FEAT_EFFECTVIBRATO
   671 					clc
   672 					ldy trackn_effvibratoa,x
   673 					adc vib0,y
   674 					EIF
   675 					sta trackn_shiftfrq,x
   676 					IFT FEAT_EFFECTVIBRATO
   677 					lda vibtabnext,y
   678 					sta trackn_effvibratoa,x
   679 					EIF
   680 					jmp ei2
   681 				ei1
   682 					dec trackn_effdelay,x
   683 				ei2
   684 					EIF
   685 2614 BC 30 21			ldy trackn_tableend,x
   686 2617 C0 0D			cpy #INSTRPAR+1
   687 2619 90 30			bcc ei3
   688 261B BD 34 21			lda trackn_tablespeeda,x
   689 261E 10 25			bpl ei2f
   690 2620			ei2c
   691 2620 98				tya
   692 2621 DD 2C 21			cmp trackn_tablea,x
   693 2624 D0 07			bne ei2c2
   694 					IFT FEAT_TABLEGO
   695 					lda trackn_tablelop,x
   696 					ELS
   697 2626 A9 0C			lda #INSTRPAR
   698 					EIF
   699 2628 9D 2C 21			sta trackn_tablea,x
   700 262B D0 03			bne ei2a
   701 262D			ei2c2
   702 262D FE 2C 21			inc trackn_tablea,x
   703 2630			ei2a
   704 2630 BD 04 21			lda trackn_instrdb,x
   705 2633 85 8C			sta nt
   706 2635 BD 08 21			lda trackn_instrhb,x
   707 2638 85 8D			sta nt+1
   708 263A BC 2C 21			ldy trackn_tablea,x
   709 263D B1 8C			lda (nt),y
   710 					IFT FEAT_TABLEMODE
   711 					ldy trackn_tablemode,x
   712 					beq ei2e
   713 					clc
   714 					adc trackn_tablenote,x
   715 				ei2e
   716 					EIF
   717 263F 9D 28 21			sta trackn_tablenote,x
   718 2642 BD 24 21			lda trackn_tabletypespeed,x
   719 					IFT FEAT_TABLETYPE||FEAT_TABLEMODE
   720 					and #$3f
   721 					EIF
   722 2645			ei2f
   723 2645 38				sec
   724 2646 E9 01			sbc #1
   725 2648 9D 34 21			sta trackn_tablespeeda,x
   726 264B			ei3
   727 264B BD 18 21			lda trackn_instrreachend,x
   728 264E 10 18			bpl ei4
   729 2650 BD F4 20			lda trackn_volume,x
   730 2653 F0 13			beq ei4
   731 					IFT FEAT_VOLUMEMIN
   732 					cmp trackn_volumemin,x
   733 					beq ei4
   734 					bcc ei4
   735 					EIF
   736 2655 A8				tay
   737 2656 BD 20 21			lda trackn_volumeslidevalue,x
   738 2659 18				clc
   739 265A 7D 1C 21			adc trackn_volumeslidedepth,x
   740 265D 9D 20 21			sta trackn_volumeslidevalue,x
   741 2660 90 06			bcc ei4
   742 2662 98				tya
   743 2663 E9 10			sbc #16
   744 2665 9D F4 20			sta trackn_volume,x
   745 2668			ei4
   746 					IFT FEAT_COMMAND2
   747 					lda #0
   748 					sta frqaddcmd2
   749 					EIF
   750 					IFT FEAT_COMMAND1||FEAT_COMMAND2||FEAT_COMMAND3||FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   751 2668 A5 8F			lda reg2
   752 					IFT FEAT_FILTER||FEAT_BASS16
   753 					sta trackn_command,x
   754 					EIF
   755 266A 29 70			and #$70
   756 					IFT 1==[FEAT_COMMAND1+FEAT_COMMAND2+FEAT_COMMAND3+FEAT_COMMAND4+FEAT_COMMAND5+FEAT_COMMAND6+[FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY]]
   757 					beq cmd0
   758 					ELS
   759 266C 4A				lsr @
   760 266D 4A				lsr @
   761 266E 8D 72 26			sta jmx+1
   762 2671 90 FE		jmx	bcc *
   763 2673 4C BA 26			jmp cmd0
   764 2676 EA				nop
   765 2677 4C 92 26			jmp cmd1
   766 					IFT FEAT_COMMAND2||FEAT_COMMAND3||FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   767 267A EA				nop
   768 267B 4C 97 26			jmp cmd2
   769 					EIF
   770 					IFT FEAT_COMMAND3||FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   771 267E EA				nop
   772 267F 4C 97 26			jmp cmd3
   773 					EIF
   774 					IFT FEAT_COMMAND4||FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   775 2682 EA				nop
   776 2683 4C A3 26			jmp cmd4
   777 					EIF
   778 					IFT FEAT_COMMAND5||FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   779 2686 EA				nop
   780 2687 4C B2 26			jmp cmd5
   781 					EIF
   782 					IFT FEAT_COMMAND6||FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   783 268A EA				nop
   784 268B 4C B2 26			jmp cmd6
   785 					EIF
   786 					IFT FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   787 268E EA				nop
   788 268F 4C B2 26			jmp cmd7
   789 					EIF
   790 					EIF
   791 					ELS
   792 					IFT FEAT_FILTER||FEAT_BASS16
   793 					lda reg2
   794 					sta trackn_command,x
   795 					EIF
   796 					EIF
   797 2692			cmd1
   798 					IFT FEAT_COMMAND1
   799 2692 A5 90			lda reg3
   800 2694 4C D6 26			jmp cmd0c
   801 					EIF
   802 2697			cmd2
   803 					IFT FEAT_COMMAND2
   804 					lda reg3
   805 					sta frqaddcmd2
   806 					lda trackn_note,x
   807 					jmp cmd0a
   808 					EIF
   809 2697			cmd3
   810 					IFT FEAT_COMMAND3
   811 2697 BD F0 20			lda trackn_note,x
   812 269A 18				clc
   813 269B 65 90			adc reg3
   814 269D 9D F0 20			sta trackn_note,x
   815 26A0 4C C0 26			jmp cmd0a
   816 					EIF
   817 26A3			cmd4
   818 					IFT FEAT_COMMAND4
   819 26A3 BD FC 20			lda trackn_shiftfrq,x
   820 26A6 18				clc
   821 26A7 65 90			adc reg3
   822 26A9 9D FC 20			sta trackn_shiftfrq,x
   823 26AC BD F0 20			lda trackn_note,x
   824 26AF 4C C0 26			jmp cmd0a
   825 					EIF
   826 26B2			cmd5
   827 					IFT FEAT_COMMAND5&&FEAT_PORTAMENTO
   828 					IFT FEAT_TABLETYPE
   829 					lda trackn_tabletypespeed,x
   830 					bpl cmd5a1
   831 					ldy trackn_note,x
   832 					lda (nr),y
   833 					clc
   834 					adc trackn_tablenote,x
   835 					jmp cmd5ax
   836 					EIF
   837 				cmd5a1
   838 					lda trackn_note,x
   839 					clc
   840 					adc trackn_tablenote,x
   841 					cmp #61
   842 					bcc cmd5a2
   843 					lda #63
   844 				cmd5a2
   845 					tay
   846 					lda (nr),y
   847 				cmd5ax
   848 					sta trackn_portafrqc,x
   849 					ldy reg3
   850 					bne cmd5a
   851 					sta trackn_portafrqa,x
   852 				cmd5a
   853 					tya
   854 					lsr @
   855 					lsr @
   856 					lsr @
   857 					lsr @
   858 					sta trackn_portaspeed,x
   859 					sta trackn_portaspeeda,x
   860 					lda reg3
   861 					and #$0f
   862 					sta trackn_portadepth,x
   863 					lda trackn_note,x
   864 					jmp cmd0a
   865 					ELI FEAT_COMMAND5
   866 					lda trackn_note,x
   867 					jmp cmd0a
   868 					EIF
   869 26B2			cmd6
   870 					IFT FEAT_COMMAND6&&FEAT_FILTER
   871 					lda reg3
   872 					clc
   873 					adc trackn_filter,x
   874 					sta trackn_filter,x
   875 					lda trackn_note,x
   876 					jmp cmd0a
   877 					ELI FEAT_COMMAND6
   878 					lda trackn_note,x
   879 					jmp cmd0a
   880 					EIF
   881 26B2			cmd7
   882 					IFT FEAT_COMMAND7SETNOTE||FEAT_COMMAND7VOLUMEONLY
   883 					IFT FEAT_COMMAND7SETNOTE
   884 26B2 A5 90			lda reg3
   885 					IFT FEAT_COMMAND7VOLUMEONLY
   886 					cmp #$80
   887 					beq cmd7a
   888 					EIF
   889 26B4 9D F0 20			sta trackn_note,x
   890 26B7 4C C0 26			jmp cmd0a
   891 					EIF
   892 					IFT FEAT_COMMAND7VOLUMEONLY
   893 				cmd7a
   894 					lda trackn_audc,x
   895 					ora #$f0
   896 					sta trackn_audc,x
   897 					lda trackn_note,x
   898 					jmp cmd0a
   899 					EIF
   900 					EIF
   901 26BA			cmd0
   902 26BA BD F0 20			lda trackn_note,x
   903 26BD 18				clc
   904 26BE 65 90			adc reg3
   905 26C0			cmd0a
   906 					IFT FEAT_TABLETYPE
   907 					ldy trackn_tabletypespeed,x
   908 					bmi cmd0b
   909 					EIF
   910 26C0 18				clc
   911 26C1 7D 28 21			adc trackn_tablenote,x
   912 26C4 C9 3D			cmp #61
   913 26C6 90 07			bcc cmd0a1
   914 26C8 A9 00			lda #0
   915 26CA 9D 3C 21			sta trackn_audc,x
   916 26CD A9 3F			lda #63
   917 26CF			cmd0a1
   918 					IFT FEAT_BASS16
   919 					sta trackn_outnote,x
   920 					EIF
   921 26CF A8				tay
   922 26D0 B1 8A			lda (nr),y
   923 26D2 18				clc
   924 26D3 7D FC 20			adc trackn_shiftfrq,x
   925 					IFT FEAT_COMMAND2
   926 					clc
   927 					adc frqaddcmd2
   928 					EIF
   929 					IFT FEAT_TABLETYPE
   930 					jmp cmd0c
   931 				cmd0b
   932 					cmp #61
   933 					bcc cmd0b1
   934 					lda #0
   935 					sta trackn_audc,x
   936 					lda #63
   937 				cmd0b1
   938 					tay
   939 					lda trackn_shiftfrq,x
   940 					clc
   941 					adc trackn_tablenote,x
   942 					clc
   943 					adc (nr),y
   944 					IFT FEAT_COMMAND2
   945 					clc
   946 					adc frqaddcmd2
   947 					EIF
   948 					EIF
   949 26D6			cmd0c
   950 26D6 9D 38 21			sta trackn_audf,x
   951 26D9			pp9
   952 					IFT FEAT_PORTAMENTO
   953 					lda trackn_portaspeeda,x
   954 					beq pp10
   955 					dec trackn_portaspeeda,x
   956 					bne pp10
   957 					lda trackn_portaspeed,x
   958 					sta trackn_portaspeeda,x
   959 					lda trackn_portafrqa,x
   960 					cmp trackn_portafrqc,x
   961 					beq pp10
   962 					bcs pps1
   963 					adc trackn_portadepth,x
   964 					bcs pps8
   965 					cmp trackn_portafrqc,x
   966 					bcs pps8
   967 					jmp pps9
   968 				pps1
   969 					sbc trackn_portadepth,x
   970 					bcc pps8
   971 					cmp trackn_portafrqc,x
   972 					bcs pps9
   973 				pps8
   974 					lda trackn_portafrqc,x
   975 				pps9
   976 					sta trackn_portafrqa,x
   977 				pp10
   978 					lda reg2
   979 					and #$01
   980 					beq pp11
   981 					lda trackn_portafrqa,x
   982 					clc
   983 					adc trackn_shiftfrq,x
   984 					sta trackn_audf,x
   985 				pp11
   986 					EIF
   987 26D9			ppnext
   988 26D9 CA				dex
   989 26DA 30 03			bmi rmt_p4
   990 26DC 4C C4 25			jmp pp1
   991 26DF			rmt_p4
   992 					IFT FEAT_AUDCTLMANUALSET
   993 					lda trackn_audctl+0
   994 					ora trackn_audctl+1
   995 					ora trackn_audctl+2
   996 					ora trackn_audctl+3
   997 					tax
   998 					ELS
   999 26DF A2 00			ldx #0
  1000 					EIF
  1001 26E1			qq1
  1002 26E1 8E EB 26			stx v_audctl
  1003 					IFT FEAT_FILTER
  1004 					IFT FEAT_FILTERG0L
  1005 					lda trackn_command+0
  1006 					bpl qq2
  1007 					lda trackn_audc+0
  1008 					and #$0f
  1009 					beq qq2
  1010 					lda trackn_audf+0
  1011 					clc
  1012 					adc trackn_filter+0
  1013 					sta trackn_audf+2
  1014 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2L
  1015 					lda trackn_audc+2
  1016 					and #$10
  1017 					bne qq1a
  1018 					EIF
  1019 					lda #0
  1020 					sta trackn_audc+2
  1021 				qq1a
  1022 					txa
  1023 					ora #4
  1024 					tax
  1025 					EIF
  1026 				qq2
  1027 					IFT FEAT_FILTERG1L
  1028 					lda trackn_command+1
  1029 					bpl qq3
  1030 					lda trackn_audc+1
  1031 					and #$0f
  1032 					beq qq3
  1033 					lda trackn_audf+1
  1034 					clc
  1035 					adc trackn_filter+1
  1036 					sta trackn_audf+3
  1037 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG3L
  1038 					lda trackn_audc+3
  1039 					and #$10
  1040 					bne qq2a
  1041 					EIF
  1042 					lda #0
  1043 					sta trackn_audc+3
  1044 				qq2a
  1045 					txa
  1046 					ora #2
  1047 					tax
  1048 					EIF
  1049 				qq3
  1050 					IFT FEAT_FILTERG0L||FEAT_FILTERG1L
  1051 					cpx v_audctl
  1052 					bne qq5
  1053 					EIF
  1054 					EIF
  1055 					IFT FEAT_BASS16
  1056 					IFT FEAT_BASS16G1L
  1057 					lda trackn_command+1
  1058 					and #$0e
  1059 					cmp #6
  1060 					bne qq4
  1061 					lda trackn_audc+1
  1062 					and #$0f
  1063 					beq qq4
  1064 					ldy trackn_outnote+1
  1065 					lda frqtabbasslo,y
  1066 					sta trackn_audf+0
  1067 					lda frqtabbasshi,y
  1068 					sta trackn_audf+1
  1069 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG0L
  1070 					lda trackn_audc+0
  1071 					and #$10
  1072 					bne qq3a
  1073 					EIF
  1074 					lda #0
  1075 					sta trackn_audc+0
  1076 				qq3a
  1077 					txa
  1078 					ora #$50
  1079 					tax
  1080 					EIF
  1081 				qq4
  1082 					IFT FEAT_BASS16G3L
  1083 					lda trackn_command+3
  1084 					and #$0e
  1085 					cmp #6
  1086 					bne qq5
  1087 					lda trackn_audc+3
  1088 					and #$0f
  1089 					beq qq5
  1090 					ldy trackn_outnote+3
  1091 					lda frqtabbasslo,y
  1092 					sta trackn_audf+2
  1093 					lda frqtabbasshi,y
  1094 					sta trackn_audf+3
  1095 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2L
  1096 					lda trackn_audc+2
  1097 					and #$10
  1098 					bne qq4a
  1099 					EIF
  1100 					lda #0
  1101 					sta trackn_audc+2
  1102 				qq4a
  1103 					txa
  1104 					ora #$28
  1105 					tax
  1106 					EIF
  1107 					EIF
  1108 26E4			qq5
  1109 26E4 8E EB 26			stx v_audctl
  1110 					IFT TRACKS>4
  1111 					IFT FEAT_AUDCTLMANUALSET
  1112 					lda trackn_audctl+4
  1113 					ora trackn_audctl+5
  1114 					ora trackn_audctl+6
  1115 					ora trackn_audctl+7
  1116 					tax
  1117 					ELS
  1118 					ldx #0
  1119 					EIF
  1120 					stx v_audctl2
  1121 					IFT FEAT_FILTER
  1122 					IFT FEAT_FILTERG0R
  1123 					lda trackn_command+0+4
  1124 					bpl qs2
  1125 					lda trackn_audc+0+4
  1126 					and #$0f
  1127 					beq qs2
  1128 					lda trackn_audf+0+4
  1129 					clc
  1130 					adc trackn_filter+0+4
  1131 					sta trackn_audf+2+4
  1132 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2R
  1133 					lda trackn_audc+2+4
  1134 					and #$10
  1135 					bne qs1a
  1136 					EIF
  1137 					lda #0
  1138 					sta trackn_audc+2+4
  1139 				qs1a
  1140 					txa
  1141 					ora #4
  1142 					tax
  1143 					EIF
  1144 				qs2
  1145 					IFT FEAT_FILTERG1R
  1146 					lda trackn_command+1+4
  1147 					bpl qs3
  1148 					lda trackn_audc+1+4
  1149 					and #$0f
  1150 					beq qs3
  1151 					lda trackn_audf+1+4
  1152 					clc
  1153 					adc trackn_filter+1+4
  1154 					sta trackn_audf+3+4
  1155 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG3R
  1156 					lda trackn_audc+3+4
  1157 					and #$10
  1158 					bne qs2a
  1159 					EIF
  1160 					lda #0
  1161 					sta trackn_audc+3+4
  1162 				qs2a
  1163 					txa
  1164 					ora #2
  1165 					tax
  1166 					EIF
  1167 				qs3
  1168 					IFT FEAT_FILTERG0R||FEAT_FILTERG1R
  1169 					cpx v_audctl2
  1170 					bne qs5
  1171 					EIF
  1172 					EIF
  1173 					IFT FEAT_BASS16
  1174 					IFT FEAT_BASS16G1R
  1175 					lda trackn_command+1+4
  1176 					and #$0e
  1177 					cmp #6
  1178 					bne qs4
  1179 					lda trackn_audc+1+4
  1180 					and #$0f
  1181 					beq qs4
  1182 					ldy trackn_outnote+1+4
  1183 					lda frqtabbasslo,y
  1184 					sta trackn_audf+0+4
  1185 					lda frqtabbasshi,y
  1186 					sta trackn_audf+1+4
  1187 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG0R
  1188 					lda trackn_audc+0+4
  1189 					and #$10
  1190 					bne qs3a
  1191 					EIF
  1192 					lda #0
  1193 					sta trackn_audc+0+4
  1194 				qs3a
  1195 					txa
  1196 					ora #$50
  1197 					tax
  1198 					EIF
  1199 				qs4
  1200 					IFT FEAT_BASS16G3R
  1201 					lda trackn_command+3+4
  1202 					and #$0e
  1203 					cmp #6
  1204 					bne qs5
  1205 					lda trackn_audc+3+4
  1206 					and #$0f
  1207 					beq qs5
  1208 					ldy trackn_outnote+3+4
  1209 					lda frqtabbasslo,y
  1210 					sta trackn_audf+2+4
  1211 					lda frqtabbasshi,y
  1212 					sta trackn_audf+3+4
  1213 					IFT FEAT_COMMAND7VOLUMEONLY&&FEAT_VOLUMEONLYG2R
  1214 					lda trackn_audc+2+4
  1215 					and #$10
  1216 					bne qs4a
  1217 					EIF
  1218 					lda #0
  1219 					sta trackn_audc+2+4
  1220 				qs4a
  1221 					txa
  1222 					ora #$28
  1223 					tax
  1224 					EIF
  1225 					EIF
  1226 				qs5
  1227 					stx v_audctl2
  1228 					EIF
  1229 26E7			rmt_p5
  1230 					IFT FEAT_INSTRSPEED==0||FEAT_INSTRSPEED>1
  1231 					lda #$ff
  1232 				v_ainstrspeed equ *-1
  1233 					ELS
  1234 26E7 A9 01			lda #1
  1235 					EIF
  1236 26E9 60				rts
  1237 26EA			SetPokey
  1238 					IFT STEREOMODE==1		;* L1 L2 L3 L4 R1 R2 R3 R4
  1239 					ldy #$ff
  1240 				v_audctl2 equ *-1
  1241 					lda trackn_audf+0+4
  1242 					ldx trackn_audf+0
  1243 				xstastx01	sta $d210
  1244 					stx $d200
  1245 					lda trackn_audc+0+4
  1246 					ldx trackn_audc+0
  1247 				xstastx02	sta $d211
  1248 					stx $d201
  1249 					lda trackn_audf+1+4
  1250 					ldx trackn_audf+1
  1251 				xstastx03	sta $d212
  1252 					stx $d202
  1253 					lda trackn_audc+1+4
  1254 					ldx trackn_audc+1
  1255 				xstastx04	sta $d213
  1256 					stx $d203
  1257 					lda trackn_audf+2+4
  1258 					ldx trackn_audf+2
  1259 				xstastx05	sta $d214
  1260 					stx $d204
  1261 					lda trackn_audc+2+4
  1262 					ldx trackn_audc+2
  1263 				xstastx06	sta $d215
  1264 					stx $d205
  1265 					lda trackn_audf+3+4
  1266 					ldx trackn_audf+3
  1267 				xstastx07	sta $d216
  1268 					stx $d206
  1269 					lda trackn_audc+3+4
  1270 					ldx trackn_audc+3
  1271 				xstastx08	sta $d217
  1272 					stx $d207
  1273 					lda #$ff
  1274 				v_audctl equ *-1
  1275 				xstysta01	sty $d218
  1276 					sta $d208
  1277 					ELI STEREOMODE==0		;* L1 L2 L3 L4
  1278 26EA A0 FF			ldy #$ff
  1279 = 26EB			v_audctl equ *-1
  1280 26EC AD 38 21			lda trackn_audf+0
  1281 26EF AE 3C 21			ldx trackn_audc+0
  1282 26F2 8D 00 D2			sta $d200
  1283 26F5 8E 01 D2			stx $d201
  1284 26F8 AD 39 21			lda trackn_audf+1
  1285 26FB AE 3D 21			ldx trackn_audc+1
  1286 26FE 8D 02 D2			sta $d200+2
  1287 2701 8E 03 D2			stx $d201+2
  1288 2704 AD 3A 21			lda trackn_audf+2
  1289 2707 AE 3E 21			ldx trackn_audc+2
  1290 270A 8D 04 D2			sta $d200+4
  1291 270D 8E 05 D2			stx $d201+4
  1292 2710 AD 3B 21			lda trackn_audf+3
  1293 2713 AE 3F 21			ldx trackn_audc+3
  1294 2716 8D 06 D2			sta $d200+6
  1295 2719 8E 07 D2			stx $d201+6
  1296 271C 8C 08 D2			sty $d208
  1297 					ELI STEREOMODE==2		;* L1 R2 R3 L4
  1298 					ldy #$ff
  1299 				v_audctl equ *-1
  1300 					lda trackn_audf+0
  1301 					ldx trackn_audc+0
  1302 					sta $d200
  1303 					stx $d201
  1304 					sta $d210
  1305 					lda trackn_audf+1
  1306 					ldx trackn_audc+1
  1307 					sta $d210+2
  1308 					stx $d211+2
  1309 					lda trackn_audf+2
  1310 					ldx trackn_audc+2
  1311 					sta $d210+4
  1312 					stx $d211+4
  1313 					sta $d200+4
  1314 					lda trackn_audf+3
  1315 					ldx trackn_audc+3
  1316 					sta $d200+6
  1317 					stx $d201+6
  1318 					sta $d210+6
  1319 					sty $d218
  1320 					sty $d208
  1321 					ELI STEREOMODE==3		;* L1 L2 R3 R4
  1322 					ldy #$ff
  1323 				v_audctl equ *-1
  1324 					lda trackn_audf+0
  1325 					ldx trackn_audc+0
  1326 					sta $d200
  1327 					stx $d201
  1328 					lda trackn_audf+1
  1329 					ldx trackn_audc+1
  1330 					sta $d200+2
  1331 					stx $d201+2
  1332 					lda trackn_audf+2
  1333 					ldx trackn_audc+2
  1334 					sta $d210+4
  1335 					stx $d211+4
  1336 					sta $d200+4
  1337 					lda trackn_audf+3
  1338 					ldx trackn_audc+3
  1339 					sta $d210+6
  1340 					stx $d211+6
  1341 					sta $d200+6
  1342 					sty $d218
  1343 					sty $d208
  1344 					EIF
  1345 271F 60				rts
  1346 2720			RMTPLAYEREND
   344 						
   345 				;*****	End of code test
   346 				;
   347 2720			END_CODE_WARNING
   348 					.if END_CODE_WARNING > PmgAddress 
   349 						.error "Code overrides code area!"
   350 					.endif
   351
   352 				;*****	Player missle graphics address
   353 				;
   354 2720					org PmgAddress
   355 A000-A7FF> 00 00 00 00 + :768	.byte %00000000	
   356 					
   357 				;*****	Missle starting address
   358 				;
   359 A300					org ms_area_1
   360 A300 00 00 00 00 00 00 + :1280 .byte %00000000
   361
   362 				;*****	Level Data definition
   363 				;
   364 A800					org DataAddress
   365 						
   366 3000					icl "Data/Levels.Asm"
Source: E:\_8BitProjects\Series\Scroller\Data\Levels.Asm
     1 				;
     2 				;****************************************************************************************************
     3 				;
     4 				;	Player Data
     5 				;
     6 				;		Each row of X and Y is associated with a level number (zero based).
     7 				;
     8 				;****************************************************************************************************
     9 				;
    10 3000			LevelsPlayer_X
    11 3000-3774> 01					.byte $01
    12
    13 3001			LevelsPlayer_Y
    14 3001 08						.byte $08
    15 				;
    16 				;****************************************************************************************************
    17 				;
    18 				;	Level Data
    19 				;
    20 				;		Low (LSB) and High (MSB) addresses of the level data map
    21 				;
    22 				;****************************************************************************************************
    23 				;
    24 3002			LevelsAddr_LSB
    25 3002 04				.byte <LEVELS_01
    26
    27 3003			LevelsAddr_MSB
    28 3003 30				.byte >LEVELS_01
    29 				;
    30 				;****************************************************************************************************
    31 				;
    32 3004			LEVELS_01
    33 3004 1E 05 02 FD 22 05 + 			.byte $1E,$05,$02,$FD,$22,$05,$02,$FD,$26,$05,$01,$FD,$FE
    34 3011 03 07 02 FD 05 07 + 			.byte $03,$07,$02,$FD,$05,$07,$02,$FD,$FE
    35 301A 08 08 02 FD 0A 08 + 			.byte $08,$08,$02,$FD,$0A,$08,$02,$FD,$FE
    36 3023 00 09 60 60 60 60 + 			.byte $00,$09,$60,$60,$60,$60,$60,$60,$FD,$0D,$09,$02,$FD,$1B,$09,$26,$27,$28,$29,$FD,$48,$09,$01,$01,$FD,$FE
    37 303D 06 0A 60 60 60 60 + 			.byte $06,$0A,$60,$60,$60,$60,$60,$FD,$FE
    38 3046 0B 0B 60 60 60 60 + 			.byte $0B,$0B,$60,$60,$60,$60,$FD,$1D,$0B,$03,$FD,$1F,$0B,$03,$FD,$FE
    39 3056 13 0C 01 FD 15 0C + 			.byte $13,$0C,$01,$FD,$15,$0C,$01,$FD,$17,$0C,$01,$FD,$26,$0C,$01,$FD,$28,$0C,$04,$FD,$2A,$0C,$01,$FD,$45,$0C,$60,$60,$46,$47,$46,$47,$61,$61,$FD,$FE
    40 307A 1D 0D 61 61 61 FD + 			.byte $1D,$0D,$61,$61,$61,$FD,$2D,$0D,$04,$FD,$39,$0D,$C0,$C1,$FD,$46,$0D,$5D,$07,$07,$07,$07,$6D,$FD,$FE
    41 3093 13 0E 61 61 61 61 + 			.byte $13,$0E,$61,$61,$61,$61,$61,$FD,$1C,$0E,$60,$70,$70,$70,$60,$FD,$26,$0E,$60,$60,$60,$60,$60,$FD,$36,$0E,$61,$61,$63,$60,$60,$FD,$46,$0E,$5D,$07,$07,$07,$07,$6D,$60,$60,$FD,$FE
    42 30BF 26 0F 5E 5D 5D 5D + 			.byte $26,$0F,$5E,$5D,$5D,$5D,$5D,$60,$60,$60,$FD,$46,$0F,$5D,$07,$07,$07,$07,$6D,$FD,$FE
    43 30D4 02 10 C0 C1 FD 26 + 			.byte $02,$10,$C0,$C1,$FD,$26,$10,$65,$23,$24,$25,$65,$66,$67,$5D,$FD,$36,$10,$01,$FD,$38,$10,$01,$FD,$3A,$10,$01,$FD,$46,$10,$5C,$07,$07,$07,$07,$6D,$FD,$FE
    44 30FA 00 11 60 60 60 60 + 			.byte $00,$11,$60,$60,$60,$60,$60,$60,$FD,$13,$11,$01,$FD,$15,$11,$01,$FD,$17,$11,$01,$FD,$28,$11,$95,$FD,$2D,$11,$5D,$FD,$46,$11,$5D,$07,$07,$07,$07,$6D,$FD,$FE
    45 3121 28 12 95 FD 2D 12 + 			.byte $28,$12,$95,$FD,$2D,$12,$5D,$FD,$35,$12,$60,$60,$60,$60,$60,$60,$60,$60,$FD,$41,$12,$60,$60,$46,$47,$46,$5D,$07,$07,$07,$07,$6D,$FD,$4E,$12,$60,$60,$60,$FD,$FE
    46 3149 0A 13 60 60 60 60 + 			.byte $0A,$13,$60,$60,$60,$60,$60,$60,$60,$FD,$1A,$13,$60,$60,$99,$99,$99,$99,$99,$60,$60,$FD,$28,$13,$95,$FD,$2B,$13,$01,$FD,$2D,$13,$5D,$FD,$35,$13,$10,$11,$12,$FD,$42,$13,$70,$07,$07,$07,$5D,$07,$07,$07,$07,$5D,$FD,$FE
    47 317F 1A 14 5D 5D FD 21 + 			.byte $1A,$14,$5D,$5D,$FD,$21,$14,$5D,$5D,$FD,$28,$14,$95,$FD,$2A,$14,$01,$FD,$2D,$14,$5D,$FD,$35,$14,$10,$11,$12,$FD,$42,$14,$70,$07,$07,$07,$07,$07,$07,$07,$07,$5C,$FD,$4E,$14,$01,$FD,$50,$14,$01,$FD,$FE
    48 31B1 17 15 60 60 60 5D + 			.byte $17,$15,$60,$60,$60,$5D,$5D,$FD,$21,$15,$5D,$5D,$FD,$28,$15,$95,$FD,$2B,$15,$01,$FD,$2D,$15,$5D,$FD,$35,$15,$10,$11,$12,$FD,$3B,$15,$01,$FD,$3D,$15,$01,$FD,$3F,$15,$03,$FD,$42,$15,$70,$07,$07,$07,$07,$07,$07,$07,$07,$5D,$FD,$FE
    49 31EA 15 16 60 60 60 60 + 			.byte $15,$16,$60,$60,$60,$60,$60,$5D,$5D,$FD,$21,$16,$5D,$6B,$FD,$28,$16,$95,$FD,$2D,$16,$5D,$FD,$35,$16,$10,$11,$12,$FD,$42,$16,$6E,$48,$49,$48,$49,$49,$48,$48,$49,$5D,$FD,$FE
    50 3215 00 17 60 60 60 60 + 			.byte $00,$17,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$5C,$6A,$60,$60,$60,$60,$60,$5D,$5D,$60,$60,$60,$60,$20,$21,$22,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$60,$70,$5D,$5D,$5D,$5D,$5D,$5D,$5D,$5D,$5D,$60,$60,$60,$60,$60,$60,$FD,$FE
    51 326B FF						.byte $FF
    52
   367 326C					icl "ScrollerData.Asm"
Source: E:\_8BitProjects\Series\Scroller\ScrollerData.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		ScrollerData.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 				;***** System Data members
    14 				;
    15 326C 00			m_sfxData						.byte $00
    16 326D 00			m_sfxValue						.byte $00
    17 326E 00			m_sfxLength						.byte $00
    18
    19 326F 00			m_floatAnimModV					.byte $00		; used for modulus operation on vertical animation
    20 3270 00			m_floatAnimModH					.byte $00		; used for modulus operation on horizontal animation
    21 3271 00			m_floatPlatformV				.byte $00		; is there vertical floating platforms
    22 3272 00			m_floatPlatformH				.byte $00		; is there horizontal floating platforms
    23 3273 00			m_floatPlatformIdx				.byte $00		; index to platform screen array
    24 3274 00			m_floatPlatform_X				.byte $00
    25 3275 00			m_floatPlatform_Y				.byte $00
    26
    27 3276 00			m_verticalLaserOn				.byte $00		; is vertical laser available
    28 3277 00			m_horizontalLaserOn				.byte $00		; is horizontal laser available
    29
    30 3278 00			m_goldCounter 					.byte $00		; current gold counter
    31 3279 00			m_healthCounter					.byte $00		; current health counter
    32 327A 00			m_waterAvailable				.byte $00		; is water available
    33
    34 327B 00			m_disableGameTimer				.byte $00		; disable game flag
    35
    36 327C 00			m_gameTimerSeconds				.byte $00		; seconds timer
    37 327D 00			m_gameTimerMinutes				.byte $00		; minutes timer
    38
    39 327E 00			m_gameTimerTSeconds				.byte $00		; seconds timer total
    40 327F 00			m_gameTSFrameCounter			.byte $00		; frame counter total
    41
    42 3280 04			m_animSeaTopTimer				.byte ANIM_SEA_TOP_FRAME_TIME
    43
    44 3281 00			m_firstCoinAnimIndex			.byte $00
    45 3282 00			m_emptyCoinAnimIndex			.byte $00
    46 3283 00			m_currentCoinAnimations			.byte $00
    47
    48 3284 01			m_animHLaserTimer				.byte $01
    49 3285 00			m_animHLaserCurrentFrame		.byte $00
    50
    51 3286 01			m_animLaserTimer				.byte $01
    52 3287 00			m_animLaserCurrentFrame			.byte $00
    53
    54 3288 00 00		m_screenBaseAddress1			.word $00
    55 328A 00 00		m_screenBaseAddress2			.word $00
    56
    57 328C 00			m_windowTargetPosX_H1			.byte $00
    58 328D 00			m_windowTargetPosX_H2			.byte $00
    59 328E 00			m_windowTargetPosY_H1			.byte $00
    60 328F 00			m_windowTargetPosY_H2			.byte $00
    61
    62 3290 00			m_windowTargetDeltaX_H1			.byte $00
    63 3291 00			m_windowTargetDeltaX_H2			.byte $00
    64 3292 00			m_windowTargetDeltaY_H1			.byte $00
    65 3293 00			m_windowTargetDeltaY_H2			.byte $00
    66
    67 3294 00			m_enemyExplosionLevelLeftX_H1	.byte $00
    68 3295 00			m_enemyExplosionLevelLeftX_H2	.byte $00
    69
    70 3296 00			m_enemyExplosionLevelTopY_H1	.byte $00
    71 3297 00			m_enemyExplosionLevelTopY_H2	.byte $00
    72 3298 00			m_enemyExplosionLevelTopY_L1	.byte $00
    73
    74 3299 00			m_enemyExplosionScreenTopY_H1	.byte $00
    75 329A 00			m_enemyExplosionScreenLeftX_H1	.byte $00
    76
    77 329B 00			m_enemyExplosionStep			.byte $00
    78
    79 329C 00			m_enemyCharPosX					.byte $00
    80 329D 00			m_enemyCharPosY					.byte $00
    81 329E 00			m_enemyExplosionStepIndex		.byte $00
    82
    83 329F 00			m_hitEnemySaveX 				.byte $00
    84 32A0 00			m_numEnemyExplosions			.byte $00
    85
    86 32A1 00			m_totalEnemies 					.byte $00
    87 32A2 00			m_activeEnemies 				.byte $00
    88
    89 32A3 00			m_searchEnemyChar 				.byte $00
    90 32A4 00			m_defEnemyLife 					.byte $00
    91 32A5 00			m_numberOfValidRows 			.byte $00
    92
    93 32A6 00			m_tempByte 						.byte $00
    94
    95 32A7 00			m_lastEnemyIndexUpdated 		.byte $00
    96
    97 32A8 00			m_enemyMissilesActive 			.byte $00
    98
    99 32A9 00			m_enemyShootDirection 			.byte $00
   100
   101 32AA 00			m_enemyShotLevelLeftX_H1 		.byte $00
   102 32AB 00			m_enemyShotLevelLeftX_H2 		.byte $00
   103 32AC 00			m_enemyShotLevelTopY_H1 		.byte $00
   104 32AD 00			m_enemyShotLevelTopY_H2 		.byte $00
   105
   106 32AE 00			m_currRow						.byte $00
   107 32AF 00			m_currCol						.byte $00
   108 32B0 00			m_scrYCount						.byte $00
   109 32B1 00			m_datYCount						.byte $00
   110
   111 32B2 00			m_pixelPositionX_H2				.byte 0
   112 32B3 00			m_pixelPositionX_H1				.byte 0
   113 32B4 00			m_pixelPositionY_H2				.byte 0
   114 32B5 00			m_pixelPositionY_H1				.byte 0
   115
   116 32B6 00			m_charPositionX					.byte 0
   117 32B7 00			m_charPositionY					.byte 0
   118
   119 32B8 00			m_lineAddressLSB				.byte 0
   120 32B9 00			m_lineAddressMSB				.byte 0
   121
   122 32BA 00			m_charRaw						.byte 0
   123 32BB 00			m_charDef						.byte 0
   124
   125 32BC 00			m_screenDelta_H2				.byte 0
   126 32BD 00			m_screenDelta_H1				.byte 0
   127
   128 32BE 00			m_hldA							.byte $00
   129 32BF 00			m_hldY							.byte $00
   130 32C0 00			m_hldX							.byte $00
   131 32C1 00			m_revX							.byte $00
   132 32C2 00			m_revIndex						.byte $00
   133 32C3 00			m_revHeight						.byte $00
   134 32C4 00			m_revOffset						.byte $00
   135 32C5 00			m_animCount						.byte $00
   136 32C6 00			m_animFrame						.byte $00
   137 32C7 00			m_animIndex        				.byte $00
   138 32C8 00			m_animHeight					.byte $00
   139 32C9 00			m_animOffset					.byte $00	
   140
   141 32CA 00			m_leftTopChar					.byte $00
   142 32CB 00			m_rightTopChar					.byte $00
   143 32CC 00			m_charBuffer_H2					.byte $00
   144 32CD 00			m_leftBottomChar				.byte $00
   145 32CE 00			m_rightBottomChar				.byte $00
   146 32CF 00			m_middleBottomChar				.byte $00
   147 32D0 00			m_bottomPosOffsetX				.byte $00
   148 32D1 00			m_bottomPosOffsetY				.byte $00
   149 32D2 00			m_playerExplosionStep			.byte $00
   150 32D3 00			m_middleBottomCharPosX			.byte $00
   151 32D4 00			m_waterPlayerDirectionFlag		.byte $00
   152 32D5 00			m_playerOnWaterSurfaceFlag		.byte $00
   153 32D6 00			m_playerExplosionScreenTopY_H1	.byte $00
   154 32D7 00			m_playerExplosionScreenTopY_L1	.byte $00
   155
   156 32D8 00			m_debugSaveX					.byte 0
   157
   158 32D9 00 00		m_currentLineAddress			.word $0000
   159
   160 32DB 00 00 00 00 00 00 + TabLevelLineAddressLSB			:256 .byte $00
   161 33DB 00 00 00 00 00 00 + TabLevelLineAddressMSB			:256 .byte $00
   162
   163 				;
   164 				;**************************************************************************************************
   165 				; Character tile type definition
   166 				;
   167 				; 	Type definition: low 4 bits (0-15 value)
   168 				;		- 0: empty normal space (with gravity info?)			CT_BLANK			= 0					
   169
   170 				;		- 1: block (with collision info, RLDU)					CT_BLOCK			= 1
   171 				;		- 6: floating platform									CT_FLOATPLATFORM	= 1	
   172
   173 				;		- 2: collectable (with value info?)						CT_COLLECTABLE		= 2
   174 				;		- 3: danger (with energy info?)							CT_DANGER			= 3
   175 				;		- 4: ladder, climbable (with directions info?)			CT_LADDER			= 4
   176 				;		- 5: water (with density info? currents?)				CT_WATER			= 5
   177 				;		- 7: health 											CT_HEALTH			= 6
   178 				;		- 8: Vertical Lasers									CT_VLASER			= 7
   179 				;		- 9: Horizontal Lasers									CT_HLASER			= 8
   180 				;
   181 				; 	External level definitions:
   182 				; 		- blocks ON/OFF
   183 				; 		- moving blocks
   184 				; 		- switches, triggers and traps
   185 				; 		- enemies and generators
   186 				; 		- dangers ON/OFF
   187 				; 		- moving dangers
   188 				; 		- interactions zones
   189 				; 		- text messages
   190 				;
   191 				;**************************************************************************************************
   192 				;
   193 34DB			TabCharDefinition
   194 34DB 00				.byte %00000000+CT_BLANK								; blank								[00]
   195 34DC 02				.byte %00000000+CT_COLLECTABLE							; collectable 1						[01]
   196 34DD 02				.byte %00000000+CT_COLLECTABLE							; collectable 1						[02]				
   197 34DE 06				.byte %00000000+CT_HEALTH								; collectable 1						[03]
   198 34DF 02				.byte %00000000+CT_COLLECTABLE							; collectable 1						[04]
   199 34E0 03				.byte %00000000+CT_DANGER								; blue spikes						[05]
   200 34E1 03				.byte %00000000+CT_DANGER								; blue spikes						[06]
   201 34E2 05				.byte %00000000+CT_WATER								; blank								[07]
   202 34E3 06				.byte %00000000+CT_HEALTH								; blank								[08]
   203 34E4 00				.byte %00000000+CT_BLANK								; blank								[09]
   204 34E5 00				.byte %00000000+CT_BLANK								; blank								[0A]
   205 34E6 00				.byte %00000000+CT_BLANK								; blank								[0B]
   206 34E7 00				.byte %00000000+CT_BLANK								; blank								[0C]
   207 34E8 00				.byte %00000000+CT_BLANK								; blank								[0D]
   208 34E9 00				.byte %00000000+CT_BLANK								; blank								[0E]
   209 34EA 00				.byte %00000000+CT_BLANK								; blank								[0F]
   210 34EB 04				.byte %00000000+CT_LADDER								; ladder							[10]
   211 34EC 04				.byte %00000000+CT_LADDER								; ladder							[11]
   212 34ED 04				.byte %00000000+CT_LADDER								; ladder							[12]
   213 34EE 03				.byte %00000000+CT_DANGER								; blue spikes						[13]
   214 34EF F8				.byte %11110000+CT_VLASER								; vertical dither 1					[14]				
   215 34F0 F8				.byte %11110000+CT_VLASER								; vertical dither 2					[15]
   216 34F1 F8				.byte %11110000+CT_VLASER								; vertical dither 3					[16]
   217 34F2 FA				.byte %11110000+CT_HLASER								; horizontal dither 1				[17]
   218 34F3 FA				.byte %11110000+CT_HLASER								; horizontal dither 2				[18]
   219 34F4 FA				.byte %11110000+CT_HLASER								; horizontal dither 3				[19]
   220 34F5 03				.byte %00000000+CT_DANGER								; spikes							[1A]
   221 34F6 03				.byte %00000000+CT_DANGER								; spikes							[1B]
   222 34F7 03				.byte %00000000+CT_DANGER								; spikes							[1C]
   223 34F8 03				.byte %00000000+CT_DANGER								; spikes							[1D]
   224 34F9 03				.byte %00000000+CT_DANGER								; spikes							[1E]
   225 34FA 03				.byte %00000000+CT_DANGER								; spikes							[1F]
   226 34FB F1				.byte %11110000+CT_BLOCK								; vertical dither 1 LB  base		[20]
   227 34FC F1				.byte %11110000+CT_BLOCK								; vertical dither 2 MB  base		[21]
   228 34FD F1				.byte %11110000+CT_BLOCK								; vertical dither 3 RB  base		[22]
   229 34FE F1				.byte %11110000+CT_BLOCK								; vertical dither 1 LT  base		[23]
   230 34FF F1				.byte %11110000+CT_BLOCK								; vertical dither 2 MT  base		[24]
   231 3500 F1				.byte %11110000+CT_BLOCK								; vertical dither 3 RT  base		[25]
   232 3501 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[26]
   233 3502 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[27]
   234 3503 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[28]
   235 3504 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[29]
   236 3505 00				.byte %00000000+CT_BLANK								; blank								[2A]
   237 3506 00				.byte %00000000+CT_BLANK								; blank								[2B]
   238 3507 00				.byte %00000000+CT_BLANK								; blank								[2C]
   239 3508 00				.byte %00000000+CT_BLANK								; blank								[2D]
   240 3509 00				.byte %00000000+CT_BLANK								; blank								[2E]
   241 350A 00				.byte %00000000+CT_BLANK								; blank								[2F]
   242 350B 00				.byte %00000000+CT_BLANK								; blank								[30]
   243 350C 00				.byte %00000000+CT_BLANK								; blank								[31]
   244 350D 00				.byte %00000000+CT_BLANK								; blank								[32]
   245 350E 00				.byte %00000000+CT_BLANK								; blank								[33]
   246 350F 00				.byte %00000000+CT_BLANK								; blank								[34]
   247 3510 00				.byte %00000000+CT_BLANK								; blank								[35]
   248 3511 00				.byte %00000000+CT_BLANK								; blank								[36]
   249 3512 00				.byte %00000000+CT_BLANK								; blank								[37]
   250 3513 00				.byte %00000000+CT_BLANK								; blank								[38]
   251 3514 00				.byte %00000000+CT_BLANK								; blank								[39]
   252 3515 03				.byte %00000000+CT_DANGER								; spikes							[3A]
   253 3516 03				.byte %00000000+CT_DANGER								; spikes							[3B]
   254 3517 00				.byte %00000000+CT_BLANK								; blank								[3C]
   255 3518 00				.byte %00000000+CT_BLANK								; blank								[3D]
   256 3519 00				.byte %00000000+CT_BLANK								; blank								[3E]
   257 351A 00				.byte %00000000+CT_BLANK								; blank								[3F]
   258 351B 13				.byte %00010000+CT_DANGER								; enemy 1 left side (red)           [40]
   259 351C 13				.byte %00010000+CT_DANGER								; enemy 1 left side (red)           [41]
   260 351D 00				.byte %00000000+CT_BLANK								; blank								[42]
   261 351E 00				.byte %00000000+CT_BLANK								; blank								[43]
   262 351F 00				.byte %00000000+CT_BLANK								; blank								[44]
   263 3520 00				.byte %00000000+CT_BLANK								; blank								[45]
   264 3521 05				.byte %00000000+CT_WATER								; blank								[46]
   265 3522 05				.byte %00000000+CT_WATER								; blank								[47]
   266 3523 05				.byte %00000000+CT_WATER								; blank								[48]
   267 3524 05				.byte %00000000+CT_WATER								; blank								[49]
   268 3525 00				.byte %00000000+CT_BLANK								; blank								[4A]
   269 3526 00				.byte %00000000+CT_BLANK								; blank								[4B]
   270 3527 F1				.byte %11110000+CT_BLOCK								; solid platform					[4C]
   271 3528 F1				.byte %11110000+CT_BLOCK								; solid platform					[4D]
   272 3529 F1				.byte %11110000+CT_BLOCK								; solid platform					[4E]
   273 352A F1				.byte %11110000+CT_BLOCK								; solid platform					[4F]
   274 352B F1				.byte %11110000+CT_BLOCK								; solid platform					[50]
   275 352C F1				.byte %11110000+CT_BLOCK								; solid platform					[51]
   276 352D 00				.byte %00000000+CT_BLANK								; blank								[52]   
   277 352E 00				.byte %00000000+CT_BLANK								; blank								[53]   
   278 352F 00				.byte %00000000+CT_BLANK								; blank								[54]   
   279 3530 00				.byte %00000000+CT_BLANK								; blank								[55]   
   280 3531 00				.byte %00000000+CT_BLANK								; blank								[56]   
   281 3532 00				.byte %00000000+CT_BLANK								; blank								[57]   
   282 3533 00				.byte %00000000+CT_BLANK								; blank								[58]   
   283 3534 00				.byte %00000000+CT_BLANK								; blank								[59]   
   284 3535 03				.byte %00000000+CT_DANGER								; spikes							[5A]   
   285 3536 03				.byte %00000000+CT_DANGER								; spikes							[5B]   
   286 3537 F1				.byte %11110000+CT_BLOCK								; solid platform					[5C]   
   287 3538 F1				.byte %11110000+CT_BLOCK								; solid platform					[5D]   
   288 3539 F1				.byte %11110000+CT_BLOCK								; solid platform					[5E]   
   289 353A 00				.byte %00000000+CT_BLANK								; blank								[5F]   
   290 353B F1				.byte %11110000+CT_BLOCK								; solid platform					[60]   
   291 353C F1				.byte %11110000+CT_BLOCK								; solid platform					[61]   
   292 353D F1				.byte %11110000+CT_BLOCK								; solid platform					[62]   
   293 353E F1				.byte %11110000+CT_BLOCK								; solid platform					[63]   
   294 353F F1				.byte %11110000+CT_BLOCK								; solid platform					[64]   
   295 3540 F1				.byte %11110000+CT_BLOCK								; solid platform					[65]   
   296 3541 F1				.byte %11110000+CT_BLOCK								; solid platform					[66]   
   297 3542 F1				.byte %11110000+CT_BLOCK								; solid platform					[67]   
   298 3543 F1				.byte %11110000+CT_BLOCK								; solid platform					[68]   
   299 3544 F1				.byte %11110000+CT_BLOCK								; solid platform					[69]   
   300 3545 F1				.byte %11110000+CT_BLOCK								; solid platform					[6A]   
   301 3546 F1				.byte %11110000+CT_BLOCK								; solid platform					[6B]   
   302 3547 F1				.byte %11110000+CT_BLOCK								; solid platform					[6C]   
   303 3548 F1				.byte %11110000+CT_BLOCK								; solid platform					[6D]   
   304 3549 F1				.byte %11110000+CT_BLOCK								; solid platform					[6E]   
   305 354A F1				.byte %11110000+CT_BLOCK								; solid platform					[6F]   
   306 354B F1				.byte %11110000+CT_BLOCK								; solid platform					[70]   
   307 354C F1				.byte %11110000+CT_BLOCK								; solid platform					[71]   
   308 354D F1				.byte %11110000+CT_BLOCK								; solid platform					[72]   
   309 354E F1				.byte %11110000+CT_BLOCK								; solid platform					[73]   
   310 354F F1				.byte %11110000+CT_BLOCK								; solid platform					[74]   
   311 3550 00				.byte %00000000+CT_BLANK								; blank								[75]   
   312 3551 00				.byte %00000000+CT_BLANK								; blank								[76]   
   313 3552 00				.byte %00000000+CT_BLANK								; blank								[77]   
   314 3553 00				.byte %00000000+CT_BLANK								; blank								[78]   
   315 3554 00				.byte %00000000+CT_BLANK								; blank								[79]   
   316 3555 00				.byte %00000000+CT_BLANK								; blank								[7A]   
   317 3556 00				.byte %00000000+CT_BLANK								; blank								[7B]   
   318 3557 00				.byte %00000000+CT_BLANK								; blank								[7C]   
   319 3558 00				.byte %00000000+CT_BLANK								; blank								[7D]   
   320 3559 00				.byte %00000000+CT_BLANK								; blank								[7E]   
   321 355A 00				.byte %00000000+CT_BLANK								; blank								[7F]   
   322 				;
   323 				;**************************************************************************************************
   324 				; second half, inverse characters, fifth color (red, danger)
   325 				;**************************************************************************************************
   326 				;
   327 355B				org TabCharDefinition+$80
   328
   329 355B 00				.byte %00000000+CT_BLANK								; blank								[80]
   330 355C 02				.byte %00000000+CT_COLLECTABLE							; collectable 1						[81]
   331 355D 02				.byte %00000000+CT_COLLECTABLE							; collectable 1						[82]				
   332 355E 06				.byte %00000000+CT_HEALTH								; collectable 1						[83]
   333 355F 02				.byte %00000000+CT_COLLECTABLE							; collectable 1						[84]
   334 3560 03				.byte %00000000+CT_DANGER								; blue spikes						[85]
   335 3561 03				.byte %00000000+CT_DANGER								; blue spikes						[86]
   336 3562 05				.byte %00000000+CT_WATER								; blank								[87]
   337 3563 06				.byte %00000000+CT_HEALTH								; blank								[88]
   338 3564 00				.byte %00000000+CT_BLANK								; blank								[89]
   339 3565 00				.byte %00000000+CT_BLANK								; blank								[8A]
   340 3566 00				.byte %00000000+CT_BLANK								; blank								[8B]
   341 3567 00				.byte %00000000+CT_BLANK								; blank								[8C]
   342 3568 00				.byte %00000000+CT_BLANK								; blank								[8D]
   343 3569 00				.byte %00000000+CT_BLANK								; blank								[8E]
   344 356A 00				.byte %00000000+CT_BLANK								; blank								[8F]
   345 356B 04				.byte %00000000+CT_LADDER								; ladder							[90]
   346 356C 04				.byte %00000000+CT_LADDER								; ladder							[91]
   347 356D 04				.byte %00000000+CT_LADDER								; ladder							[92]
   348 356E 03				.byte %00000000+CT_DANGER								; blue spikes						[93]
   349 356F F8				.byte %11110000+CT_VLASER								; vertical dither 1					[94]				
   350 3570 F8				.byte %11110000+CT_VLASER								; vertical dither 2					[95]
   351 3571 F8				.byte %11110000+CT_VLASER								; vertical dither 3					[96]
   352 3572 FA				.byte %11110000+CT_HLASER								; horizontal dither 1				[97]
   353 3573 FA				.byte %11110000+CT_HLASER								; horizontal dither 2				[98]
   354 3574 FA				.byte %11110000+CT_HLASER								; horizontal dither 3				[99]
   355 3575 03				.byte %00000000+CT_DANGER								; spikes							[9A]
   356 3576 03				.byte %00000000+CT_DANGER								; spikes							[9B]
   357 3577 03				.byte %00000000+CT_DANGER								; spikes							[9C]
   358 3578 03				.byte %00000000+CT_DANGER								; spikes							[9D]
   359 3579 03				.byte %00000000+CT_DANGER								; spikes							[9E]
   360 357A 03				.byte %00000000+CT_DANGER								; spikes							[9F]
   361 357B F1				.byte %11110000+CT_BLOCK								; vertical dither 1 LB  base		[A0]
   362 357C F1				.byte %11110000+CT_BLOCK								; vertical dither 2 MB  base		[A1]
   363 357D F1				.byte %11110000+CT_BLOCK								; vertical dither 3 RB  base		[A2]
   364 357E F1				.byte %11110000+CT_BLOCK								; vertical dither 1 LT  base		[A3]
   365 357F F1				.byte %11110000+CT_BLOCK								; vertical dither 2 MT  base		[A4]
   366 3580 F1				.byte %11110000+CT_BLOCK								; vertical dither 3 RT  base		[A5]
   367 3581 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[A6]
   368 3582 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[A7]
   369 3583 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[A8]
   370 3584 17				.byte %00010000+CT_FLOATPLATFORMH						; Floating Platform					[A9]
   371 3585 00				.byte %00000000+CT_BLANK								; blank								[AA]
   372 3586 00				.byte %00000000+CT_BLANK								; blank								[AB]
   373 3587 00				.byte %00000000+CT_BLANK								; blank								[AC]
   374 3588 00				.byte %00000000+CT_BLANK								; blank								[AD]
   375 3589 00				.byte %00000000+CT_BLANK								; blank								[AE]
   376 358A 00				.byte %00000000+CT_BLANK								; blank								[AF]
   377 358B 00				.byte %00000000+CT_BLANK								; blank								[B0]
   378 358C 00				.byte %00000000+CT_BLANK								; blank								[B1]
   379 358D 00				.byte %00000000+CT_BLANK								; blank								[B2]
   380 358E 00				.byte %00000000+CT_BLANK								; blank								[B3]
   381 358F 00				.byte %00000000+CT_BLANK								; blank								[B4]
   382 3590 00				.byte %00000000+CT_BLANK								; blank								[B5]
   383 3591 00				.byte %00000000+CT_BLANK								; blank								[B6]
   384 3592 00				.byte %00000000+CT_BLANK								; blank								[B7]
   385 3593 00				.byte %00000000+CT_BLANK								; blank								[B8]
   386 3594 00				.byte %00000000+CT_BLANK								; blank								[B9]
   387 3595 03				.byte %00000000+CT_DANGER								; spikes							[BA]
   388 3596 03				.byte %00000000+CT_DANGER								; spikes							[BB]
   389 3597 00				.byte %00000000+CT_BLANK								; blank								[BC]
   390 3598 00				.byte %00000000+CT_BLANK								; blank								[BD]
   391 3599 00				.byte %00000000+CT_BLANK								; blank								[BE]
   392 359A 00				.byte %00000000+CT_BLANK								; blank								[BF]
   393 359B 13				.byte %00010000+CT_DANGER								; enemy 1 left side (red)           [C0]
   394 359C 13				.byte %00010000+CT_DANGER								; enemy 1 left side (red)           [C1]
   395 359D 00				.byte %00000000+CT_BLANK								; blank								[C2]
   396 359E 00				.byte %00000000+CT_BLANK								; blank								[C3]
   397 359F 00				.byte %00000000+CT_BLANK								; blank								[C4]
   398 35A0 00				.byte %00000000+CT_BLANK								; blank								[C5]
   399 35A1 05				.byte %00000000+CT_WATER								; blank								[C6]
   400 35A2 05				.byte %00000000+CT_WATER								; blank								[C7]
   401 35A3 05				.byte %00000000+CT_WATER								; blank								[C8]
   402 35A4 05				.byte %00000000+CT_WATER								; blank								[C9]
   403 35A5 00				.byte %00000000+CT_BLANK								; blank								[CA]
   404 35A6 00				.byte %00000000+CT_BLANK								; blank								[CB]
   405 35A7 F1				.byte %11110000+CT_BLOCK								; solid platform					[CC]
   406 35A8 F1				.byte %11110000+CT_BLOCK								; solid platform					[CD]
   407 35A9 F1				.byte %11110000+CT_BLOCK								; solid platform					[CE]
   408 35AA F1				.byte %11110000+CT_BLOCK								; solid platform					[CF]
   409 35AB F1				.byte %11110000+CT_BLOCK								; solid platform					[D0]
   410 35AC F1				.byte %11110000+CT_BLOCK								; solid platform					[D1]
   411 35AD 00				.byte %00000000+CT_BLANK								; blank								[D2]   
   412 35AE 00				.byte %00000000+CT_BLANK								; blank								[D3]   
   413 35AF 00				.byte %00000000+CT_BLANK								; blank								[D4]   
   414 35B0 00				.byte %00000000+CT_BLANK								; blank								[D5]   
   415 35B1 00				.byte %00000000+CT_BLANK								; blank								[D6]   
   416 35B2 00				.byte %00000000+CT_BLANK								; blank								[D7]   
   417 35B3 00				.byte %00000000+CT_BLANK								; blank								[D8]   
   418 35B4 00				.byte %00000000+CT_BLANK								; blank								[D9]   
   419 35B5 03				.byte %00000000+CT_DANGER								; spikes							[DA]   
   420 35B6 03				.byte %00000000+CT_DANGER								; spikes							[DB]   
   421 35B7 F1				.byte %11110000+CT_BLOCK								; solid platform					[DC]   
   422 35B8 F1				.byte %11110000+CT_BLOCK								; solid platform					[DD]   
   423 35B9 F1				.byte %11110000+CT_BLOCK								; solid platform					[DE]   
   424 35BA 00				.byte %00000000+CT_BLANK								; blank								[DF]   
   425 35BB F1				.byte %11110000+CT_BLOCK								; solid platform					[E0]   
   426 35BC F1				.byte %11110000+CT_BLOCK								; solid platform					[E1]   
   427 35BD F1				.byte %11110000+CT_BLOCK								; solid platform					[E2]   
   428 35BE F1				.byte %11110000+CT_BLOCK								; solid platform					[E3]   
   429 35BF F1				.byte %11110000+CT_BLOCK								; solid platform					[E4]   
   430 35C0 F1				.byte %11110000+CT_BLOCK								; solid platform					[E5]   
   431 35C1 F1				.byte %11110000+CT_BLOCK								; solid platform					[E6]   
   432 35C2 F1				.byte %11110000+CT_BLOCK								; solid platform					[E7]   
   433 35C3 F1				.byte %11110000+CT_BLOCK								; solid platform					[E8]   
   434 35C4 F1				.byte %11110000+CT_BLOCK								; solid platform					[E9]   
   435 35C5 F1				.byte %11110000+CT_BLOCK								; solid platform					[EA]   
   436 35C6 F1				.byte %11110000+CT_BLOCK								; solid platform					[EB]   
   437 35C7 F1				.byte %11110000+CT_BLOCK								; solid platform					[EC]   
   438 35C8 F1				.byte %11110000+CT_BLOCK								; solid platform					[ED]   
   439 35C9 F1				.byte %11110000+CT_BLOCK								; solid platform					[EE]   
   440 35CA F1				.byte %11110000+CT_BLOCK								; solid platform					[EF]   
   441 35CB F1				.byte %11110000+CT_BLOCK								; solid platform					[F0]   
   442 35CC F1				.byte %11110000+CT_BLOCK								; solid platform					[F1]   
   443 35CD F1				.byte %11110000+CT_BLOCK								; solid platform					[F2]   
   444 35CE F1				.byte %11110000+CT_BLOCK								; solid platform					[F3]   
   445 35CF F1				.byte %11110000+CT_BLOCK								; solid platform					[F4]   
   446 35D0 00				.byte %00000000+CT_BLANK								; blank								[F5]   
   447 35D1 00				.byte %00000000+CT_BLANK								; blank								[F6]   
   448 35D2 00				.byte %00000000+CT_BLANK								; blank								[F7]   
   449 35D3 00				.byte %00000000+CT_BLANK								; blank								[F8]   
   450 35D4 00				.byte %00000000+CT_BLANK								; blank								[F9]   
   451 35D5 00				.byte %00000000+CT_BLANK								; blank								[FA]   
   452 35D6 00				.byte %00000000+CT_BLANK								; blank								[FB]   
   453 35D7 00				.byte %00000000+CT_BLANK								; blank								[FC]   
   454 35D8 00				.byte %00000000+CT_BLANK								; blank								[FD]   
   455 35D9 00				.byte %00000000+CT_BLANK								; blank								[FE]   
   456 35DA 00				.byte %00000000+CT_BLANK								; blank								[FF]
   457
   458 				;*****	Game Dislplay List Definition
   459 				;
   460 35DB			GameDL 
   461 35DB 70					.byte DL_BLANK_8
   462 35DC 70					.byte DL_BLANK_8
   463 35DD F0					.byte DL_BLANK_8 + DL_DLI
   464
   465 35DE			GameDL_LMS1
   466 						
   467 = B000					?dldata = GameMemoryAddress
   468 						.rept 24
   469 							.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   470 							.BYTE <?DLDATA, >?DLDATA
   471 							?DLDATA += LEVEL_CHAR_SIZE_X
   472 						.ENDR
   472 						.endr
Source: REPT
   469 35DE 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35DF 00 B0					.BYTE <?DLDATA, >?DLDATA
   469 = B052						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35E1 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35E2 52 B0					.BYTE <?DLDATA, >?DLDATA
   469 = B0A4						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35E4 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35E5 A4 B0					.BYTE <?DLDATA, >?DLDATA
   469 = B0F6						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35E7 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35E8 F6 B0					.BYTE <?DLDATA, >?DLDATA
   469 = B148						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35EA 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35EB 48 B1					.BYTE <?DLDATA, >?DLDATA
   469 = B19A						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35ED 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35EE 9A B1					.BYTE <?DLDATA, >?DLDATA
   469 = B1EC						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35F0 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35F1 EC B1					.BYTE <?DLDATA, >?DLDATA
   469 = B23E						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35F3 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35F4 3E B2					.BYTE <?DLDATA, >?DLDATA
   469 = B290						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35F6 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35F7 90 B2					.BYTE <?DLDATA, >?DLDATA
   469 = B2E2						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35F9 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35FA E2 B2					.BYTE <?DLDATA, >?DLDATA
   469 = B334						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35FC 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 35FD 34 B3					.BYTE <?DLDATA, >?DLDATA
   469 = B386						?DLDATA += LEVEL_CHAR_SIZE_X
   469 35FF 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3600 86 B3					.BYTE <?DLDATA, >?DLDATA
   469 = B3D8						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3602 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3603 D8 B3					.BYTE <?DLDATA, >?DLDATA
   469 = B42A						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3605 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3606 2A B4					.BYTE <?DLDATA, >?DLDATA
   469 = B47C						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3608 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3609 7C B4					.BYTE <?DLDATA, >?DLDATA
   469 = B4CE						?DLDATA += LEVEL_CHAR_SIZE_X
   469 360B 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 360C CE B4					.BYTE <?DLDATA, >?DLDATA
   469 = B520						?DLDATA += LEVEL_CHAR_SIZE_X
   469 360E 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 360F 20 B5					.BYTE <?DLDATA, >?DLDATA
   469 = B572						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3611 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3612 72 B5					.BYTE <?DLDATA, >?DLDATA
   469 = B5C4						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3614 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3615 C4 B5					.BYTE <?DLDATA, >?DLDATA
   469 = B616						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3617 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3618 16 B6					.BYTE <?DLDATA, >?DLDATA
   469 = B668						?DLDATA += LEVEL_CHAR_SIZE_X
   469 361A 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 361B 68 B6					.BYTE <?DLDATA, >?DLDATA
   469 = B6BA						?DLDATA += LEVEL_CHAR_SIZE_X
   469 361D 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 361E BA B6					.BYTE <?DLDATA, >?DLDATA
   469 = B70C						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3620 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3621 0C B7					.BYTE <?DLDATA, >?DLDATA
   469 = B75E						?DLDATA += LEVEL_CHAR_SIZE_X
   469 3623 74						.BYTE DL_TEXT_4 + DL_LMS + DL_HSCROLL + DL_VSCROLL
   469 3624 5E B7					.BYTE <?DLDATA, >?DLDATA
   469 = B7B0						?DLDATA += LEVEL_CHAR_SIZE_X
Source: E:\_8BitProjects\Series\Scroller\ScrollerData.Asm
   473 					
   474 3626 54					.byte DL_TEXT_4 + DL_LMS + DL_HSCROLL
   475 3627 B0 B7				.byte <?dldata, >?dldata
   476 					
   477 3629 A0					.byte DL_BLANK_3 + DL_DLI
   478
   479 = 0680					?dldata = HudMemoryAddr
   480 						.rept 2
   481 							.BYTE DL_TEXT_2 + DL_LMS
   482 							.BYTE <?DLDATA, >?DLDATA
   483 							?DLDATA += WINDOW_CHAR_SIZE_X
   484 						.ENDR	
   484 						.endr	
Source: REPT
   481 362A 42						.BYTE DL_TEXT_2 + DL_LMS
   481 362B 80 06					.BYTE <?DLDATA, >?DLDATA
   481 = 06A8						?DLDATA += WINDOW_CHAR_SIZE_X
   481 362D 42						.BYTE DL_TEXT_2 + DL_LMS
   481 362E A8 06					.BYTE <?DLDATA, >?DLDATA
   481 = 06D0						?DLDATA += WINDOW_CHAR_SIZE_X
Source: E:\_8BitProjects\Series\Scroller\ScrollerData.Asm
   485 					
   486 3630 41 00 0E				.byte DL_JUMP_VB, <GameDspLstAddr, >GameDspLstAddr
   487
   488 = 0058			GameDLEnd = * - GameDL
   489 							
   368 3633					icl "PlayerData.Asm"
Source: E:\_8BitProjects\Series\Scroller\PlayerData.Asm
     1 				;
     2 				;***************************************************************************************************
     3 				;
     4 				;	Filename:		PlayerData.Asm
     5 				;
     6 				;	Modified On:	Thur Apr 26, 2018 01:12 PM
     7 				;
     8 				;	Comments:		Portions of this code taken from NRV's OPEN_PLAT project and
     9 				;					Ken Jennings C64 to Atari MLP and also from WUDSN Tutorials.
    10 				;				
    11 				;***************************************************************************************************
    12 				;
    13 3633			.array TabAnimationMap [12] .byte
    14  [0000] 00 15 01			$00, $15, $01 			
    15  [0003] 15 15 01			$15, $15, $01
    16  [0006] 2A 15 01			$2A, $15, $01		
    17  [0009] 3F 15 01			$3F, $15, $01	 
    18 				.enda
    19
    20 363F			.array TabAnimationMiscMap [10] .byte
    21
    22  [0000] 45 37 18 0C 08		<BONUS100, >BONUS100, BONUS100END, $0C, $08
    23  [0005] 5D 37 18 0C 08		<CLEARBONUS, >CLEARBONUS, CLEARBONUSEND, $0C, $08
    24 					
    25 				.enda
    26
    27 3649			TabPlayerShape_01								
    28 					
    29 					; Standing 0
    30 3649 18				.byte 	%00011000							; ...##...
    31 364A 3C				.byte 	%00111100                           ; ..####..
    32 364B FF				.byte 	%11111111                           ; ########
    33 364C 00				.byte 	%00000000                           ; ........
    34 364D 00				.byte 	%00000000                           ; ........
    35 364E 00				.byte 	%00000000                           ; ........
    36 364F 00				.byte 	%00000000                           ; ........
    37 3650 00				.byte 	%00000000                           ; ........
    38 3651 00				.byte 	%00000000                           ; ........
    39 3652 18				.byte 	%00011000                           ; ...##...
    40 3653 18				.byte 	%00011000                           ; ...##...
    41 3654 3C				.byte 	%00111100                           ; ..####..
    42 3655 6E				.byte 	%01101110                           ; .##.###.
    43 3656 00				.byte 	%00000000                           ; ........
    44 3657 00				.byte 	%00000000                           ; ........
    45 3658 6E				.byte 	%01101110                           ; .## ###.
    46 3659 76				.byte 	%01110110                           ; .######.
    47 365A 3C				.byte 	%00111100                           ; ..####..
    48 365B 00				.byte 	%00000000                           ; ........
    49 365C 00				.byte 	%00000000                           ; ........
    50 365D 00				.byte 	%00000000                           ; ........
    51 						
    52 					; Walking 0
    53 365E 18				.byte 	%00011000							; ...##...
    54 365F 3C				.byte	%00111100							; ..####..
    55 3660 FF				.byte	%11111111							; ########
    56 3661 00				.byte	%00000000							; ........
    57 3662 00				.byte	%00000000							; ........
    58 3663 00				.byte 	%00000000							; ........							
    59 3664 00				.byte 	%00000000							; ........
    60 3665 00				.byte 	%00000000							; ........		
    61 3666 00				.byte 	%00000000							; ........
    62 3667 18				.byte 	%00011000							; ...##...
    63 3668 18				.byte 	%00011000							; ...##...
    64 3669 3C				.byte 	%00111100							; ..####..
    65 366A 6E				.byte 	%01101110							; .##.###.
    66 366B 00				.byte 	%00000000							; ........
    67 366C 00				.byte 	%00000000							; ........
    68 366D 7A				.byte 	%01111010							; .####.#.
    69 366E 7E				.byte 	%01111110							; .######.
    70 366F 3C				.byte 	%00111100							; ..####..
    71 3670 00				.byte 	%00000000							; ........
    72 3671 00				.byte 	%00000000							; ........
    73 3672 00				.byte 	%00000000							; ........
    74
    75 					; Walking 1	
    76 3673 18				.byte 	%00011000							; ...##...  
    77 3674 3C				.byte 	%00111100							; ..####..  
    78 3675 FF				.byte 	%11111111                           ; ########  
    79 3676 00				.byte 	%00000000                           ; ........  
    80 3677 00				.byte 	%00000000			                ; ........  
    81 3678 00				.byte 	%00000000                           ; ........	
    82 3679 00				.byte 	%00000000                           ; ........  
    83 367A 00				.byte 	%00000000                           ; ........	
    84 367B 00				.byte 	%00000000                           ; ........  
    85 367C 18				.byte 	%00011000                           ; ...##...  
    86 367D 18				.byte 	%00011000                           ; ...##...  
    87 367E 3C				.byte 	%00111100                           ; ..####..  
    88 367F 6E				.byte 	%01101110                           ; .##.###.  
    89 3680 00				.byte 	%00000000                           ; ........  
    90 3681 00				.byte 	%00000000                           ; ........  
    91 3682 3E				.byte 	%00111110                           ; ..#####.  
    92 3683 7E				.byte 	%01111110                           ; .######.  
    93 3684 3C				.byte 	%00111100                           ; ..####..  
    94 3685 00				.byte 	%00000000                           ; ........  
    95 3686 00				.byte 	%00000000                           ; ........  
    96 3687 00				.byte 	%00000000                           ; ........  
    97
    98 					; Jumping 0
    99 3688 18				.byte %00011000								;...##...
   100 3689 3C				.byte %00111100								;..####..
   101 368A FF				.byte %11111111								;########
   102 368B 00				.byte %00000000								;........
   103 368C 00				.byte %00000000								;........
   104 368D 00				.byte %00000000								;........
   105 368E 00				.byte %00000000								;........
   106 368F 00				.byte %00000000								;........
   107 3690 00				.byte %00000000								;........
   108 3691 18				.byte %00011000								;...##...
   109 3692 18				.byte %00011000								;...##...
   110 3693 3C				.byte %00111100								;..####..
   111 3694 7E				.byte %01111110								;.######.
   112 3695 00				.byte %00000000								;........
   113 3696 00				.byte %00000000								;........
   114 3697 7E				.byte %01111110								;.######.
   115 3698 3E				.byte %00111110								;..#####.
   116 3699 0C				.byte %00001100								;....##..
   117 369A 00				.byte %00000000								;........
   118 369B 00				.byte %00000000								;........
   119 369C 00				.byte %00000000								;........
   120 				                                                
   121 369D			TabPlayerShape_01A								
   122 					
   123 					; Standing 0			
   124 369D 18				.byte 	%00011000							; ...##...
   125 369E 3C				.byte 	%00111100                           ; ..####..
   126 369F FF				.byte 	%11111111                           ; ########
   127 36A0 3C				.byte 	%00111100                           ; ..####..
   128 36A1 34				.byte 	%00110100                           ; ..##.#..
   129 36A2 3E				.byte 	%00111110                           ; ..#####.
   130 36A3 34				.byte 	%00110100                           ; ..##.#..
   131 36A4 38				.byte 	%00111000                           ; ..###...
   132 36A5 1C				.byte 	%00011100                           ; ...###..
   133 36A6 00				.byte 	%00000000                           ; ........
   134 36A7 00				.byte 	%00000000                           ; ........
   135 36A8 00				.byte 	%00000000                           ; ........
   136 36A9 00				.byte 	%00000000                           ; ........
   137 36AA 6E				.byte 	%01101110                           ; .##.###.
   138 36AB 6E				.byte 	%01101110                           ; .##.###.
   139 36AC 00				.byte 	%00000000                           ; ........
   140 36AD 00				.byte 	%00000000                           ; ........
   141 36AE 00				.byte 	%00000000                           ; ........
   142 36AF 00				.byte 	%00000000                           ; ........
   143 36B0 00				.byte 	%00000000                           ; ........
   144 36B1 00				.byte 	%00000000                           ; ........
   145 						
   146 					
   147 					; Walking 0
   148 36B2 18				.byte 	%00011000							; ...##...
   149 36B3 3C				.byte 	%00111100							; ..####..	
   150 36B4 FF				.byte 	%11111111							; ########
   151 36B5 3C				.byte 	%00111100							; ..####..
   152 36B6 34				.byte 	%00110100							; ..##.#..
   153 36B7 3E				.byte 	%00111110							; ..#####.
   154 36B8 34				.byte 	%00110100							; ..##.#..
   155 36B9 38				.byte 	%00111000							; ..###...
   156 36BA 1C				.byte 	%00011100							; ...###..
   157 36BB 00				.byte 	%00000000							; ........
   158 36BC 00				.byte 	%00000000							; ........
   159 36BD 00				.byte 	%00000000							; ........
   160 36BE 00				.byte 	%00000000							; ........
   161 36BF 6E				.byte 	%01101110							; .##.###.	
   162 36C0 76				.byte 	%01110110							; .###.##.
   163 36C1 00				.byte 	%00000000							; ........
   164 36C2 00				.byte 	%00000000							; ........
   165 36C3 00				.byte 	%00000000							; ........
   166 36C4 00				.byte 	%00000000							; ........
   167 36C5 00				.byte 	%00000000							; ........
   168 36C6 00				.byte 	%00000000							; ........
   169
   170 					; Walking 1
   171 36C7 18				.byte	%00011000							; ...##... 
   172 36C8 3C				.byte	%00111100                           ; ..####.. 
   173 36C9 FF				.byte	%11111111                           ; ######## 
   174 36CA 3C				.byte	%00111100                           ; ..####.. 
   175 36CB 34				.byte	%00110100			                ; ..##.#.. 
   176 36CC 3E				.byte	%00111110                           ; ..#####. 
   177 36CD 34				.byte	%00110100                           ; ..##.#.. 
   178 36CE 38				.byte	%00111000                           ; ..###... 
   179 36CF 1C				.byte	%00011100                           ; ...###.. 
   180 36D0 00				.byte	%00000000                           ; ........ 
   181 36D1 00				.byte	%00000000                           ; ........ 
   182 36D2 00				.byte	%00000000                           ; ........ 
   183 36D3 00				.byte	%00000000                           ; ........ 
   184 36D4 6E				.byte	%01101110                           ; .##.###. 
   185 36D5 5E				.byte	%01011110                           ; .#.####. 
   186 36D6 00				.byte	%00000000                           ; ........ 
   187 36D7 00				.byte	%00000000                           ; ........ 
   188 36D8 00				.byte	%00000000                           ; ........ 
   189 36D9 00				.byte	%00000000                           ; ........ 
   190 36DA 00				.byte	%00000000                           ; ........ 
   191 36DB 00				.byte	%00000000                           ; ........       
   192 					
   193 					
   194 					; Jumping 1	
   195 36DC 18				.byte %00011000								;...##...
   196 36DD 3C				.byte %00111100                             ;..####..
   197 36DE FF				.byte %11111111                             ;########
   198 36DF 3C				.byte %00111100                             ;..####..
   199 36E0 34				.byte %00110100                             ;..##.#..
   200 36E1 3E				.byte %00111110                             ;..#####.
   201 36E2 34				.byte %00110100                             ;..##.#..
   202 36E3 38				.byte %00111000                             ;..###...
   203 36E4 1C				.byte %00011100                             ;...###..
   204 36E5 00				.byte %00000000                             ;........
   205 36E6 00				.byte %00000000                             ;........
   206 36E7 00				.byte %00000000                             ;........
   207 36E8 00				.byte %00000000                             ;........
   208 36E9 7E				.byte %01111110                             ;.######.
   209 36EA 7E				.byte %01111110                             ;.######.
   210 36EB 00				.byte %00000000                             ;........
   211 36EC 00				.byte %00000000                             ;........
   212 36ED 00				.byte %00000000                             ;........
   213 36EE 00				.byte %00000000                             ;........
   214 36EF 00				.byte %00000000                             ;........
   215 36F0 00				.byte %00000000                             ;........
   216 					
   217
   218 36F1			TabPlayerShape_01B								
   219
   220 					; Standing 0
   221 36F1 00				.byte 	%00000000							; ........
   222 36F2 00				.byte 	%00000000                           ; ........
   223 36F3 00				.byte 	%00000000                           ; ........
   224 36F4 00				.byte 	%00000000                           ; ........
   225 36F5 00				.byte 	%00000000			                ; ........
   226 36F6 00				.byte 	%00000000                           ; ........
   227 36F7 00				.byte 	%00000000                           ; ........
   228 36F8 00				.byte 	%00000000                           ; ........
   229 36F9 00				.byte 	%00000000                           ; ........
   230 36FA 00				.byte 	%00000000                           ; ........
   231 36FB 00				.byte 	%00000000                           ; ........
   232 36FC 00				.byte 	%00000000                           ; ........
   233 36FD 10				.byte 	%00010000                           ; ...#....
   234 36FE 10				.byte 	%00010000                           ; ...#....
   235 36FF 10				.byte 	%00010000                           ; ...#....
   236 3700 10				.byte 	%00010000                           ; ...#....
   237 3701 08				.byte 	%00001000                           ; ........
   238 3702 00				.byte 	%00000000                           ; ........
   239 3703 10				.byte 	%00010000                           ; ...#.#..
   240 3704 10				.byte 	%00010000                           ; ...#.#..
   241 3705 18				.byte 	%00011000                           ; ...####.
   242
   243 					; Walking 0
   244 3706 00				.byte 	%00000000							; ........
   245 3707 00				.byte   %00000000							; ........
   246 3708 00				.byte   %00000000							; ........
   247 3709 00				.byte   %00000000							; ........
   248 370A 00				.byte   %00000000							; ........
   249 370B 00				.byte 	%00000000							; ........
   250 370C 00				.byte   %00000000							; ........
   251 370D 00				.byte   %00000000							; ........
   252 370E 00				.byte   %00000000							; ........
   253 370F 00				.byte   %00000000							; ........
   254 3710 00				.byte 	%00000000							; ........
   255 3711 00				.byte   %00000000							; ........
   256 3712 10				.byte   %00010000							; ...#....
   257 3713 10				.byte   %00010000							; ...#....
   258 3714 08				.byte   %00001000							; ....#...
   259 3715 04				.byte 	%00000100							; .....#..
   260 3716 00				.byte   %00000000							; ........
   261 3717 00				.byte   %00000000							; ........
   262 3718 24				.byte   %00100100							; ..#. #..
   263 3719 24				.byte   %00100100							; ..#. #..
   264 371A 36				.byte   %00110110							; ..## ##.
   265
   266 					; Walking 1	
   267 371B 00				.byte 	%00000000							; ........
   268 371C 00				.byte 	%00000000                           ; ........
   269 371D 00				.byte 	%00000000                           ; ........
   270 371E 00				.byte 	%00000000                           ; ........
   271 371F 00				.byte 	%00000000			                ; ........
   272 3720 00				.byte 	%00000000                           ; ........
   273 3721 00				.byte 	%00000000                           ; ........
   274 3722 00				.byte 	%00000000                           ; ........
   275 3723 00				.byte 	%00000000                           ; ........
   276 3724 00				.byte 	%00000000                           ; ........
   277 3725 00				.byte 	%00000000                           ; ........
   278 3726 00				.byte 	%00000000                           ; ........
   279 3727 10				.byte 	%00010000                           ; ...#....
   280 3728 10				.byte 	%00010000                           ; ...#....
   281 3729 20				.byte 	%00100000                           ; ..#.....
   282 372A 40				.byte 	%01000000                           ; .#......
   283 372B 00				.byte 	%00000000                           ; ........
   284 372C 00				.byte 	%00000000                           ; ........
   285 372D 24				.byte 	%00100100                           ; .#...#..
   286 372E 24				.byte 	%00100100                           ; .#...#..
   287 372F 36				.byte 	%00110110                           ; .##..##.
   288 					
   289 					; Jumping 2
   290 3730 00			    .byte %00000000								;........
   291 3731 00			    .byte %00000000                             ;........
   292 3732 00				.byte %00000000                             ;........
   293 3733 00				.byte %00000000                             ;........
   294 3734 00				.byte %00000000                             ;........
   295 3735 00				.byte %00000000                             ;........
   296 3736 00				.byte %00000000                             ;........
   297 3737 00				.byte %00000000                             ;........
   298 3738 81				.byte %10000001                             ;#......#
   299 3739 42				.byte %01000010                             ;.#....#.
   300 373A 24				.byte %00100100                             ;..#..#..
   301 373B 00				.byte %00000000                             ;........
   302 373C 00				.byte %00000000                             ;........
   303 373D 00				.byte %00000000                             ;........
   304 373E 00				.byte %00000000                             ;........
   305 373F 10				.byte %00010000                             ;...#....
   306 3740 14				.byte %00010100                             ;...#.#..
   307 3741 24				.byte %00100100                             ;..#..#..
   308 3742 A5				.byte %10100101                             ;#.#..#.#
   309 3743 42				.byte %01000010                             ;.#....#.
   310 3744 00				.byte %00000000                             ;........
   311
   312 				;*****	Misc Animations and Graphics
   313 				;
   314 3745			BONUS100
   315
   316 3745 00 00 00			.byte %0000,%0000,%0000							;............
   317 3748 04 04 04			.byte %0100,%0100,%0100							;.#...#...#..
   318 374B 04 0A 0A			.byte %0100,%1010,%1010							;.#..#.#.#.#.
   319 374E 04 0A 0A			.byte %0100,%1010,%1010							;.#..#.#.#.#.
   320 3751 04 0A 0A			.byte %0100,%1010,%1010							;.#..#.#.#.#.
   321 3754 04 0A 0A			.byte %0100,%1010,%1010							;.#..#.#.#.#.
   322 3757 04 04 04			.byte %0100,%0100,%0100							;.#...#...#..
   323 375A 00 00 00			.byte %0000,%0000,%0000							;............
   324
   325 = 0018			BONUS100END = * - BONUS100
   326
   327 375D			CLEARBONUS
   328
   329 375D 00 00 00			.byte %0000,%0000,%0000							;............
   330 3760 00 00 00			.byte %0000,%0000,%0000							;............
   331 3763 00 00 00			.byte %0000,%0000,%0000							;............
   332 3766 00 00 00			.byte %0000,%0000,%0000							;............
   333 3769 00 00 00			.byte %0000,%0000,%0000							;............
   334 376C 00 00 00			.byte %0000,%0000,%0000							;............
   335 376F 00 00 00			.byte %0000,%0000,%0000							;............
   336 3772 00 00 00			.byte %0000,%0000,%0000							;............
   337
   338 = 0018			CLEARBONUSEND = * - CLEARBONUS
   369 						
   370 				.PRINT "Data Size : ", * - DataAddress		
   370 				Data Size : $0775
   371
   372 				;*****	Game font address
   373 				;
   374 3775					org GameFontAddress
   375 A800-AFFF> 00 00 00 00 + 		ins "data/scroller.fnt"
   376 					
   377 				;*****	Text font address
   378 				;
   379 AC00					org TextFontAddress
   380 AC00 00 00 00 00 00 00 + 		ins "data/atari.fnt"
   381 					
   382 				;*****	Sound Data Address
   383 				;
   384 B000					org SoundAddress
   385 						opt h-									;RMT module is standard Atari binary file already
   386 4000 FF FF 00 40 AA 42 + 		ins "Data/sfx.rmt"						;include music RMT module
   387 						opt h+
   388 					
   389 				;*****	HUD Memory Address	
   390 				;
   391 42B1					org HudMemoryAddr							
   392 						 
   393 				.if PAL_VERSION = 0
   394 0680-06CF> 00 00 27 00 + 		.sb "  G 00    E 00    T 00:00.0  H 00 NTSC  "
   395 				.else
   396 						.sb "  G 00    E 00    T 00:00.0  H 00  PAL  "
   397 				.endif
   398 06A8 00 00 00 00 00 00 + 		.sb "                                        "
   399 					
   400 				;*****	Game Memory Address 
   401 				;
   402 06D0					org GameMemoryAddress	
   403 						.rept $1000-LEVEL_CHAR_SIZE_X
   404 							.BYTE $00
   405 						.ENDR
   405 						.endr
Source: REPT
   404 B000-BFFF> 00					.BYTE $00
   404 B001 00						.BYTE $00
   404 B002 00						.BYTE $00
   404 B003 00						.BYTE $00
   404 B004 00						.BYTE $00
   404 B005 00						.BYTE $00
   404 B006 00						.BYTE $00
   404 B007 00						.BYTE $00
   404 B008 00						.BYTE $00
   404 B009 00						.BYTE $00
   404 B00A 00						.BYTE $00
   404 B00B 00						.BYTE $00
   404 B00C 00						.BYTE $00
   404 B00D 00						.BYTE $00
   404 B00E 00						.BYTE $00
   404 B00F 00						.BYTE $00
   404 B010 00						.BYTE $00
   404 B011 00						.BYTE $00
   404 B012 00						.BYTE $00
   404 B013 00						.BYTE $00
   404 B014 00						.BYTE $00
   404 B015 00						.BYTE $00
   404 B016 00						.BYTE $00
   404 B017 00						.BYTE $00
   404 B018 00						.BYTE $00
   404 B019 00						.BYTE $00
   404 B01A 00						.BYTE $00
   404 B01B 00						.BYTE $00
   404 B01C 00						.BYTE $00
   404 B01D 00						.BYTE $00
   404 B01E 00						.BYTE $00
   404 B01F 00						.BYTE $00
   404 B020 00						.BYTE $00
   404 B021 00						.BYTE $00
   404 B022 00						.BYTE $00
   404 B023 00						.BYTE $00
   404 B024 00						.BYTE $00
   404 B025 00						.BYTE $00
   404 B026 00						.BYTE $00
   404 B027 00						.BYTE $00
   404 B028 00						.BYTE $00
   404 B029 00						.BYTE $00
   404 B02A 00						.BYTE $00
   404 B02B 00						.BYTE $00
   404 B02C 00						.BYTE $00
   404 B02D 00						.BYTE $00
   404 B02E 00						.BYTE $00
   404 B02F 00						.BYTE $00
   404 B030 00						.BYTE $00
   404 B031 00						.BYTE $00
   404 B032 00						.BYTE $00
   404 B033 00						.BYTE $00
   404 B034 00						.BYTE $00
   404 B035 00						.BYTE $00
   404 B036 00						.BYTE $00
   404 B037 00						.BYTE $00
   404 B038 00						.BYTE $00
   404 B039 00						.BYTE $00
   404 B03A 00						.BYTE $00
   404 B03B 00						.BYTE $00
   404 B03C 00						.BYTE $00
   404 B03D 00						.BYTE $00
   404 B03E 00						.BYTE $00
   404 B03F 00						.BYTE $00
   404 B040 00						.BYTE $00
   404 B041 00						.BYTE $00
   404 B042 00						.BYTE $00
   404 B043 00						.BYTE $00
   404 B044 00						.BYTE $00
   404 B045 00						.BYTE $00
   404 B046 00						.BYTE $00
   404 B047 00						.BYTE $00
   404 B048 00						.BYTE $00
   404 B049 00						.BYTE $00
   404 B04A 00						.BYTE $00
   404 B04B 00						.BYTE $00
   404 B04C 00						.BYTE $00
   404 B04D 00						.BYTE $00
   404 B04E 00						.BYTE $00
   404 B04F 00						.BYTE $00
   404 B050 00						.BYTE $00
   404 B051 00						.BYTE $00
   404 B052 00						.BYTE $00
   404 B053 00						.BYTE $00
   404 B054 00						.BYTE $00
   404 B055 00						.BYTE $00
   404 B056 00						.BYTE $00
   404 B057 00						.BYTE $00
   404 B058 00						.BYTE $00
   404 B059 00						.BYTE $00
   404 B05A 00						.BYTE $00
   404 B05B 00						.BYTE $00
   404 B05C 00						.BYTE $00
   404 B05D 00						.BYTE $00
   404 B05E 00						.BYTE $00
   404 B05F 00						.BYTE $00
   404 B060 00						.BYTE $00
   404 B061 00						.BYTE $00
   404 B062 00						.BYTE $00
   404 B063 00						.BYTE $00
   404 B064 00						.BYTE $00
   404 B065 00						.BYTE $00
   404 B066 00						.BYTE $00
   404 B067 00						.BYTE $00
   404 B068 00						.BYTE $00
   404 B069 00						.BYTE $00
   404 B06A 00						.BYTE $00
   404 B06B 00						.BYTE $00
   404 B06C 00						.BYTE $00
   404 B06D 00						.BYTE $00
   404 B06E 00						.BYTE $00
   404 B06F 00						.BYTE $00
   404 B070 00						.BYTE $00
   404 B071 00						.BYTE $00
   404 B072 00						.BYTE $00
   404 B073 00						.BYTE $00
   404 B074 00						.BYTE $00
   404 B075 00						.BYTE $00
   404 B076 00						.BYTE $00
   404 B077 00						.BYTE $00
   404 B078 00						.BYTE $00
   404 B079 00						.BYTE $00
   404 B07A 00						.BYTE $00
   404 B07B 00						.BYTE $00
   404 B07C 00						.BYTE $00
   404 B07D 00						.BYTE $00
   404 B07E 00						.BYTE $00
   404 B07F 00						.BYTE $00
   404 B080 00						.BYTE $00
   404 B081 00						.BYTE $00
   404 B082 00						.BYTE $00
   404 B083 00						.BYTE $00
   404 B084 00						.BYTE $00
   404 B085 00						.BYTE $00
   404 B086 00						.BYTE $00
   404 B087 00						.BYTE $00
   404 B088 00						.BYTE $00
   404 B089 00						.BYTE $00
   404 B08A 00						.BYTE $00
   404 B08B 00						.BYTE $00
   404 B08C 00						.BYTE $00
   404 B08D 00						.BYTE $00
   404 B08E 00						.BYTE $00
   404 B08F 00						.BYTE $00
   404 B090 00						.BYTE $00
   404 B091 00						.BYTE $00
   404 B092 00						.BYTE $00
   404 B093 00						.BYTE $00
   404 B094 00						.BYTE $00
   404 B095 00						.BYTE $00
   404 B096 00						.BYTE $00
   404 B097 00						.BYTE $00
   404 B098 00						.BYTE $00
   404 B099 00						.BYTE $00
   404 B09A 00						.BYTE $00
   404 B09B 00						.BYTE $00
   404 B09C 00						.BYTE $00
   404 B09D 00						.BYTE $00
   404 B09E 00						.BYTE $00
   404 B09F 00						.BYTE $00
   404 B0A0 00						.BYTE $00
   404 B0A1 00						.BYTE $00
   404 B0A2 00						.BYTE $00
   404 B0A3 00						.BYTE $00
   404 B0A4 00						.BYTE $00
   404 B0A5 00						.BYTE $00
   404 B0A6 00						.BYTE $00
   404 B0A7 00						.BYTE $00
   404 B0A8 00						.BYTE $00
   404 B0A9 00						.BYTE $00
   404 B0AA 00						.BYTE $00
   404 B0AB 00						.BYTE $00
   404 B0AC 00						.BYTE $00
   404 B0AD 00						.BYTE $00
   404 B0AE 00						.BYTE $00
   404 B0AF 00						.BYTE $00
   404 B0B0 00						.BYTE $00
   404 B0B1 00						.BYTE $00
   404 B0B2 00						.BYTE $00
   404 B0B3 00						.BYTE $00
   404 B0B4 00						.BYTE $00
   404 B0B5 00						.BYTE $00
   404 B0B6 00						.BYTE $00
   404 B0B7 00						.BYTE $00
   404 B0B8 00						.BYTE $00
   404 B0B9 00						.BYTE $00
   404 B0BA 00						.BYTE $00
   404 B0BB 00						.BYTE $00
   404 B0BC 00						.BYTE $00
   404 B0BD 00						.BYTE $00
   404 B0BE 00						.BYTE $00
   404 B0BF 00						.BYTE $00
   404 B0C0 00						.BYTE $00
   404 B0C1 00						.BYTE $00
   404 B0C2 00						.BYTE $00
   404 B0C3 00						.BYTE $00
   404 B0C4 00						.BYTE $00
   404 B0C5 00						.BYTE $00
   404 B0C6 00						.BYTE $00
   404 B0C7 00						.BYTE $00
   404 B0C8 00						.BYTE $00
   404 B0C9 00						.BYTE $00
   404 B0CA 00						.BYTE $00
   404 B0CB 00						.BYTE $00
   404 B0CC 00						.BYTE $00
   404 B0CD 00						.BYTE $00
   404 B0CE 00						.BYTE $00
   404 B0CF 00						.BYTE $00
   404 B0D0 00						.BYTE $00
   404 B0D1 00						.BYTE $00
   404 B0D2 00						.BYTE $00
   404 B0D3 00						.BYTE $00
   404 B0D4 00						.BYTE $00
   404 B0D5 00						.BYTE $00
   404 B0D6 00						.BYTE $00
   404 B0D7 00						.BYTE $00
   404 B0D8 00						.BYTE $00
   404 B0D9 00						.BYTE $00
   404 B0DA 00						.BYTE $00
   404 B0DB 00						.BYTE $00
   404 B0DC 00						.BYTE $00
   404 B0DD 00						.BYTE $00
   404 B0DE 00						.BYTE $00
   404 B0DF 00						.BYTE $00
   404 B0E0 00						.BYTE $00
   404 B0E1 00						.BYTE $00
   404 B0E2 00						.BYTE $00
   404 B0E3 00						.BYTE $00
   404 B0E4 00						.BYTE $00
   404 B0E5 00						.BYTE $00
   404 B0E6 00						.BYTE $00
   404 B0E7 00						.BYTE $00
   404 B0E8 00						.BYTE $00
   404 B0E9 00						.BYTE $00
   404 B0EA 00						.BYTE $00
   404 B0EB 00						.BYTE $00
   404 B0EC 00						.BYTE $00
   404 B0ED 00						.BYTE $00
   404 B0EE 00						.BYTE $00
   404 B0EF 00						.BYTE $00
   404 B0F0 00						.BYTE $00
   404 B0F1 00						.BYTE $00
   404 B0F2 00						.BYTE $00
   404 B0F3 00						.BYTE $00
   404 B0F4 00						.BYTE $00
   404 B0F5 00						.BYTE $00
   404 B0F6 00						.BYTE $00
   404 B0F7 00						.BYTE $00
   404 B0F8 00						.BYTE $00
   404 B0F9 00						.BYTE $00
   404 B0FA 00						.BYTE $00
   404 B0FB 00						.BYTE $00
   404 B0FC 00						.BYTE $00
   404 B0FD 00						.BYTE $00
   404 B0FE 00						.BYTE $00
   404 B0FF 00						.BYTE $00
   404 B100 00						.BYTE $00
   404 B101 00						.BYTE $00
   404 B102 00						.BYTE $00
   404 B103 00						.BYTE $00
   404 B104 00						.BYTE $00
   404 B105 00						.BYTE $00
   404 B106 00						.BYTE $00
   404 B107 00						.BYTE $00
   404 B108 00						.BYTE $00
   404 B109 00						.BYTE $00
   404 B10A 00						.BYTE $00
   404 B10B 00						.BYTE $00
   404 B10C 00						.BYTE $00
   404 B10D 00						.BYTE $00
   404 B10E 00						.BYTE $00
   404 B10F 00						.BYTE $00
   404 B110 00						.BYTE $00
   404 B111 00						.BYTE $00
   404 B112 00						.BYTE $00
   404 B113 00						.BYTE $00
   404 B114 00						.BYTE $00
   404 B115 00						.BYTE $00
   404 B116 00						.BYTE $00
   404 B117 00						.BYTE $00
   404 B118 00						.BYTE $00
   404 B119 00						.BYTE $00
   404 B11A 00						.BYTE $00
   404 B11B 00						.BYTE $00
   404 B11C 00						.BYTE $00
   404 B11D 00						.BYTE $00
   404 B11E 00						.BYTE $00
   404 B11F 00						.BYTE $00
   404 B120 00						.BYTE $00
   404 B121 00						.BYTE $00
   404 B122 00						.BYTE $00
   404 B123 00						.BYTE $00
   404 B124 00						.BYTE $00
   404 B125 00						.BYTE $00
   404 B126 00						.BYTE $00
   404 B127 00						.BYTE $00
   404 B128 00						.BYTE $00
   404 B129 00						.BYTE $00
   404 B12A 00						.BYTE $00
   404 B12B 00						.BYTE $00
   404 B12C 00						.BYTE $00
   404 B12D 00						.BYTE $00
   404 B12E 00						.BYTE $00
   404 B12F 00						.BYTE $00
   404 B130 00						.BYTE $00
   404 B131 00						.BYTE $00
   404 B132 00						.BYTE $00
   404 B133 00						.BYTE $00
   404 B134 00						.BYTE $00
   404 B135 00						.BYTE $00
   404 B136 00						.BYTE $00
   404 B137 00						.BYTE $00
   404 B138 00						.BYTE $00
   404 B139 00						.BYTE $00
   404 B13A 00						.BYTE $00
   404 B13B 00						.BYTE $00
   404 B13C 00						.BYTE $00
   404 B13D 00						.BYTE $00
   404 B13E 00						.BYTE $00
   404 B13F 00						.BYTE $00
   404 B140 00						.BYTE $00
   404 B141 00						.BYTE $00
   404 B142 00						.BYTE $00
   404 B143 00						.BYTE $00
   404 B144 00						.BYTE $00
   404 B145 00						.BYTE $00
   404 B146 00						.BYTE $00
   404 B147 00						.BYTE $00
   404 B148 00						.BYTE $00
   404 B149 00						.BYTE $00
   404 B14A 00						.BYTE $00
   404 B14B 00						.BYTE $00
   404 B14C 00						.BYTE $00
   404 B14D 00						.BYTE $00
   404 B14E 00						.BYTE $00
   404 B14F 00						.BYTE $00
   404 B150 00						.BYTE $00
   404 B151 00						.BYTE $00
   404 B152 00						.BYTE $00
   404 B153 00						.BYTE $00
   404 B154 00						.BYTE $00
   404 B155 00						.BYTE $00
   404 B156 00						.BYTE $00
   404 B157 00						.BYTE $00
   404 B158 00						.BYTE $00
   404 B159 00						.BYTE $00
   404 B15A 00						.BYTE $00
   404 B15B 00						.BYTE $00
   404 B15C 00						.BYTE $00
   404 B15D 00						.BYTE $00
   404 B15E 00						.BYTE $00
   404 B15F 00						.BYTE $00
   404 B160 00						.BYTE $00
   404 B161 00						.BYTE $00
   404 B162 00						.BYTE $00
   404 B163 00						.BYTE $00
   404 B164 00						.BYTE $00
   404 B165 00						.BYTE $00
   404 B166 00						.BYTE $00
   404 B167 00						.BYTE $00
   404 B168 00						.BYTE $00
   404 B169 00						.BYTE $00
   404 B16A 00						.BYTE $00
   404 B16B 00						.BYTE $00
   404 B16C 00						.BYTE $00
   404 B16D 00						.BYTE $00
   404 B16E 00						.BYTE $00
   404 B16F 00						.BYTE $00
   404 B170 00						.BYTE $00
   404 B171 00						.BYTE $00
   404 B172 00						.BYTE $00
   404 B173 00						.BYTE $00
   404 B174 00						.BYTE $00
   404 B175 00						.BYTE $00
   404 B176 00						.BYTE $00
   404 B177 00						.BYTE $00
   404 B178 00						.BYTE $00
   404 B179 00						.BYTE $00
   404 B17A 00						.BYTE $00
   404 B17B 00						.BYTE $00
   404 B17C 00						.BYTE $00
   404 B17D 00						.BYTE $00
   404 B17E 00						.BYTE $00
   404 B17F 00						.BYTE $00
   404 B180 00						.BYTE $00
   404 B181 00						.BYTE $00
   404 B182 00						.BYTE $00
   404 B183 00						.BYTE $00
   404 B184 00						.BYTE $00
   404 B185 00						.BYTE $00
   404 B186 00						.BYTE $00
   404 B187 00						.BYTE $00
   404 B188 00						.BYTE $00
   404 B189 00						.BYTE $00
   404 B18A 00						.BYTE $00
   404 B18B 00						.BYTE $00
   404 B18C 00						.BYTE $00
   404 B18D 00						.BYTE $00
   404 B18E 00						.BYTE $00
   404 B18F 00						.BYTE $00
   404 B190 00						.BYTE $00
   404 B191 00						.BYTE $00
   404 B192 00						.BYTE $00
   404 B193 00						.BYTE $00
   404 B194 00						.BYTE $00
   404 B195 00						.BYTE $00
   404 B196 00						.BYTE $00
   404 B197 00						.BYTE $00
   404 B198 00						.BYTE $00
   404 B199 00						.BYTE $00
   404 B19A 00						.BYTE $00
   404 B19B 00						.BYTE $00
   404 B19C 00						.BYTE $00
   404 B19D 00						.BYTE $00
   404 B19E 00						.BYTE $00
   404 B19F 00						.BYTE $00
   404 B1A0 00						.BYTE $00
   404 B1A1 00						.BYTE $00
   404 B1A2 00						.BYTE $00
   404 B1A3 00						.BYTE $00
   404 B1A4 00						.BYTE $00
   404 B1A5 00						.BYTE $00
   404 B1A6 00						.BYTE $00
   404 B1A7 00						.BYTE $00
   404 B1A8 00						.BYTE $00
   404 B1A9 00						.BYTE $00
   404 B1AA 00						.BYTE $00
   404 B1AB 00						.BYTE $00
   404 B1AC 00						.BYTE $00
   404 B1AD 00						.BYTE $00
   404 B1AE 00						.BYTE $00
   404 B1AF 00						.BYTE $00
   404 B1B0 00						.BYTE $00
   404 B1B1 00						.BYTE $00
   404 B1B2 00						.BYTE $00
   404 B1B3 00						.BYTE $00
   404 B1B4 00						.BYTE $00
   404 B1B5 00						.BYTE $00
   404 B1B6 00						.BYTE $00
   404 B1B7 00						.BYTE $00
   404 B1B8 00						.BYTE $00
   404 B1B9 00						.BYTE $00
   404 B1BA 00						.BYTE $00
   404 B1BB 00						.BYTE $00
   404 B1BC 00						.BYTE $00
   404 B1BD 00						.BYTE $00
   404 B1BE 00						.BYTE $00
   404 B1BF 00						.BYTE $00
   404 B1C0 00						.BYTE $00
   404 B1C1 00						.BYTE $00
   404 B1C2 00						.BYTE $00
   404 B1C3 00						.BYTE $00
   404 B1C4 00						.BYTE $00
   404 B1C5 00						.BYTE $00
   404 B1C6 00						.BYTE $00
   404 B1C7 00						.BYTE $00
   404 B1C8 00						.BYTE $00
   404 B1C9 00						.BYTE $00
   404 B1CA 00						.BYTE $00
   404 B1CB 00						.BYTE $00
   404 B1CC 00						.BYTE $00
   404 B1CD 00						.BYTE $00
   404 B1CE 00						.BYTE $00
   404 B1CF 00						.BYTE $00
   404 B1D0 00						.BYTE $00
   404 B1D1 00						.BYTE $00
   404 B1D2 00						.BYTE $00
   404 B1D3 00						.BYTE $00
   404 B1D4 00						.BYTE $00
   404 B1D5 00						.BYTE $00
   404 B1D6 00						.BYTE $00
   404 B1D7 00						.BYTE $00
   404 B1D8 00						.BYTE $00
   404 B1D9 00						.BYTE $00
   404 B1DA 00						.BYTE $00
   404 B1DB 00						.BYTE $00
   404 B1DC 00						.BYTE $00
   404 B1DD 00						.BYTE $00
   404 B1DE 00						.BYTE $00
   404 B1DF 00						.BYTE $00
   404 B1E0 00						.BYTE $00
   404 B1E1 00						.BYTE $00
   404 B1E2 00						.BYTE $00
   404 B1E3 00						.BYTE $00
   404 B1E4 00						.BYTE $00
   404 B1E5 00						.BYTE $00
   404 B1E6 00						.BYTE $00
   404 B1E7 00						.BYTE $00
   404 B1E8 00						.BYTE $00
   404 B1E9 00						.BYTE $00
   404 B1EA 00						.BYTE $00
   404 B1EB 00						.BYTE $00
   404 B1EC 00						.BYTE $00
   404 B1ED 00						.BYTE $00
   404 B1EE 00						.BYTE $00
   404 B1EF 00						.BYTE $00
   404 B1F0 00						.BYTE $00
   404 B1F1 00						.BYTE $00
   404 B1F2 00						.BYTE $00
   404 B1F3 00						.BYTE $00
   404 B1F4 00						.BYTE $00
   404 B1F5 00						.BYTE $00
   404 B1F6 00						.BYTE $00
   404 B1F7 00						.BYTE $00
   404 B1F8 00						.BYTE $00
   404 B1F9 00						.BYTE $00
   404 B1FA 00						.BYTE $00
   404 B1FB 00						.BYTE $00
   404 B1FC 00						.BYTE $00
   404 B1FD 00						.BYTE $00
   404 B1FE 00						.BYTE $00
   404 B1FF 00						.BYTE $00
   404 B200 00						.BYTE $00
   404 B201 00						.BYTE $00
   404 B202 00						.BYTE $00
   404 B203 00						.BYTE $00
   404 B204 00						.BYTE $00
   404 B205 00						.BYTE $00
   404 B206 00						.BYTE $00
   404 B207 00						.BYTE $00
   404 B208 00						.BYTE $00
   404 B209 00						.BYTE $00
   404 B20A 00						.BYTE $00
   404 B20B 00						.BYTE $00
   404 B20C 00						.BYTE $00
   404 B20D 00						.BYTE $00
   404 B20E 00						.BYTE $00
   404 B20F 00						.BYTE $00
   404 B210 00						.BYTE $00
   404 B211 00						.BYTE $00
   404 B212 00						.BYTE $00
   404 B213 00						.BYTE $00
   404 B214 00						.BYTE $00
   404 B215 00						.BYTE $00
   404 B216 00						.BYTE $00
   404 B217 00						.BYTE $00
   404 B218 00						.BYTE $00
   404 B219 00						.BYTE $00
   404 B21A 00						.BYTE $00
   404 B21B 00						.BYTE $00
   404 B21C 00						.BYTE $00
   404 B21D 00						.BYTE $00
   404 B21E 00						.BYTE $00
   404 B21F 00						.BYTE $00
   404 B220 00						.BYTE $00
   404 B221 00						.BYTE $00
   404 B222 00						.BYTE $00
   404 B223 00						.BYTE $00
   404 B224 00						.BYTE $00
   404 B225 00						.BYTE $00
   404 B226 00						.BYTE $00
   404 B227 00						.BYTE $00
   404 B228 00						.BYTE $00
   404 B229 00						.BYTE $00
   404 B22A 00						.BYTE $00
   404 B22B 00						.BYTE $00
   404 B22C 00						.BYTE $00
   404 B22D 00						.BYTE $00
   404 B22E 00						.BYTE $00
   404 B22F 00						.BYTE $00
   404 B230 00						.BYTE $00
   404 B231 00						.BYTE $00
   404 B232 00						.BYTE $00
   404 B233 00						.BYTE $00
   404 B234 00						.BYTE $00
   404 B235 00						.BYTE $00
   404 B236 00						.BYTE $00
   404 B237 00						.BYTE $00
   404 B238 00						.BYTE $00
   404 B239 00						.BYTE $00
   404 B23A 00						.BYTE $00
   404 B23B 00						.BYTE $00
   404 B23C 00						.BYTE $00
   404 B23D 00						.BYTE $00
   404 B23E 00						.BYTE $00
   404 B23F 00						.BYTE $00
   404 B240 00						.BYTE $00
   404 B241 00						.BYTE $00
   404 B242 00						.BYTE $00
   404 B243 00						.BYTE $00
   404 B244 00						.BYTE $00
   404 B245 00						.BYTE $00
   404 B246 00						.BYTE $00
   404 B247 00						.BYTE $00
   404 B248 00						.BYTE $00
   404 B249 00						.BYTE $00
   404 B24A 00						.BYTE $00
   404 B24B 00						.BYTE $00
   404 B24C 00						.BYTE $00
   404 B24D 00						.BYTE $00
   404 B24E 00						.BYTE $00
   404 B24F 00						.BYTE $00
   404 B250 00						.BYTE $00
   404 B251 00						.BYTE $00
   404 B252 00						.BYTE $00
   404 B253 00						.BYTE $00
   404 B254 00						.BYTE $00
   404 B255 00						.BYTE $00
   404 B256 00						.BYTE $00
   404 B257 00						.BYTE $00
   404 B258 00						.BYTE $00
   404 B259 00						.BYTE $00
   404 B25A 00						.BYTE $00
   404 B25B 00						.BYTE $00
   404 B25C 00						.BYTE $00
   404 B25D 00						.BYTE $00
   404 B25E 00						.BYTE $00
   404 B25F 00						.BYTE $00
   404 B260 00						.BYTE $00
   404 B261 00						.BYTE $00
   404 B262 00						.BYTE $00
   404 B263 00						.BYTE $00
   404 B264 00						.BYTE $00
   404 B265 00						.BYTE $00
   404 B266 00						.BYTE $00
   404 B267 00						.BYTE $00
   404 B268 00						.BYTE $00
   404 B269 00						.BYTE $00
   404 B26A 00						.BYTE $00
   404 B26B 00						.BYTE $00
   404 B26C 00						.BYTE $00
   404 B26D 00						.BYTE $00
   404 B26E 00						.BYTE $00
   404 B26F 00						.BYTE $00
   404 B270 00						.BYTE $00
   404 B271 00						.BYTE $00
   404 B272 00						.BYTE $00
   404 B273 00						.BYTE $00
   404 B274 00						.BYTE $00
   404 B275 00						.BYTE $00
   404 B276 00						.BYTE $00
   404 B277 00						.BYTE $00
   404 B278 00						.BYTE $00
   404 B279 00						.BYTE $00
   404 B27A 00						.BYTE $00
   404 B27B 00						.BYTE $00
   404 B27C 00						.BYTE $00
   404 B27D 00						.BYTE $00
   404 B27E 00						.BYTE $00
   404 B27F 00						.BYTE $00
   404 B280 00						.BYTE $00
   404 B281 00						.BYTE $00
   404 B282 00						.BYTE $00
   404 B283 00						.BYTE $00
   404 B284 00						.BYTE $00
   404 B285 00						.BYTE $00
   404 B286 00						.BYTE $00
   404 B287 00						.BYTE $00
   404 B288 00						.BYTE $00
   404 B289 00						.BYTE $00
   404 B28A 00						.BYTE $00
   404 B28B 00						.BYTE $00
   404 B28C 00						.BYTE $00
   404 B28D 00						.BYTE $00
   404 B28E 00						.BYTE $00
   404 B28F 00						.BYTE $00
   404 B290 00						.BYTE $00
   404 B291 00						.BYTE $00
   404 B292 00						.BYTE $00
   404 B293 00						.BYTE $00
   404 B294 00						.BYTE $00
   404 B295 00						.BYTE $00
   404 B296 00						.BYTE $00
   404 B297 00						.BYTE $00
   404 B298 00						.BYTE $00
   404 B299 00						.BYTE $00
   404 B29A 00						.BYTE $00
   404 B29B 00						.BYTE $00
   404 B29C 00						.BYTE $00
   404 B29D 00						.BYTE $00
   404 B29E 00						.BYTE $00
   404 B29F 00						.BYTE $00
   404 B2A0 00						.BYTE $00
   404 B2A1 00						.BYTE $00
   404 B2A2 00						.BYTE $00
   404 B2A3 00						.BYTE $00
   404 B2A4 00						.BYTE $00
   404 B2A5 00						.BYTE $00
   404 B2A6 00						.BYTE $00
   404 B2A7 00						.BYTE $00
   404 B2A8 00						.BYTE $00
   404 B2A9 00						.BYTE $00
   404 B2AA 00						.BYTE $00
   404 B2AB 00						.BYTE $00
   404 B2AC 00						.BYTE $00
   404 B2AD 00						.BYTE $00
   404 B2AE 00						.BYTE $00
   404 B2AF 00						.BYTE $00
   404 B2B0 00						.BYTE $00
   404 B2B1 00						.BYTE $00
   404 B2B2 00						.BYTE $00
   404 B2B3 00						.BYTE $00
   404 B2B4 00						.BYTE $00
   404 B2B5 00						.BYTE $00
   404 B2B6 00						.BYTE $00
   404 B2B7 00						.BYTE $00
   404 B2B8 00						.BYTE $00
   404 B2B9 00						.BYTE $00
   404 B2BA 00						.BYTE $00
   404 B2BB 00						.BYTE $00
   404 B2BC 00						.BYTE $00
   404 B2BD 00						.BYTE $00
   404 B2BE 00						.BYTE $00
   404 B2BF 00						.BYTE $00
   404 B2C0 00						.BYTE $00
   404 B2C1 00						.BYTE $00
   404 B2C2 00						.BYTE $00
   404 B2C3 00						.BYTE $00
   404 B2C4 00						.BYTE $00
   404 B2C5 00						.BYTE $00
   404 B2C6 00						.BYTE $00
   404 B2C7 00						.BYTE $00
   404 B2C8 00						.BYTE $00
   404 B2C9 00						.BYTE $00
   404 B2CA 00						.BYTE $00
   404 B2CB 00						.BYTE $00
   404 B2CC 00						.BYTE $00
   404 B2CD 00						.BYTE $00
   404 B2CE 00						.BYTE $00
   404 B2CF 00						.BYTE $00
   404 B2D0 00						.BYTE $00
   404 B2D1 00						.BYTE $00
   404 B2D2 00						.BYTE $00
   404 B2D3 00						.BYTE $00
   404 B2D4 00						.BYTE $00
   404 B2D5 00						.BYTE $00
   404 B2D6 00						.BYTE $00
   404 B2D7 00						.BYTE $00
   404 B2D8 00						.BYTE $00
   404 B2D9 00						.BYTE $00
   404 B2DA 00						.BYTE $00
   404 B2DB 00						.BYTE $00
   404 B2DC 00						.BYTE $00
   404 B2DD 00						.BYTE $00
   404 B2DE 00						.BYTE $00
   404 B2DF 00						.BYTE $00
   404 B2E0 00						.BYTE $00
   404 B2E1 00						.BYTE $00
   404 B2E2 00						.BYTE $00
   404 B2E3 00						.BYTE $00
   404 B2E4 00						.BYTE $00
   404 B2E5 00						.BYTE $00
   404 B2E6 00						.BYTE $00
   404 B2E7 00						.BYTE $00
   404 B2E8 00						.BYTE $00
   404 B2E9 00						.BYTE $00
   404 B2EA 00						.BYTE $00
   404 B2EB 00						.BYTE $00
   404 B2EC 00						.BYTE $00
   404 B2ED 00						.BYTE $00
   404 B2EE 00						.BYTE $00
   404 B2EF 00						.BYTE $00
   404 B2F0 00						.BYTE $00
   404 B2F1 00						.BYTE $00
   404 B2F2 00						.BYTE $00
   404 B2F3 00						.BYTE $00
   404 B2F4 00						.BYTE $00
   404 B2F5 00						.BYTE $00
   404 B2F6 00						.BYTE $00
   404 B2F7 00						.BYTE $00
   404 B2F8 00						.BYTE $00
   404 B2F9 00						.BYTE $00
   404 B2FA 00						.BYTE $00
   404 B2FB 00						.BYTE $00
   404 B2FC 00						.BYTE $00
   404 B2FD 00						.BYTE $00
   404 B2FE 00						.BYTE $00
   404 B2FF 00						.BYTE $00
   404 B300 00						.BYTE $00
   404 B301 00						.BYTE $00
   404 B302 00						.BYTE $00
   404 B303 00						.BYTE $00
   404 B304 00						.BYTE $00
   404 B305 00						.BYTE $00
   404 B306 00						.BYTE $00
   404 B307 00						.BYTE $00
   404 B308 00						.BYTE $00
   404 B309 00						.BYTE $00
   404 B30A 00						.BYTE $00
   404 B30B 00						.BYTE $00
   404 B30C 00						.BYTE $00
   404 B30D 00						.BYTE $00
   404 B30E 00						.BYTE $00
   404 B30F 00						.BYTE $00
   404 B310 00						.BYTE $00
   404 B311 00						.BYTE $00
   404 B312 00						.BYTE $00
   404 B313 00						.BYTE $00
   404 B314 00						.BYTE $00
   404 B315 00						.BYTE $00
   404 B316 00						.BYTE $00
   404 B317 00						.BYTE $00
   404 B318 00						.BYTE $00
   404 B319 00						.BYTE $00
   404 B31A 00						.BYTE $00
   404 B31B 00						.BYTE $00
   404 B31C 00						.BYTE $00
   404 B31D 00						.BYTE $00
   404 B31E 00						.BYTE $00
   404 B31F 00						.BYTE $00
   404 B320 00						.BYTE $00
   404 B321 00						.BYTE $00
   404 B322 00						.BYTE $00
   404 B323 00						.BYTE $00
   404 B324 00						.BYTE $00
   404 B325 00						.BYTE $00
   404 B326 00						.BYTE $00
   404 B327 00						.BYTE $00
   404 B328 00						.BYTE $00
   404 B329 00						.BYTE $00
   404 B32A 00						.BYTE $00
   404 B32B 00						.BYTE $00
   404 B32C 00						.BYTE $00
   404 B32D 00						.BYTE $00
   404 B32E 00						.BYTE $00
   404 B32F 00						.BYTE $00
   404 B330 00						.BYTE $00
   404 B331 00						.BYTE $00
   404 B332 00						.BYTE $00
   404 B333 00						.BYTE $00
   404 B334 00						.BYTE $00
   404 B335 00						.BYTE $00
   404 B336 00						.BYTE $00
   404 B337 00						.BYTE $00
   404 B338 00						.BYTE $00
   404 B339 00						.BYTE $00
   404 B33A 00						.BYTE $00
   404 B33B 00						.BYTE $00
   404 B33C 00						.BYTE $00
   404 B33D 00						.BYTE $00
   404 B33E 00						.BYTE $00
   404 B33F 00						.BYTE $00
   404 B340 00						.BYTE $00
   404 B341 00						.BYTE $00
   404 B342 00						.BYTE $00
   404 B343 00						.BYTE $00
   404 B344 00						.BYTE $00
   404 B345 00						.BYTE $00
   404 B346 00						.BYTE $00
   404 B347 00						.BYTE $00
   404 B348 00						.BYTE $00
   404 B349 00						.BYTE $00
   404 B34A 00						.BYTE $00
   404 B34B 00						.BYTE $00
   404 B34C 00						.BYTE $00
   404 B34D 00						.BYTE $00
   404 B34E 00						.BYTE $00
   404 B34F 00						.BYTE $00
   404 B350 00						.BYTE $00
   404 B351 00						.BYTE $00
   404 B352 00						.BYTE $00
   404 B353 00						.BYTE $00
   404 B354 00						.BYTE $00
   404 B355 00						.BYTE $00
   404 B356 00						.BYTE $00
   404 B357 00						.BYTE $00
   404 B358 00						.BYTE $00
   404 B359 00						.BYTE $00
   404 B35A 00						.BYTE $00
   404 B35B 00						.BYTE $00
   404 B35C 00						.BYTE $00
   404 B35D 00						.BYTE $00
   404 B35E 00						.BYTE $00
   404 B35F 00						.BYTE $00
   404 B360 00						.BYTE $00
   404 B361 00						.BYTE $00
   404 B362 00						.BYTE $00
   404 B363 00						.BYTE $00
   404 B364 00						.BYTE $00
   404 B365 00						.BYTE $00
   404 B366 00						.BYTE $00
   404 B367 00						.BYTE $00
   404 B368 00						.BYTE $00
   404 B369 00						.BYTE $00
   404 B36A 00						.BYTE $00
   404 B36B 00						.BYTE $00
   404 B36C 00						.BYTE $00
   404 B36D 00						.BYTE $00
   404 B36E 00						.BYTE $00
   404 B36F 00						.BYTE $00
   404 B370 00						.BYTE $00
   404 B371 00						.BYTE $00
   404 B372 00						.BYTE $00
   404 B373 00						.BYTE $00
   404 B374 00						.BYTE $00
   404 B375 00						.BYTE $00
   404 B376 00						.BYTE $00
   404 B377 00						.BYTE $00
   404 B378 00						.BYTE $00
   404 B379 00						.BYTE $00
   404 B37A 00						.BYTE $00
   404 B37B 00						.BYTE $00
   404 B37C 00						.BYTE $00
   404 B37D 00						.BYTE $00
   404 B37E 00						.BYTE $00
   404 B37F 00						.BYTE $00
   404 B380 00						.BYTE $00
   404 B381 00						.BYTE $00
   404 B382 00						.BYTE $00
   404 B383 00						.BYTE $00
   404 B384 00						.BYTE $00
   404 B385 00						.BYTE $00
   404 B386 00						.BYTE $00
   404 B387 00						.BYTE $00
   404 B388 00						.BYTE $00
   404 B389 00						.BYTE $00
   404 B38A 00						.BYTE $00
   404 B38B 00						.BYTE $00
   404 B38C 00						.BYTE $00
   404 B38D 00						.BYTE $00
   404 B38E 00						.BYTE $00
   404 B38F 00						.BYTE $00
   404 B390 00						.BYTE $00
   404 B391 00						.BYTE $00
   404 B392 00						.BYTE $00
   404 B393 00						.BYTE $00
   404 B394 00						.BYTE $00
   404 B395 00						.BYTE $00
   404 B396 00						.BYTE $00
   404 B397 00						.BYTE $00
   404 B398 00						.BYTE $00
   404 B399 00						.BYTE $00
   404 B39A 00						.BYTE $00
   404 B39B 00						.BYTE $00
   404 B39C 00						.BYTE $00
   404 B39D 00						.BYTE $00
   404 B39E 00						.BYTE $00
   404 B39F 00						.BYTE $00
   404 B3A0 00						.BYTE $00
   404 B3A1 00						.BYTE $00
   404 B3A2 00						.BYTE $00
   404 B3A3 00						.BYTE $00
   404 B3A4 00						.BYTE $00
   404 B3A5 00						.BYTE $00
   404 B3A6 00						.BYTE $00
   404 B3A7 00						.BYTE $00
   404 B3A8 00						.BYTE $00
   404 B3A9 00						.BYTE $00
   404 B3AA 00						.BYTE $00
   404 B3AB 00						.BYTE $00
   404 B3AC 00						.BYTE $00
   404 B3AD 00						.BYTE $00
   404 B3AE 00						.BYTE $00
   404 B3AF 00						.BYTE $00
   404 B3B0 00						.BYTE $00
   404 B3B1 00						.BYTE $00
   404 B3B2 00						.BYTE $00
   404 B3B3 00						.BYTE $00
   404 B3B4 00						.BYTE $00
   404 B3B5 00						.BYTE $00
   404 B3B6 00						.BYTE $00
   404 B3B7 00						.BYTE $00
   404 B3B8 00						.BYTE $00
   404 B3B9 00						.BYTE $00
   404 B3BA 00						.BYTE $00
   404 B3BB 00						.BYTE $00
   404 B3BC 00						.BYTE $00
   404 B3BD 00						.BYTE $00
   404 B3BE 00						.BYTE $00
   404 B3BF 00						.BYTE $00
   404 B3C0 00						.BYTE $00
   404 B3C1 00						.BYTE $00
   404 B3C2 00						.BYTE $00
   404 B3C3 00						.BYTE $00
   404 B3C4 00						.BYTE $00
   404 B3C5 00						.BYTE $00
   404 B3C6 00						.BYTE $00
   404 B3C7 00						.BYTE $00
   404 B3C8 00						.BYTE $00
   404 B3C9 00						.BYTE $00
   404 B3CA 00						.BYTE $00
   404 B3CB 00						.BYTE $00
   404 B3CC 00						.BYTE $00
   404 B3CD 00						.BYTE $00
   404 B3CE 00						.BYTE $00
   404 B3CF 00						.BYTE $00
   404 B3D0 00						.BYTE $00
   404 B3D1 00						.BYTE $00
   404 B3D2 00						.BYTE $00
   404 B3D3 00						.BYTE $00
   404 B3D4 00						.BYTE $00
   404 B3D5 00						.BYTE $00
   404 B3D6 00						.BYTE $00
   404 B3D7 00						.BYTE $00
   404 B3D8 00						.BYTE $00
   404 B3D9 00						.BYTE $00
   404 B3DA 00						.BYTE $00
   404 B3DB 00						.BYTE $00
   404 B3DC 00						.BYTE $00
   404 B3DD 00						.BYTE $00
   404 B3DE 00						.BYTE $00
   404 B3DF 00						.BYTE $00
   404 B3E0 00						.BYTE $00
   404 B3E1 00						.BYTE $00
   404 B3E2 00						.BYTE $00
   404 B3E3 00						.BYTE $00
   404 B3E4 00						.BYTE $00
   404 B3E5 00						.BYTE $00
   404 B3E6 00						.BYTE $00
   404 B3E7 00						.BYTE $00
   404 B3E8 00						.BYTE $00
   404 B3E9 00						.BYTE $00
   404 B3EA 00						.BYTE $00
   404 B3EB 00						.BYTE $00
   404 B3EC 00						.BYTE $00
   404 B3ED 00						.BYTE $00
   404 B3EE 00						.BYTE $00
   404 B3EF 00						.BYTE $00
   404 B3F0 00						.BYTE $00
   404 B3F1 00						.BYTE $00
   404 B3F2 00						.BYTE $00
   404 B3F3 00						.BYTE $00
   404 B3F4 00						.BYTE $00
   404 B3F5 00						.BYTE $00
   404 B3F6 00						.BYTE $00
   404 B3F7 00						.BYTE $00
   404 B3F8 00						.BYTE $00
   404 B3F9 00						.BYTE $00
   404 B3FA 00						.BYTE $00
   404 B3FB 00						.BYTE $00
   404 B3FC 00						.BYTE $00
   404 B3FD 00						.BYTE $00
   404 B3FE 00						.BYTE $00
   404 B3FF 00						.BYTE $00
   404 B400 00						.BYTE $00
   404 B401 00						.BYTE $00
   404 B402 00						.BYTE $00
   404 B403 00						.BYTE $00
   404 B404 00						.BYTE $00
   404 B405 00						.BYTE $00
   404 B406 00						.BYTE $00
   404 B407 00						.BYTE $00
   404 B408 00						.BYTE $00
   404 B409 00						.BYTE $00
   404 B40A 00						.BYTE $00
   404 B40B 00						.BYTE $00
   404 B40C 00						.BYTE $00
   404 B40D 00						.BYTE $00
   404 B40E 00						.BYTE $00
   404 B40F 00						.BYTE $00
   404 B410 00						.BYTE $00
   404 B411 00						.BYTE $00
   404 B412 00						.BYTE $00
   404 B413 00						.BYTE $00
   404 B414 00						.BYTE $00
   404 B415 00						.BYTE $00
   404 B416 00						.BYTE $00
   404 B417 00						.BYTE $00
   404 B418 00						.BYTE $00
   404 B419 00						.BYTE $00
   404 B41A 00						.BYTE $00
   404 B41B 00						.BYTE $00
   404 B41C 00						.BYTE $00
   404 B41D 00						.BYTE $00
   404 B41E 00						.BYTE $00
   404 B41F 00						.BYTE $00
   404 B420 00						.BYTE $00
   404 B421 00						.BYTE $00
   404 B422 00						.BYTE $00
   404 B423 00						.BYTE $00
   404 B424 00						.BYTE $00
   404 B425 00						.BYTE $00
   404 B426 00						.BYTE $00
   404 B427 00						.BYTE $00
   404 B428 00						.BYTE $00
   404 B429 00						.BYTE $00
   404 B42A 00						.BYTE $00
   404 B42B 00						.BYTE $00
   404 B42C 00						.BYTE $00
   404 B42D 00						.BYTE $00
   404 B42E 00						.BYTE $00
   404 B42F 00						.BYTE $00
   404 B430 00						.BYTE $00
   404 B431 00						.BYTE $00
   404 B432 00						.BYTE $00
   404 B433 00						.BYTE $00
   404 B434 00						.BYTE $00
   404 B435 00						.BYTE $00
   404 B436 00						.BYTE $00
   404 B437 00						.BYTE $00
   404 B438 00						.BYTE $00
   404 B439 00						.BYTE $00
   404 B43A 00						.BYTE $00
   404 B43B 00						.BYTE $00
   404 B43C 00						.BYTE $00
   404 B43D 00						.BYTE $00
   404 B43E 00						.BYTE $00
   404 B43F 00						.BYTE $00
   404 B440 00						.BYTE $00
   404 B441 00						.BYTE $00
   404 B442 00						.BYTE $00
   404 B443 00						.BYTE $00
   404 B444 00						.BYTE $00
   404 B445 00						.BYTE $00
   404 B446 00						.BYTE $00
   404 B447 00						.BYTE $00
   404 B448 00						.BYTE $00
   404 B449 00						.BYTE $00
   404 B44A 00						.BYTE $00
   404 B44B 00						.BYTE $00
   404 B44C 00						.BYTE $00
   404 B44D 00						.BYTE $00
   404 B44E 00						.BYTE $00
   404 B44F 00						.BYTE $00
   404 B450 00						.BYTE $00
   404 B451 00						.BYTE $00
   404 B452 00						.BYTE $00
   404 B453 00						.BYTE $00
   404 B454 00						.BYTE $00
   404 B455 00						.BYTE $00
   404 B456 00						.BYTE $00
   404 B457 00						.BYTE $00
   404 B458 00						.BYTE $00
   404 B459 00						.BYTE $00
   404 B45A 00						.BYTE $00
   404 B45B 00						.BYTE $00
   404 B45C 00						.BYTE $00
   404 B45D 00						.BYTE $00
   404 B45E 00						.BYTE $00
   404 B45F 00						.BYTE $00
   404 B460 00						.BYTE $00
   404 B461 00						.BYTE $00
   404 B462 00						.BYTE $00
   404 B463 00						.BYTE $00
   404 B464 00						.BYTE $00
   404 B465 00						.BYTE $00
   404 B466 00						.BYTE $00
   404 B467 00						.BYTE $00
   404 B468 00						.BYTE $00
   404 B469 00						.BYTE $00
   404 B46A 00						.BYTE $00
   404 B46B 00						.BYTE $00
   404 B46C 00						.BYTE $00
   404 B46D 00						.BYTE $00
   404 B46E 00						.BYTE $00
   404 B46F 00						.BYTE $00
   404 B470 00						.BYTE $00
   404 B471 00						.BYTE $00
   404 B472 00						.BYTE $00
   404 B473 00						.BYTE $00
   404 B474 00						.BYTE $00
   404 B475 00						.BYTE $00
   404 B476 00						.BYTE $00
   404 B477 00						.BYTE $00
   404 B478 00						.BYTE $00
   404 B479 00						.BYTE $00
   404 B47A 00						.BYTE $00
   404 B47B 00						.BYTE $00
   404 B47C 00						.BYTE $00
   404 B47D 00						.BYTE $00
   404 B47E 00						.BYTE $00
   404 B47F 00						.BYTE $00
   404 B480 00						.BYTE $00
   404 B481 00						.BYTE $00
   404 B482 00						.BYTE $00
   404 B483 00						.BYTE $00
   404 B484 00						.BYTE $00
   404 B485 00						.BYTE $00
   404 B486 00						.BYTE $00
   404 B487 00						.BYTE $00
   404 B488 00						.BYTE $00
   404 B489 00						.BYTE $00
   404 B48A 00						.BYTE $00
   404 B48B 00						.BYTE $00
   404 B48C 00						.BYTE $00
   404 B48D 00						.BYTE $00
   404 B48E 00						.BYTE $00
   404 B48F 00						.BYTE $00
   404 B490 00						.BYTE $00
   404 B491 00						.BYTE $00
   404 B492 00						.BYTE $00
   404 B493 00						.BYTE $00
   404 B494 00						.BYTE $00
   404 B495 00						.BYTE $00
   404 B496 00						.BYTE $00
   404 B497 00						.BYTE $00
   404 B498 00						.BYTE $00
   404 B499 00						.BYTE $00
   404 B49A 00						.BYTE $00
   404 B49B 00						.BYTE $00
   404 B49C 00						.BYTE $00
   404 B49D 00						.BYTE $00
   404 B49E 00						.BYTE $00
   404 B49F 00						.BYTE $00
   404 B4A0 00						.BYTE $00
   404 B4A1 00						.BYTE $00
   404 B4A2 00						.BYTE $00
   404 B4A3 00						.BYTE $00
   404 B4A4 00						.BYTE $00
   404 B4A5 00						.BYTE $00
   404 B4A6 00						.BYTE $00
   404 B4A7 00						.BYTE $00
   404 B4A8 00						.BYTE $00
   404 B4A9 00						.BYTE $00
   404 B4AA 00						.BYTE $00
   404 B4AB 00						.BYTE $00
   404 B4AC 00						.BYTE $00
   404 B4AD 00						.BYTE $00
   404 B4AE 00						.BYTE $00
   404 B4AF 00						.BYTE $00
   404 B4B0 00						.BYTE $00
   404 B4B1 00						.BYTE $00
   404 B4B2 00						.BYTE $00
   404 B4B3 00						.BYTE $00
   404 B4B4 00						.BYTE $00
   404 B4B5 00						.BYTE $00
   404 B4B6 00						.BYTE $00
   404 B4B7 00						.BYTE $00
   404 B4B8 00						.BYTE $00
   404 B4B9 00						.BYTE $00
   404 B4BA 00						.BYTE $00
   404 B4BB 00						.BYTE $00
   404 B4BC 00						.BYTE $00
   404 B4BD 00						.BYTE $00
   404 B4BE 00						.BYTE $00
   404 B4BF 00						.BYTE $00
   404 B4C0 00						.BYTE $00
   404 B4C1 00						.BYTE $00
   404 B4C2 00						.BYTE $00
   404 B4C3 00						.BYTE $00
   404 B4C4 00						.BYTE $00
   404 B4C5 00						.BYTE $00
   404 B4C6 00						.BYTE $00
   404 B4C7 00						.BYTE $00
   404 B4C8 00						.BYTE $00
   404 B4C9 00						.BYTE $00
   404 B4CA 00						.BYTE $00
   404 B4CB 00						.BYTE $00
   404 B4CC 00						.BYTE $00
   404 B4CD 00						.BYTE $00
   404 B4CE 00						.BYTE $00
   404 B4CF 00						.BYTE $00
   404 B4D0 00						.BYTE $00
   404 B4D1 00						.BYTE $00
   404 B4D2 00						.BYTE $00
   404 B4D3 00						.BYTE $00
   404 B4D4 00						.BYTE $00
   404 B4D5 00						.BYTE $00
   404 B4D6 00						.BYTE $00
   404 B4D7 00						.BYTE $00
   404 B4D8 00						.BYTE $00
   404 B4D9 00						.BYTE $00
   404 B4DA 00						.BYTE $00
   404 B4DB 00						.BYTE $00
   404 B4DC 00						.BYTE $00
   404 B4DD 00						.BYTE $00
   404 B4DE 00						.BYTE $00
   404 B4DF 00						.BYTE $00
   404 B4E0 00						.BYTE $00
   404 B4E1 00						.BYTE $00
   404 B4E2 00						.BYTE $00
   404 B4E3 00						.BYTE $00
   404 B4E4 00						.BYTE $00
   404 B4E5 00						.BYTE $00
   404 B4E6 00						.BYTE $00
   404 B4E7 00						.BYTE $00
   404 B4E8 00						.BYTE $00
   404 B4E9 00						.BYTE $00
   404 B4EA 00						.BYTE $00
   404 B4EB 00						.BYTE $00
   404 B4EC 00						.BYTE $00
   404 B4ED 00						.BYTE $00
   404 B4EE 00						.BYTE $00
   404 B4EF 00						.BYTE $00
   404 B4F0 00						.BYTE $00
   404 B4F1 00						.BYTE $00
   404 B4F2 00						.BYTE $00
   404 B4F3 00						.BYTE $00
   404 B4F4 00						.BYTE $00
   404 B4F5 00						.BYTE $00
   404 B4F6 00						.BYTE $00
   404 B4F7 00						.BYTE $00
   404 B4F8 00						.BYTE $00
   404 B4F9 00						.BYTE $00
   404 B4FA 00						.BYTE $00
   404 B4FB 00						.BYTE $00
   404 B4FC 00						.BYTE $00
   404 B4FD 00						.BYTE $00
   404 B4FE 00						.BYTE $00
   404 B4FF 00						.BYTE $00
   404 B500 00						.BYTE $00
   404 B501 00						.BYTE $00
   404 B502 00						.BYTE $00
   404 B503 00						.BYTE $00
   404 B504 00						.BYTE $00
   404 B505 00						.BYTE $00
   404 B506 00						.BYTE $00
   404 B507 00						.BYTE $00
   404 B508 00						.BYTE $00
   404 B509 00						.BYTE $00
   404 B50A 00						.BYTE $00
   404 B50B 00						.BYTE $00
   404 B50C 00						.BYTE $00
   404 B50D 00						.BYTE $00
   404 B50E 00						.BYTE $00
   404 B50F 00						.BYTE $00
   404 B510 00						.BYTE $00
   404 B511 00						.BYTE $00
   404 B512 00						.BYTE $00
   404 B513 00						.BYTE $00
   404 B514 00						.BYTE $00
   404 B515 00						.BYTE $00
   404 B516 00						.BYTE $00
   404 B517 00						.BYTE $00
   404 B518 00						.BYTE $00
   404 B519 00						.BYTE $00
   404 B51A 00						.BYTE $00
   404 B51B 00						.BYTE $00
   404 B51C 00						.BYTE $00
   404 B51D 00						.BYTE $00
   404 B51E 00						.BYTE $00
   404 B51F 00						.BYTE $00
   404 B520 00						.BYTE $00
   404 B521 00						.BYTE $00
   404 B522 00						.BYTE $00
   404 B523 00						.BYTE $00
   404 B524 00						.BYTE $00
   404 B525 00						.BYTE $00
   404 B526 00						.BYTE $00
   404 B527 00						.BYTE $00
   404 B528 00						.BYTE $00
   404 B529 00						.BYTE $00
   404 B52A 00						.BYTE $00
   404 B52B 00						.BYTE $00
   404 B52C 00						.BYTE $00
   404 B52D 00						.BYTE $00
   404 B52E 00						.BYTE $00
   404 B52F 00						.BYTE $00
   404 B530 00						.BYTE $00
   404 B531 00						.BYTE $00
   404 B532 00						.BYTE $00
   404 B533 00						.BYTE $00
   404 B534 00						.BYTE $00
   404 B535 00						.BYTE $00
   404 B536 00						.BYTE $00
   404 B537 00						.BYTE $00
   404 B538 00						.BYTE $00
   404 B539 00						.BYTE $00
   404 B53A 00						.BYTE $00
   404 B53B 00						.BYTE $00
   404 B53C 00						.BYTE $00
   404 B53D 00						.BYTE $00
   404 B53E 00						.BYTE $00
   404 B53F 00						.BYTE $00
   404 B540 00						.BYTE $00
   404 B541 00						.BYTE $00
   404 B542 00						.BYTE $00
   404 B543 00						.BYTE $00
   404 B544 00						.BYTE $00
   404 B545 00						.BYTE $00
   404 B546 00						.BYTE $00
   404 B547 00						.BYTE $00
   404 B548 00						.BYTE $00
   404 B549 00						.BYTE $00
   404 B54A 00						.BYTE $00
   404 B54B 00						.BYTE $00
   404 B54C 00						.BYTE $00
   404 B54D 00						.BYTE $00
   404 B54E 00						.BYTE $00
   404 B54F 00						.BYTE $00
   404 B550 00						.BYTE $00
   404 B551 00						.BYTE $00
   404 B552 00						.BYTE $00
   404 B553 00						.BYTE $00
   404 B554 00						.BYTE $00
   404 B555 00						.BYTE $00
   404 B556 00						.BYTE $00
   404 B557 00						.BYTE $00
   404 B558 00						.BYTE $00
   404 B559 00						.BYTE $00
   404 B55A 00						.BYTE $00
   404 B55B 00						.BYTE $00
   404 B55C 00						.BYTE $00
   404 B55D 00						.BYTE $00
   404 B55E 00						.BYTE $00
   404 B55F 00						.BYTE $00
   404 B560 00						.BYTE $00
   404 B561 00						.BYTE $00
   404 B562 00						.BYTE $00
   404 B563 00						.BYTE $00
   404 B564 00						.BYTE $00
   404 B565 00						.BYTE $00
   404 B566 00						.BYTE $00
   404 B567 00						.BYTE $00
   404 B568 00						.BYTE $00
   404 B569 00						.BYTE $00
   404 B56A 00						.BYTE $00
   404 B56B 00						.BYTE $00
   404 B56C 00						.BYTE $00
   404 B56D 00						.BYTE $00
   404 B56E 00						.BYTE $00
   404 B56F 00						.BYTE $00
   404 B570 00						.BYTE $00
   404 B571 00						.BYTE $00
   404 B572 00						.BYTE $00
   404 B573 00						.BYTE $00
   404 B574 00						.BYTE $00
   404 B575 00						.BYTE $00
   404 B576 00						.BYTE $00
   404 B577 00						.BYTE $00
   404 B578 00						.BYTE $00
   404 B579 00						.BYTE $00
   404 B57A 00						.BYTE $00
   404 B57B 00						.BYTE $00
   404 B57C 00						.BYTE $00
   404 B57D 00						.BYTE $00
   404 B57E 00						.BYTE $00
   404 B57F 00						.BYTE $00
   404 B580 00						.BYTE $00
   404 B581 00						.BYTE $00
   404 B582 00						.BYTE $00
   404 B583 00						.BYTE $00
   404 B584 00						.BYTE $00
   404 B585 00						.BYTE $00
   404 B586 00						.BYTE $00
   404 B587 00						.BYTE $00
   404 B588 00						.BYTE $00
   404 B589 00						.BYTE $00
   404 B58A 00						.BYTE $00
   404 B58B 00						.BYTE $00
   404 B58C 00						.BYTE $00
   404 B58D 00						.BYTE $00
   404 B58E 00						.BYTE $00
   404 B58F 00						.BYTE $00
   404 B590 00						.BYTE $00
   404 B591 00						.BYTE $00
   404 B592 00						.BYTE $00
   404 B593 00						.BYTE $00
   404 B594 00						.BYTE $00
   404 B595 00						.BYTE $00
   404 B596 00						.BYTE $00
   404 B597 00						.BYTE $00
   404 B598 00						.BYTE $00
   404 B599 00						.BYTE $00
   404 B59A 00						.BYTE $00
   404 B59B 00						.BYTE $00
   404 B59C 00						.BYTE $00
   404 B59D 00						.BYTE $00
   404 B59E 00						.BYTE $00
   404 B59F 00						.BYTE $00
   404 B5A0 00						.BYTE $00
   404 B5A1 00						.BYTE $00
   404 B5A2 00						.BYTE $00
   404 B5A3 00						.BYTE $00
   404 B5A4 00						.BYTE $00
   404 B5A5 00						.BYTE $00
   404 B5A6 00						.BYTE $00
   404 B5A7 00						.BYTE $00
   404 B5A8 00						.BYTE $00
   404 B5A9 00						.BYTE $00
   404 B5AA 00						.BYTE $00
   404 B5AB 00						.BYTE $00
   404 B5AC 00						.BYTE $00
   404 B5AD 00						.BYTE $00
   404 B5AE 00						.BYTE $00
   404 B5AF 00						.BYTE $00
   404 B5B0 00						.BYTE $00
   404 B5B1 00						.BYTE $00
   404 B5B2 00						.BYTE $00
   404 B5B3 00						.BYTE $00
   404 B5B4 00						.BYTE $00
   404 B5B5 00						.BYTE $00
   404 B5B6 00						.BYTE $00
   404 B5B7 00						.BYTE $00
   404 B5B8 00						.BYTE $00
   404 B5B9 00						.BYTE $00
   404 B5BA 00						.BYTE $00
   404 B5BB 00						.BYTE $00
   404 B5BC 00						.BYTE $00
   404 B5BD 00						.BYTE $00
   404 B5BE 00						.BYTE $00
   404 B5BF 00						.BYTE $00
   404 B5C0 00						.BYTE $00
   404 B5C1 00						.BYTE $00
   404 B5C2 00						.BYTE $00
   404 B5C3 00						.BYTE $00
   404 B5C4 00						.BYTE $00
   404 B5C5 00						.BYTE $00
   404 B5C6 00						.BYTE $00
   404 B5C7 00						.BYTE $00
   404 B5C8 00						.BYTE $00
   404 B5C9 00						.BYTE $00
   404 B5CA 00						.BYTE $00
   404 B5CB 00						.BYTE $00
   404 B5CC 00						.BYTE $00
   404 B5CD 00						.BYTE $00
   404 B5CE 00						.BYTE $00
   404 B5CF 00						.BYTE $00
   404 B5D0 00						.BYTE $00
   404 B5D1 00						.BYTE $00
   404 B5D2 00						.BYTE $00
   404 B5D3 00						.BYTE $00
   404 B5D4 00						.BYTE $00
   404 B5D5 00						.BYTE $00
   404 B5D6 00						.BYTE $00
   404 B5D7 00						.BYTE $00
   404 B5D8 00						.BYTE $00
   404 B5D9 00						.BYTE $00
   404 B5DA 00						.BYTE $00
   404 B5DB 00						.BYTE $00
   404 B5DC 00						.BYTE $00
   404 B5DD 00						.BYTE $00
   404 B5DE 00						.BYTE $00
   404 B5DF 00						.BYTE $00
   404 B5E0 00						.BYTE $00
   404 B5E1 00						.BYTE $00
   404 B5E2 00						.BYTE $00
   404 B5E3 00						.BYTE $00
   404 B5E4 00						.BYTE $00
   404 B5E5 00						.BYTE $00
   404 B5E6 00						.BYTE $00
   404 B5E7 00						.BYTE $00
   404 B5E8 00						.BYTE $00
   404 B5E9 00						.BYTE $00
   404 B5EA 00						.BYTE $00
   404 B5EB 00						.BYTE $00
   404 B5EC 00						.BYTE $00
   404 B5ED 00						.BYTE $00
   404 B5EE 00						.BYTE $00
   404 B5EF 00						.BYTE $00
   404 B5F0 00						.BYTE $00
   404 B5F1 00						.BYTE $00
   404 B5F2 00						.BYTE $00
   404 B5F3 00						.BYTE $00
   404 B5F4 00						.BYTE $00
   404 B5F5 00						.BYTE $00
   404 B5F6 00						.BYTE $00
   404 B5F7 00						.BYTE $00
   404 B5F8 00						.BYTE $00
   404 B5F9 00						.BYTE $00
   404 B5FA 00						.BYTE $00
   404 B5FB 00						.BYTE $00
   404 B5FC 00						.BYTE $00
   404 B5FD 00						.BYTE $00
   404 B5FE 00						.BYTE $00
   404 B5FF 00						.BYTE $00
   404 B600 00						.BYTE $00
   404 B601 00						.BYTE $00
   404 B602 00						.BYTE $00
   404 B603 00						.BYTE $00
   404 B604 00						.BYTE $00
   404 B605 00						.BYTE $00
   404 B606 00						.BYTE $00
   404 B607 00						.BYTE $00
   404 B608 00						.BYTE $00
   404 B609 00						.BYTE $00
   404 B60A 00						.BYTE $00
   404 B60B 00						.BYTE $00
   404 B60C 00						.BYTE $00
   404 B60D 00						.BYTE $00
   404 B60E 00						.BYTE $00
   404 B60F 00						.BYTE $00
   404 B610 00						.BYTE $00
   404 B611 00						.BYTE $00
   404 B612 00						.BYTE $00
   404 B613 00						.BYTE $00
   404 B614 00						.BYTE $00
   404 B615 00						.BYTE $00
   404 B616 00						.BYTE $00
   404 B617 00						.BYTE $00
   404 B618 00						.BYTE $00
   404 B619 00						.BYTE $00
   404 B61A 00						.BYTE $00
   404 B61B 00						.BYTE $00
   404 B61C 00						.BYTE $00
   404 B61D 00						.BYTE $00
   404 B61E 00						.BYTE $00
   404 B61F 00						.BYTE $00
   404 B620 00						.BYTE $00
   404 B621 00						.BYTE $00
   404 B622 00						.BYTE $00
   404 B623 00						.BYTE $00
   404 B624 00						.BYTE $00
   404 B625 00						.BYTE $00
   404 B626 00						.BYTE $00
   404 B627 00						.BYTE $00
   404 B628 00						.BYTE $00
   404 B629 00						.BYTE $00
   404 B62A 00						.BYTE $00
   404 B62B 00						.BYTE $00
   404 B62C 00						.BYTE $00
   404 B62D 00						.BYTE $00
   404 B62E 00						.BYTE $00
   404 B62F 00						.BYTE $00
   404 B630 00						.BYTE $00
   404 B631 00						.BYTE $00
   404 B632 00						.BYTE $00
   404 B633 00						.BYTE $00
   404 B634 00						.BYTE $00
   404 B635 00						.BYTE $00
   404 B636 00						.BYTE $00
   404 B637 00						.BYTE $00
   404 B638 00						.BYTE $00
   404 B639 00						.BYTE $00
   404 B63A 00						.BYTE $00
   404 B63B 00						.BYTE $00
   404 B63C 00						.BYTE $00
   404 B63D 00						.BYTE $00
   404 B63E 00						.BYTE $00
   404 B63F 00						.BYTE $00
   404 B640 00						.BYTE $00
   404 B641 00						.BYTE $00
   404 B642 00						.BYTE $00
   404 B643 00						.BYTE $00
   404 B644 00						.BYTE $00
   404 B645 00						.BYTE $00
   404 B646 00						.BYTE $00
   404 B647 00						.BYTE $00
   404 B648 00						.BYTE $00
   404 B649 00						.BYTE $00
   404 B64A 00						.BYTE $00
   404 B64B 00						.BYTE $00
   404 B64C 00						.BYTE $00
   404 B64D 00						.BYTE $00
   404 B64E 00						.BYTE $00
   404 B64F 00						.BYTE $00
   404 B650 00						.BYTE $00
   404 B651 00						.BYTE $00
   404 B652 00						.BYTE $00
   404 B653 00						.BYTE $00
   404 B654 00						.BYTE $00
   404 B655 00						.BYTE $00
   404 B656 00						.BYTE $00
   404 B657 00						.BYTE $00
   404 B658 00						.BYTE $00
   404 B659 00						.BYTE $00
   404 B65A 00						.BYTE $00
   404 B65B 00						.BYTE $00
   404 B65C 00						.BYTE $00
   404 B65D 00						.BYTE $00
   404 B65E 00						.BYTE $00
   404 B65F 00						.BYTE $00
   404 B660 00						.BYTE $00
   404 B661 00						.BYTE $00
   404 B662 00						.BYTE $00
   404 B663 00						.BYTE $00
   404 B664 00						.BYTE $00
   404 B665 00						.BYTE $00
   404 B666 00						.BYTE $00
   404 B667 00						.BYTE $00
   404 B668 00						.BYTE $00
   404 B669 00						.BYTE $00
   404 B66A 00						.BYTE $00
   404 B66B 00						.BYTE $00
   404 B66C 00						.BYTE $00
   404 B66D 00						.BYTE $00
   404 B66E 00						.BYTE $00
   404 B66F 00						.BYTE $00
   404 B670 00						.BYTE $00
   404 B671 00						.BYTE $00
   404 B672 00						.BYTE $00
   404 B673 00						.BYTE $00
   404 B674 00						.BYTE $00
   404 B675 00						.BYTE $00
   404 B676 00						.BYTE $00
   404 B677 00						.BYTE $00
   404 B678 00						.BYTE $00
   404 B679 00						.BYTE $00
   404 B67A 00						.BYTE $00
   404 B67B 00						.BYTE $00
   404 B67C 00						.BYTE $00
   404 B67D 00						.BYTE $00
   404 B67E 00						.BYTE $00
   404 B67F 00						.BYTE $00
   404 B680 00						.BYTE $00
   404 B681 00						.BYTE $00
   404 B682 00						.BYTE $00
   404 B683 00						.BYTE $00
   404 B684 00						.BYTE $00
   404 B685 00						.BYTE $00
   404 B686 00						.BYTE $00
   404 B687 00						.BYTE $00
   404 B688 00						.BYTE $00
   404 B689 00						.BYTE $00
   404 B68A 00						.BYTE $00
   404 B68B 00						.BYTE $00
   404 B68C 00						.BYTE $00
   404 B68D 00						.BYTE $00
   404 B68E 00						.BYTE $00
   404 B68F 00						.BYTE $00
   404 B690 00						.BYTE $00
   404 B691 00						.BYTE $00
   404 B692 00						.BYTE $00
   404 B693 00						.BYTE $00
   404 B694 00						.BYTE $00
   404 B695 00						.BYTE $00
   404 B696 00						.BYTE $00
   404 B697 00						.BYTE $00
   404 B698 00						.BYTE $00
   404 B699 00						.BYTE $00
   404 B69A 00						.BYTE $00
   404 B69B 00						.BYTE $00
   404 B69C 00						.BYTE $00
   404 B69D 00						.BYTE $00
   404 B69E 00						.BYTE $00
   404 B69F 00						.BYTE $00
   404 B6A0 00						.BYTE $00
   404 B6A1 00						.BYTE $00
   404 B6A2 00						.BYTE $00
   404 B6A3 00						.BYTE $00
   404 B6A4 00						.BYTE $00
   404 B6A5 00						.BYTE $00
   404 B6A6 00						.BYTE $00
   404 B6A7 00						.BYTE $00
   404 B6A8 00						.BYTE $00
   404 B6A9 00						.BYTE $00
   404 B6AA 00						.BYTE $00
   404 B6AB 00						.BYTE $00
   404 B6AC 00						.BYTE $00
   404 B6AD 00						.BYTE $00
   404 B6AE 00						.BYTE $00
   404 B6AF 00						.BYTE $00
   404 B6B0 00						.BYTE $00
   404 B6B1 00						.BYTE $00
   404 B6B2 00						.BYTE $00
   404 B6B3 00						.BYTE $00
   404 B6B4 00						.BYTE $00
   404 B6B5 00						.BYTE $00
   404 B6B6 00						.BYTE $00
   404 B6B7 00						.BYTE $00
   404 B6B8 00						.BYTE $00
   404 B6B9 00						.BYTE $00
   404 B6BA 00						.BYTE $00
   404 B6BB 00						.BYTE $00
   404 B6BC 00						.BYTE $00
   404 B6BD 00						.BYTE $00
   404 B6BE 00						.BYTE $00
   404 B6BF 00						.BYTE $00
   404 B6C0 00						.BYTE $00
   404 B6C1 00						.BYTE $00
   404 B6C2 00						.BYTE $00
   404 B6C3 00						.BYTE $00
   404 B6C4 00						.BYTE $00
   404 B6C5 00						.BYTE $00
   404 B6C6 00						.BYTE $00
   404 B6C7 00						.BYTE $00
   404 B6C8 00						.BYTE $00
   404 B6C9 00						.BYTE $00
   404 B6CA 00						.BYTE $00
   404 B6CB 00						.BYTE $00
   404 B6CC 00						.BYTE $00
   404 B6CD 00						.BYTE $00
   404 B6CE 00						.BYTE $00
   404 B6CF 00						.BYTE $00
   404 B6D0 00						.BYTE $00
   404 B6D1 00						.BYTE $00
   404 B6D2 00						.BYTE $00
   404 B6D3 00						.BYTE $00
   404 B6D4 00						.BYTE $00
   404 B6D5 00						.BYTE $00
   404 B6D6 00						.BYTE $00
   404 B6D7 00						.BYTE $00
   404 B6D8 00						.BYTE $00
   404 B6D9 00						.BYTE $00
   404 B6DA 00						.BYTE $00
   404 B6DB 00						.BYTE $00
   404 B6DC 00						.BYTE $00
   404 B6DD 00						.BYTE $00
   404 B6DE 00						.BYTE $00
   404 B6DF 00						.BYTE $00
   404 B6E0 00						.BYTE $00
   404 B6E1 00						.BYTE $00
   404 B6E2 00						.BYTE $00
   404 B6E3 00						.BYTE $00
   404 B6E4 00						.BYTE $00
   404 B6E5 00						.BYTE $00
   404 B6E6 00						.BYTE $00
   404 B6E7 00						.BYTE $00
   404 B6E8 00						.BYTE $00
   404 B6E9 00						.BYTE $00
   404 B6EA 00						.BYTE $00
   404 B6EB 00						.BYTE $00
   404 B6EC 00						.BYTE $00
   404 B6ED 00						.BYTE $00
   404 B6EE 00						.BYTE $00
   404 B6EF 00						.BYTE $00
   404 B6F0 00						.BYTE $00
   404 B6F1 00						.BYTE $00
   404 B6F2 00						.BYTE $00
   404 B6F3 00						.BYTE $00
   404 B6F4 00						.BYTE $00
   404 B6F5 00						.BYTE $00
   404 B6F6 00						.BYTE $00
   404 B6F7 00						.BYTE $00
   404 B6F8 00						.BYTE $00
   404 B6F9 00						.BYTE $00
   404 B6FA 00						.BYTE $00
   404 B6FB 00						.BYTE $00
   404 B6FC 00						.BYTE $00
   404 B6FD 00						.BYTE $00
   404 B6FE 00						.BYTE $00
   404 B6FF 00						.BYTE $00
   404 B700 00						.BYTE $00
   404 B701 00						.BYTE $00
   404 B702 00						.BYTE $00
   404 B703 00						.BYTE $00
   404 B704 00						.BYTE $00
   404 B705 00						.BYTE $00
   404 B706 00						.BYTE $00
   404 B707 00						.BYTE $00
   404 B708 00						.BYTE $00
   404 B709 00						.BYTE $00
   404 B70A 00						.BYTE $00
   404 B70B 00						.BYTE $00
   404 B70C 00						.BYTE $00
   404 B70D 00						.BYTE $00
   404 B70E 00						.BYTE $00
   404 B70F 00						.BYTE $00
   404 B710 00						.BYTE $00
   404 B711 00						.BYTE $00
   404 B712 00						.BYTE $00
   404 B713 00						.BYTE $00
   404 B714 00						.BYTE $00
   404 B715 00						.BYTE $00
   404 B716 00						.BYTE $00
   404 B717 00						.BYTE $00
   404 B718 00						.BYTE $00
   404 B719 00						.BYTE $00
   404 B71A 00						.BYTE $00
   404 B71B 00						.BYTE $00
   404 B71C 00						.BYTE $00
   404 B71D 00						.BYTE $00
   404 B71E 00						.BYTE $00
   404 B71F 00						.BYTE $00
   404 B720 00						.BYTE $00
   404 B721 00						.BYTE $00
   404 B722 00						.BYTE $00
   404 B723 00						.BYTE $00
   404 B724 00						.BYTE $00
   404 B725 00						.BYTE $00
   404 B726 00						.BYTE $00
   404 B727 00						.BYTE $00
   404 B728 00						.BYTE $00
   404 B729 00						.BYTE $00
   404 B72A 00						.BYTE $00
   404 B72B 00						.BYTE $00
   404 B72C 00						.BYTE $00
   404 B72D 00						.BYTE $00
   404 B72E 00						.BYTE $00
   404 B72F 00						.BYTE $00
   404 B730 00						.BYTE $00
   404 B731 00						.BYTE $00
   404 B732 00						.BYTE $00
   404 B733 00						.BYTE $00
   404 B734 00						.BYTE $00
   404 B735 00						.BYTE $00
   404 B736 00						.BYTE $00
   404 B737 00						.BYTE $00
   404 B738 00						.BYTE $00
   404 B739 00						.BYTE $00
   404 B73A 00						.BYTE $00
   404 B73B 00						.BYTE $00
   404 B73C 00						.BYTE $00
   404 B73D 00						.BYTE $00
   404 B73E 00						.BYTE $00
   404 B73F 00						.BYTE $00
   404 B740 00						.BYTE $00
   404 B741 00						.BYTE $00
   404 B742 00						.BYTE $00
   404 B743 00						.BYTE $00
   404 B744 00						.BYTE $00
   404 B745 00						.BYTE $00
   404 B746 00						.BYTE $00
   404 B747 00						.BYTE $00
   404 B748 00						.BYTE $00
   404 B749 00						.BYTE $00
   404 B74A 00						.BYTE $00
   404 B74B 00						.BYTE $00
   404 B74C 00						.BYTE $00
   404 B74D 00						.BYTE $00
   404 B74E 00						.BYTE $00
   404 B74F 00						.BYTE $00
   404 B750 00						.BYTE $00
   404 B751 00						.BYTE $00
   404 B752 00						.BYTE $00
   404 B753 00						.BYTE $00
   404 B754 00						.BYTE $00
   404 B755 00						.BYTE $00
   404 B756 00						.BYTE $00
   404 B757 00						.BYTE $00
   404 B758 00						.BYTE $00
   404 B759 00						.BYTE $00
   404 B75A 00						.BYTE $00
   404 B75B 00						.BYTE $00
   404 B75C 00						.BYTE $00
   404 B75D 00						.BYTE $00
   404 B75E 00						.BYTE $00
   404 B75F 00						.BYTE $00
   404 B760 00						.BYTE $00
   404 B761 00						.BYTE $00
   404 B762 00						.BYTE $00
   404 B763 00						.BYTE $00
   404 B764 00						.BYTE $00
   404 B765 00						.BYTE $00
   404 B766 00						.BYTE $00
   404 B767 00						.BYTE $00
   404 B768 00						.BYTE $00
   404 B769 00						.BYTE $00
   404 B76A 00						.BYTE $00
   404 B76B 00						.BYTE $00
   404 B76C 00						.BYTE $00
   404 B76D 00						.BYTE $00
   404 B76E 00						.BYTE $00
   404 B76F 00						.BYTE $00
   404 B770 00						.BYTE $00
   404 B771 00						.BYTE $00
   404 B772 00						.BYTE $00
   404 B773 00						.BYTE $00
   404 B774 00						.BYTE $00
   404 B775 00						.BYTE $00
   404 B776 00						.BYTE $00
   404 B777 00						.BYTE $00
   404 B778 00						.BYTE $00
   404 B779 00						.BYTE $00
   404 B77A 00						.BYTE $00
   404 B77B 00						.BYTE $00
   404 B77C 00						.BYTE $00
   404 B77D 00						.BYTE $00
   404 B77E 00						.BYTE $00
   404 B77F 00						.BYTE $00
   404 B780 00						.BYTE $00
   404 B781 00						.BYTE $00
   404 B782 00						.BYTE $00
   404 B783 00						.BYTE $00
   404 B784 00						.BYTE $00
   404 B785 00						.BYTE $00
   404 B786 00						.BYTE $00
   404 B787 00						.BYTE $00
   404 B788 00						.BYTE $00
   404 B789 00						.BYTE $00
   404 B78A 00						.BYTE $00
   404 B78B 00						.BYTE $00
   404 B78C 00						.BYTE $00
   404 B78D 00						.BYTE $00
   404 B78E 00						.BYTE $00
   404 B78F 00						.BYTE $00
   404 B790 00						.BYTE $00
   404 B791 00						.BYTE $00
   404 B792 00						.BYTE $00
   404 B793 00						.BYTE $00
   404 B794 00						.BYTE $00
   404 B795 00						.BYTE $00
   404 B796 00						.BYTE $00
   404 B797 00						.BYTE $00
   404 B798 00						.BYTE $00
   404 B799 00						.BYTE $00
   404 B79A 00						.BYTE $00
   404 B79B 00						.BYTE $00
   404 B79C 00						.BYTE $00
   404 B79D 00						.BYTE $00
   404 B79E 00						.BYTE $00
   404 B79F 00						.BYTE $00
   404 B7A0 00						.BYTE $00
   404 B7A1 00						.BYTE $00
   404 B7A2 00						.BYTE $00
   404 B7A3 00						.BYTE $00
   404 B7A4 00						.BYTE $00
   404 B7A5 00						.BYTE $00
   404 B7A6 00						.BYTE $00
   404 B7A7 00						.BYTE $00
   404 B7A8 00						.BYTE $00
   404 B7A9 00						.BYTE $00
   404 B7AA 00						.BYTE $00
   404 B7AB 00						.BYTE $00
   404 B7AC 00						.BYTE $00
   404 B7AD 00						.BYTE $00
   404 B7AE 00						.BYTE $00
   404 B7AF 00						.BYTE $00
   404 B7B0 00						.BYTE $00
   404 B7B1 00						.BYTE $00
   404 B7B2 00						.BYTE $00
   404 B7B3 00						.BYTE $00
   404 B7B4 00						.BYTE $00
   404 B7B5 00						.BYTE $00
   404 B7B6 00						.BYTE $00
   404 B7B7 00						.BYTE $00
   404 B7B8 00						.BYTE $00
   404 B7B9 00						.BYTE $00
   404 B7BA 00						.BYTE $00
   404 B7BB 00						.BYTE $00
   404 B7BC 00						.BYTE $00
   404 B7BD 00						.BYTE $00
   404 B7BE 00						.BYTE $00
   404 B7BF 00						.BYTE $00
   404 B7C0 00						.BYTE $00
   404 B7C1 00						.BYTE $00
   404 B7C2 00						.BYTE $00
   404 B7C3 00						.BYTE $00
   404 B7C4 00						.BYTE $00
   404 B7C5 00						.BYTE $00
   404 B7C6 00						.BYTE $00
   404 B7C7 00						.BYTE $00
   404 B7C8 00						.BYTE $00
   404 B7C9 00						.BYTE $00
   404 B7CA 00						.BYTE $00
   404 B7CB 00						.BYTE $00
   404 B7CC 00						.BYTE $00
   404 B7CD 00						.BYTE $00
   404 B7CE 00						.BYTE $00
   404 B7CF 00						.BYTE $00
   404 B7D0 00						.BYTE $00
   404 B7D1 00						.BYTE $00
   404 B7D2 00						.BYTE $00
   404 B7D3 00						.BYTE $00
   404 B7D4 00						.BYTE $00
   404 B7D5 00						.BYTE $00
   404 B7D6 00						.BYTE $00
   404 B7D7 00						.BYTE $00
   404 B7D8 00						.BYTE $00
   404 B7D9 00						.BYTE $00
   404 B7DA 00						.BYTE $00
   404 B7DB 00						.BYTE $00
   404 B7DC 00						.BYTE $00
   404 B7DD 00						.BYTE $00
   404 B7DE 00						.BYTE $00
   404 B7DF 00						.BYTE $00
   404 B7E0 00						.BYTE $00
   404 B7E1 00						.BYTE $00
   404 B7E2 00						.BYTE $00
   404 B7E3 00						.BYTE $00
   404 B7E4 00						.BYTE $00
   404 B7E5 00						.BYTE $00
   404 B7E6 00						.BYTE $00
   404 B7E7 00						.BYTE $00
   404 B7E8 00						.BYTE $00
   404 B7E9 00						.BYTE $00
   404 B7EA 00						.BYTE $00
   404 B7EB 00						.BYTE $00
   404 B7EC 00						.BYTE $00
   404 B7ED 00						.BYTE $00
   404 B7EE 00						.BYTE $00
   404 B7EF 00						.BYTE $00
   404 B7F0 00						.BYTE $00
   404 B7F1 00						.BYTE $00
   404 B7F2 00						.BYTE $00
   404 B7F3 00						.BYTE $00
   404 B7F4 00						.BYTE $00
   404 B7F5 00						.BYTE $00
   404 B7F6 00						.BYTE $00
   404 B7F7 00						.BYTE $00
   404 B7F8 00						.BYTE $00
   404 B7F9 00						.BYTE $00
   404 B7FA 00						.BYTE $00
   404 B7FB 00						.BYTE $00
   404 B7FC 00						.BYTE $00
   404 B7FD 00						.BYTE $00
   404 B7FE 00						.BYTE $00
   404 B7FF 00						.BYTE $00
   404 B800 00						.BYTE $00
   404 B801 00						.BYTE $00
   404 B802 00						.BYTE $00
   404 B803 00						.BYTE $00
   404 B804 00						.BYTE $00
   404 B805 00						.BYTE $00
   404 B806 00						.BYTE $00
   404 B807 00						.BYTE $00
   404 B808 00						.BYTE $00
   404 B809 00						.BYTE $00
   404 B80A 00						.BYTE $00
   404 B80B 00						.BYTE $00
   404 B80C 00						.BYTE $00
   404 B80D 00						.BYTE $00
   404 B80E 00						.BYTE $00
   404 B80F 00						.BYTE $00
   404 B810 00						.BYTE $00
   404 B811 00						.BYTE $00
   404 B812 00						.BYTE $00
   404 B813 00						.BYTE $00
   404 B814 00						.BYTE $00
   404 B815 00						.BYTE $00
   404 B816 00						.BYTE $00
   404 B817 00						.BYTE $00
   404 B818 00						.BYTE $00
   404 B819 00						.BYTE $00
   404 B81A 00						.BYTE $00
   404 B81B 00						.BYTE $00
   404 B81C 00						.BYTE $00
   404 B81D 00						.BYTE $00
   404 B81E 00						.BYTE $00
   404 B81F 00						.BYTE $00
   404 B820 00						.BYTE $00
   404 B821 00						.BYTE $00
   404 B822 00						.BYTE $00
   404 B823 00						.BYTE $00
   404 B824 00						.BYTE $00
   404 B825 00						.BYTE $00
   404 B826 00						.BYTE $00
   404 B827 00						.BYTE $00
   404 B828 00						.BYTE $00
   404 B829 00						.BYTE $00
   404 B82A 00						.BYTE $00
   404 B82B 00						.BYTE $00
   404 B82C 00						.BYTE $00
   404 B82D 00						.BYTE $00
   404 B82E 00						.BYTE $00
   404 B82F 00						.BYTE $00
   404 B830 00						.BYTE $00
   404 B831 00						.BYTE $00
   404 B832 00						.BYTE $00
   404 B833 00						.BYTE $00
   404 B834 00						.BYTE $00
   404 B835 00						.BYTE $00
   404 B836 00						.BYTE $00
   404 B837 00						.BYTE $00
   404 B838 00						.BYTE $00
   404 B839 00						.BYTE $00
   404 B83A 00						.BYTE $00
   404 B83B 00						.BYTE $00
   404 B83C 00						.BYTE $00
   404 B83D 00						.BYTE $00
   404 B83E 00						.BYTE $00
   404 B83F 00						.BYTE $00
   404 B840 00						.BYTE $00
   404 B841 00						.BYTE $00
   404 B842 00						.BYTE $00
   404 B843 00						.BYTE $00
   404 B844 00						.BYTE $00
   404 B845 00						.BYTE $00
   404 B846 00						.BYTE $00
   404 B847 00						.BYTE $00
   404 B848 00						.BYTE $00
   404 B849 00						.BYTE $00
   404 B84A 00						.BYTE $00
   404 B84B 00						.BYTE $00
   404 B84C 00						.BYTE $00
   404 B84D 00						.BYTE $00
   404 B84E 00						.BYTE $00
   404 B84F 00						.BYTE $00
   404 B850 00						.BYTE $00
   404 B851 00						.BYTE $00
   404 B852 00						.BYTE $00
   404 B853 00						.BYTE $00
   404 B854 00						.BYTE $00
   404 B855 00						.BYTE $00
   404 B856 00						.BYTE $00
   404 B857 00						.BYTE $00
   404 B858 00						.BYTE $00
   404 B859 00						.BYTE $00
   404 B85A 00						.BYTE $00
   404 B85B 00						.BYTE $00
   404 B85C 00						.BYTE $00
   404 B85D 00						.BYTE $00
   404 B85E 00						.BYTE $00
   404 B85F 00						.BYTE $00
   404 B860 00						.BYTE $00
   404 B861 00						.BYTE $00
   404 B862 00						.BYTE $00
   404 B863 00						.BYTE $00
   404 B864 00						.BYTE $00
   404 B865 00						.BYTE $00
   404 B866 00						.BYTE $00
   404 B867 00						.BYTE $00
   404 B868 00						.BYTE $00
   404 B869 00						.BYTE $00
   404 B86A 00						.BYTE $00
   404 B86B 00						.BYTE $00
   404 B86C 00						.BYTE $00
   404 B86D 00						.BYTE $00
   404 B86E 00						.BYTE $00
   404 B86F 00						.BYTE $00
   404 B870 00						.BYTE $00
   404 B871 00						.BYTE $00
   404 B872 00						.BYTE $00
   404 B873 00						.BYTE $00
   404 B874 00						.BYTE $00
   404 B875 00						.BYTE $00
   404 B876 00						.BYTE $00
   404 B877 00						.BYTE $00
   404 B878 00						.BYTE $00
   404 B879 00						.BYTE $00
   404 B87A 00						.BYTE $00
   404 B87B 00						.BYTE $00
   404 B87C 00						.BYTE $00
   404 B87D 00						.BYTE $00
   404 B87E 00						.BYTE $00
   404 B87F 00						.BYTE $00
   404 B880 00						.BYTE $00
   404 B881 00						.BYTE $00
   404 B882 00						.BYTE $00
   404 B883 00						.BYTE $00
   404 B884 00						.BYTE $00
   404 B885 00						.BYTE $00
   404 B886 00						.BYTE $00
   404 B887 00						.BYTE $00
   404 B888 00						.BYTE $00
   404 B889 00						.BYTE $00
   404 B88A 00						.BYTE $00
   404 B88B 00						.BYTE $00
   404 B88C 00						.BYTE $00
   404 B88D 00						.BYTE $00
   404 B88E 00						.BYTE $00
   404 B88F 00						.BYTE $00
   404 B890 00						.BYTE $00
   404 B891 00						.BYTE $00
   404 B892 00						.BYTE $00
   404 B893 00						.BYTE $00
   404 B894 00						.BYTE $00
   404 B895 00						.BYTE $00
   404 B896 00						.BYTE $00
   404 B897 00						.BYTE $00
   404 B898 00						.BYTE $00
   404 B899 00						.BYTE $00
   404 B89A 00						.BYTE $00
   404 B89B 00						.BYTE $00
   404 B89C 00						.BYTE $00
   404 B89D 00						.BYTE $00
   404 B89E 00						.BYTE $00
   404 B89F 00						.BYTE $00
   404 B8A0 00						.BYTE $00
   404 B8A1 00						.BYTE $00
   404 B8A2 00						.BYTE $00
   404 B8A3 00						.BYTE $00
   404 B8A4 00						.BYTE $00
   404 B8A5 00						.BYTE $00
   404 B8A6 00						.BYTE $00
   404 B8A7 00						.BYTE $00
   404 B8A8 00						.BYTE $00
   404 B8A9 00						.BYTE $00
   404 B8AA 00						.BYTE $00
   404 B8AB 00						.BYTE $00
   404 B8AC 00						.BYTE $00
   404 B8AD 00						.BYTE $00
   404 B8AE 00						.BYTE $00
   404 B8AF 00						.BYTE $00
   404 B8B0 00						.BYTE $00
   404 B8B1 00						.BYTE $00
   404 B8B2 00						.BYTE $00
   404 B8B3 00						.BYTE $00
   404 B8B4 00						.BYTE $00
   404 B8B5 00						.BYTE $00
   404 B8B6 00						.BYTE $00
   404 B8B7 00						.BYTE $00
   404 B8B8 00						.BYTE $00
   404 B8B9 00						.BYTE $00
   404 B8BA 00						.BYTE $00
   404 B8BB 00						.BYTE $00
   404 B8BC 00						.BYTE $00
   404 B8BD 00						.BYTE $00
   404 B8BE 00						.BYTE $00
   404 B8BF 00						.BYTE $00
   404 B8C0 00						.BYTE $00
   404 B8C1 00						.BYTE $00
   404 B8C2 00						.BYTE $00
   404 B8C3 00						.BYTE $00
   404 B8C4 00						.BYTE $00
   404 B8C5 00						.BYTE $00
   404 B8C6 00						.BYTE $00
   404 B8C7 00						.BYTE $00
   404 B8C8 00						.BYTE $00
   404 B8C9 00						.BYTE $00
   404 B8CA 00						.BYTE $00
   404 B8CB 00						.BYTE $00
   404 B8CC 00						.BYTE $00
   404 B8CD 00						.BYTE $00
   404 B8CE 00						.BYTE $00
   404 B8CF 00						.BYTE $00
   404 B8D0 00						.BYTE $00
   404 B8D1 00						.BYTE $00
   404 B8D2 00						.BYTE $00
   404 B8D3 00						.BYTE $00
   404 B8D4 00						.BYTE $00
   404 B8D5 00						.BYTE $00
   404 B8D6 00						.BYTE $00
   404 B8D7 00						.BYTE $00
   404 B8D8 00						.BYTE $00
   404 B8D9 00						.BYTE $00
   404 B8DA 00						.BYTE $00
   404 B8DB 00						.BYTE $00
   404 B8DC 00						.BYTE $00
   404 B8DD 00						.BYTE $00
   404 B8DE 00						.BYTE $00
   404 B8DF 00						.BYTE $00
   404 B8E0 00						.BYTE $00
   404 B8E1 00						.BYTE $00
   404 B8E2 00						.BYTE $00
   404 B8E3 00						.BYTE $00
   404 B8E4 00						.BYTE $00
   404 B8E5 00						.BYTE $00
   404 B8E6 00						.BYTE $00
   404 B8E7 00						.BYTE $00
   404 B8E8 00						.BYTE $00
   404 B8E9 00						.BYTE $00
   404 B8EA 00						.BYTE $00
   404 B8EB 00						.BYTE $00
   404 B8EC 00						.BYTE $00
   404 B8ED 00						.BYTE $00
   404 B8EE 00						.BYTE $00
   404 B8EF 00						.BYTE $00
   404 B8F0 00						.BYTE $00
   404 B8F1 00						.BYTE $00
   404 B8F2 00						.BYTE $00
   404 B8F3 00						.BYTE $00
   404 B8F4 00						.BYTE $00
   404 B8F5 00						.BYTE $00
   404 B8F6 00						.BYTE $00
   404 B8F7 00						.BYTE $00
   404 B8F8 00						.BYTE $00
   404 B8F9 00						.BYTE $00
   404 B8FA 00						.BYTE $00
   404 B8FB 00						.BYTE $00
   404 B8FC 00						.BYTE $00
   404 B8FD 00						.BYTE $00
   404 B8FE 00						.BYTE $00
   404 B8FF 00						.BYTE $00
   404 B900 00						.BYTE $00
   404 B901 00						.BYTE $00
   404 B902 00						.BYTE $00
   404 B903 00						.BYTE $00
   404 B904 00						.BYTE $00
   404 B905 00						.BYTE $00
   404 B906 00						.BYTE $00
   404 B907 00						.BYTE $00
   404 B908 00						.BYTE $00
   404 B909 00						.BYTE $00
   404 B90A 00						.BYTE $00
   404 B90B 00						.BYTE $00
   404 B90C 00						.BYTE $00
   404 B90D 00						.BYTE $00
   404 B90E 00						.BYTE $00
   404 B90F 00						.BYTE $00
   404 B910 00						.BYTE $00
   404 B911 00						.BYTE $00
   404 B912 00						.BYTE $00
   404 B913 00						.BYTE $00
   404 B914 00						.BYTE $00
   404 B915 00						.BYTE $00
   404 B916 00						.BYTE $00
   404 B917 00						.BYTE $00
   404 B918 00						.BYTE $00
   404 B919 00						.BYTE $00
   404 B91A 00						.BYTE $00
   404 B91B 00						.BYTE $00
   404 B91C 00						.BYTE $00
   404 B91D 00						.BYTE $00
   404 B91E 00						.BYTE $00
   404 B91F 00						.BYTE $00
   404 B920 00						.BYTE $00
   404 B921 00						.BYTE $00
   404 B922 00						.BYTE $00
   404 B923 00						.BYTE $00
   404 B924 00						.BYTE $00
   404 B925 00						.BYTE $00
   404 B926 00						.BYTE $00
   404 B927 00						.BYTE $00
   404 B928 00						.BYTE $00
   404 B929 00						.BYTE $00
   404 B92A 00						.BYTE $00
   404 B92B 00						.BYTE $00
   404 B92C 00						.BYTE $00
   404 B92D 00						.BYTE $00
   404 B92E 00						.BYTE $00
   404 B92F 00						.BYTE $00
   404 B930 00						.BYTE $00
   404 B931 00						.BYTE $00
   404 B932 00						.BYTE $00
   404 B933 00						.BYTE $00
   404 B934 00						.BYTE $00
   404 B935 00						.BYTE $00
   404 B936 00						.BYTE $00
   404 B937 00						.BYTE $00
   404 B938 00						.BYTE $00
   404 B939 00						.BYTE $00
   404 B93A 00						.BYTE $00
   404 B93B 00						.BYTE $00
   404 B93C 00						.BYTE $00
   404 B93D 00						.BYTE $00
   404 B93E 00						.BYTE $00
   404 B93F 00						.BYTE $00
   404 B940 00						.BYTE $00
   404 B941 00						.BYTE $00
   404 B942 00						.BYTE $00
   404 B943 00						.BYTE $00
   404 B944 00						.BYTE $00
   404 B945 00						.BYTE $00
   404 B946 00						.BYTE $00
   404 B947 00						.BYTE $00
   404 B948 00						.BYTE $00
   404 B949 00						.BYTE $00
   404 B94A 00						.BYTE $00
   404 B94B 00						.BYTE $00
   404 B94C 00						.BYTE $00
   404 B94D 00						.BYTE $00
   404 B94E 00						.BYTE $00
   404 B94F 00						.BYTE $00
   404 B950 00						.BYTE $00
   404 B951 00						.BYTE $00
   404 B952 00						.BYTE $00
   404 B953 00						.BYTE $00
   404 B954 00						.BYTE $00
   404 B955 00						.BYTE $00
   404 B956 00						.BYTE $00
   404 B957 00						.BYTE $00
   404 B958 00						.BYTE $00
   404 B959 00						.BYTE $00
   404 B95A 00						.BYTE $00
   404 B95B 00						.BYTE $00
   404 B95C 00						.BYTE $00
   404 B95D 00						.BYTE $00
   404 B95E 00						.BYTE $00
   404 B95F 00						.BYTE $00
   404 B960 00						.BYTE $00
   404 B961 00						.BYTE $00
   404 B962 00						.BYTE $00
   404 B963 00						.BYTE $00
   404 B964 00						.BYTE $00
   404 B965 00						.BYTE $00
   404 B966 00						.BYTE $00
   404 B967 00						.BYTE $00
   404 B968 00						.BYTE $00
   404 B969 00						.BYTE $00
   404 B96A 00						.BYTE $00
   404 B96B 00						.BYTE $00
   404 B96C 00						.BYTE $00
   404 B96D 00						.BYTE $00
   404 B96E 00						.BYTE $00
   404 B96F 00						.BYTE $00
   404 B970 00						.BYTE $00
   404 B971 00						.BYTE $00
   404 B972 00						.BYTE $00
   404 B973 00						.BYTE $00
   404 B974 00						.BYTE $00
   404 B975 00						.BYTE $00
   404 B976 00						.BYTE $00
   404 B977 00						.BYTE $00
   404 B978 00						.BYTE $00
   404 B979 00						.BYTE $00
   404 B97A 00						.BYTE $00
   404 B97B 00						.BYTE $00
   404 B97C 00						.BYTE $00
   404 B97D 00						.BYTE $00
   404 B97E 00						.BYTE $00
   404 B97F 00						.BYTE $00
   404 B980 00						.BYTE $00
   404 B981 00						.BYTE $00
   404 B982 00						.BYTE $00
   404 B983 00						.BYTE $00
   404 B984 00						.BYTE $00
   404 B985 00						.BYTE $00
   404 B986 00						.BYTE $00
   404 B987 00						.BYTE $00
   404 B988 00						.BYTE $00
   404 B989 00						.BYTE $00
   404 B98A 00						.BYTE $00
   404 B98B 00						.BYTE $00
   404 B98C 00						.BYTE $00
   404 B98D 00						.BYTE $00
   404 B98E 00						.BYTE $00
   404 B98F 00						.BYTE $00
   404 B990 00						.BYTE $00
   404 B991 00						.BYTE $00
   404 B992 00						.BYTE $00
   404 B993 00						.BYTE $00
   404 B994 00						.BYTE $00
   404 B995 00						.BYTE $00
   404 B996 00						.BYTE $00
   404 B997 00						.BYTE $00
   404 B998 00						.BYTE $00
   404 B999 00						.BYTE $00
   404 B99A 00						.BYTE $00
   404 B99B 00						.BYTE $00
   404 B99C 00						.BYTE $00
   404 B99D 00						.BYTE $00
   404 B99E 00						.BYTE $00
   404 B99F 00						.BYTE $00
   404 B9A0 00						.BYTE $00
   404 B9A1 00						.BYTE $00
   404 B9A2 00						.BYTE $00
   404 B9A3 00						.BYTE $00
   404 B9A4 00						.BYTE $00
   404 B9A5 00						.BYTE $00
   404 B9A6 00						.BYTE $00
   404 B9A7 00						.BYTE $00
   404 B9A8 00						.BYTE $00
   404 B9A9 00						.BYTE $00
   404 B9AA 00						.BYTE $00
   404 B9AB 00						.BYTE $00
   404 B9AC 00						.BYTE $00
   404 B9AD 00						.BYTE $00
   404 B9AE 00						.BYTE $00
   404 B9AF 00						.BYTE $00
   404 B9B0 00						.BYTE $00
   404 B9B1 00						.BYTE $00
   404 B9B2 00						.BYTE $00
   404 B9B3 00						.BYTE $00
   404 B9B4 00						.BYTE $00
   404 B9B5 00						.BYTE $00
   404 B9B6 00						.BYTE $00
   404 B9B7 00						.BYTE $00
   404 B9B8 00						.BYTE $00
   404 B9B9 00						.BYTE $00
   404 B9BA 00						.BYTE $00
   404 B9BB 00						.BYTE $00
   404 B9BC 00						.BYTE $00
   404 B9BD 00						.BYTE $00
   404 B9BE 00						.BYTE $00
   404 B9BF 00						.BYTE $00
   404 B9C0 00						.BYTE $00
   404 B9C1 00						.BYTE $00
   404 B9C2 00						.BYTE $00
   404 B9C3 00						.BYTE $00
   404 B9C4 00						.BYTE $00
   404 B9C5 00						.BYTE $00
   404 B9C6 00						.BYTE $00
   404 B9C7 00						.BYTE $00
   404 B9C8 00						.BYTE $00
   404 B9C9 00						.BYTE $00
   404 B9CA 00						.BYTE $00
   404 B9CB 00						.BYTE $00
   404 B9CC 00						.BYTE $00
   404 B9CD 00						.BYTE $00
   404 B9CE 00						.BYTE $00
   404 B9CF 00						.BYTE $00
   404 B9D0 00						.BYTE $00
   404 B9D1 00						.BYTE $00
   404 B9D2 00						.BYTE $00
   404 B9D3 00						.BYTE $00
   404 B9D4 00						.BYTE $00
   404 B9D5 00						.BYTE $00
   404 B9D6 00						.BYTE $00
   404 B9D7 00						.BYTE $00
   404 B9D8 00						.BYTE $00
   404 B9D9 00						.BYTE $00
   404 B9DA 00						.BYTE $00
   404 B9DB 00						.BYTE $00
   404 B9DC 00						.BYTE $00
   404 B9DD 00						.BYTE $00
   404 B9DE 00						.BYTE $00
   404 B9DF 00						.BYTE $00
   404 B9E0 00						.BYTE $00
   404 B9E1 00						.BYTE $00
   404 B9E2 00						.BYTE $00
   404 B9E3 00						.BYTE $00
   404 B9E4 00						.BYTE $00
   404 B9E5 00						.BYTE $00
   404 B9E6 00						.BYTE $00
   404 B9E7 00						.BYTE $00
   404 B9E8 00						.BYTE $00
   404 B9E9 00						.BYTE $00
   404 B9EA 00						.BYTE $00
   404 B9EB 00						.BYTE $00
   404 B9EC 00						.BYTE $00
   404 B9ED 00						.BYTE $00
   404 B9EE 00						.BYTE $00
   404 B9EF 00						.BYTE $00
   404 B9F0 00						.BYTE $00
   404 B9F1 00						.BYTE $00
   404 B9F2 00						.BYTE $00
   404 B9F3 00						.BYTE $00
   404 B9F4 00						.BYTE $00
   404 B9F5 00						.BYTE $00
   404 B9F6 00						.BYTE $00
   404 B9F7 00						.BYTE $00
   404 B9F8 00						.BYTE $00
   404 B9F9 00						.BYTE $00
   404 B9FA 00						.BYTE $00
   404 B9FB 00						.BYTE $00
   404 B9FC 00						.BYTE $00
   404 B9FD 00						.BYTE $00
   404 B9FE 00						.BYTE $00
   404 B9FF 00						.BYTE $00
   404 BA00 00						.BYTE $00
   404 BA01 00						.BYTE $00
   404 BA02 00						.BYTE $00
   404 BA03 00						.BYTE $00
   404 BA04 00						.BYTE $00
   404 BA05 00						.BYTE $00
   404 BA06 00						.BYTE $00
   404 BA07 00						.BYTE $00
   404 BA08 00						.BYTE $00
   404 BA09 00						.BYTE $00
   404 BA0A 00						.BYTE $00
   404 BA0B 00						.BYTE $00
   404 BA0C 00						.BYTE $00
   404 BA0D 00						.BYTE $00
   404 BA0E 00						.BYTE $00
   404 BA0F 00						.BYTE $00
   404 BA10 00						.BYTE $00
   404 BA11 00						.BYTE $00
   404 BA12 00						.BYTE $00
   404 BA13 00						.BYTE $00
   404 BA14 00						.BYTE $00
   404 BA15 00						.BYTE $00
   404 BA16 00						.BYTE $00
   404 BA17 00						.BYTE $00
   404 BA18 00						.BYTE $00
   404 BA19 00						.BYTE $00
   404 BA1A 00						.BYTE $00
   404 BA1B 00						.BYTE $00
   404 BA1C 00						.BYTE $00
   404 BA1D 00						.BYTE $00
   404 BA1E 00						.BYTE $00
   404 BA1F 00						.BYTE $00
   404 BA20 00						.BYTE $00
   404 BA21 00						.BYTE $00
   404 BA22 00						.BYTE $00
   404 BA23 00						.BYTE $00
   404 BA24 00						.BYTE $00
   404 BA25 00						.BYTE $00
   404 BA26 00						.BYTE $00
   404 BA27 00						.BYTE $00
   404 BA28 00						.BYTE $00
   404 BA29 00						.BYTE $00
   404 BA2A 00						.BYTE $00
   404 BA2B 00						.BYTE $00
   404 BA2C 00						.BYTE $00
   404 BA2D 00						.BYTE $00
   404 BA2E 00						.BYTE $00
   404 BA2F 00						.BYTE $00
   404 BA30 00						.BYTE $00
   404 BA31 00						.BYTE $00
   404 BA32 00						.BYTE $00
   404 BA33 00						.BYTE $00
   404 BA34 00						.BYTE $00
   404 BA35 00						.BYTE $00
   404 BA36 00						.BYTE $00
   404 BA37 00						.BYTE $00
   404 BA38 00						.BYTE $00
   404 BA39 00						.BYTE $00
   404 BA3A 00						.BYTE $00
   404 BA3B 00						.BYTE $00
   404 BA3C 00						.BYTE $00
   404 BA3D 00						.BYTE $00
   404 BA3E 00						.BYTE $00
   404 BA3F 00						.BYTE $00
   404 BA40 00						.BYTE $00
   404 BA41 00						.BYTE $00
   404 BA42 00						.BYTE $00
   404 BA43 00						.BYTE $00
   404 BA44 00						.BYTE $00
   404 BA45 00						.BYTE $00
   404 BA46 00						.BYTE $00
   404 BA47 00						.BYTE $00
   404 BA48 00						.BYTE $00
   404 BA49 00						.BYTE $00
   404 BA4A 00						.BYTE $00
   404 BA4B 00						.BYTE $00
   404 BA4C 00						.BYTE $00
   404 BA4D 00						.BYTE $00
   404 BA4E 00						.BYTE $00
   404 BA4F 00						.BYTE $00
   404 BA50 00						.BYTE $00
   404 BA51 00						.BYTE $00
   404 BA52 00						.BYTE $00
   404 BA53 00						.BYTE $00
   404 BA54 00						.BYTE $00
   404 BA55 00						.BYTE $00
   404 BA56 00						.BYTE $00
   404 BA57 00						.BYTE $00
   404 BA58 00						.BYTE $00
   404 BA59 00						.BYTE $00
   404 BA5A 00						.BYTE $00
   404 BA5B 00						.BYTE $00
   404 BA5C 00						.BYTE $00
   404 BA5D 00						.BYTE $00
   404 BA5E 00						.BYTE $00
   404 BA5F 00						.BYTE $00
   404 BA60 00						.BYTE $00
   404 BA61 00						.BYTE $00
   404 BA62 00						.BYTE $00
   404 BA63 00						.BYTE $00
   404 BA64 00						.BYTE $00
   404 BA65 00						.BYTE $00
   404 BA66 00						.BYTE $00
   404 BA67 00						.BYTE $00
   404 BA68 00						.BYTE $00
   404 BA69 00						.BYTE $00
   404 BA6A 00						.BYTE $00
   404 BA6B 00						.BYTE $00
   404 BA6C 00						.BYTE $00
   404 BA6D 00						.BYTE $00
   404 BA6E 00						.BYTE $00
   404 BA6F 00						.BYTE $00
   404 BA70 00						.BYTE $00
   404 BA71 00						.BYTE $00
   404 BA72 00						.BYTE $00
   404 BA73 00						.BYTE $00
   404 BA74 00						.BYTE $00
   404 BA75 00						.BYTE $00
   404 BA76 00						.BYTE $00
   404 BA77 00						.BYTE $00
   404 BA78 00						.BYTE $00
   404 BA79 00						.BYTE $00
   404 BA7A 00						.BYTE $00
   404 BA7B 00						.BYTE $00
   404 BA7C 00						.BYTE $00
   404 BA7D 00						.BYTE $00
   404 BA7E 00						.BYTE $00
   404 BA7F 00						.BYTE $00
   404 BA80 00						.BYTE $00
   404 BA81 00						.BYTE $00
   404 BA82 00						.BYTE $00
   404 BA83 00						.BYTE $00
   404 BA84 00						.BYTE $00
   404 BA85 00						.BYTE $00
   404 BA86 00						.BYTE $00
   404 BA87 00						.BYTE $00
   404 BA88 00						.BYTE $00
   404 BA89 00						.BYTE $00
   404 BA8A 00						.BYTE $00
   404 BA8B 00						.BYTE $00
   404 BA8C 00						.BYTE $00
   404 BA8D 00						.BYTE $00
   404 BA8E 00						.BYTE $00
   404 BA8F 00						.BYTE $00
   404 BA90 00						.BYTE $00
   404 BA91 00						.BYTE $00
   404 BA92 00						.BYTE $00
   404 BA93 00						.BYTE $00
   404 BA94 00						.BYTE $00
   404 BA95 00						.BYTE $00
   404 BA96 00						.BYTE $00
   404 BA97 00						.BYTE $00
   404 BA98 00						.BYTE $00
   404 BA99 00						.BYTE $00
   404 BA9A 00						.BYTE $00
   404 BA9B 00						.BYTE $00
   404 BA9C 00						.BYTE $00
   404 BA9D 00						.BYTE $00
   404 BA9E 00						.BYTE $00
   404 BA9F 00						.BYTE $00
   404 BAA0 00						.BYTE $00
   404 BAA1 00						.BYTE $00
   404 BAA2 00						.BYTE $00
   404 BAA3 00						.BYTE $00
   404 BAA4 00						.BYTE $00
   404 BAA5 00						.BYTE $00
   404 BAA6 00						.BYTE $00
   404 BAA7 00						.BYTE $00
   404 BAA8 00						.BYTE $00
   404 BAA9 00						.BYTE $00
   404 BAAA 00						.BYTE $00
   404 BAAB 00						.BYTE $00
   404 BAAC 00						.BYTE $00
   404 BAAD 00						.BYTE $00
   404 BAAE 00						.BYTE $00
   404 BAAF 00						.BYTE $00
   404 BAB0 00						.BYTE $00
   404 BAB1 00						.BYTE $00
   404 BAB2 00						.BYTE $00
   404 BAB3 00						.BYTE $00
   404 BAB4 00						.BYTE $00
   404 BAB5 00						.BYTE $00
   404 BAB6 00						.BYTE $00
   404 BAB7 00						.BYTE $00
   404 BAB8 00						.BYTE $00
   404 BAB9 00						.BYTE $00
   404 BABA 00						.BYTE $00
   404 BABB 00						.BYTE $00
   404 BABC 00						.BYTE $00
   404 BABD 00						.BYTE $00
   404 BABE 00						.BYTE $00
   404 BABF 00						.BYTE $00
   404 BAC0 00						.BYTE $00
   404 BAC1 00						.BYTE $00
   404 BAC2 00						.BYTE $00
   404 BAC3 00						.BYTE $00
   404 BAC4 00						.BYTE $00
   404 BAC5 00						.BYTE $00
   404 BAC6 00						.BYTE $00
   404 BAC7 00						.BYTE $00
   404 BAC8 00						.BYTE $00
   404 BAC9 00						.BYTE $00
   404 BACA 00						.BYTE $00
   404 BACB 00						.BYTE $00
   404 BACC 00						.BYTE $00
   404 BACD 00						.BYTE $00
   404 BACE 00						.BYTE $00
   404 BACF 00						.BYTE $00
   404 BAD0 00						.BYTE $00
   404 BAD1 00						.BYTE $00
   404 BAD2 00						.BYTE $00
   404 BAD3 00						.BYTE $00
   404 BAD4 00						.BYTE $00
   404 BAD5 00						.BYTE $00
   404 BAD6 00						.BYTE $00
   404 BAD7 00						.BYTE $00
   404 BAD8 00						.BYTE $00
   404 BAD9 00						.BYTE $00
   404 BADA 00						.BYTE $00
   404 BADB 00						.BYTE $00
   404 BADC 00						.BYTE $00
   404 BADD 00						.BYTE $00
   404 BADE 00						.BYTE $00
   404 BADF 00						.BYTE $00
   404 BAE0 00						.BYTE $00
   404 BAE1 00						.BYTE $00
   404 BAE2 00						.BYTE $00
   404 BAE3 00						.BYTE $00
   404 BAE4 00						.BYTE $00
   404 BAE5 00						.BYTE $00
   404 BAE6 00						.BYTE $00
   404 BAE7 00						.BYTE $00
   404 BAE8 00						.BYTE $00
   404 BAE9 00						.BYTE $00
   404 BAEA 00						.BYTE $00
   404 BAEB 00						.BYTE $00
   404 BAEC 00						.BYTE $00
   404 BAED 00						.BYTE $00
   404 BAEE 00						.BYTE $00
   404 BAEF 00						.BYTE $00
   404 BAF0 00						.BYTE $00
   404 BAF1 00						.BYTE $00
   404 BAF2 00						.BYTE $00
   404 BAF3 00						.BYTE $00
   404 BAF4 00						.BYTE $00
   404 BAF5 00						.BYTE $00
   404 BAF6 00						.BYTE $00
   404 BAF7 00						.BYTE $00
   404 BAF8 00						.BYTE $00
   404 BAF9 00						.BYTE $00
   404 BAFA 00						.BYTE $00
   404 BAFB 00						.BYTE $00
   404 BAFC 00						.BYTE $00
   404 BAFD 00						.BYTE $00
   404 BAFE 00						.BYTE $00
   404 BAFF 00						.BYTE $00
   404 BB00 00						.BYTE $00
   404 BB01 00						.BYTE $00
   404 BB02 00						.BYTE $00
   404 BB03 00						.BYTE $00
   404 BB04 00						.BYTE $00
   404 BB05 00						.BYTE $00
   404 BB06 00						.BYTE $00
   404 BB07 00						.BYTE $00
   404 BB08 00						.BYTE $00
   404 BB09 00						.BYTE $00
   404 BB0A 00						.BYTE $00
   404 BB0B 00						.BYTE $00
   404 BB0C 00						.BYTE $00
   404 BB0D 00						.BYTE $00
   404 BB0E 00						.BYTE $00
   404 BB0F 00						.BYTE $00
   404 BB10 00						.BYTE $00
   404 BB11 00						.BYTE $00
   404 BB12 00						.BYTE $00
   404 BB13 00						.BYTE $00
   404 BB14 00						.BYTE $00
   404 BB15 00						.BYTE $00
   404 BB16 00						.BYTE $00
   404 BB17 00						.BYTE $00
   404 BB18 00						.BYTE $00
   404 BB19 00						.BYTE $00
   404 BB1A 00						.BYTE $00
   404 BB1B 00						.BYTE $00
   404 BB1C 00						.BYTE $00
   404 BB1D 00						.BYTE $00
   404 BB1E 00						.BYTE $00
   404 BB1F 00						.BYTE $00
   404 BB20 00						.BYTE $00
   404 BB21 00						.BYTE $00
   404 BB22 00						.BYTE $00
   404 BB23 00						.BYTE $00
   404 BB24 00						.BYTE $00
   404 BB25 00						.BYTE $00
   404 BB26 00						.BYTE $00
   404 BB27 00						.BYTE $00
   404 BB28 00						.BYTE $00
   404 BB29 00						.BYTE $00
   404 BB2A 00						.BYTE $00
   404 BB2B 00						.BYTE $00
   404 BB2C 00						.BYTE $00
   404 BB2D 00						.BYTE $00
   404 BB2E 00						.BYTE $00
   404 BB2F 00						.BYTE $00
   404 BB30 00						.BYTE $00
   404 BB31 00						.BYTE $00
   404 BB32 00						.BYTE $00
   404 BB33 00						.BYTE $00
   404 BB34 00						.BYTE $00
   404 BB35 00						.BYTE $00
   404 BB36 00						.BYTE $00
   404 BB37 00						.BYTE $00
   404 BB38 00						.BYTE $00
   404 BB39 00						.BYTE $00
   404 BB3A 00						.BYTE $00
   404 BB3B 00						.BYTE $00
   404 BB3C 00						.BYTE $00
   404 BB3D 00						.BYTE $00
   404 BB3E 00						.BYTE $00
   404 BB3F 00						.BYTE $00
   404 BB40 00						.BYTE $00
   404 BB41 00						.BYTE $00
   404 BB42 00						.BYTE $00
   404 BB43 00						.BYTE $00
   404 BB44 00						.BYTE $00
   404 BB45 00						.BYTE $00
   404 BB46 00						.BYTE $00
   404 BB47 00						.BYTE $00
   404 BB48 00						.BYTE $00
   404 BB49 00						.BYTE $00
   404 BB4A 00						.BYTE $00
   404 BB4B 00						.BYTE $00
   404 BB4C 00						.BYTE $00
   404 BB4D 00						.BYTE $00
   404 BB4E 00						.BYTE $00
   404 BB4F 00						.BYTE $00
   404 BB50 00						.BYTE $00
   404 BB51 00						.BYTE $00
   404 BB52 00						.BYTE $00
   404 BB53 00						.BYTE $00
   404 BB54 00						.BYTE $00
   404 BB55 00						.BYTE $00
   404 BB56 00						.BYTE $00
   404 BB57 00						.BYTE $00
   404 BB58 00						.BYTE $00
   404 BB59 00						.BYTE $00
   404 BB5A 00						.BYTE $00
   404 BB5B 00						.BYTE $00
   404 BB5C 00						.BYTE $00
   404 BB5D 00						.BYTE $00
   404 BB5E 00						.BYTE $00
   404 BB5F 00						.BYTE $00
   404 BB60 00						.BYTE $00
   404 BB61 00						.BYTE $00
   404 BB62 00						.BYTE $00
   404 BB63 00						.BYTE $00
   404 BB64 00						.BYTE $00
   404 BB65 00						.BYTE $00
   404 BB66 00						.BYTE $00
   404 BB67 00						.BYTE $00
   404 BB68 00						.BYTE $00
   404 BB69 00						.BYTE $00
   404 BB6A 00						.BYTE $00
   404 BB6B 00						.BYTE $00
   404 BB6C 00						.BYTE $00
   404 BB6D 00						.BYTE $00
   404 BB6E 00						.BYTE $00
   404 BB6F 00						.BYTE $00
   404 BB70 00						.BYTE $00
   404 BB71 00						.BYTE $00
   404 BB72 00						.BYTE $00
   404 BB73 00						.BYTE $00
   404 BB74 00						.BYTE $00
   404 BB75 00						.BYTE $00
   404 BB76 00						.BYTE $00
   404 BB77 00						.BYTE $00
   404 BB78 00						.BYTE $00
   404 BB79 00						.BYTE $00
   404 BB7A 00						.BYTE $00
   404 BB7B 00						.BYTE $00
   404 BB7C 00						.BYTE $00
   404 BB7D 00						.BYTE $00
   404 BB7E 00						.BYTE $00
   404 BB7F 00						.BYTE $00
   404 BB80 00						.BYTE $00
   404 BB81 00						.BYTE $00
   404 BB82 00						.BYTE $00
   404 BB83 00						.BYTE $00
   404 BB84 00						.BYTE $00
   404 BB85 00						.BYTE $00
   404 BB86 00						.BYTE $00
   404 BB87 00						.BYTE $00
   404 BB88 00						.BYTE $00
   404 BB89 00						.BYTE $00
   404 BB8A 00						.BYTE $00
   404 BB8B 00						.BYTE $00
   404 BB8C 00						.BYTE $00
   404 BB8D 00						.BYTE $00
   404 BB8E 00						.BYTE $00
   404 BB8F 00						.BYTE $00
   404 BB90 00						.BYTE $00
   404 BB91 00						.BYTE $00
   404 BB92 00						.BYTE $00
   404 BB93 00						.BYTE $00
   404 BB94 00						.BYTE $00
   404 BB95 00						.BYTE $00
   404 BB96 00						.BYTE $00
   404 BB97 00						.BYTE $00
   404 BB98 00						.BYTE $00
   404 BB99 00						.BYTE $00
   404 BB9A 00						.BYTE $00
   404 BB9B 00						.BYTE $00
   404 BB9C 00						.BYTE $00
   404 BB9D 00						.BYTE $00
   404 BB9E 00						.BYTE $00
   404 BB9F 00						.BYTE $00
   404 BBA0 00						.BYTE $00
   404 BBA1 00						.BYTE $00
   404 BBA2 00						.BYTE $00
   404 BBA3 00						.BYTE $00
   404 BBA4 00						.BYTE $00
   404 BBA5 00						.BYTE $00
   404 BBA6 00						.BYTE $00
   404 BBA7 00						.BYTE $00
   404 BBA8 00						.BYTE $00
   404 BBA9 00						.BYTE $00
   404 BBAA 00						.BYTE $00
   404 BBAB 00						.BYTE $00
   404 BBAC 00						.BYTE $00
   404 BBAD 00						.BYTE $00
   404 BBAE 00						.BYTE $00
   404 BBAF 00						.BYTE $00
   404 BBB0 00						.BYTE $00
   404 BBB1 00						.BYTE $00
   404 BBB2 00						.BYTE $00
   404 BBB3 00						.BYTE $00
   404 BBB4 00						.BYTE $00
   404 BBB5 00						.BYTE $00
   404 BBB6 00						.BYTE $00
   404 BBB7 00						.BYTE $00
   404 BBB8 00						.BYTE $00
   404 BBB9 00						.BYTE $00
   404 BBBA 00						.BYTE $00
   404 BBBB 00						.BYTE $00
   404 BBBC 00						.BYTE $00
   404 BBBD 00						.BYTE $00
   404 BBBE 00						.BYTE $00
   404 BBBF 00						.BYTE $00
   404 BBC0 00						.BYTE $00
   404 BBC1 00						.BYTE $00
   404 BBC2 00						.BYTE $00
   404 BBC3 00						.BYTE $00
   404 BBC4 00						.BYTE $00
   404 BBC5 00						.BYTE $00
   404 BBC6 00						.BYTE $00
   404 BBC7 00						.BYTE $00
   404 BBC8 00						.BYTE $00
   404 BBC9 00						.BYTE $00
   404 BBCA 00						.BYTE $00
   404 BBCB 00						.BYTE $00
   404 BBCC 00						.BYTE $00
   404 BBCD 00						.BYTE $00
   404 BBCE 00						.BYTE $00
   404 BBCF 00						.BYTE $00
   404 BBD0 00						.BYTE $00
   404 BBD1 00						.BYTE $00
   404 BBD2 00						.BYTE $00
   404 BBD3 00						.BYTE $00
   404 BBD4 00						.BYTE $00
   404 BBD5 00						.BYTE $00
   404 BBD6 00						.BYTE $00
   404 BBD7 00						.BYTE $00
   404 BBD8 00						.BYTE $00
   404 BBD9 00						.BYTE $00
   404 BBDA 00						.BYTE $00
   404 BBDB 00						.BYTE $00
   404 BBDC 00						.BYTE $00
   404 BBDD 00						.BYTE $00
   404 BBDE 00						.BYTE $00
   404 BBDF 00						.BYTE $00
   404 BBE0 00						.BYTE $00
   404 BBE1 00						.BYTE $00
   404 BBE2 00						.BYTE $00
   404 BBE3 00						.BYTE $00
   404 BBE4 00						.BYTE $00
   404 BBE5 00						.BYTE $00
   404 BBE6 00						.BYTE $00
   404 BBE7 00						.BYTE $00
   404 BBE8 00						.BYTE $00
   404 BBE9 00						.BYTE $00
   404 BBEA 00						.BYTE $00
   404 BBEB 00						.BYTE $00
   404 BBEC 00						.BYTE $00
   404 BBED 00						.BYTE $00
   404 BBEE 00						.BYTE $00
   404 BBEF 00						.BYTE $00
   404 BBF0 00						.BYTE $00
   404 BBF1 00						.BYTE $00
   404 BBF2 00						.BYTE $00
   404 BBF3 00						.BYTE $00
   404 BBF4 00						.BYTE $00
   404 BBF5 00						.BYTE $00
   404 BBF6 00						.BYTE $00
   404 BBF7 00						.BYTE $00
   404 BBF8 00						.BYTE $00
   404 BBF9 00						.BYTE $00
   404 BBFA 00						.BYTE $00
   404 BBFB 00						.BYTE $00
   404 BBFC 00						.BYTE $00
   404 BBFD 00						.BYTE $00
   404 BBFE 00						.BYTE $00
   404 BBFF 00						.BYTE $00
   404 BC00 00						.BYTE $00
   404 BC01 00						.BYTE $00
   404 BC02 00						.BYTE $00
   404 BC03 00						.BYTE $00
   404 BC04 00						.BYTE $00
   404 BC05 00						.BYTE $00
   404 BC06 00						.BYTE $00
   404 BC07 00						.BYTE $00
   404 BC08 00						.BYTE $00
   404 BC09 00						.BYTE $00
   404 BC0A 00						.BYTE $00
   404 BC0B 00						.BYTE $00
   404 BC0C 00						.BYTE $00
   404 BC0D 00						.BYTE $00
   404 BC0E 00						.BYTE $00
   404 BC0F 00						.BYTE $00
   404 BC10 00						.BYTE $00
   404 BC11 00						.BYTE $00
   404 BC12 00						.BYTE $00
   404 BC13 00						.BYTE $00
   404 BC14 00						.BYTE $00
   404 BC15 00						.BYTE $00
   404 BC16 00						.BYTE $00
   404 BC17 00						.BYTE $00
   404 BC18 00						.BYTE $00
   404 BC19 00						.BYTE $00
   404 BC1A 00						.BYTE $00
   404 BC1B 00						.BYTE $00
   404 BC1C 00						.BYTE $00
   404 BC1D 00						.BYTE $00
   404 BC1E 00						.BYTE $00
   404 BC1F 00						.BYTE $00
   404 BC20 00						.BYTE $00
   404 BC21 00						.BYTE $00
   404 BC22 00						.BYTE $00
   404 BC23 00						.BYTE $00
   404 BC24 00						.BYTE $00
   404 BC25 00						.BYTE $00
   404 BC26 00						.BYTE $00
   404 BC27 00						.BYTE $00
   404 BC28 00						.BYTE $00
   404 BC29 00						.BYTE $00
   404 BC2A 00						.BYTE $00
   404 BC2B 00						.BYTE $00
   404 BC2C 00						.BYTE $00
   404 BC2D 00						.BYTE $00
   404 BC2E 00						.BYTE $00
   404 BC2F 00						.BYTE $00
   404 BC30 00						.BYTE $00
   404 BC31 00						.BYTE $00
   404 BC32 00						.BYTE $00
   404 BC33 00						.BYTE $00
   404 BC34 00						.BYTE $00
   404 BC35 00						.BYTE $00
   404 BC36 00						.BYTE $00
   404 BC37 00						.BYTE $00
   404 BC38 00						.BYTE $00
   404 BC39 00						.BYTE $00
   404 BC3A 00						.BYTE $00
   404 BC3B 00						.BYTE $00
   404 BC3C 00						.BYTE $00
   404 BC3D 00						.BYTE $00
   404 BC3E 00						.BYTE $00
   404 BC3F 00						.BYTE $00
   404 BC40 00						.BYTE $00
   404 BC41 00						.BYTE $00
   404 BC42 00						.BYTE $00
   404 BC43 00						.BYTE $00
   404 BC44 00						.BYTE $00
   404 BC45 00						.BYTE $00
   404 BC46 00						.BYTE $00
   404 BC47 00						.BYTE $00
   404 BC48 00						.BYTE $00
   404 BC49 00						.BYTE $00
   404 BC4A 00						.BYTE $00
   404 BC4B 00						.BYTE $00
   404 BC4C 00						.BYTE $00
   404 BC4D 00						.BYTE $00
   404 BC4E 00						.BYTE $00
   404 BC4F 00						.BYTE $00
   404 BC50 00						.BYTE $00
   404 BC51 00						.BYTE $00
   404 BC52 00						.BYTE $00
   404 BC53 00						.BYTE $00
   404 BC54 00						.BYTE $00
   404 BC55 00						.BYTE $00
   404 BC56 00						.BYTE $00
   404 BC57 00						.BYTE $00
   404 BC58 00						.BYTE $00
   404 BC59 00						.BYTE $00
   404 BC5A 00						.BYTE $00
   404 BC5B 00						.BYTE $00
   404 BC5C 00						.BYTE $00
   404 BC5D 00						.BYTE $00
   404 BC5E 00						.BYTE $00
   404 BC5F 00						.BYTE $00
   404 BC60 00						.BYTE $00
   404 BC61 00						.BYTE $00
   404 BC62 00						.BYTE $00
   404 BC63 00						.BYTE $00
   404 BC64 00						.BYTE $00
   404 BC65 00						.BYTE $00
   404 BC66 00						.BYTE $00
   404 BC67 00						.BYTE $00
   404 BC68 00						.BYTE $00
   404 BC69 00						.BYTE $00
   404 BC6A 00						.BYTE $00
   404 BC6B 00						.BYTE $00
   404 BC6C 00						.BYTE $00
   404 BC6D 00						.BYTE $00
   404 BC6E 00						.BYTE $00
   404 BC6F 00						.BYTE $00
   404 BC70 00						.BYTE $00
   404 BC71 00						.BYTE $00
   404 BC72 00						.BYTE $00
   404 BC73 00						.BYTE $00
   404 BC74 00						.BYTE $00
   404 BC75 00						.BYTE $00
   404 BC76 00						.BYTE $00
   404 BC77 00						.BYTE $00
   404 BC78 00						.BYTE $00
   404 BC79 00						.BYTE $00
   404 BC7A 00						.BYTE $00
   404 BC7B 00						.BYTE $00
   404 BC7C 00						.BYTE $00
   404 BC7D 00						.BYTE $00
   404 BC7E 00						.BYTE $00
   404 BC7F 00						.BYTE $00
   404 BC80 00						.BYTE $00
   404 BC81 00						.BYTE $00
   404 BC82 00						.BYTE $00
   404 BC83 00						.BYTE $00
   404 BC84 00						.BYTE $00
   404 BC85 00						.BYTE $00
   404 BC86 00						.BYTE $00
   404 BC87 00						.BYTE $00
   404 BC88 00						.BYTE $00
   404 BC89 00						.BYTE $00
   404 BC8A 00						.BYTE $00
   404 BC8B 00						.BYTE $00
   404 BC8C 00						.BYTE $00
   404 BC8D 00						.BYTE $00
   404 BC8E 00						.BYTE $00
   404 BC8F 00						.BYTE $00
   404 BC90 00						.BYTE $00
   404 BC91 00						.BYTE $00
   404 BC92 00						.BYTE $00
   404 BC93 00						.BYTE $00
   404 BC94 00						.BYTE $00
   404 BC95 00						.BYTE $00
   404 BC96 00						.BYTE $00
   404 BC97 00						.BYTE $00
   404 BC98 00						.BYTE $00
   404 BC99 00						.BYTE $00
   404 BC9A 00						.BYTE $00
   404 BC9B 00						.BYTE $00
   404 BC9C 00						.BYTE $00
   404 BC9D 00						.BYTE $00
   404 BC9E 00						.BYTE $00
   404 BC9F 00						.BYTE $00
   404 BCA0 00						.BYTE $00
   404 BCA1 00						.BYTE $00
   404 BCA2 00						.BYTE $00
   404 BCA3 00						.BYTE $00
   404 BCA4 00						.BYTE $00
   404 BCA5 00						.BYTE $00
   404 BCA6 00						.BYTE $00
   404 BCA7 00						.BYTE $00
   404 BCA8 00						.BYTE $00
   404 BCA9 00						.BYTE $00
   404 BCAA 00						.BYTE $00
   404 BCAB 00						.BYTE $00
   404 BCAC 00						.BYTE $00
   404 BCAD 00						.BYTE $00
   404 BCAE 00						.BYTE $00
   404 BCAF 00						.BYTE $00
   404 BCB0 00						.BYTE $00
   404 BCB1 00						.BYTE $00
   404 BCB2 00						.BYTE $00
   404 BCB3 00						.BYTE $00
   404 BCB4 00						.BYTE $00
   404 BCB5 00						.BYTE $00
   404 BCB6 00						.BYTE $00
   404 BCB7 00						.BYTE $00
   404 BCB8 00						.BYTE $00
   404 BCB9 00						.BYTE $00
   404 BCBA 00						.BYTE $00
   404 BCBB 00						.BYTE $00
   404 BCBC 00						.BYTE $00
   404 BCBD 00						.BYTE $00
   404 BCBE 00						.BYTE $00
   404 BCBF 00						.BYTE $00
   404 BCC0 00						.BYTE $00
   404 BCC1 00						.BYTE $00
   404 BCC2 00						.BYTE $00
   404 BCC3 00						.BYTE $00
   404 BCC4 00						.BYTE $00
   404 BCC5 00						.BYTE $00
   404 BCC6 00						.BYTE $00
   404 BCC7 00						.BYTE $00
   404 BCC8 00						.BYTE $00
   404 BCC9 00						.BYTE $00
   404 BCCA 00						.BYTE $00
   404 BCCB 00						.BYTE $00
   404 BCCC 00						.BYTE $00
   404 BCCD 00						.BYTE $00
   404 BCCE 00						.BYTE $00
   404 BCCF 00						.BYTE $00
   404 BCD0 00						.BYTE $00
   404 BCD1 00						.BYTE $00
   404 BCD2 00						.BYTE $00
   404 BCD3 00						.BYTE $00
   404 BCD4 00						.BYTE $00
   404 BCD5 00						.BYTE $00
   404 BCD6 00						.BYTE $00
   404 BCD7 00						.BYTE $00
   404 BCD8 00						.BYTE $00
   404 BCD9 00						.BYTE $00
   404 BCDA 00						.BYTE $00
   404 BCDB 00						.BYTE $00
   404 BCDC 00						.BYTE $00
   404 BCDD 00						.BYTE $00
   404 BCDE 00						.BYTE $00
   404 BCDF 00						.BYTE $00
   404 BCE0 00						.BYTE $00
   404 BCE1 00						.BYTE $00
   404 BCE2 00						.BYTE $00
   404 BCE3 00						.BYTE $00
   404 BCE4 00						.BYTE $00
   404 BCE5 00						.BYTE $00
   404 BCE6 00						.BYTE $00
   404 BCE7 00						.BYTE $00
   404 BCE8 00						.BYTE $00
   404 BCE9 00						.BYTE $00
   404 BCEA 00						.BYTE $00
   404 BCEB 00						.BYTE $00
   404 BCEC 00						.BYTE $00
   404 BCED 00						.BYTE $00
   404 BCEE 00						.BYTE $00
   404 BCEF 00						.BYTE $00
   404 BCF0 00						.BYTE $00
   404 BCF1 00						.BYTE $00
   404 BCF2 00						.BYTE $00
   404 BCF3 00						.BYTE $00
   404 BCF4 00						.BYTE $00
   404 BCF5 00						.BYTE $00
   404 BCF6 00						.BYTE $00
   404 BCF7 00						.BYTE $00
   404 BCF8 00						.BYTE $00
   404 BCF9 00						.BYTE $00
   404 BCFA 00						.BYTE $00
   404 BCFB 00						.BYTE $00
   404 BCFC 00						.BYTE $00
   404 BCFD 00						.BYTE $00
   404 BCFE 00						.BYTE $00
   404 BCFF 00						.BYTE $00
   404 BD00 00						.BYTE $00
   404 BD01 00						.BYTE $00
   404 BD02 00						.BYTE $00
   404 BD03 00						.BYTE $00
   404 BD04 00						.BYTE $00
   404 BD05 00						.BYTE $00
   404 BD06 00						.BYTE $00
   404 BD07 00						.BYTE $00
   404 BD08 00						.BYTE $00
   404 BD09 00						.BYTE $00
   404 BD0A 00						.BYTE $00
   404 BD0B 00						.BYTE $00
   404 BD0C 00						.BYTE $00
   404 BD0D 00						.BYTE $00
   404 BD0E 00						.BYTE $00
   404 BD0F 00						.BYTE $00
   404 BD10 00						.BYTE $00
   404 BD11 00						.BYTE $00
   404 BD12 00						.BYTE $00
   404 BD13 00						.BYTE $00
   404 BD14 00						.BYTE $00
   404 BD15 00						.BYTE $00
   404 BD16 00						.BYTE $00
   404 BD17 00						.BYTE $00
   404 BD18 00						.BYTE $00
   404 BD19 00						.BYTE $00
   404 BD1A 00						.BYTE $00
   404 BD1B 00						.BYTE $00
   404 BD1C 00						.BYTE $00
   404 BD1D 00						.BYTE $00
   404 BD1E 00						.BYTE $00
   404 BD1F 00						.BYTE $00
   404 BD20 00						.BYTE $00
   404 BD21 00						.BYTE $00
   404 BD22 00						.BYTE $00
   404 BD23 00						.BYTE $00
   404 BD24 00						.BYTE $00
   404 BD25 00						.BYTE $00
   404 BD26 00						.BYTE $00
   404 BD27 00						.BYTE $00
   404 BD28 00						.BYTE $00
   404 BD29 00						.BYTE $00
   404 BD2A 00						.BYTE $00
   404 BD2B 00						.BYTE $00
   404 BD2C 00						.BYTE $00
   404 BD2D 00						.BYTE $00
   404 BD2E 00						.BYTE $00
   404 BD2F 00						.BYTE $00
   404 BD30 00						.BYTE $00
   404 BD31 00						.BYTE $00
   404 BD32 00						.BYTE $00
   404 BD33 00						.BYTE $00
   404 BD34 00						.BYTE $00
   404 BD35 00						.BYTE $00
   404 BD36 00						.BYTE $00
   404 BD37 00						.BYTE $00
   404 BD38 00						.BYTE $00
   404 BD39 00						.BYTE $00
   404 BD3A 00						.BYTE $00
   404 BD3B 00						.BYTE $00
   404 BD3C 00						.BYTE $00
   404 BD3D 00						.BYTE $00
   404 BD3E 00						.BYTE $00
   404 BD3F 00						.BYTE $00
   404 BD40 00						.BYTE $00
   404 BD41 00						.BYTE $00
   404 BD42 00						.BYTE $00
   404 BD43 00						.BYTE $00
   404 BD44 00						.BYTE $00
   404 BD45 00						.BYTE $00
   404 BD46 00						.BYTE $00
   404 BD47 00						.BYTE $00
   404 BD48 00						.BYTE $00
   404 BD49 00						.BYTE $00
   404 BD4A 00						.BYTE $00
   404 BD4B 00						.BYTE $00
   404 BD4C 00						.BYTE $00
   404 BD4D 00						.BYTE $00
   404 BD4E 00						.BYTE $00
   404 BD4F 00						.BYTE $00
   404 BD50 00						.BYTE $00
   404 BD51 00						.BYTE $00
   404 BD52 00						.BYTE $00
   404 BD53 00						.BYTE $00
   404 BD54 00						.BYTE $00
   404 BD55 00						.BYTE $00
   404 BD56 00						.BYTE $00
   404 BD57 00						.BYTE $00
   404 BD58 00						.BYTE $00
   404 BD59 00						.BYTE $00
   404 BD5A 00						.BYTE $00
   404 BD5B 00						.BYTE $00
   404 BD5C 00						.BYTE $00
   404 BD5D 00						.BYTE $00
   404 BD5E 00						.BYTE $00
   404 BD5F 00						.BYTE $00
   404 BD60 00						.BYTE $00
   404 BD61 00						.BYTE $00
   404 BD62 00						.BYTE $00
   404 BD63 00						.BYTE $00
   404 BD64 00						.BYTE $00
   404 BD65 00						.BYTE $00
   404 BD66 00						.BYTE $00
   404 BD67 00						.BYTE $00
   404 BD68 00						.BYTE $00
   404 BD69 00						.BYTE $00
   404 BD6A 00						.BYTE $00
   404 BD6B 00						.BYTE $00
   404 BD6C 00						.BYTE $00
   404 BD6D 00						.BYTE $00
   404 BD6E 00						.BYTE $00
   404 BD6F 00						.BYTE $00
   404 BD70 00						.BYTE $00
   404 BD71 00						.BYTE $00
   404 BD72 00						.BYTE $00
   404 BD73 00						.BYTE $00
   404 BD74 00						.BYTE $00
   404 BD75 00						.BYTE $00
   404 BD76 00						.BYTE $00
   404 BD77 00						.BYTE $00
   404 BD78 00						.BYTE $00
   404 BD79 00						.BYTE $00
   404 BD7A 00						.BYTE $00
   404 BD7B 00						.BYTE $00
   404 BD7C 00						.BYTE $00
   404 BD7D 00						.BYTE $00
   404 BD7E 00						.BYTE $00
   404 BD7F 00						.BYTE $00
   404 BD80 00						.BYTE $00
   404 BD81 00						.BYTE $00
   404 BD82 00						.BYTE $00
   404 BD83 00						.BYTE $00
   404 BD84 00						.BYTE $00
   404 BD85 00						.BYTE $00
   404 BD86 00						.BYTE $00
   404 BD87 00						.BYTE $00
   404 BD88 00						.BYTE $00
   404 BD89 00						.BYTE $00
   404 BD8A 00						.BYTE $00
   404 BD8B 00						.BYTE $00
   404 BD8C 00						.BYTE $00
   404 BD8D 00						.BYTE $00
   404 BD8E 00						.BYTE $00
   404 BD8F 00						.BYTE $00
   404 BD90 00						.BYTE $00
   404 BD91 00						.BYTE $00
   404 BD92 00						.BYTE $00
   404 BD93 00						.BYTE $00
   404 BD94 00						.BYTE $00
   404 BD95 00						.BYTE $00
   404 BD96 00						.BYTE $00
   404 BD97 00						.BYTE $00
   404 BD98 00						.BYTE $00
   404 BD99 00						.BYTE $00
   404 BD9A 00						.BYTE $00
   404 BD9B 00						.BYTE $00
   404 BD9C 00						.BYTE $00
   404 BD9D 00						.BYTE $00
   404 BD9E 00						.BYTE $00
   404 BD9F 00						.BYTE $00
   404 BDA0 00						.BYTE $00
   404 BDA1 00						.BYTE $00
   404 BDA2 00						.BYTE $00
   404 BDA3 00						.BYTE $00
   404 BDA4 00						.BYTE $00
   404 BDA5 00						.BYTE $00
   404 BDA6 00						.BYTE $00
   404 BDA7 00						.BYTE $00
   404 BDA8 00						.BYTE $00
   404 BDA9 00						.BYTE $00
   404 BDAA 00						.BYTE $00
   404 BDAB 00						.BYTE $00
   404 BDAC 00						.BYTE $00
   404 BDAD 00						.BYTE $00
   404 BDAE 00						.BYTE $00
   404 BDAF 00						.BYTE $00
   404 BDB0 00						.BYTE $00
   404 BDB1 00						.BYTE $00
   404 BDB2 00						.BYTE $00
   404 BDB3 00						.BYTE $00
   404 BDB4 00						.BYTE $00
   404 BDB5 00						.BYTE $00
   404 BDB6 00						.BYTE $00
   404 BDB7 00						.BYTE $00
   404 BDB8 00						.BYTE $00
   404 BDB9 00						.BYTE $00
   404 BDBA 00						.BYTE $00
   404 BDBB 00						.BYTE $00
   404 BDBC 00						.BYTE $00
   404 BDBD 00						.BYTE $00
   404 BDBE 00						.BYTE $00
   404 BDBF 00						.BYTE $00
   404 BDC0 00						.BYTE $00
   404 BDC1 00						.BYTE $00
   404 BDC2 00						.BYTE $00
   404 BDC3 00						.BYTE $00
   404 BDC4 00						.BYTE $00
   404 BDC5 00						.BYTE $00
   404 BDC6 00						.BYTE $00
   404 BDC7 00						.BYTE $00
   404 BDC8 00						.BYTE $00
   404 BDC9 00						.BYTE $00
   404 BDCA 00						.BYTE $00
   404 BDCB 00						.BYTE $00
   404 BDCC 00						.BYTE $00
   404 BDCD 00						.BYTE $00
   404 BDCE 00						.BYTE $00
   404 BDCF 00						.BYTE $00
   404 BDD0 00						.BYTE $00
   404 BDD1 00						.BYTE $00
   404 BDD2 00						.BYTE $00
   404 BDD3 00						.BYTE $00
   404 BDD4 00						.BYTE $00
   404 BDD5 00						.BYTE $00
   404 BDD6 00						.BYTE $00
   404 BDD7 00						.BYTE $00
   404 BDD8 00						.BYTE $00
   404 BDD9 00						.BYTE $00
   404 BDDA 00						.BYTE $00
   404 BDDB 00						.BYTE $00
   404 BDDC 00						.BYTE $00
   404 BDDD 00						.BYTE $00
   404 BDDE 00						.BYTE $00
   404 BDDF 00						.BYTE $00
   404 BDE0 00						.BYTE $00
   404 BDE1 00						.BYTE $00
   404 BDE2 00						.BYTE $00
   404 BDE3 00						.BYTE $00
   404 BDE4 00						.BYTE $00
   404 BDE5 00						.BYTE $00
   404 BDE6 00						.BYTE $00
   404 BDE7 00						.BYTE $00
   404 BDE8 00						.BYTE $00
   404 BDE9 00						.BYTE $00
   404 BDEA 00						.BYTE $00
   404 BDEB 00						.BYTE $00
   404 BDEC 00						.BYTE $00
   404 BDED 00						.BYTE $00
   404 BDEE 00						.BYTE $00
   404 BDEF 00						.BYTE $00
   404 BDF0 00						.BYTE $00
   404 BDF1 00						.BYTE $00
   404 BDF2 00						.BYTE $00
   404 BDF3 00						.BYTE $00
   404 BDF4 00						.BYTE $00
   404 BDF5 00						.BYTE $00
   404 BDF6 00						.BYTE $00
   404 BDF7 00						.BYTE $00
   404 BDF8 00						.BYTE $00
   404 BDF9 00						.BYTE $00
   404 BDFA 00						.BYTE $00
   404 BDFB 00						.BYTE $00
   404 BDFC 00						.BYTE $00
   404 BDFD 00						.BYTE $00
   404 BDFE 00						.BYTE $00
   404 BDFF 00						.BYTE $00
   404 BE00 00						.BYTE $00
   404 BE01 00						.BYTE $00
   404 BE02 00						.BYTE $00
   404 BE03 00						.BYTE $00
   404 BE04 00						.BYTE $00
   404 BE05 00						.BYTE $00
   404 BE06 00						.BYTE $00
   404 BE07 00						.BYTE $00
   404 BE08 00						.BYTE $00
   404 BE09 00						.BYTE $00
   404 BE0A 00						.BYTE $00
   404 BE0B 00						.BYTE $00
   404 BE0C 00						.BYTE $00
   404 BE0D 00						.BYTE $00
   404 BE0E 00						.BYTE $00
   404 BE0F 00						.BYTE $00
   404 BE10 00						.BYTE $00
   404 BE11 00						.BYTE $00
   404 BE12 00						.BYTE $00
   404 BE13 00						.BYTE $00
   404 BE14 00						.BYTE $00
   404 BE15 00						.BYTE $00
   404 BE16 00						.BYTE $00
   404 BE17 00						.BYTE $00
   404 BE18 00						.BYTE $00
   404 BE19 00						.BYTE $00
   404 BE1A 00						.BYTE $00
   404 BE1B 00						.BYTE $00
   404 BE1C 00						.BYTE $00
   404 BE1D 00						.BYTE $00
   404 BE1E 00						.BYTE $00
   404 BE1F 00						.BYTE $00
   404 BE20 00						.BYTE $00
   404 BE21 00						.BYTE $00
   404 BE22 00						.BYTE $00
   404 BE23 00						.BYTE $00
   404 BE24 00						.BYTE $00
   404 BE25 00						.BYTE $00
   404 BE26 00						.BYTE $00
   404 BE27 00						.BYTE $00
   404 BE28 00						.BYTE $00
   404 BE29 00						.BYTE $00
   404 BE2A 00						.BYTE $00
   404 BE2B 00						.BYTE $00
   404 BE2C 00						.BYTE $00
   404 BE2D 00						.BYTE $00
   404 BE2E 00						.BYTE $00
   404 BE2F 00						.BYTE $00
   404 BE30 00						.BYTE $00
   404 BE31 00						.BYTE $00
   404 BE32 00						.BYTE $00
   404 BE33 00						.BYTE $00
   404 BE34 00						.BYTE $00
   404 BE35 00						.BYTE $00
   404 BE36 00						.BYTE $00
   404 BE37 00						.BYTE $00
   404 BE38 00						.BYTE $00
   404 BE39 00						.BYTE $00
   404 BE3A 00						.BYTE $00
   404 BE3B 00						.BYTE $00
   404 BE3C 00						.BYTE $00
   404 BE3D 00						.BYTE $00
   404 BE3E 00						.BYTE $00
   404 BE3F 00						.BYTE $00
   404 BE40 00						.BYTE $00
   404 BE41 00						.BYTE $00
   404 BE42 00						.BYTE $00
   404 BE43 00						.BYTE $00
   404 BE44 00						.BYTE $00
   404 BE45 00						.BYTE $00
   404 BE46 00						.BYTE $00
   404 BE47 00						.BYTE $00
   404 BE48 00						.BYTE $00
   404 BE49 00						.BYTE $00
   404 BE4A 00						.BYTE $00
   404 BE4B 00						.BYTE $00
   404 BE4C 00						.BYTE $00
   404 BE4D 00						.BYTE $00
   404 BE4E 00						.BYTE $00
   404 BE4F 00						.BYTE $00
   404 BE50 00						.BYTE $00
   404 BE51 00						.BYTE $00
   404 BE52 00						.BYTE $00
   404 BE53 00						.BYTE $00
   404 BE54 00						.BYTE $00
   404 BE55 00						.BYTE $00
   404 BE56 00						.BYTE $00
   404 BE57 00						.BYTE $00
   404 BE58 00						.BYTE $00
   404 BE59 00						.BYTE $00
   404 BE5A 00						.BYTE $00
   404 BE5B 00						.BYTE $00
   404 BE5C 00						.BYTE $00
   404 BE5D 00						.BYTE $00
   404 BE5E 00						.BYTE $00
   404 BE5F 00						.BYTE $00
   404 BE60 00						.BYTE $00
   404 BE61 00						.BYTE $00
   404 BE62 00						.BYTE $00
   404 BE63 00						.BYTE $00
   404 BE64 00						.BYTE $00
   404 BE65 00						.BYTE $00
   404 BE66 00						.BYTE $00
   404 BE67 00						.BYTE $00
   404 BE68 00						.BYTE $00
   404 BE69 00						.BYTE $00
   404 BE6A 00						.BYTE $00
   404 BE6B 00						.BYTE $00
   404 BE6C 00						.BYTE $00
   404 BE6D 00						.BYTE $00
   404 BE6E 00						.BYTE $00
   404 BE6F 00						.BYTE $00
   404 BE70 00						.BYTE $00
   404 BE71 00						.BYTE $00
   404 BE72 00						.BYTE $00
   404 BE73 00						.BYTE $00
   404 BE74 00						.BYTE $00
   404 BE75 00						.BYTE $00
   404 BE76 00						.BYTE $00
   404 BE77 00						.BYTE $00
   404 BE78 00						.BYTE $00
   404 BE79 00						.BYTE $00
   404 BE7A 00						.BYTE $00
   404 BE7B 00						.BYTE $00
   404 BE7C 00						.BYTE $00
   404 BE7D 00						.BYTE $00
   404 BE7E 00						.BYTE $00
   404 BE7F 00						.BYTE $00
   404 BE80 00						.BYTE $00
   404 BE81 00						.BYTE $00
   404 BE82 00						.BYTE $00
   404 BE83 00						.BYTE $00
   404 BE84 00						.BYTE $00
   404 BE85 00						.BYTE $00
   404 BE86 00						.BYTE $00
   404 BE87 00						.BYTE $00
   404 BE88 00						.BYTE $00
   404 BE89 00						.BYTE $00
   404 BE8A 00						.BYTE $00
   404 BE8B 00						.BYTE $00
   404 BE8C 00						.BYTE $00
   404 BE8D 00						.BYTE $00
   404 BE8E 00						.BYTE $00
   404 BE8F 00						.BYTE $00
   404 BE90 00						.BYTE $00
   404 BE91 00						.BYTE $00
   404 BE92 00						.BYTE $00
   404 BE93 00						.BYTE $00
   404 BE94 00						.BYTE $00
   404 BE95 00						.BYTE $00
   404 BE96 00						.BYTE $00
   404 BE97 00						.BYTE $00
   404 BE98 00						.BYTE $00
   404 BE99 00						.BYTE $00
   404 BE9A 00						.BYTE $00
   404 BE9B 00						.BYTE $00
   404 BE9C 00						.BYTE $00
   404 BE9D 00						.BYTE $00
   404 BE9E 00						.BYTE $00
   404 BE9F 00						.BYTE $00
   404 BEA0 00						.BYTE $00
   404 BEA1 00						.BYTE $00
   404 BEA2 00						.BYTE $00
   404 BEA3 00						.BYTE $00
   404 BEA4 00						.BYTE $00
   404 BEA5 00						.BYTE $00
   404 BEA6 00						.BYTE $00
   404 BEA7 00						.BYTE $00
   404 BEA8 00						.BYTE $00
   404 BEA9 00						.BYTE $00
   404 BEAA 00						.BYTE $00
   404 BEAB 00						.BYTE $00
   404 BEAC 00						.BYTE $00
   404 BEAD 00						.BYTE $00
   404 BEAE 00						.BYTE $00
   404 BEAF 00						.BYTE $00
   404 BEB0 00						.BYTE $00
   404 BEB1 00						.BYTE $00
   404 BEB2 00						.BYTE $00
   404 BEB3 00						.BYTE $00
   404 BEB4 00						.BYTE $00
   404 BEB5 00						.BYTE $00
   404 BEB6 00						.BYTE $00
   404 BEB7 00						.BYTE $00
   404 BEB8 00						.BYTE $00
   404 BEB9 00						.BYTE $00
   404 BEBA 00						.BYTE $00
   404 BEBB 00						.BYTE $00
   404 BEBC 00						.BYTE $00
   404 BEBD 00						.BYTE $00
   404 BEBE 00						.BYTE $00
   404 BEBF 00						.BYTE $00
   404 BEC0 00						.BYTE $00
   404 BEC1 00						.BYTE $00
   404 BEC2 00						.BYTE $00
   404 BEC3 00						.BYTE $00
   404 BEC4 00						.BYTE $00
   404 BEC5 00						.BYTE $00
   404 BEC6 00						.BYTE $00
   404 BEC7 00						.BYTE $00
   404 BEC8 00						.BYTE $00
   404 BEC9 00						.BYTE $00
   404 BECA 00						.BYTE $00
   404 BECB 00						.BYTE $00
   404 BECC 00						.BYTE $00
   404 BECD 00						.BYTE $00
   404 BECE 00						.BYTE $00
   404 BECF 00						.BYTE $00
   404 BED0 00						.BYTE $00
   404 BED1 00						.BYTE $00
   404 BED2 00						.BYTE $00
   404 BED3 00						.BYTE $00
   404 BED4 00						.BYTE $00
   404 BED5 00						.BYTE $00
   404 BED6 00						.BYTE $00
   404 BED7 00						.BYTE $00
   404 BED8 00						.BYTE $00
   404 BED9 00						.BYTE $00
   404 BEDA 00						.BYTE $00
   404 BEDB 00						.BYTE $00
   404 BEDC 00						.BYTE $00
   404 BEDD 00						.BYTE $00
   404 BEDE 00						.BYTE $00
   404 BEDF 00						.BYTE $00
   404 BEE0 00						.BYTE $00
   404 BEE1 00						.BYTE $00
   404 BEE2 00						.BYTE $00
   404 BEE3 00						.BYTE $00
   404 BEE4 00						.BYTE $00
   404 BEE5 00						.BYTE $00
   404 BEE6 00						.BYTE $00
   404 BEE7 00						.BYTE $00
   404 BEE8 00						.BYTE $00
   404 BEE9 00						.BYTE $00
   404 BEEA 00						.BYTE $00
   404 BEEB 00						.BYTE $00
   404 BEEC 00						.BYTE $00
   404 BEED 00						.BYTE $00
   404 BEEE 00						.BYTE $00
   404 BEEF 00						.BYTE $00
   404 BEF0 00						.BYTE $00
   404 BEF1 00						.BYTE $00
   404 BEF2 00						.BYTE $00
   404 BEF3 00						.BYTE $00
   404 BEF4 00						.BYTE $00
   404 BEF5 00						.BYTE $00
   404 BEF6 00						.BYTE $00
   404 BEF7 00						.BYTE $00
   404 BEF8 00						.BYTE $00
   404 BEF9 00						.BYTE $00
   404 BEFA 00						.BYTE $00
   404 BEFB 00						.BYTE $00
   404 BEFC 00						.BYTE $00
   404 BEFD 00						.BYTE $00
   404 BEFE 00						.BYTE $00
   404 BEFF 00						.BYTE $00
   404 BF00 00						.BYTE $00
   404 BF01 00						.BYTE $00
   404 BF02 00						.BYTE $00
   404 BF03 00						.BYTE $00
   404 BF04 00						.BYTE $00
   404 BF05 00						.BYTE $00
   404 BF06 00						.BYTE $00
   404 BF07 00						.BYTE $00
   404 BF08 00						.BYTE $00
   404 BF09 00						.BYTE $00
   404 BF0A 00						.BYTE $00
   404 BF0B 00						.BYTE $00
   404 BF0C 00						.BYTE $00
   404 BF0D 00						.BYTE $00
   404 BF0E 00						.BYTE $00
   404 BF0F 00						.BYTE $00
   404 BF10 00						.BYTE $00
   404 BF11 00						.BYTE $00
   404 BF12 00						.BYTE $00
   404 BF13 00						.BYTE $00
   404 BF14 00						.BYTE $00
   404 BF15 00						.BYTE $00
   404 BF16 00						.BYTE $00
   404 BF17 00						.BYTE $00
   404 BF18 00						.BYTE $00
   404 BF19 00						.BYTE $00
   404 BF1A 00						.BYTE $00
   404 BF1B 00						.BYTE $00
   404 BF1C 00						.BYTE $00
   404 BF1D 00						.BYTE $00
   404 BF1E 00						.BYTE $00
   404 BF1F 00						.BYTE $00
   404 BF20 00						.BYTE $00
   404 BF21 00						.BYTE $00
   404 BF22 00						.BYTE $00
   404 BF23 00						.BYTE $00
   404 BF24 00						.BYTE $00
   404 BF25 00						.BYTE $00
   404 BF26 00						.BYTE $00
   404 BF27 00						.BYTE $00
   404 BF28 00						.BYTE $00
   404 BF29 00						.BYTE $00
   404 BF2A 00						.BYTE $00
   404 BF2B 00						.BYTE $00
   404 BF2C 00						.BYTE $00
   404 BF2D 00						.BYTE $00
   404 BF2E 00						.BYTE $00
   404 BF2F 00						.BYTE $00
   404 BF30 00						.BYTE $00
   404 BF31 00						.BYTE $00
   404 BF32 00						.BYTE $00
   404 BF33 00						.BYTE $00
   404 BF34 00						.BYTE $00
   404 BF35 00						.BYTE $00
   404 BF36 00						.BYTE $00
   404 BF37 00						.BYTE $00
   404 BF38 00						.BYTE $00
   404 BF39 00						.BYTE $00
   404 BF3A 00						.BYTE $00
   404 BF3B 00						.BYTE $00
   404 BF3C 00						.BYTE $00
   404 BF3D 00						.BYTE $00
   404 BF3E 00						.BYTE $00
   404 BF3F 00						.BYTE $00
   404 BF40 00						.BYTE $00
   404 BF41 00						.BYTE $00
   404 BF42 00						.BYTE $00
   404 BF43 00						.BYTE $00
   404 BF44 00						.BYTE $00
   404 BF45 00						.BYTE $00
   404 BF46 00						.BYTE $00
   404 BF47 00						.BYTE $00
   404 BF48 00						.BYTE $00
   404 BF49 00						.BYTE $00
   404 BF4A 00						.BYTE $00
   404 BF4B 00						.BYTE $00
   404 BF4C 00						.BYTE $00
   404 BF4D 00						.BYTE $00
   404 BF4E 00						.BYTE $00
   404 BF4F 00						.BYTE $00
   404 BF50 00						.BYTE $00
   404 BF51 00						.BYTE $00
   404 BF52 00						.BYTE $00
   404 BF53 00						.BYTE $00
   404 BF54 00						.BYTE $00
   404 BF55 00						.BYTE $00
   404 BF56 00						.BYTE $00
   404 BF57 00						.BYTE $00
   404 BF58 00						.BYTE $00
   404 BF59 00						.BYTE $00
   404 BF5A 00						.BYTE $00
   404 BF5B 00						.BYTE $00
   404 BF5C 00						.BYTE $00
   404 BF5D 00						.BYTE $00
   404 BF5E 00						.BYTE $00
   404 BF5F 00						.BYTE $00
   404 BF60 00						.BYTE $00
   404 BF61 00						.BYTE $00
   404 BF62 00						.BYTE $00
   404 BF63 00						.BYTE $00
   404 BF64 00						.BYTE $00
   404 BF65 00						.BYTE $00
   404 BF66 00						.BYTE $00
   404 BF67 00						.BYTE $00
   404 BF68 00						.BYTE $00
   404 BF69 00						.BYTE $00
   404 BF6A 00						.BYTE $00
   404 BF6B 00						.BYTE $00
   404 BF6C 00						.BYTE $00
   404 BF6D 00						.BYTE $00
   404 BF6E 00						.BYTE $00
   404 BF6F 00						.BYTE $00
   404 BF70 00						.BYTE $00
   404 BF71 00						.BYTE $00
   404 BF72 00						.BYTE $00
   404 BF73 00						.BYTE $00
   404 BF74 00						.BYTE $00
   404 BF75 00						.BYTE $00
   404 BF76 00						.BYTE $00
   404 BF77 00						.BYTE $00
   404 BF78 00						.BYTE $00
   404 BF79 00						.BYTE $00
   404 BF7A 00						.BYTE $00
   404 BF7B 00						.BYTE $00
   404 BF7C 00						.BYTE $00
   404 BF7D 00						.BYTE $00
   404 BF7E 00						.BYTE $00
   404 BF7F 00						.BYTE $00
   404 BF80 00						.BYTE $00
   404 BF81 00						.BYTE $00
   404 BF82 00						.BYTE $00
   404 BF83 00						.BYTE $00
   404 BF84 00						.BYTE $00
   404 BF85 00						.BYTE $00
   404 BF86 00						.BYTE $00
   404 BF87 00						.BYTE $00
   404 BF88 00						.BYTE $00
   404 BF89 00						.BYTE $00
   404 BF8A 00						.BYTE $00
   404 BF8B 00						.BYTE $00
   404 BF8C 00						.BYTE $00
   404 BF8D 00						.BYTE $00
   404 BF8E 00						.BYTE $00
   404 BF8F 00						.BYTE $00
   404 BF90 00						.BYTE $00
   404 BF91 00						.BYTE $00
   404 BF92 00						.BYTE $00
   404 BF93 00						.BYTE $00
   404 BF94 00						.BYTE $00
   404 BF95 00						.BYTE $00
   404 BF96 00						.BYTE $00
   404 BF97 00						.BYTE $00
   404 BF98 00						.BYTE $00
   404 BF99 00						.BYTE $00
   404 BF9A 00						.BYTE $00
   404 BF9B 00						.BYTE $00
   404 BF9C 00						.BYTE $00
   404 BF9D 00						.BYTE $00
   404 BF9E 00						.BYTE $00
   404 BF9F 00						.BYTE $00
   404 BFA0 00						.BYTE $00
   404 BFA1 00						.BYTE $00
   404 BFA2 00						.BYTE $00
   404 BFA3 00						.BYTE $00
   404 BFA4 00						.BYTE $00
   404 BFA5 00						.BYTE $00
   404 BFA6 00						.BYTE $00
   404 BFA7 00						.BYTE $00
   404 BFA8 00						.BYTE $00
   404 BFA9 00						.BYTE $00
   404 BFAA 00						.BYTE $00
   404 BFAB 00						.BYTE $00
   404 BFAC 00						.BYTE $00
   404 BFAD 00						.BYTE $00
Source: E:\_8BitProjects\Series\Scroller\Scroller.asm
   406 					
   407 						; add extra line info to avoid problem with ladder in the last line	
   408 BFAE 61 61 61 61 61 61 + 		:LEVEL_CHAR_SIZE_X 		.byte $61
   409
   410 				;*****	Run Address
   411 				;
   412 02E0-02E1> 00 48				run InitSystem
